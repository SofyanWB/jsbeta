"use strict";(self.webpackChunkjakartasatubeta=self.webpackChunkjakartasatubeta||[]).push([[4517],{83978:function(e,t,r){r.d(t,{Z:function(){return h}});var n=r(15671),i=r(43144),a=r(11752),o=r(61120),u=r(60136),s=r(29388),l=r(27366),c=(r(32718),r(25243),r(63780),r(93169),r(10064),r(69912)),p=r(80613),f=r(82022),y=r(8548),d=function(e){(0,u.Z)(r,e);var t=(0,s.Z)(r);function r(){return(0,n.Z)(this,r),t.apply(this,arguments)}return(0,i.Z)(r,[{key:"doRender",value:function(e){e.drawPhase===p.jx.HIGHLIGHT&&(0,a.Z)((0,o.Z)(r.prototype),"doRender",this).call(this,e)}},{key:"renderChildren",value:function(e){if(this.attributeView.update(),this.children.some((function(e){return e.hasData}))){this.attributeView.bindTextures(e.context),(0,a.Z)((0,o.Z)(r.prototype),"renderChildren",this).call(this,e);var t=e.painter.effects.highlight;t.bind(e),e.context.setColorMask(!0,!0,!0,!0),e.context.clear(y.lk.COLOR_BUFFER_BIT),this._renderChildren(e,t.defines.concat(["highlightAll"])),t.draw(e),t.unbind()}}}]),r}(f.Z),h=d=(0,l._)([(0,c.j)("esri.views.2d.layers.support.HighlightGraphicContainer")],d)},84848:function(e,t,r){r.d(t,{VF:function(){return ye},Uf:function(){return fe}});var n=r(1413),i=r(93433),a=r(29439),o=r(37762),u=r(74165),s=r(15861),l=r(15671),c=r(43144),p=r(60136),f=r(29388),y=r(27366),d=r(52639),h=r(7138),v=r(63780),m=r(40281),b=r(10064),g=r(42537),x=r(93169),w=r(77427),Z=r(66978),k=r(94172),_=r(68860),F=r(49861),C=r(25243),I=r(69912),S=r(53866),R=r(82582),j=r(37270),E=r(87072);function O(e,t){return t?"xoffset"in t&&t.xoffset?Math.max(e,Math.abs(t.xoffset)):"yoffset"in t&&t.yoffset?Math.max(e,Math.abs(t.yoffset||0)):e:e}function P(e,t){return"number"==typeof e?e:e&&e.stops&&e.stops.length?function(e){for(var t=0,r=0,n=0;n<e.length;n++){var i=e[n].size;"number"==typeof i&&(t+=i,r++)}return t/r}(e.stops):t}function N(e,t){if(!t)return e;var r=t.filter((function(e){return"size"===e.type})).map((function(t){var r=t.maxSize,n=t.minSize;return(P(r,e)+P(n,e))/2})),n=0,i=r.length;if(0===i)return e;for(var a=0;a<i;a++)n+=r[a];var o=Math.floor(n/i);return Math.max(o,e)}function V(e){var t=e&&e.renderer,r="touch"===(e&&e.event&&e.event.pointerType)?9:6;if(!t)return r;var n="visualVariables"in t?N(r,t.visualVariables):r;if("simple"===t.type)return O(n,t.symbol);if("unique-value"===t.type){var i,a=n;return null!==(i=t.uniqueValueInfos)&&void 0!==i&&i.forEach((function(e){a=O(a,e.symbol)})),a}if("class-breaks"===t.type){var o=n;return t.classBreakInfos.forEach((function(e){o=O(o,e.symbol)})),o}return"dot-density"===t.type||t.type,n}var G=r(76200),T=r(91340),M=r(23084),A=r(76672),L=r(77981),U=r(58132),H=function(e){return e.spatialReference.wkid||JSON.stringify(e.spatialReference)};function J(e,t){var r=e.toJSON(),n=r.dpi,i=r.gdbVersion,a=r.geometry,o=r.geometryPrecision,u=r.height,s=r.layerOption,l=r.mapExtent,c=r.maxAllowableOffset,p=r.returnFieldName,f=r.returnGeometry,y=r.returnUnformattedValues,d=r.returnZ,h=r.spatialReference,v=r.timeExtent,m=r.tolerance,b=r.width,g=q(e),x=g.dynamicLayers,w=g.layerDefs,Z=g.layerIds,k=t&&null!=t.geometry?t.geometry:null,_={geometryPrecision:o,maxAllowableOffset:c,returnFieldName:p,returnGeometry:f,returnUnformattedValues:y,returnZ:d,tolerance:m},F=k&&k.toJSON()||a;if(_.imageDisplay="".concat(b,",").concat(u,",").concat(n),i&&(_.gdbVersion=i),F&&(delete F.spatialReference,_.geometry=JSON.stringify(F),_.geometryType=(0,L.Ji)(F)),h?_.sr=h.wkid||JSON.stringify(h):F&&F.spatialReference?_.sr=H(F):l&&l.spatialReference&&(_.sr=H(l)),_.time=v?[v.start,v.end].join(","):null,l){var C=l.xmin,I=l.ymin,S=l.xmax,R=l.ymax;_.mapExtent="".concat(C,",").concat(I,",").concat(S,",").concat(R)}return w&&(_.layerDefs=w),x&&!w&&(_.dynamicLayers=x),_.layers="popup"===s?"visible":s,Z&&!x&&(_.layers+=":".concat(Z.join(","))),_}function q(e){var t,r,n=e.mapExtent,i=e.floors,a=e.width,u=e.sublayers,s=e.layerIds,l=e.layerOption,c=e.gdbVersion,p=null===u||void 0===u||null===(t=u.find((function(e){return null!=e.layer})))||void 0===t||null===(r=t.layer)||void 0===r?void 0:r.serviceSublayers,f="popup"===l,y={},d=(0,R.yZ)({extent:n,width:a,spatialReference:null===n||void 0===n?void 0:n.spatialReference}),h=[];if(null!==u&&void 0!==u&&u.forEach((function e(t){var r=0===d,n=0===t.minScale||d<=t.minScale,i=0===t.maxScale||d>=t.maxScale;if(t.visible&&(r||n&&i))if(t.sublayers)t.sublayers.forEach(e);else{if(!1===(null===s||void 0===s?void 0:s.includes(t.id))||f&&(!t.popupTemplate||!t.popupEnabled))return;h.unshift(t)}})),u&&!h.length)y.layerIds=[];else{var v=(0,U.FN)(h,p,c),m=h.map((function(e){var t=(0,E.f)(i,e);return e.toExportImageJSON(t)}));if(v)y.dynamicLayers=JSON.stringify(m);else{if(u){var b=h.map((function(e){return e.id}));s&&(b=b.filter((function(e){return s.includes(e)}))),y.layerIds=b}else(null===s||void 0===s?void 0:s.length)&&(y.layerIds=s);var g=function(e,t){var r=!(null===e||void 0===e||!e.length),n=t.filter((function(e){return null!=e.definitionExpression||r&&null!=e.floorInfo}));return n.length?n.map((function(t){var r=(0,E.f)(e,t),n=(0,A._)(r,t.definitionExpression);return{id:t.id,definitionExpression:null!==n&&void 0!==n?n:void 0}})):null}(i,h);if(null!=g&&g.length){var x,w={},Z=(0,o.Z)(g);try{for(Z.s();!(x=Z.n()).done;){var k=x.value;k.definitionExpression&&(w[k.id]=k.definitionExpression)}}catch(_){Z.e(_)}finally{Z.f()}Object.keys(w).length&&(y.layerDefs=JSON.stringify(w))}}}return y}var Q,z=r(59486),B=r(62044),D=r(46784),K=r(78952),W=Q=function(e){(0,p.Z)(r,e);var t=(0,f.Z)(r);function r(e){var n;return(0,l.Z)(this,r),(n=t.call(this,e)).dpi=96,n.floors=null,n.gdbVersion=null,n.geometry=null,n.geometryPrecision=null,n.height=400,n.layerIds=null,n.layerOption="top",n.mapExtent=null,n.maxAllowableOffset=null,n.returnFieldName=!0,n.returnGeometry=!1,n.returnM=!1,n.returnUnformattedValues=!0,n.returnZ=!1,n.spatialReference=null,n.sublayers=null,n.timeExtent=null,n.tolerance=null,n.width=400,n}return(0,c.Z)(r,null,[{key:"from",value:function(e){return(0,C.TJ)(Q,e)}}]),r}(D.wq);(0,y._)([(0,F.Cb)({type:Number,json:{write:!0}})],W.prototype,"dpi",void 0),(0,y._)([(0,F.Cb)()],W.prototype,"floors",void 0),(0,y._)([(0,F.Cb)({type:String,json:{write:!0}})],W.prototype,"gdbVersion",void 0),(0,y._)([(0,F.Cb)({types:z.qM,json:{read:L.im,write:!0}})],W.prototype,"geometry",void 0),(0,y._)([(0,F.Cb)({type:Number,json:{write:!0}})],W.prototype,"geometryPrecision",void 0),(0,y._)([(0,F.Cb)({type:Number,json:{write:!0}})],W.prototype,"height",void 0),(0,y._)([(0,F.Cb)({type:[Number],json:{write:!0}})],W.prototype,"layerIds",void 0),(0,y._)([(0,F.Cb)({type:["top","visible","all","popup"],json:{write:!0}})],W.prototype,"layerOption",void 0),(0,y._)([(0,F.Cb)({type:S.Z,json:{write:!0}})],W.prototype,"mapExtent",void 0),(0,y._)([(0,F.Cb)({type:Number,json:{write:!0}})],W.prototype,"maxAllowableOffset",void 0),(0,y._)([(0,F.Cb)({type:Boolean,json:{write:!0}})],W.prototype,"returnFieldName",void 0),(0,y._)([(0,F.Cb)({type:Boolean,json:{write:!0}})],W.prototype,"returnGeometry",void 0),(0,y._)([(0,F.Cb)({type:Boolean,json:{write:!0}})],W.prototype,"returnM",void 0),(0,y._)([(0,F.Cb)({type:Boolean,json:{write:!0}})],W.prototype,"returnUnformattedValues",void 0),(0,y._)([(0,F.Cb)({type:Boolean,json:{write:!0}})],W.prototype,"returnZ",void 0),(0,y._)([(0,F.Cb)({type:K.Z,json:{write:!0}})],W.prototype,"spatialReference",void 0),(0,y._)([(0,F.Cb)()],W.prototype,"sublayers",void 0),(0,y._)([(0,F.Cb)({type:B.Z,json:{write:!0}})],W.prototype,"timeExtent",void 0),(0,y._)([(0,F.Cb)({type:Number,json:{write:!0}})],W.prototype,"tolerance",void 0),(0,y._)([(0,F.Cb)({type:Number,json:{write:!0}})],W.prototype,"width",void 0);var X=W=Q=(0,y._)([(0,I.j)("esri.rest.support.IdentifyParameters")],W),Y=r(38511),$=r(31201),ee=r(27823),te=function(e){(0,p.Z)(r,e);var t=(0,f.Z)(r);function r(e){var n;return(0,l.Z)(this,r),(n=t.call(this,e)).displayFieldName=null,n.feature=null,n.layerId=null,n.layerName=null,n}return(0,c.Z)(r,[{key:"readFeature",value:function(e,t){return d.Z.fromJSON({attributes:(0,n.Z)({},t.attributes),geometry:(0,n.Z)({},t.geometry)})}},{key:"writeFeature",value:function(e,t){if(e){var r=e.attributes,i=e.geometry;r&&(t.attributes=(0,n.Z)({},r)),null!=i&&(t.geometry=i.toJSON(),t.geometryType=ee.P.toJSON(i.type))}}}]),r}(D.wq);(0,y._)([(0,F.Cb)({type:String,json:{write:!0}})],te.prototype,"displayFieldName",void 0),(0,y._)([(0,F.Cb)({type:d.Z})],te.prototype,"feature",void 0),(0,y._)([(0,Y.r)("feature",["attributes","geometry"])],te.prototype,"readFeature",null),(0,y._)([(0,$.c)("feature")],te.prototype,"writeFeature",null),(0,y._)([(0,F.Cb)({type:Number,json:{write:!0}})],te.prototype,"layerId",void 0),(0,y._)([(0,F.Cb)({type:String,json:{write:!0}})],te.prototype,"layerName",void 0);var re=te=(0,y._)([(0,I.j)("esri.rest.support.IdentifyResult")],te);function ne(e,t,r){return ie.apply(this,arguments)}function ie(){return ie=(0,s.Z)((0,u.Z)().mark((function e(t,r,i){var a,o;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=(r=oe(r)).geometry?[r.geometry]:[],o=(0,M.en)(t),e.abrupt("return",(o.path+="/identify",(0,T.aX)(a).then((function(e){var t=J(r,{geometry:e&&e[0]}),a=(0,M.cv)((0,n.Z)((0,n.Z)({},o.query),{},{f:"json"},t)),u=(0,M.lA)(a,i);return(0,G.default)(o.path,u).then(ae).then((function(e){return ue(e,r.sublayers)}))}))));case 2:case"end":return e.stop()}}),e)}))),ie.apply(this,arguments)}function ae(e){var t=e.data;return t.results=t.results||[],t.exceededTransferLimit=Boolean(t.exceededTransferLimit),t.results=t.results.map((function(e){return re.fromJSON(e)})),t}function oe(e){return X.from(e)}function ue(e,t){if(null===t||void 0===t||!t.length)return e;var r=new Map;t.forEach((function e(t){r.set(t.id,t),t.sublayers&&t.sublayers.forEach(e)}));var n,i=(0,o.Z)(e.results);try{for(i.s();!(n=i.n()).done;){var a=n.value;a.feature.sourceLayer=r.get(a.layerId)}}catch(u){i.e(u)}finally{i.f()}return e}var se=r(819),le=r(16072),ce=r(24405),pe=null;function fe(e,t){return"tile"===t.type||"map-image"===t.type}var ye=function(e){(0,p.Z)(n,e);var t=(0,f.Z)(n);function n(e){var r;return(0,l.Z)(this,n),(r=t.call(this,e))._featuresResolutions=new WeakMap,r.highlightGraphics=null,r.highlightGraphicUpdated=null,r.updateHighlightedFeatures=(0,Z.Ds)(function(){var e=(0,s.Z)((0,u.Z)().mark((function e(t){return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.destroyed||r.updatingHandles.addPromise(r._updateHighlightedFeaturesGeometries(t).catch((function(){})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),r}return(0,c.Z)(n,[{key:"initialize",value:function(){var e=this,t=function(t){e.updatingHandles.addPromise(e._updateHighlightedFeaturesSymbols(t).catch((function(){}))),e.updateHighlightedFeatures(e._highlightGeometriesResolution)};this.addHandles([(0,k.on)((function(){return e.highlightGraphics}),"change",(function(e){return t(e.added)}),{onListenerAdd:function(e){return t(e)}})])}},{key:"fetchPopupFeatures",value:function(){var e=(0,s.Z)((0,u.Z)().mark((function e(t,r){var n,i,a,o,s,l,c,p;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=this.layerView,s=o.layer,l=o.view.scale,t){e.next=3;break}throw new b.Z("fetchPopupFeatures:invalid-area","Nothing to fetch without area",{layer:s});case 3:if((c=de(s.sublayers,l,r)).length){e.next=6;break}return e.abrupt("return",[]);case 6:return e.next=8,ve(s,c);case 8:if(p=e.sent,(null===(n=null===(i=s.capabilities)||void 0===i||null===(a=i.operations)||void 0===a?void 0:a.supportsIdentify)||void 0===n||n)&&s.version>=10.5||p){e.next=11;break}throw new b.Z("fetchPopupFeatures:not-supported","query operation is disabled for this service",{layer:s});case 11:return e.abrupt("return",p?this._fetchPopupFeaturesUsingQueries(t,c,r):this._fetchPopupFeaturesUsingIdentify(t,c,r));case 12:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"clearHighlights",value:function(){var e;null===(e=this.highlightGraphics)||void 0===e||e.removeAll()}},{key:"highlight",value:function(e){var t,r=this.highlightGraphics;if(!r)return{remove:function(){}};var n=null;if(e instanceof d.Z?n=[e]:m.Z.isCollection(e)&&e.length>0?n=e.toArray():Array.isArray(e)&&e.length>0&&(n=e),!(n=null===(t=n)||void 0===t?void 0:t.filter(v.pC))||!n.length)return(0,g.kB)();var i,a=(0,o.Z)(n);try{for(a.s();!(i=a.n()).done;){var u=i.value,s=u.sourceLayer;null!=s&&"geometryType"in s&&"point"===s.geometryType&&(u.visible=!1)}}catch(l){a.e(l)}finally{a.f()}return r.addMany(n),{remove:function(){var e;r.removeMany(null!==(e=n)&&void 0!==e?e:[])}}}},{key:"_updateHighlightedFeaturesSymbols",value:function(){var e=(0,s.Z)((0,u.Z)().mark((function e(t){var n,i,a,l,c,p;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.layerView.view,i=this.highlightGraphics,a=this.highlightGraphicUpdated,i&&a){l=(0,o.Z)(t);try{for(p=function(){var e=c.value,t=e.sourceLayer&&"renderer"in e.sourceLayer&&e.sourceLayer.renderer;e.sourceLayer&&"geometryType"in e.sourceLayer&&"point"===e.sourceLayer.geometryType&&t&&"getSymbolAsync"in t&&t.getSymbolAsync(e).then(function(){var o=(0,s.Z)((0,u.Z)().mark((function o(s){var l,c,p;return(0,u.Z)().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(s||(s=new le.Z),c=null,p="visualVariables"in t?null===(l=t.visualVariables)||void 0===l?void 0:l.find((function(e){return"size"===e.type})):void 0,o.t0=p,!o.t0){o.next=11;break}if(o.t1=pe,o.t1){o.next=10;break}return o.next=9,Promise.resolve().then(r.bind(r,56011));case 9:pe=o.sent.getSize;case 10:c=pe(p,e,{view:n.type,scale:n.scale,shape:"simple-marker"===s.type?s.style:null});case 11:c||(c="width"in s&&"height"in s&&null!=s.width&&null!=s.height?Math.max(s.width,s.height):"size"in s?s.size:16),i.includes(e)&&(e.symbol=new le.Z({style:"square",size:c,xoffset:"xoffset"in s?s.xoffset:0,yoffset:"yoffset"in s?s.yoffset:0}),a(e,"symbol"),e.visible=!0);case 13:case"end":return o.stop()}}),o)})));return function(e){return o.apply(this,arguments)}}())},l.s();!(c=l.n()).done;)p()}catch(f){l.e(f)}finally{l.f()}}case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_updateHighlightedFeaturesGeometries",value:function(){var e=(0,s.Z)((0,u.Z)().mark((function e(t){var r,n,s,l,c,p,f,y,d,h,v,m,b,g,x,Z,k,_,F,C,I;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.layerView,n=r.layer,s=r.view,l=this.highlightGraphics,c=this.highlightGraphicUpdated,this._highlightGeometriesResolution=t,c&&null!==l&&void 0!==l&&l.length&&n.capabilities.operations.supportsQuery){e.next=3;break}return e.abrupt("return");case 3:p=this._getTargetResolution(t),f=new Map,y=(0,o.Z)(l);try{for(y.s();!(d=y.n()).done;)h=d.value,(!this._featuresResolutions.has(h)||this._featuresResolutions.get(h)>p)&&(v=h.sourceLayer,(0,w.s1)(f,v,(function(){return new Map})).set(h.getObjectId(),h))}catch(u){y.e(u)}finally{y.f()}return m=Array.from(f,(function(e){var t=(0,a.Z)(e,2),r=t[0],n=t[1],o=r.createQuery();return o.objectIds=(0,i.Z)(n.keys()),o.outFields=[r.objectIdField],o.returnGeometry=!0,o.maxAllowableOffset=p,o.outSpatialReference=s.spatialReference,r.queryFeatures(o)})),e.next=9,Promise.all(m);case 9:if(b=e.sent,!this.destroyed){g=(0,o.Z)(b);try{for(g.s();!(x=g.n()).done;){Z=x.value.features,k=(0,o.Z)(Z);try{for(k.s();!(_=k.n()).done;)F=_.value,C=F.sourceLayer,(I=f.get(C).get(F.getObjectId()))&&l.includes(I)&&(I.geometry=F.geometry,c(I,"geometry"),this._featuresResolutions.set(I,p))}catch(u){k.e(u)}finally{k.f()}}}catch(u){g.e(u)}finally{g.f()}}case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_getTargetResolution",value:function(e){var t=e*(0,_.c9)(this.layerView.view.spatialReference),r=t/16;return r<=10?0:e/t*r}},{key:"_fetchPopupFeaturesUsingIdentify",value:function(){var e=(0,s.Z)((0,u.Z)().mark((function e(t,r,n){var i,a,o;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._createIdentifyParameters(t,r,n);case 2:if(null!=(i=e.sent)){e.next=5;break}return e.abrupt("return",[]);case 5:return e.next=7,ne(this.layerView.layer.parsedUrl,i);case 7:return a=e.sent,o=a.results,e.abrupt("return",o.map((function(e){return e.feature})));case 10:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"_createIdentifyParameters",value:function(){var e=(0,s.Z)((0,u.Z)().mark((function e(t,r,n){var i,a,o,s,l,c,p,f,y,d,h,v,m;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.layerView,a=i.floors,o=i.layer,s=i.timeExtent,l=i.view,c=l.spatialReference,p=l.scale,f=null!=n?n.event:null,r.length){e.next=3;break}return e.abrupt("return",null);case 3:return e.next=5,Promise.all(r.map((function(e){return e.sublayer.load().catch((function(){}))})));case 5:return y=Math.min((0,x.Z)("mapservice-popup-identify-max-tolerance"),o.allSublayers.reduce((function(e,t){return t.renderer?V({renderer:t.renderer,event:f}):e}),2)),d=this.createFetchPopupFeaturesQueryGeometry(t,y),h=(0,R.dp)(p,c),v=Math.round(d.width/h),m=new S.Z({xmin:d.center.x-h*v,ymin:d.center.y-h*v,xmax:d.center.x+h*v,ymax:d.center.y+h*v,spatialReference:d.spatialReference}),e.abrupt("return",new X({floors:a,gdbVersion:"gdbVersion"in o?o.gdbVersion:void 0,geometry:t,height:v,layerOption:"popup",mapExtent:m,returnGeometry:!0,spatialReference:c,sublayers:o.sublayers,timeExtent:s,tolerance:y,width:v}));case 7:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"_fetchPopupFeaturesUsingQueries",value:function(){var e=(0,s.Z)((0,u.Z)().mark((function e(t,r,n){var l,c,p,f,y,d=this;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=this.layerView,c=l.floors,p=l.timeExtent,f=null!=n?n.event:null,y=r.map(function(){var e=(0,s.Z)((0,u.Z)().mark((function e(r){var n,i,s,l,y,h,v,m,b,g,x,w,Z,k,_,F,C,I,S,R,O,P;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.sublayer,s=r.popupTemplate,e.next=3,i.load().catch((function(){}));case 3:if(!i.capabilities||i.capabilities.operations.supportsQuery){e.next=5;break}return e.abrupt("return",[]);case 5:return l=i.createQuery(),y=V({renderer:i.renderer,event:f}),h=d.createFetchPopupFeaturesQueryGeometry(t,y),v=new Set,e.next=11,Promise.all([(0,ce.e7)(i,s),null===(n=i.renderer)||void 0===n?void 0:n.collectRequiredFields(v,i.fieldsIndex)]);case 11:return m=e.sent,b=(0,a.Z)(m,1),g=b[0],(0,j.gd)(v,i.fieldsIndex,g),x=Array.from(v).sort(),l.geometry=h,l.outFields=x,l.timeExtent=p,c&&(w=c.clone(),null!=(Z=(0,E.f)(w,i))&&(l.where=l.where?"(".concat(l.where,") AND (").concat(Z,")"):Z)),k=d._getTargetResolution(h.width/y),e.next=20,he(s);case 20:return _=e.sent,(F="point"===i.geometryType||_&&_.arcadeUtils.hasGeometryOperations(s))||(l.maxAllowableOffset=k),e.next=25,i.queryFeatures(l);case 25:return C=e.sent,I=C.features,S=F?0:k,e.next=30,be(i,I);case 30:I=e.sent,R=(0,o.Z)(I);try{for(R.s();!(O=R.n()).done;)P=O.value,d._featuresResolutions.set(P,S)}catch(u){R.e(u)}finally{R.f()}return e.abrupt("return",I);case 34:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=3,(0,Z.as)(y);case 3:return e.abrupt("return",e.sent.reverse().reduce((function(e,t){return t.value?[].concat((0,i.Z)(e),(0,i.Z)(t.value)):e}),[]).filter(v.pC));case 4:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()}]),n}(h.Z);function de(e,t,r){var i,a=[];return(null!==(i=null===e||void 0===e?void 0:e.toArray())&&void 0!==i?i:[]).reverse().map((function e(i){var o=0===i.minScale||t<=i.minScale,u=0===i.maxScale||t>=i.maxScale;if(i.visible&&o&&u)if(i.sublayers)i.sublayers.forEach(e);else if(i.popupEnabled){var s=(0,ce.V5)(i,(0,n.Z)((0,n.Z)({},r),{},{defaultPopupTemplateEnabled:!1}));null!=s&&a.unshift({sublayer:i,popupTemplate:s})}})),a}function he(e){var t;return null!==(t=e.expressionInfos)&&void 0!==t&&t.length||Array.isArray(e.content)&&e.content.some((function(e){return"expression"===e.type}))?(0,se.LC)():Promise.resolve()}function ve(e,t){return me.apply(this,arguments)}function me(){return me=(0,s.Z)((0,u.Z)().mark((function e(t,r){var n,i;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(n=t.capabilities)||void 0===n||null===(i=n.operations)||void 0===i||!i.supportsQuery){e.next=2;break}return e.abrupt("return",!0);case 2:return e.prev=2,e.next=5,Promise.any(r.map((function(e){var t=e.sublayer;return t.load().then((function(){return t.capabilities.operations.supportsQuery}))})));case 5:return e.abrupt("return",e.sent);case 8:return e.prev=8,e.t0=e.catch(2),e.abrupt("return",!1);case 11:case"end":return e.stop()}}),e,null,[[2,8]])}))),me.apply(this,arguments)}function be(e,t){return ge.apply(this,arguments)}function ge(){return ge=(0,s.Z)((0,u.Z)().mark((function e(t,r){var n;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.renderer,e.t0=n&&"defaultSymbol"in n&&!n.defaultSymbol,!e.t0){e.next=11;break}if(!n.valueExpression){e.next=9;break}return e.next=6,Promise.all(r.map((function(e){return n.getSymbolAsync(e).then((function(t){return t?e:null}))}))).then((function(e){return e.filter((function(e){return null!=e}))}));case 6:e.t1=e.sent,e.next=10;break;case 9:e.t1=r.filter((function(e){return null!=n.getSymbol(e)}));case 10:r=e.t1;case 11:return e.abrupt("return",r);case 12:case"end":return e.stop()}}),e)}))),ge.apply(this,arguments)}(0,y._)([(0,F.Cb)({constructOnly:!0})],ye.prototype,"createFetchPopupFeaturesQueryGeometry",void 0),(0,y._)([(0,F.Cb)({constructOnly:!0})],ye.prototype,"layerView",void 0),(0,y._)([(0,F.Cb)({constructOnly:!0})],ye.prototype,"highlightGraphics",void 0),(0,y._)([(0,F.Cb)({constructOnly:!0})],ye.prototype,"highlightGraphicUpdated",void 0),(0,y._)([(0,F.Cb)({constructOnly:!0})],ye.prototype,"updatingHandles",void 0),ye=(0,y._)([(0,I.j)("esri.views.layers.support.MapService")],ye)},24405:function(e,t,r){r.d(t,{V5:function(){return l},e7:function(){return u}});var n=r(74165),i=r(93433),a=r(15861),o=r(37270);function u(e){return s.apply(this,arguments)}function s(){return s=(0,a.Z)((0,n.Z)().mark((function e(t){var r,a,u,s,l,c,p,f,y,d,h,v=arguments;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(u=v.length>1&&void 0!==v[1]?v[1]:t.popupTemplate)){e.next=3;break}return e.abrupt("return",[]);case 3:return e.next=5,u.getRequiredFields(t.fieldsIndex);case 5:if(s=e.sent,l=u.lastEditInfoEnabled,c=t.objectIdField,p=t.typeIdField,f=t.globalIdField,y=t.relationships,!s.includes("*")){e.next=13;break}return e.abrupt("return",["*"]);case 13:if(!l){e.next=19;break}return e.next=16,(0,o.CH)(t);case 16:e.t0=e.sent,e.next=20;break;case 19:e.t0=[];case 20:return d=e.t0,h=(0,o.Q0)(t.fieldsIndex,[].concat((0,i.Z)(s),(0,i.Z)(d))),e.abrupt("return",(p&&h.push(p),h&&c&&null!==(r=t.fieldsIndex)&&void 0!==r&&r.has(c)&&!h.includes(c)&&h.push(c),h&&f&&null!==(a=t.fieldsIndex)&&void 0!==a&&a.has(f)&&!h.includes(f)&&h.push(f),y&&y.forEach((function(e){var r,n=e.keyField;h&&n&&(null===(r=t.fieldsIndex)||void 0===r?void 0:r.has(n))&&!h.includes(n)&&h.push(n)})),h));case 23:case"end":return e.stop()}}),e)}))),s.apply(this,arguments)}function l(e,t){return e.popupTemplate?e.popupTemplate:null!=t&&t.defaultPopupTemplateEnabled&&null!=e.defaultPopupTemplate?e.defaultPopupTemplate:null}},45008:function(e,t,r){r.d(t,{K:function(){return a}});r(59486);var n=r(68860),i=r(53866);function a(e,t,r){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new i.Z,u=0;if("2d"===r.type)u=t*(null!==(a=r.resolution)&&void 0!==a?a:0);else if("3d"===r.type){var s=r.overlayPixelSizeInMapUnits(e),l=r.basemapSpatialReference;u=null==l||l.equals(r.spatialReference)?t*s:(0,n.c9)(l)/(0,n.c9)(r.spatialReference)}var c=e.x-u,p=e.y-u,f=e.x+u,y=e.y+u,d=r.spatialReference;return o.xmin=Math.min(c,f),o.ymin=Math.min(p,y),o.xmax=Math.max(c,f),o.ymax=Math.max(p,y),o.spatialReference=d,o}new i.Z}}]);
//# sourceMappingURL=4517.2c390238.chunk.js.map