{"version":3,"file":"static/js/7481.fb753fc5.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/views/2d/layers/features/support/whereUtils.js","../node_modules/@arcgis/core/views/2d/layers/features/support/FeatureFilter.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport e from\"../../../../../core/Error.js\";import r from\"../../../../../core/Logger.js\";const t=r.getLogger(\"esri.views.2d.layers.features.support.whereUtils\"),a={getAttribute:(e,r)=>e.field(r)};async function s(r,s){const n=await import(\"../../../../../core/sql/WhereClause.js\");try{const o=n.WhereClause.create(r,s);if(!o.isStandardized){const r=new e(\"mapview - bad input\",\"Unable to apply filter's definition expression, as expression is not standardized.\",o);t.error(r)}return e=>{const r=e.readArcadeFeature();return o.testFeature(r,a)}}catch(o){return t.warn(\"mapview-bad-where-clause\",\"Encountered an error when evaluating where clause\",r),e=>!0}}export{s as createWhereClause};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport t from\"../../../../../core/Error.js\";import e from\"../../../../../core/Logger.js\";import{create as i}from\"../../../../../geometry/support/aaBoundingRect.js\";import{getBoundsXY as s}from\"../../../../../geometry/support/boundsUtils.js\";import{getSpatialQueryOperator as r}from\"../../../../../layers/graphics/data/spatialQuerySupport.js\";import{getTimeOperator as o}from\"../../../../../layers/graphics/data/timeSupport.js\";import{normalizeQueryLike as h}from\"../../../../../layers/graphics/data/utils.js\";import a from\"../../../../../rest/support/Query.js\";import{featureAdapter as l}from\"../FeatureStore2D.js\";import{createWhereClause as n}from\"./whereUtils.js\";const d=1,m=2;class _{constructor(t){this._geometryBounds=i(),this._idToVisibility=new Map,this._serviceInfo=t}get hash(){return this._hash}check(t){return this._applyFilter(t)}clear(){const t=this._resetAllHiddenIds();return this.update(),{show:t,hide:[]}}invalidate(){this._idToVisibility.forEach(((t,e)=>{this._idToVisibility.set(e,0)}))}setKnownIds(t){for(const e of t)this._idToVisibility.set(e,d)}setTrue(t){const e=[],i=[],s=new Set(t);return this._idToVisibility.forEach(((t,r)=>{const o=!!(this._idToVisibility.get(r)&d),h=s.has(r);!o&&h?e.push(r):o&&!h&&i.push(r),this._idToVisibility.set(r,h?d|m:0)})),{show:e,hide:i}}createQuery(){const{geometry:t,spatialRel:e,where:i,timeExtent:s,objectIds:r}=this;return a.fromJSON({geometry:t,spatialRel:e,where:i,timeExtent:s,objectIds:r})}async update(t,e){this._hash=JSON.stringify(t);const i=await h(t,null,e);await Promise.all([this._setGeometryFilter(i),this._setIdFilter(i),this._setAttributeFilter(i),this._setTimeFilter(i)])}async _setAttributeFilter(t){if(!t||!t.where)return this._clause=null,void(this.where=null);this._clause=await n(t.where,this._serviceInfo.fieldsIndex),this.where=t.where}_setIdFilter(t){this._idsToShow=t&&t.objectIds&&new Set(t.objectIds),this._idsToHide=t&&t.hiddenIds&&new Set(t.hiddenIds),this.objectIds=t&&t.objectIds}async _setGeometryFilter(t){if(!t||!t.geometry)return this._spatialQueryOperator=null,this.geometry=null,void(this.spatialRel=null);const e=t.geometry,i=t.spatialRel||\"esriSpatialRelIntersects\",o=await r(i,e,this._serviceInfo.geometryType,this._serviceInfo.hasZ,this._serviceInfo.hasM);s(this._geometryBounds,e),this._spatialQueryOperator=o,this.geometry=e,this.spatialRel=i}_setTimeFilter(i){if(this.timeExtent=this._timeOperator=null,i&&i.timeExtent)if(this._serviceInfo.timeInfo)this.timeExtent=i.timeExtent,this._timeOperator=o(this._serviceInfo.timeInfo,i.timeExtent,l);else{const s=new t(\"feature-layer-view:time-filter-not-available\",\"Unable to apply time filter, as layer doesn't have time metadata.\",i.timeExtent);e.getLogger(\"esri.views.2d.layers.features.controllers.FeatureFilter\").error(s)}}_applyFilter(t){return this._filterByGeometry(t)&&this._filterById(t)&&this._filterByTime(t)&&this._filterByExpression(t)}_filterByExpression(t){return!this.where||this._clause(t)}_filterById(t){return(!this._idsToHide||!this._idsToHide.size||!this._idsToHide.has(t.getObjectId()))&&(!this._idsToShow||!this._idsToShow.size||this._idsToShow.has(t.getObjectId()))}_filterByGeometry(t){if(!this.geometry)return!0;const e=t.readHydratedGeometry();return!!e&&this._spatialQueryOperator(e)}_filterByTime(t){return null==this._timeOperator||this._timeOperator(t)}_resetAllHiddenIds(){const t=[];return this._idToVisibility.forEach(((e,i)=>{e&d||(this._idToVisibility.set(i,d),t.push(i))})),t}}export{_ as default};\n"],"names":["t","r","a","getAttribute","e","field","s","n","o","WhereClause","create","isStandardized","error","readArcadeFeature","testFeature","warn","_","this","_geometryBounds","i","_idToVisibility","Map","_serviceInfo","get","_hash","_applyFilter","_resetAllHiddenIds","update","show","hide","forEach","set","Set","h","has","push","d","geometry","spatialRel","where","timeExtent","objectIds","JSON","stringify","Promise","all","_setGeometryFilter","_setIdFilter","_setAttributeFilter","_setTimeFilter","_clause","fieldsIndex","_idsToShow","_idsToHide","hiddenIds","_spatialQueryOperator","geometryType","hasZ","hasM","_timeOperator","timeInfo","l","_filterByGeometry","_filterById","_filterByTime","_filterByExpression","size","getObjectId","readHydratedGeometry"],"sourceRoot":""}