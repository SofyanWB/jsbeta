{"version":3,"file":"static/js/7568.b08b8967.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/views/2d/engine/Bitmap.js","../node_modules/@arcgis/core/views/2d/engine/BitmapTile.js","../node_modules/@arcgis/core/views/2d/engine/BitmapTileContainer.js","../node_modules/@arcgis/core/views/2d/engine/ImageryBitmapSource.js","../node_modules/@arcgis/core/views/2d/layers/BitmapTileLayerView2D.js","../node_modules/@arcgis/core/views/2d/layers/support/imageUtils.js","../node_modules/@arcgis/core/views/layers/RefreshableLayerView.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport{applySome as t}from\"../../../core/maybe.js\";import{createResolver as e,onAbortOrThrow as s,throwIfNotAbortError as i}from\"../../../core/promiseUtils.js\";import{g as r,h,r as o,l as u,m as a}from\"../../../chunks/mat3.js\";import{c as n}from\"../../../chunks/mat3f32.js\";import{f as d}from\"../../../chunks/vec2f32.js\";import{DisplayObject as l}from\"./DisplayObject.js\";import c from\"./ImageryBitmapSource.js\";import{ContextType as _}from\"../../webgl/contextUtils.js\";import{SizedPixelFormat as p,PixelFormat as m,TextureWrapMode as x}from\"../../webgl/enums.js\";import{Texture as g}from\"../../webgl/Texture.js\";import{TextureDescriptor as f}from\"../../webgl/TextureDescriptor.js\";function w(t){return t&&\"render\"in t}function b(t){const e=document.createElement(\"canvas\");return e.width=t.width,e.height=t.height,t.render(e.getContext(\"2d\")),e}function v(e){return w(e)?e instanceof c?t(e.getRenderedRasterPixels(),(t=>t.renderedRasterPixels)):b(e):e}class T extends l{constructor(t=null,e=!1){super(),this.blendFunction=\"standard\",this._sourceWidth=0,this._sourceHeight=0,this._textureInvalidated=!1,this._texture=null,this.stencilRef=0,this.coordScale=[1,1],this._height=void 0,this.pixelRatio=1,this.resolution=0,this.rotation=0,this._source=null,this._width=void 0,this.x=0,this.y=0,this.immutable=e,this.source=t,this.requestRender=this.requestRender.bind(this)}destroy(){this._texture&&(this._texture.dispose(),this._texture=null),null!=this._uploadStatus&&(this._uploadStatus.controller.abort(),this._uploadStatus=null)}get isSourceScaled(){return this.width!==this._sourceWidth||this.height!==this._sourceHeight}get height(){return void 0!==this._height?this._height:this._sourceHeight}set height(t){this._height=t}get source(){return this._source}set source(t){null==t&&null==this._source||(this._source=t,this.invalidateTexture(),this.requestRender())}get width(){return void 0!==this._width?this._width:this._sourceWidth}set width(t){this._width=t}beforeRender(t){super.beforeRender(t),this.updateTexture(t)}async setSourceAsync(t,i){null!=this._uploadStatus&&this._uploadStatus.controller.abort();const r=new AbortController,h=e();return s(i,(()=>r.abort())),s(r,(t=>h.reject(t))),this._uploadStatus={controller:r,resolver:h},this.source=t,h.promise}invalidateTexture(){this._textureInvalidated||(this._textureInvalidated=!0,this._source instanceof HTMLImageElement?(this._sourceHeight=this._source.naturalHeight,this._sourceWidth=this._source.naturalWidth):this._source&&(this._sourceHeight=this._source.height,this._sourceWidth=this._source.width))}updateTransitionProperties(t,e){t>=64&&(this.fadeTransitionEnabled=!1,this.inFadeTransition=!1),super.updateTransitionProperties(t,e)}setTransform(t){const e=r(this.transforms.dvs),[s,i]=t.toScreenNoRotation([0,0],[this.x,this.y]),n=this.resolution/this.pixelRatio/t.resolution,l=n*this.width,c=n*this.height,_=Math.PI*this.rotation/180;h(e,e,d(s,i)),h(e,e,d(l/2,c/2)),o(e,e,-_),h(e,e,d(-l/2,-c/2)),u(e,e,d(l,c)),a(this.transforms.dvs,t.displayViewMat3,e)}setSamplingProfile(t){this._texture&&(t.mips&&!this._texture.descriptor.hasMipmap&&this._texture.generateMipmap(),this._texture.setSamplingMode(t.samplingMode))}bind(t,e){this._texture&&t.bindTexture(this._texture,e)}async updateTexture({context:t,painter:e}){if(!this._textureInvalidated)return;if(this._textureInvalidated=!1,this._texture||(this._texture=this._createTexture(t)),!this.source)return void this._texture.setData(null);this._texture.resize(this._sourceWidth,this._sourceHeight);const s=v(this.source);try{if(null!=this._uploadStatus){const{controller:t,resolver:i}=this._uploadStatus,r={signal:t.signal},{width:h,height:o}=this,u=this._texture,a=e.textureUploadManager;await a.enqueueTextureUpdate({data:s,texture:u,width:h,height:o},r),i.resolve(),this._uploadStatus=null}else this._texture.setData(s);this.ready()}catch(r){i(r)}}onDetach(){this.destroy()}_createTransforms(){return{dvs:n()}}_createTexture(t){const e=this.immutable&&t.type===_.WEBGL2,s=new f;return s.internalFormat=e?p.RGBA8:m.RGBA,s.wrapMode=x.CLAMP_TO_EDGE,s.isImmutable=e,s.width=this._sourceWidth,s.height=this._sourceHeight,new g(t,s)}}export{T as Bitmap,w as isImageSource,b as rasterize};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport{c as t}from\"../../../chunks/mat3f32.js\";import{Bitmap as e}from\"./Bitmap.js\";import{TiledDisplayObject as s}from\"./webgl/TiledDisplayObject.js\";class r extends s{constructor(t,s,r,i,a,n,m=null){super(t,s,r,i,a,n),this.bitmap=new e(m),this.bitmap.coordScale=[a,n],this.bitmap.once(\"isReady\",(()=>this.ready()))}destroy(){super.destroy(),this.bitmap.destroy()}beforeRender(t){super.beforeRender(t),this.bitmap.beforeRender(t)}afterRender(t){super.afterRender(t),this.bitmap.afterRender(t)}set stencilRef(t){this.bitmap.stencilRef=t}get stencilRef(){return this.bitmap.stencilRef}_createTransforms(){return{dvs:t(),tileMat3:t()}}setTransform(t){super.setTransform(t),this.bitmap.transforms.dvs=this.transforms.dvs}onAttach(){this.bitmap.stage=this.stage}onDetach(){this.bitmap&&(this.bitmap.stage=null)}}export{r as BitmapTile};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport{create as e}from\"../../../geometry/support/aaBoundingRect.js\";import{BitmapTile as i}from\"./BitmapTile.js\";import{brushes as r}from\"./brushes.js\";import{WGLDrawPhase as t}from\"./webgl/enums.js\";import s from\"./webgl/TileContainer.js\";class n extends s{get requiresDedicatedFBO(){return this.children.some((e=>\"additive\"===e.bitmap.blendFunction))}createTile(r){const t=this._tileInfoView.getTileBounds(e(),r),s=this._tileInfoView.getTileResolution(r.level),[n,o]=this._tileInfoView.tileInfo.size;return new i(r,s,t[0],t[3],n,o)}prepareRenderPasses(e){const i=e.registerRenderPass({name:\"bitmap (tile)\",brushes:[r.bitmap],target:()=>this.children.map((e=>e.bitmap)),drawPhase:t.MAP});return[...super.prepareRenderPasses(e),i]}doRender(e){this.visible&&e.drawPhase===t.MAP&&super.doRender(e)}}export{n as BitmapTileContainer};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nclass l{constructor(l,e,t){this.pixelBlock=l,this.extent=e,this.originalPixelBlock=t}get width(){return null!=this.pixelBlock?this.pixelBlock.width:0}get height(){return null!=this.pixelBlock?this.pixelBlock.height:0}render(l){const e=this.pixelBlock;if(null==e)return;const t=this.filter({extent:this.extent,pixelBlock:this.originalPixelBlock??e});if(null==t.pixelBlock)return;t.pixelBlock.maskIsAlpha&&(t.pixelBlock.premultiplyAlpha=!0);const i=t.pixelBlock.getAsRGBA(),h=l.createImageData(t.pixelBlock.width,t.pixelBlock.height);h.data.set(i),l.putImageData(h,0,0)}getRenderedRasterPixels(){const l=this.filter({extent:this.extent,pixelBlock:this.pixelBlock});return null==l.pixelBlock?null:(l.pixelBlock.maskIsAlpha&&(l.pixelBlock.premultiplyAlpha=!0),{width:l.pixelBlock.width,height:l.pixelBlock.height,renderedRasterPixels:new Uint8Array(l.pixelBlock.getAsRGBA().buffer)})}}export{l as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import\"../../../core/Logger.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/arrayUtils.js\";import\"../../../core/has.js\";import\"../../../core/Error.js\";import{subclass as i}from\"../../../core/accessorSupport/decorators/subclass.js\";import{BitmapTileContainer as r}from\"../engine/BitmapTileContainer.js\";const t=t=>{let s=class extends t{attach(){this.view.timeline.record(`${this.layer.title} (BitmapTileLayer) Attach`),this._bitmapView=new r(this._tileInfoView),this.container.addChild(this._bitmapView)}detach(){this.container.removeChild(this._bitmapView),this._bitmapView?.removeAllChildren()}};return s=e([i(\"esri.views.2d.layers.BitmapTileLayerView2D\")],s),s};export{t as BitmapTileLayerView2D};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nfunction e(e){return e instanceof HTMLImageElement?e.naturalWidth:e.width}function t(e){return e instanceof HTMLImageElement?e.naturalHeight:e.height}function n(n,l,r,u){if(r.level===u.level)return l;const i=n.tileInfo.size,a=n.getTileResolution(r.level),c=n.getTileResolution(u.level);let g=n.getLODInfoAt(u.level);const h=g.getXForColumn(u.col),d=g.getYForRow(u.row);g=n.getLODInfoAt(r.level);const f=g.getXForColumn(r.col),s=g.getYForRow(r.row),m=e(l)/i[0],v=t(l)/i[1],w=Math.round(m*((h-f)/a)),I=Math.round(v*(-(d-s)/a)),M=Math.round(m*i[0]*(c/a)),F=Math.round(v*i[1]*(c/a)),L=o(i);return L.getContext(\"2d\").drawImage(l,w,I,M,F,0,0,i[0],i[1]),L}function o(e){const t=document.createElement(\"canvas\");return[t.width,t.height]=e,t}export{o as createBlankImage,n as resampleImage};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport{_ as r}from\"../../chunks/tslib.es6.js\";import e from\"../../core/Logger.js\";import{isAbortError as s}from\"../../core/promiseUtils.js\";import{on as o}from\"../../core/reactiveUtils.js\";import{property as t}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/accessorSupport/ensureType.js\";import\"../../core/arrayUtils.js\";import\"../../core/has.js\";import{subclass as i}from\"../../core/accessorSupport/decorators/subclass.js\";const a=a=>{let c=class extends a{initialize(){this.handles.add(o((()=>this.layer),\"refresh\",(r=>{this.doRefresh(r.dataChanged).catch((r=>{s(r)||e.getLogger(this).error(r)}))})),\"RefreshableLayerView\")}};return r([t()],c.prototype,\"layer\",void 0),c=r([i(\"esri.layers.mixins.RefreshableLayerView\")],c),c};export{a as default};\n"],"names":["w","t","b","e","document","createElement","width","height","render","getContext","v","c","getRenderedRasterPixels","renderedRasterPixels","T","blendFunction","_sourceWidth","_sourceHeight","_textureInvalidated","_texture","stencilRef","coordScale","_height","pixelRatio","resolution","rotation","_source","_width","x","y","immutable","source","requestRender","bind","this","dispose","_uploadStatus","controller","abort","get","set","invalidateTexture","updateTexture","i","r","AbortController","h","s","reject","resolver","promise","HTMLImageElement","naturalHeight","naturalWidth","fadeTransitionEnabled","inFadeTransition","transforms","dvs","toScreenNoRotation","n","l","_","Math","PI","d","o","u","a","displayViewMat3","mips","descriptor","hasMipmap","generateMipmap","setSamplingMode","samplingMode","bindTexture","context","painter","_createTexture","setData","resize","signal","textureUploadManager","enqueueTextureUpdate","data","texture","resolve","ready","destroy","type","f","internalFormat","p","m","wrapMode","isImmutable","g","bitmap","once","beforeRender","afterRender","tileMat3","stage","children","some","_tileInfoView","getTileBounds","getTileResolution","level","tileInfo","size","registerRenderPass","name","brushes","target","map","drawPhase","visible","pixelBlock","extent","originalPixelBlock","filter","maskIsAlpha","premultiplyAlpha","getAsRGBA","createImageData","putImageData","Uint8Array","buffer","view","timeline","record","layer","title","_bitmapView","container","addChild","removeChild","removeAllChildren","getLODInfoAt","getXForColumn","col","getYForRow","row","round","I","M","F","L","drawImage","handles","add","doRefresh","dataChanged","catch","error","prototype"],"sourceRoot":""}