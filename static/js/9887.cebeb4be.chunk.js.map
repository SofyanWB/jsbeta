{"version":3,"file":"static/js/9887.cebeb4be.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/layers/graphics/editingSupport.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport e from\"../../Graphic.js\";import t from\"../../core/Collection.js\";import a from\"../../core/Error.js\";import{clone as r}from\"../../core/lang.js\";import s from\"../../core/Logger.js\";import{createResolver as o}from\"../../core/promiseUtils.js\";import{dataComponents as i}from\"../../core/urlUtils.js\";import{normalizeCentralMeridian as n}from\"../../geometry/support/normalizeUtils.js\";import{isEditBusLayer as d,emitApplyEditsEvent as l}from\"../mixins/EditBusLayer.js\";import{getMimeTypeFormatId as u,getFilenameFormatId as p}from\"../support/infoFor3D.js\";import{getEffectiveEditingEnabled as c,getEffectiveLayerCapabilities as h}from\"../support/layerUtils.js\";function m(e){return e&&null!=e.applyEdits}function y(e){return\"object\"==typeof e&&null!=e&&\"objectId\"in e&&!!e.objectId}function f(e){return e.every(y)}function g(e){return\"object\"==typeof e&&null!=e&&\"globalId\"in e&&!!e.globalId}function b(e){return e.every(g)}async function F(e,t,a,s={}){let i;if(d(e)&&e.url)i=l(e.url,e.layerId,\"original-and-current-features\"===s.returnServiceEditsOption);else{i=o(),i.promise.then((t=>{(t.addedFeatures.length||t.updatedFeatures.length||t.deletedFeatures.length||t.addedAttachments.length||t.updatedAttachments.length||t.deletedAttachments.length)&&e.emit(\"edits\",t)}));const t={result:i.promise};e.emit(\"apply-edits\",t)}try{const{results:o,edits:n}=await w(e,t,a,s),d=e=>e.filter((e=>!e.error)).map(r),l={edits:n,addedFeatures:d(o.addFeatureResults),updatedFeatures:d(o.updateFeatureResults),deletedFeatures:d(o.deleteFeatureResults),addedAttachments:d(o.addAttachmentResults),updatedAttachments:d(o.updateAttachmentResults),deletedAttachments:d(o.deleteAttachmentResults),exceededTransferLimit:!1};return o.editedFeatureResults?.length&&(l.editedFeatures=o.editedFeatureResults),i.resolve(l),o}catch(n){throw i.reject(n),n}}async function w(e,t,r,s){if(await e.load(),!m(t))throw new a(`${e.type}-layer:no-editing-support`,\"Layer source does not support applyEdits capability\",{layer:e});if(!c(e))throw new a(`${e.type}-layer:editing-disabled`,\"Editing is disabled for layer\",{layer:e});const{edits:o,options:i}=await A(e,r,s);return o.addFeatures?.length||o.updateFeatures?.length||o.deleteFeatures?.length||o.addAttachments?.length||o.updateAttachments?.length||o.deleteAttachments?.length?{edits:o,results:await t.applyEdits(o,i)}:{edits:o,results:{addFeatureResults:[],updateFeatureResults:[],deleteFeatureResults:[],addAttachmentResults:[],updateAttachmentResults:[],deleteAttachmentResults:[]}}}async function A(e,r,o){const i=r&&(r.addFeatures||r.updateFeatures||r.deleteFeatures),n=r&&(r.addAttachments||r.updateAttachments||r.deleteAttachments),d=null!=e.infoFor3D;if(!r||!i&&!n)throw new a(`${e.type}-layer:missing-parameters`,\"'addFeatures', 'updateFeatures', 'deleteFeatures', 'addAttachments', 'updateAttachments' or 'deleteAttachments' parameter is required\");const l=h(e);if(!l.data.isVersioned&&o?.gdbVersion)throw new a(`${e.type}-layer:invalid-parameter`,\"'gdbVersion' is applicable only if the layer supports versioned data. See: 'capabilities.data.isVersioned'\");if(!l.editing.supportsRollbackOnFailure&&o?.rollbackOnFailureEnabled)throw new a(`${e.type}-layer:invalid-parameter`,\"This layer does not support 'rollbackOnFailureEnabled' parameter. See: 'capabilities.editing.supportsRollbackOnFailure'\");if(!l.editing.supportsGlobalId&&o?.globalIdUsed)throw new a(`${e.type}-layer:invalid-parameter`,\"This layer does not support 'globalIdUsed' parameter. See: 'capabilities.editing.supportsGlobalId'\");if(!l.editing.supportsGlobalId&&n)throw new a(`${e.type}-layer:invalid-parameter`,\"'addAttachments', 'updateAttachments' and 'deleteAttachments' are applicable only if the layer supports global ids. See: 'capabilities.editing.supportsGlobalId'\");if(!o?.globalIdUsed&&n)throw new a(`${e.type}-layer:invalid-parameter`,\"When 'addAttachments', 'updateAttachments' or 'deleteAttachments' is specified, globalIdUsed should be set to true\");const u={...o};if(null!=u.rollbackOnFailureEnabled||l.editing.supportsRollbackOnFailure||(u.rollbackOnFailureEnabled=!0),u.rollbackOnFailureEnabled||\"original-and-current-features\"!==u.returnServiceEditsOption||(!1===u.rollbackOnFailureEnabled&&s.getLogger(\"esri.layers.graphics.editingSupport\").warn(`${e.type}-layer:invalid-parameter`,\"'original-and-current-features' is valid for 'returnServiceEditsOption' only when 'rollBackOnFailure' is true, but 'rollBackOnFailure' was set to false. 'rollBackOnFailure' has been overwrritten and set to true.\"),u.rollbackOnFailureEnabled=!0),!l.editing.supportsReturnServiceEditsInSourceSpatialReference&&u.returnServiceEditsInSourceSR)throw new a(`${e.type}-layer:invalid-parameter`,\"This layer does not support 'returnServiceEditsInSourceSR' parameter. See: 'capabilities.editing.supportsReturnServiceEditsInSourceSpatialReference'\");if(u.returnServiceEditsInSourceSR&&\"original-and-current-features\"!==u.returnServiceEditsOption)throw new a(`${e.type}-layer:invalid-parameter`,\"'returnServiceEditsInSourceSR' is valid only when 'returnServiceEditsOption' is set to 'original-and-current-features'\");const p={...r};if(p.addFeatures=r&&t.isCollection(r.addFeatures)?r.addFeatures.toArray():p.addFeatures||[],p.updateFeatures=r&&t.isCollection(r.updateFeatures)?r.updateFeatures.toArray():p.updateFeatures||[],p.deleteFeatures=r&&t.isCollection(r.deleteFeatures)?r.deleteFeatures.toArray():p.deleteFeatures||[],p.addFeatures.length&&!l.operations.supportsAdd)throw new a(`${e.type}-layer:unsupported-operation`,\"Layer does not support adding features.\");if(p.updateFeatures.length&&!l.operations.supportsUpdate)throw new a(`${e.type}-layer:unsupported-operation`,\"Layer does not support updating features.\");if(p.deleteFeatures.length&&!l.operations.supportsDelete)throw new a(`${e.type}-layer:unsupported-operation`,\"Layer does not support deleting features.\");p.addAttachments=p.addAttachments||[],p.updateAttachments=p.updateAttachments||[],p.deleteAttachments=p.deleteAttachments||[],p.addFeatures=p.addFeatures.map(j),p.updateFeatures=p.updateFeatures.map(j),p.addAssetFeatures=[];const c=o?.globalIdUsed||d;p.addFeatures.forEach((t=>E(t,e,c))),p.updateFeatures.forEach((t=>$(t,e,c))),p.deleteFeatures.forEach((t=>S(t,e,c))),p.addAttachments.forEach((t=>R(t,e))),p.updateAttachments.forEach((t=>R(t,e))),d&&await U(p,e);return{edits:await O(p),options:u}}function v(e,t,r){if(r){if(\"attributes\"in e&&!e.attributes[t.globalIdField])throw new a(`${t.type}-layer:invalid-parameter`,\"Feature should have 'globalId' when 'globalIdUsed' is true\");if(!(\"attributes\"in e)&&!e.globalId)throw new a(`${t.type}-layer:invalid-parameter`,\"'globalId' of the feature should be passed when 'globalIdUsed' is true\")}if(\"geometry\"in e&&null!=e.geometry){if(e.geometry.hasZ&&!1===t.capabilities?.data.supportsZ)throw new a(`${t.type}-layer:z-unsupported`,\"Layer does not support z values while feature has z values.\");if(e.geometry.hasM&&!1===t.capabilities?.data.supportsM)throw new a(`${t.type}-layer:m-unsupported`,\"Layer does not support m values while feature has m values.\")}}function I(e,t){if(\"geometry\"in e&&\"mesh\"===e.geometry?.type){const{geometry:r}=e;if(r.vertexSpace.isGeoreferenced)throw new a(`${t.type}-layer:georeferenced-mesh-unsupported`,\"Uploading georeferenced meshes to a layer is not supported.\")}}function E(e,t,a){v(e,t,a),I(e,t)}function S(e,t,a){v(e,t,a)}function $(e,t,r){v(e,t,r),I(e,t);const s=h(t);if(\"geometry\"in e&&null!=e.geometry&&!s?.editing.supportsGeometryUpdate)throw new a(`${t.type}-layer:unsupported-operation`,\"Layer does not support geometry updates.\")}function R(e,t){const{feature:r,attachment:s}=e;if(!r||\"attributes\"in r&&!r.attributes[t.globalIdField])throw new a(`${t.type}-layer:invalid-parameter`,\"Attachment should have reference to a feature with 'globalId'\");if(!(\"attributes\"in r)&&!r.globalId)throw new a(`${t.type}-layer:invalid-parameter`,\"Attachment should have reference to 'globalId' of the parent feature\");if(!s.globalId)throw new a(`${t.type}-layer:invalid-parameter`,\"Attachment should have 'globalId'\");if(!s.data&&!s.uploadId)throw new a(`${t.type}-layer:invalid-parameter`,\"Attachment should have 'data' or 'uploadId'\");if(!(s.data instanceof File&&!!s.data.name)&&!s.name)throw new a(`${t.type}-layer:invalid-parameter`,\"'name' is required when attachment is specified as Base64 encoded string using 'data'\");if(!t.capabilities?.editing.supportsUploadWithItemId&&s.uploadId)throw new a(`${t.type}-layer:invalid-parameter`,\"This layer does not support 'uploadId' parameter. See: 'capabilities.editing.supportsUploadWithItemId'\");if(\"string\"==typeof s.data){const e=i(s.data);if(e&&!e.isBase64)throw new a(`${t.type}-layer:invalid-parameter`,\"Attachment 'data' should be a Blob, File or Base64 encoded string\")}}async function O(e){const t=e.addFeatures??[],a=e.updateFeatures??[],r=t.concat(a).map((e=>e.geometry)),s=await n(r),o=t.length,i=a.length;return s.slice(0,o).forEach(((e,a)=>t[a].geometry=e)),s.slice(o,o+i).forEach(((e,t)=>a[t].geometry=e)),e}function j(t){const a=new e;return t.attributes||(t.attributes={}),a.geometry=t.geometry,a.attributes=t.attributes,a}async function U(e,t){if(null==t.infoFor3D)return;const{infoFor3D:r}=t,s=u(\"model/gltf-binary\",r.supportedFormats)??p(\"glb\",r.supportedFormats);if(!(!!s&&r.editFormats.includes(s)))throw new a(`${t.type}-layer:binary-gltf-asset-not-supported`,\"3DObjectFeatureLayer requires binary glTF (.glb) support for updating mesh geometry.\");e.addAssetFeatures??=[];const{addAssetFeatures:o}=e;for(const a of e.addFeatures??[])L(a)&&o.push(a);for(const a of e.updateFeatures??[])L(a)&&o.push(a)}function L(e){return\"mesh\"===e?.geometry?.type}function k(e,t,r,s){if(!m(t))throw new a(`${e.type}-layer:no-editing-support`,\"Layer source does not support applyEdits capability\",{layer:e});if(!t.uploadAssets)throw new a(`${e.type}-layer:no-asset-upload-support`,\"Layer source does not support uploadAssets capability\",{layer:e});return t.uploadAssets(r,s)}export{F as applyEdits,b as isFeatureIdentifierArrayWithGlobalId,f as isFeatureIdentifierArrayWithObjectId,g as isFeatureIdentifierWithGlobalId,y as isFeatureIdentifierWithObjectId,k as uploadAssets};\n"],"names":["m","e","applyEdits","y","objectId","f","every","g","globalId","b","F","t","a","s","d","url","i","l","layerId","returnServiceEditsOption","o","promise","then","addedFeatures","length","updatedFeatures","deletedFeatures","addedAttachments","updatedAttachments","deletedAttachments","emit","result","w","results","n","edits","filter","error","map","r","addFeatureResults","updateFeatureResults","deleteFeatureResults","addAttachmentResults","updateAttachmentResults","deleteAttachmentResults","exceededTransferLimit","editedFeatureResults","editedFeatures","resolve","reject","load","type","layer","c","A","options","addFeatures","updateFeatures","deleteFeatures","addAttachments","updateAttachments","deleteAttachments","infoFor3D","h","data","isVersioned","gdbVersion","editing","supportsRollbackOnFailure","rollbackOnFailureEnabled","supportsGlobalId","globalIdUsed","u","warn","supportsReturnServiceEditsInSourceSpatialReference","returnServiceEditsInSourceSR","p","toArray","operations","supportsAdd","supportsUpdate","supportsDelete","j","addAssetFeatures","forEach","E","$","S","R","U","O","v","attributes","globalIdField","geometry","hasZ","capabilities","supportsZ","hasM","supportsM","I","vertexSpace","isGeoreferenced","supportsGeometryUpdate","feature","attachment","uploadId","File","name","supportsUploadWithItemId","isBase64","concat","slice","supportedFormats","editFormats","includes","L","push","k","uploadAssets"],"sourceRoot":""}