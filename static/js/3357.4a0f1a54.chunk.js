"use strict";(self.webpackChunkjakartasatubeta=self.webpackChunkjakartasatubeta||[]).push([[3357],{98266:function(e,t,i){i.d(t,{D:function(){return d},s:function(){return c}});var n=i(15671),r=i(43144),a=i(11752),o=i(61120),s=i(60136),l=i(29388),u=i(24390);function c(e,t,i,n){e.set(t,i.get(n)),i.on(n,(function(i){e.set(t,i)}))}var d=function(e){(0,s.Z)(i,e);var t=(0,l.Z)(i);function i(){return(0,n.Z)(this,i),t.apply(this,arguments)}return(0,r.Z)(i,[{key:"setupDefaultRules",value:function(){(0,a.Z)((0,o.Z)(i.prototype),"setupDefaultRules",this).call(this);var e=this._root.language,t=this._root.interfaceColors,n=this._root.horizontalLayout,r=this._root.verticalLayout,s=this.rule.bind(this);s("InterfaceColors").setAll({stroke:u.C.fromHex(15066597),fill:u.C.fromHex(15987699),primaryButton:u.C.fromHex(6788316),primaryButtonHover:u.C.fromHex(6779356),primaryButtonDown:u.C.fromHex(6872182),primaryButtonActive:u.C.fromHex(6872182),primaryButtonText:u.C.fromHex(16777215),primaryButtonStroke:u.C.fromHex(16777215),secondaryButton:u.C.fromHex(14277081),secondaryButtonHover:u.C.fromHex(10724259),secondaryButtonDown:u.C.fromHex(9276813),secondaryButtonActive:u.C.fromHex(15132390),secondaryButtonText:u.C.fromHex(0),secondaryButtonStroke:u.C.fromHex(16777215),grid:u.C.fromHex(0),background:u.C.fromHex(16777215),alternativeBackground:u.C.fromHex(0),text:u.C.fromHex(0),alternativeText:u.C.fromHex(16777215),disabled:u.C.fromHex(11382189),positive:u.C.fromHex(5288704),negative:u.C.fromHex(11730944)});var l=s("ColorSet");l.setAll({passOptions:{hue:.05,saturation:0,lightness:0},colors:[u.C.fromHex(6797276)],step:1,reuse:!1,startIndex:0}),l.setPrivate("currentStep",0),l.setPrivate("currentPass",0),s("Entity").setAll({stateAnimationDuration:0,stateAnimationEasing:(0,u.an)(u.ap)}),s("Component").setAll({interpolationDuration:0,interpolationEasing:(0,u.an)(u.ap)}),s("Sprite").setAll({visible:!0,scale:1,opacity:1,rotation:0,position:"relative",tooltipX:u.ao,tooltipY:u.ao,tooltipPosition:"fixed",isMeasured:!0}),s("Sprite").states.create("default",{visible:!0,opacity:1}),s("Container").setAll({interactiveChildren:!0,setStateOnChildren:!1}),s("Graphics").setAll({strokeWidth:1}),s("Chart").setAll({width:u.a4,height:u.a4,interactiveChildren:!1}),s("Sprite",["horizontal","center"]).setAll({centerX:u.ao,x:u.ao}),s("Sprite",["vertical","center"]).setAll({centerY:u.ao,y:u.ao}),s("Container",["horizontal","layout"]).setAll({layout:n}),s("Container",["vertical","layout"]).setAll({layout:r}),s("Pattern").setAll({repetition:"repeat",width:50,height:50,rotation:0,fillOpacity:1}),s("LinePattern").setAll({gap:6,colorOpacity:1,width:49,height:49}),s("RectanglePattern").setAll({gap:6,checkered:!1,centered:!0,maxWidth:5,maxHeight:5,width:48,height:48,strokeWidth:0}),s("CirclePattern").setAll({gap:5,checkered:!1,centered:!1,radius:3,strokeWidth:0,width:45,height:45}),s("LinearGradient").setAll({rotation:90}),s("Legend").setAll({fillField:"fill",strokeField:"stroke",nameField:"name",layout:u.a1.new(this._root,{}),layer:30,clickTarget:"itemContainer"}),s("Container",["legend","item","itemcontainer"]).setAll({paddingLeft:5,paddingRight:5,paddingBottom:5,paddingTop:5,layout:n,setStateOnChildren:!0,interactiveChildren:!1,ariaChecked:!0,focusable:!0,ariaLabel:e.translate("Press ENTER to toggle"),role:"checkbox"});var d=s("Rectangle",["legend","item","background"]);d.setAll({fillOpacity:0}),c(d,"fill",t,"background"),s("Container",["legend","marker"]).setAll({setStateOnChildren:!0,centerY:u.ao,paddingLeft:0,paddingRight:0,paddingBottom:0,paddingTop:0,width:18,height:18}),s("RoundedRectangle",["legend","marker","rectangle"]).setAll({width:u.a4,height:u.a4,cornerRadiusBL:3,cornerRadiusTL:3,cornerRadiusBR:3,cornerRadiusTR:3});var h=s("RoundedRectangle",["legend","marker","rectangle"]).states.create("disabled",{});c(h,"fill",t,"disabled"),c(h,"stroke",t,"disabled"),s("Label",["legend","label"]).setAll({centerY:u.ao,marginLeft:5,paddingRight:0,paddingLeft:0,paddingTop:0,paddingBottom:0,populateText:!0}),c(s("Label",["legend","label"]).states.create("disabled",{}),"fill",t,"disabled"),s("Label",["legend","value","label"]).setAll({centerY:u.ao,marginLeft:5,paddingRight:0,paddingLeft:0,paddingTop:0,paddingBottom:0,width:50,centerX:u.a4,populateText:!0}),c(s("Label",["legend","value","label"]).states.create("disabled",{}),"fill",t,"disabled"),s("HeatLegend").setAll({stepCount:1}),s("RoundedRectangle",["heatlegend","marker"]).setAll({cornerRadiusTR:0,cornerRadiusBR:0,cornerRadiusTL:0,cornerRadiusBL:0}),s("RoundedRectangle",["vertical","heatlegend","marker"]).setAll({height:u.a4,width:15}),s("RoundedRectangle",["horizontal","heatlegend","marker"]).setAll({width:u.a4,height:15}),s("HeatLegend",["vertical"]).setAll({height:u.a4}),s("HeatLegend",["horizontal"]).setAll({width:u.a4}),s("Label",["heatlegend","start"]).setAll({paddingLeft:5,paddingRight:5,paddingTop:5,paddingBottom:5}),s("Label",["heatlegend","end"]).setAll({paddingLeft:5,paddingRight:5,paddingTop:5,paddingBottom:5});var f=s("Label");f.setAll({paddingTop:8,paddingBottom:8,paddingLeft:10,paddingRight:10,fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',fontSize:"1em",populateText:!1}),c(f,"fill",t,"text"),s("RadialLabel").setAll({textType:"regular",centerY:u.ao,centerX:u.ao,inside:!1,radius:0,baseRadius:u.a4,orientation:"auto",textAlign:"center"}),s("RoundedRectangle").setAll({cornerRadiusTL:8,cornerRadiusBL:8,cornerRadiusTR:8,cornerRadiusBR:8}),s("PointedRectangle").setAll({pointerBaseWidth:15,pointerLength:10,cornerRadius:8}),s("Slice").setAll({shiftRadius:0,dRadius:0,dInnerRadius:0});var v=s("Tick");v.setAll({strokeOpacity:.15,isMeasured:!1,length:4.5,position:"absolute",crisp:!0}),c(v,"stroke",t,"grid"),s("Bullet").setAll({locationX:.5,locationY:.5}),s("Tooltip").setAll({position:"absolute",getFillFromSprite:!0,getStrokeFromSprite:!1,autoTextColor:!0,paddingTop:9,paddingBottom:8,paddingLeft:10,paddingRight:10,marginBottom:5,pointerOrientation:"vertical",centerX:u.ao,centerY:u.ao,animationEasing:(0,u.an)(u.ap),exportable:!1}),s("PointedRectangle",["tooltip","background"]).setAll({strokeOpacity:.9,cornerRadius:4,pointerLength:4,pointerBaseWidth:8,fillOpacity:.9,stroke:u.C.fromHex(16777215)});var p=s("Label",["tooltip"]);p.setAll({role:"tooltip",populateText:!0,paddingRight:0,paddingTop:0,paddingLeft:0,paddingBottom:0}),c(p,"fill",t,"alternativeText"),s("Button").setAll({paddingTop:8,paddingBottom:8,paddingLeft:10,paddingRight:10,interactive:!0,layout:n,interactiveChildren:!1,setStateOnChildren:!0,focusable:!0}),s("Button").states.create("hover",{}),s("Button").states.create("down",{stateAnimationDuration:0}),s("Button").states.create("active",{});var g=s("RoundedRectangle",["button","background"]);c(g,"fill",t,"primaryButton"),c(g,"stroke",t,"primaryButtonStroke"),c(s("RoundedRectangle",["button","background"]).states.create("hover",{}),"fill",t,"primaryButtonHover"),c(s("RoundedRectangle",["button","background"]).states.create("down",{stateAnimationDuration:0}),"fill",t,"primaryButtonDown"),c(s("RoundedRectangle",["button","background"]).states.create("active",{}),"fill",t,"primaryButtonActive"),c(s("Graphics",["button","icon"]),"stroke",t,"primaryButtonText"),c(s("Label",["button"]),"fill",t,"primaryButtonText"),s("Button",["zoom"]).setAll({paddingTop:18,paddingBottom:18,paddingLeft:12,paddingRight:12,centerX:46,centerY:-10,y:0,x:u.a4,role:"button",ariaLabel:e.translate("Zoom Out"),layer:30});var y=s("RoundedRectangle",["background","button","zoom"]);y.setAll({cornerRadiusBL:40,cornerRadiusBR:40,cornerRadiusTL:40,cornerRadiusTR:40}),c(y,"fill",t,"primaryButton"),c(s("RoundedRectangle",["background","button","zoom"]).states.create("hover",{}),"fill",t,"primaryButtonHover"),c(s("RoundedRectangle",["background","button","zoom"]).states.create("down",{stateAnimationDuration:0}),"fill",t,"primaryButtonDown");var m=s("Graphics",["icon","button","zoom"]);m.setAll({crisp:!0,strokeOpacity:.7,draw:function(e){e.moveTo(0,0),e.lineTo(12,0)}}),c(m,"stroke",t,"primaryButtonText"),s("Button",["resize"]).setAll({paddingTop:9,paddingBottom:9,paddingLeft:13,paddingRight:13,draggable:!0,centerX:u.ao,centerY:u.ao,position:"absolute",role:"slider",ariaValueMin:"0",ariaValueMax:"100",ariaLabel:e.translate("Use up and down arrows to move selection")});var b=s("RoundedRectangle",["background","resize","button"]);b.setAll({cornerRadiusBL:40,cornerRadiusBR:40,cornerRadiusTL:40,cornerRadiusTR:40}),c(b,"fill",t,"secondaryButton"),c(b,"stroke",t,"secondaryButtonStroke"),c(s("RoundedRectangle",["background","resize","button"]).states.create("hover",{}),"fill",t,"secondaryButtonHover"),c(s("RoundedRectangle",["background","resize","button"]).states.create("down",{stateAnimationDuration:0}),"fill",t,"secondaryButtonDown");var _=s("Graphics",["resize","button","icon"]);_.setAll({interactive:!1,crisp:!0,strokeOpacity:.5,draw:function(e){e.moveTo(0,.5),e.lineTo(0,12.5),e.moveTo(4,.5),e.lineTo(4,12.5)}}),c(_,"stroke",t,"secondaryButtonText"),s("Button",["resize","vertical"]).setAll({rotation:90,cursorOverStyle:"ns-resize"}),s("Button",["resize","horizontal"]).setAll({cursorOverStyle:"ew-resize"}),s("Button",["play"]).setAll({paddingTop:13,paddingBottom:13,paddingLeft:14,paddingRight:14,ariaLabel:e.translate("Play"),toggleKey:"active"});var w=s("RoundedRectangle",["play","background"]);w.setAll({strokeOpacity:.5,cornerRadiusBL:100,cornerRadiusBR:100,cornerRadiusTL:100,cornerRadiusTR:100}),c(w,"fill",t,"primaryButton");var k=s("Graphics",["play","icon"]);k.setAll({stateAnimationDuration:0,dx:1,draw:function(e){e.moveTo(0,-5),e.lineTo(8,0),e.lineTo(0,5),e.lineTo(0,-5)}}),c(k,"fill",t,"primaryButtonText"),s("Graphics",["play","icon"]).states.create("default",{stateAnimationDuration:0}),s("Graphics",["play","icon"]).states.create("active",{stateAnimationDuration:0,draw:function(e){e.moveTo(-4,-5),e.lineTo(-1,-5),e.lineTo(-1,5),e.lineTo(-4,5),e.lineTo(-4,-5),e.moveTo(4,-5),e.lineTo(1,-5),e.lineTo(1,5),e.lineTo(4,5),e.lineTo(4,-5)}}),s("Button",["switch"]).setAll({paddingTop:4,paddingBottom:4,paddingLeft:4,paddingRight:4,ariaLabel:e.translate("Press ENTER to toggle"),toggleKey:"active",width:40,height:24,layout:null});var x=s("RoundedRectangle",["switch","background"]);x.setAll({strokeOpacity:.5,cornerRadiusBL:100,cornerRadiusBR:100,cornerRadiusTL:100,cornerRadiusTR:100}),c(x,"fill",t,"primaryButton");var C=s("Circle",["switch","icon"]);C.setAll({radius:8,centerY:0,centerX:0,dx:0}),c(C,"fill",t,"primaryButtonText"),s("Graphics",["switch","icon"]).states.create("active",{dx:16}),s("Scrollbar").setAll({start:0,end:1,layer:30,animationEasing:(0,u.an)(u.ap)}),s("Scrollbar",["vertical"]).setAll({marginRight:13,marginLeft:13,minWidth:12,height:u.a4}),s("Scrollbar",["horizontal"]).setAll({marginTop:13,marginBottom:13,minHeight:12,width:u.a4}),this.rule("Button",["scrollbar"]).setAll({exportable:!1});var M=s("RoundedRectangle",["scrollbar","main","background"]);M.setAll({cornerRadiusTL:8,cornerRadiusBL:8,cornerRadiusTR:8,cornerRadiusBR:8,fillOpacity:.8}),c(M,"fill",t,"fill");var P=s("RoundedRectangle",["scrollbar","thumb"]);P.setAll({role:"slider",ariaLive:"polite",position:"absolute",draggable:!0}),c(P,"fill",t,"secondaryButton"),c(s("RoundedRectangle",["scrollbar","thumb"]).states.create("hover",{}),"fill",t,"secondaryButtonHover"),c(s("RoundedRectangle",["scrollbar","thumb"]).states.create("down",{stateAnimationDuration:0}),"fill",t,"secondaryButtonDown"),s("RoundedRectangle",["scrollbar","thumb","vertical"]).setAll({x:u.ao,width:u.a4,centerX:u.ao,ariaLabel:e.translate("Use up and down arrows to move selection")}),s("RoundedRectangle",["scrollbar","thumb","horizontal"]).setAll({y:u.ao,centerY:u.ao,height:u.a4,ariaLabel:e.translate("Use left and right arrows to move selection")});var Z=s("PointedRectangle",["axis","tooltip","background"]);Z.setAll({cornerRadius:0}),c(Z,"fill",t,"alternativeBackground"),s("Label",["axis","tooltip"]).setAll({role:void 0}),s("Label",["axis","tooltip","y"]).setAll({textAlign:"right"}),s("Label",["axis","tooltip","y","opposite"]).setAll({textAlign:"left"}),s("Label",["axis","tooltip","x"]).setAll({textAlign:"center"}),s("Tooltip",["categoryaxis"]).setAll({labelText:"{category}"}),s("Star").setAll({spikes:5,innerRadius:5,radius:10}),s("Tooltip",["stock"]).setAll({paddingTop:6,paddingBottom:5,paddingLeft:7,paddingRight:7}),s("PointedRectangle",["tooltip","stock","axis"]).setAll({pointerLength:0,pointerBaseWidth:0,cornerRadius:3}),s("Label",["tooltip","stock"]).setAll({fontSize:"0.8em"}),s("SpriteResizer").setAll({rotationStep:10}),s("Container",["resizer","grip"]).states.create("hover",{});var A=s("RoundedRectangle",["resizer","grip"]);A.setAll({strokeOpacity:.7,strokeWidth:1,fillOpacity:1,width:12,height:12}),c(A,"fill",t,"background"),c(A,"stroke",t,"alternativeBackground");var T=s("RoundedRectangle",["resizer","grip","outline"]);T.setAll({strokeOpacity:0,fillOpacity:0,width:20,height:20}),T.states.create("hover",{fillOpacity:.3}),c(T,"fill",t,"alternativeBackground"),s("RoundedRectangle",["resizer","grip","left"]).setAll({cornerRadiusBL:0,cornerRadiusBR:0,cornerRadiusTL:0,cornerRadiusTR:0}),s("RoundedRectangle",["resizer","grip","right"]).setAll({cornerRadiusBL:0,cornerRadiusBR:0,cornerRadiusTL:0,cornerRadiusTR:0});var I=s("Rectangle",["resizer","rectangle"]);I.setAll({strokeDasharray:[2,2],strokeOpacity:.5,strokeWidth:1}),c(I,"stroke",t,"alternativeBackground")}}]),i}(u.am)},24390:function(e,t,i){i.d(t,{$:function(){return Nt},A:function(){return z},B:function(){return M},C:function(){return Ye},D:function(){return H},E:function(){return xt},F:function(){return pe},G:function(){return W},H:function(){return fe},I:function(){return ye},J:function(){return O},K:function(){return F},L:function(){return D},M:function(){return V},N:function(){return Ot},O:function(){return T},P:function(){return x},Q:function(){return $},R:function(){return Q},S:function(){return at},T:function(){return zt},U:function(){return ge},V:function(){return N},W:function(){return be},X:function(){return ot},Y:function(){return Je},Z:function(){return Ce},_:function(){return Y},a:function(){return k},a0:function(){return Rt},a1:function(){return Ht},a2:function(){return vt},a3:function(){return qt},a4:function(){return J},a5:function(){return Bt},a6:function(){return We},a7:function(){return St},a8:function(){return de},a9:function(){return he},aA:function(){return kt},aB:function(){return L},aC:function(){return Xe},aD:function(){return G},aE:function(){return et},aF:function(){return mt},aG:function(){return ve},aH:function(){return Be},aI:function(){return v},aJ:function(){return ke},aK:function(){return tt},aL:function(){return ze},aa:function(){return te},ab:function(){return gt},ac:function(){return oe},ad:function(){return I},ae:function(){return Pe},af:function(){return Vt},ag:function(){return Gt},ah:function(){return _e},ai:function(){return pt},aj:function(){return it},ak:function(){return He},al:function(){return Xt},am:function(){return Kt},an:function(){return dt},ao:function(){return ee},ap:function(){return ct},aq:function(){return me},ar:function(){return we},as:function(){return Qe},at:function(){return nt},au:function(){return rt},av:function(){return Et},aw:function(){return lt},ax:function(){return X},ay:function(){return Zt},az:function(){return q},b:function(){return ie},c:function(){return Me},d:function(){return C},e:function(){return Z},f:function(){return ne},g:function(){return w},h:function(){return Se},i:function(){return _},j:function(){return Ee},k:function(){return R},l:function(){return Fe},m:function(){return Ae},n:function(){return y},o:function(){return le},p:function(){return xe},q:function(){return Oe},r:function(){return Te},s:function(){return Ie},t:function(){return De},u:function(){return p},v:function(){return Ze},w:function(){return re},x:function(){return P},y:function(){return ue},z:function(){return se}});var n=i(82963),r=i(93433),a=i(11752),o=i(61120),s=i(74165),l=i(97326),u=i(60136),c=i(29388),d=i(15671),h=i(43144),f=i(27366);function v(e){return Number(e)!==e}function p(e){if(null!=e&&!w(e)){var t=Number(e);return v(t)&&_(e)&&""!=e?p(e.replace(/[^0-9.\-]+/g,"")):t}return e}function g(e){if(b(e))return new Date(e);if(w(e))return new Date(e);var t=Number(e);return w(t)?new Date(t):new Date(e)}function y(e){if(v(e))return"NaN";if(e===1/0)return"Infinity";if(e===-1/0)return"-Infinity";if(0===e&&1/e==-1/0)return"-0";var t=e<0;e=Math.abs(e);var i,n=/^([0-9]+)(?:\.([0-9]+))?(?:e[\+\-]([0-9]+))?$/.exec(""+e),r=n[1],a=n[2]||"";if(void 0===n[3])i=""===a?r:r+"."+a;else{var o=+n[3];if(e<1)i="0."+m("0",o-1)+r+a;else{var s=o-a.length;i=0===s?r+a:s<0?r+a.slice(0,s)+"."+a.slice(s):r+a+m("0",s)}}return t?"-"+i:i}function m(e,t){return new Array(t+1).join(e)}function b(e){return"[object Date]"===function(e){return{}.toString.call(e)}(e)}function _(e){return"string"==typeof e}function w(e){return"number"==typeof e&&Number(e)==e}function k(e){return"object"==typeof e&&null!==e}var x="__\xa7\xa7\xa7__",C="__\xa7\xa7\xa7\xa7__";function M(e,t){for(var i=e.length,n=0;n<i;++n)if(e[n]===t)return n;return-1}function P(e,t){for(var i=e.length,n=new Array(i),r=0;r<i;++r)n[r]=t(e[r],r);return n}function Z(e,t){for(var i=e.length,n=0;n<i;++n)t(e[n],n)}function A(e,t){for(var i=e.length;i>0;)t(e[--i],i)}function T(e,t){for(var i=e.length,n=0;n<i&&t(e[n],n);++n);}function I(e,t){for(var i=!1,n=0;;){if(-1===(n=e.indexOf(t,n)))return i;i=!0,e.splice(n,1)}}function O(e,t){var i=e.indexOf(t);return-1!==i&&(e.splice(i,1),!0)}function D(e,t){-1===e.indexOf(t)&&e.push(t)}function F(e){for(var t=e.length,i=new Array(t),n=0;n<t;++n)i[n]=e[n];return i}function E(e,t,i){e.splice(t,0,i)}function S(e,t){e.splice(t,1)}function B(e,t){for(var i=e.length,n=0;n<i;++n)if(t(e[n],n))return n;return-1}function L(e,t){var i=B(e,t);if(-1!==i)return e[i]}function j(e,t){for(var i=0,n=e.length,r=!1;i<n;){var a=i+n>>1,o=t(e[a]);o<0?i=a+1:0===o?(r=!0,i=a+1):n=a}return{found:r,index:r?i-1:i}}function R(e,t){for(var i=e.length;i>0;)t(e[--i])||e.splice(i,1)}var N=function(){function e(){(0,d.Z)(this,e),Object.defineProperty(this,"_disposed",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._disposed=!1}return(0,h.Z)(e,[{key:"isDisposed",value:function(){return this._disposed}},{key:"dispose",value:function(){this._disposed||(this._disposed=!0,this._dispose())}}]),e}(),H=function(){function e(t){(0,d.Z)(this,e),Object.defineProperty(this,"_disposed",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_dispose",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._disposed=!1,this._dispose=t}return(0,h.Z)(e,[{key:"isDisposed",value:function(){return this._disposed}},{key:"dispose",value:function(){this._disposed||(this._disposed=!0,this._dispose())}}]),e}(),z=function(e){(0,u.Z)(i,e);var t=(0,c.Z)(i);function i(){var e;return(0,d.Z)(this,i),e=t.apply(this,arguments),Object.defineProperty((0,l.Z)(e),"_disposers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),e}return(0,h.Z)(i,[{key:"_dispose",value:function(){Z(this._disposers,(function(e){e.dispose()}))}}]),i}(N),V=function(e){(0,u.Z)(i,e);var t=(0,c.Z)(i);function i(e){var n;return(0,d.Z)(this,i),n=t.call(this),Object.defineProperty((0,l.Z)(n),"_disposers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),n._disposers=e,n}return(0,h.Z)(i,[{key:"_dispose",value:function(){Z(this._disposers,(function(e){e.dispose()}))}}]),i}(N),W=function(e){(0,u.Z)(i,e);var t=(0,c.Z)(i);function i(){var e;return(0,d.Z)(this,i),e=t.apply(this,arguments),Object.defineProperty((0,l.Z)(e),"_counter",{enumerable:!0,configurable:!0,writable:!0,value:0}),e}return(0,h.Z)(i,[{key:"increment",value:function(){var e=this;return++this._counter,new H((function(){--e._counter,0===e._counter&&e.dispose()}))}}]),i}(H),Y=function(){function e(){(0,d.Z)(this,e),Object.defineProperty(this,"_listeners",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_killed",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_disabled",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_iterating",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_enabled",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_disposed",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._listeners=[],this._killed=[],this._disabled={},this._iterating=0,this._enabled=!0,this._disposed=!1}return(0,h.Z)(e,[{key:"isDisposed",value:function(){return this._disposed}},{key:"dispose",value:function(){if(!this._disposed){this._disposed=!0;var e=this._listeners;this._iterating=1,this._listeners=null,this._disabled=null;try{Z(e,(function(e){e.disposer.dispose()}))}finally{this._killed=null,this._iterating=null}}}},{key:"hasListeners",value:function(){return 0!==this._listeners.length}},{key:"hasListenersByType",value:function(e){return function(e,t){for(var i=e.length,n=0;n<i;++n)if(t(e[n]))return!0;return!1}(this._listeners,(function(t){return(null===t.type||t.type===e)&&!t.killed}))}},{key:"enable",value:function(){this._enabled=!0}},{key:"disable",value:function(){this._enabled=!1}},{key:"enableType",value:function(e){delete this._disabled[e]}},{key:"disableType",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;this._disabled[e]=t}},{key:"_removeListener",value:function(e){if(0===this._iterating){var t=this._listeners.indexOf(e);if(-1===t)throw new Error("Invalid state: could not remove listener");this._listeners.splice(t,1)}else this._killed.push(e)}},{key:"_removeExistingListener",value:function(e,t,i,n){if(this._disposed)throw new Error("EventDispatcher is disposed");this._eachListener((function(r){r.once!==e||r.type!==t||void 0!==i&&r.callback!==i||r.context!==n||r.disposer.dispose()}))}},{key:"isEnabled",value:function(e){if(this._disposed)throw new Error("EventDispatcher is disposed");return this._enabled&&this._listeners.length>0&&this.hasListenersByType(e)&&void 0===this._disabled[e]}},{key:"removeType",value:function(e){if(this._disposed)throw new Error("EventDispatcher is disposed");this._eachListener((function(t){t.type===e&&t.disposer.dispose()}))}},{key:"has",value:function(e,t,i){return-1!==B(this._listeners,(function(n){return!0!==n.once&&n.type===e&&(void 0===t||n.callback===t)&&n.context===i}))}},{key:"_shouldDispatch",value:function(e){if(this._disposed)throw new Error("EventDispatcher is disposed");var t=this._disabled[e];return w(t)?(t<=1?delete this._disabled[e]:--this._disabled[e],!1):this._enabled}},{key:"_eachListener",value:function(e){var t=this;++this._iterating;try{Z(this._listeners,e)}finally{--this._iterating,0===this._iterating&&0!==this._killed.length&&(Z(this._killed,(function(e){t._removeListener(e)})),this._killed.length=0)}}},{key:"dispatch",value:function(e,t){this._shouldDispatch(e)&&this._eachListener((function(i){i.killed||null!==i.type&&i.type!==e||i.dispatch(e,t)}))}},{key:"_on",value:function(e,t,i,n,r,a){var o=this;if(this._disposed)throw new Error("EventDispatcher is disposed");this._removeExistingListener(e,t,i,n);var s={type:t,callback:i,context:n,shouldClone:r,dispatch:a,killed:!1,once:e,disposer:new H((function(){s.killed=!0,o._removeListener(s)}))};return this._listeners.push(s),s}},{key:"onAll",value:function(e,t){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this._on(!1,null,e,t,i,(function(i,n){return e.call(t,n)})).disposer}},{key:"on",value:function(e,t,i){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return this._on(!1,e,t,i,n,(function(e,n){return t.call(i,n)})).disposer}},{key:"once",value:function(e,t,i){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=this._on(!0,e,t,i,n,(function(e,n){r.disposer.dispose(),t.call(i,n)}));return r.disposer}},{key:"off",value:function(e,t,i){this._removeExistingListener(!1,e,t,i)}},{key:"copyFrom",value:function(e){var t=this;if(this._disposed)throw new Error("EventDispatcher is disposed");if(e===this)throw new Error("Cannot copyFrom the same TargetedEventDispatcher");var i=[];return Z(e._listeners,(function(e){!e.killed&&e.shouldClone&&(null===e.type?i.push(t.onAll(e.callback,e.context)):e.once?i.push(t.once(e.type,e.callback,e.context)):i.push(t.on(e.type,e.callback,e.context)))})),new V(i)}}]),e}();function U(e,t){if(!(e>=0&&e<t))throw new Error("Index out of bounds: "+e)}var q=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];(0,d.Z)(this,t),Object.defineProperty(this,"_values",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:new Y}),this._values=e}return(0,h.Z)(t,[{key:"values",get:function(){return this._values}},{key:"contains",value:function(e){return-1!==this._values.indexOf(e)}},{key:"removeValue",value:function(e){for(var t=0,i=this._values.length;t<i;)this._values[t]===e?(this.removeIndex(t),--i):++t}},{key:"indexOf",value:function(e){return M(this._values,e)}},{key:"length",get:function(){return this._values.length}},{key:"hasIndex",value:function(e){return e>=0&&e<this._values.length}},{key:"getIndex",value:function(e){return this._values[e]}},{key:"_onPush",value:function(e){this.events.isEnabled("push")&&this.events.dispatch("push",{type:"push",target:this,newValue:e})}},{key:"_onInsertIndex",value:function(e,t){this.events.isEnabled("insertIndex")&&this.events.dispatch("insertIndex",{type:"insertIndex",target:this,index:e,newValue:t})}},{key:"_onSetIndex",value:function(e,t,i){this.events.isEnabled("setIndex")&&this.events.dispatch("setIndex",{type:"setIndex",target:this,index:e,oldValue:t,newValue:i})}},{key:"_onRemoveIndex",value:function(e,t){this.events.isEnabled("removeIndex")&&this.events.dispatch("removeIndex",{type:"removeIndex",target:this,index:e,oldValue:t})}},{key:"_onMoveIndex",value:function(e,t,i){this.events.isEnabled("moveIndex")&&this.events.dispatch("moveIndex",{type:"moveIndex",target:this,oldIndex:e,newIndex:t,value:i})}},{key:"_onClear",value:function(e){this.events.isEnabled("clear")&&this.events.dispatch("clear",{type:"clear",target:this,oldValues:e})}},{key:"setIndex",value:function(e,t){U(e,this._values.length);var i=this._values[e];return i!==t&&(this._values[e]=t,this._onSetIndex(e,i,t)),i}},{key:"insertIndex",value:function(e,t){return U(e,this._values.length+1),E(this._values,e,t),this._onInsertIndex(e,t),t}},{key:"swap",value:function(e,t){var i=this._values.length;if(U(e,i),U(t,i),e!==t){var n=this._values[e],r=this._values[t];this._values[e]=r,this._onSetIndex(e,n,r),this._values[t]=n,this._onSetIndex(t,r,n)}}},{key:"removeIndex",value:function(e){U(e,this._values.length);var t=this._values[e];return S(this._values,e),this._onRemoveIndex(e,t),t}},{key:"moveValue",value:function(e,t){var i=this.indexOf(e);if(-1!==i)if(S(this._values,i),null==t){var n=this._values.length;this._values.push(e),this._onMoveIndex(i,n,e)}else E(this._values,t,e),this._onMoveIndex(i,t,e);else null==t?(this._values.push(e),this._onPush(e)):(E(this._values,t,e),this._onInsertIndex(t,e));return e}},{key:"push",value:function(e){return this._values.push(e),this._onPush(e),e}},{key:"unshift",value:function(e){return this.insertIndex(0,e),e}},{key:"pushAll",value:function(e){var t=this;Z(e,(function(e){t.push(e)}))}},{key:"copyFrom",value:function(e){this.pushAll(e._values)}},{key:"pop",value:function(){return this._values.length-1<0?void 0:this.removeIndex(this._values.length-1)}},{key:"shift",value:function(){return this._values.length?this.removeIndex(0):void 0}},{key:"setAll",value:function(e){var t=this,i=this._values;this._values=[],this._onClear(i),Z(e,(function(e){t._values.push(e),t._onPush(e)}))}},{key:"clear",value:function(){this.setAll([])}},{key:e,value:(0,s.Z)().mark((function e(){var t,i;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this._values.length,i=0;case 2:if(!(i<t)){e.next=8;break}return e.next=5,this._values[i];case 5:++i,e.next=2;break;case 8:case"end":return e.stop()}}),e,this)}))},{key:"each",value:function(e){Z(this._values,e)}},{key:"eachReverse",value:function(e){A(this._values,e)}}]),t}(Symbol.iterator),G=function(e){(0,u.Z)(i,e);var t=(0,c.Z)(i);function i(){var e;return(0,d.Z)(this,i),e=t.apply(this,arguments),Object.defineProperty((0,l.Z)(e),"autoDispose",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty((0,l.Z)(e),"_disposed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),e}return(0,h.Z)(i,[{key:"_onSetIndex",value:function(e,t,n){this.autoDispose&&t.dispose(),(0,a.Z)((0,o.Z)(i.prototype),"_onSetIndex",this).call(this,e,t,n)}},{key:"_onRemoveIndex",value:function(e,t){this.autoDispose&&t.dispose(),(0,a.Z)((0,o.Z)(i.prototype),"_onRemoveIndex",this).call(this,e,t)}},{key:"_onClear",value:function(e){this.autoDispose&&Z(e,(function(e){e.dispose()})),(0,a.Z)((0,o.Z)(i.prototype),"_onClear",this).call(this,e)}},{key:"isDisposed",value:function(){return this._disposed}},{key:"dispose",value:function(){this._disposed||(this._disposed=!0,this.autoDispose&&Z(this._values,(function(e){e.dispose()})))}}]),i}(q),X=function(e){(0,u.Z)(i,e);var t=(0,c.Z)(i);function i(e,n){var r;return(0,d.Z)(this,i),r=t.call(this),Object.defineProperty((0,l.Z)(r),"template",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,l.Z)(r),"make",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),r.template=e,r.make=n,r}return(0,h.Z)(i)}(G),K=function(e){(0,u.Z)(i,e);var t=(0,c.Z)(i);function i(e){var n;return(0,d.Z)(this,i),n=t.call(this),Object.defineProperty((0,l.Z)(n),"_disposed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty((0,l.Z)(n),"_container",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,l.Z)(n),"_events",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),n._container=e,n._events=n.events.onAll((function(e){if("clear"===e.type)Z(e.oldValues,(function(e){n._onRemoved(e)}));else if("push"===e.type)n._onInserted(e.newValue);else if("setIndex"===e.type)n._onRemoved(e.oldValue),n._onInserted(e.newValue,e.index);else if("insertIndex"===e.type)n._onInserted(e.newValue,e.index);else if("removeIndex"===e.type)n._onRemoved(e.oldValue);else{if("moveIndex"!==e.type)throw new Error("Unknown IListEvent type");n._onRemoved(e.value),n._onInserted(e.value,e.newIndex)}})),n}return(0,h.Z)(i,[{key:"_onInserted",value:function(e,t){e._setParent(this._container,!0);var i=this._container._childrenDisplay;void 0===t?i.addChild(e._display):i.addChildAt(e._display,t)}},{key:"_onRemoved",value:function(e){this._container._childrenDisplay.removeChild(e._display),this._container.markDirtyBounds(),this._container.markDirty()}},{key:"isDisposed",value:function(){return this._disposed}},{key:"dispose",value:function(){this._disposed||(this._disposed=!0,this._events.dispose(),Z(this.values,(function(e){e.dispose()})))}}]),i}(q),$=function(){function e(t){(0,d.Z)(this,e),Object.defineProperty(this,"_value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._value=t}return(0,h.Z)(e,[{key:"value",get:function(){return this._value/100}},{key:"percent",get:function(){return this._value}},{key:"toString",value:function(){return this._value+"%"}},{key:"interpolate",value:function(e,t){return e+this.value*(t-e)}}],[{key:"normalize",value:function(t,i,n){return t instanceof e?t:new e(i===n?0:100*Math.min(Math.max(1/(n-i)*(t-i),0),1))}}]),e}();function Q(e){return new $(e)}Q(0);var J=Q(100),ee=Q(50);function te(e){return Object.keys(e)}function ie(e){return Object.assign({},e)}function ne(e,t){te(e).forEach((function(i){t(i,e[i])}))}function re(e,t){for(var i in e)if(ae(e,i)&&!t(i,e[i]))break}function ae(e,t){return{}.hasOwnProperty.call(e,t)}function oe(e){e.parentNode&&e.parentNode.removeChild(e)}function se(e,t,i,n){return e.addEventListener(t,i,n||!1),new H((function(){e.removeEventListener(t,i,n||!1)}))}function le(e){return se(window,"resize",(function(t){e()}))}function ue(e){switch(e){case"touchevents":return window.hasOwnProperty("TouchEvent");case"pointerevents":return window.hasOwnProperty("PointerEvent");case"mouseevents":return window.hasOwnProperty("MouseEvent");case"wheelevents":return window.hasOwnProperty("WheelEvent");case"keyboardevents":return window.hasOwnProperty("KeyboardEvent")}return!1}function ce(e){return e.pointerId||0}function de(){if(document.activeElement&&document.activeElement!=document.body)if(document.activeElement.blur)document.activeElement.blur();else{var e=document.createElement("button");e.style.position="fixed",e.style.top="0px",e.style.left="-10000px",document.body.appendChild(e),e.focus(),e.blur(),document.body.removeChild(e)}}function he(e){e&&e.focus()}function fe(e){if(ue("pointerevents"))return e;if(ue("touchevents"))switch(e){case"pointerover":case"pointerdown":return"touchstart";case"pointerout":case"pointerup":return"touchend";case"pointermove":return"touchmove";case"click":return"click";case"dblclick":return"dblclick"}else if(ue("mouseevents"))switch(e){case"pointerover":return"mouseover";case"pointerout":return"mouseout";case"pointerdown":return"mousedown";case"pointermove":return"mousemove";case"pointerup":return"mouseup";case"click":return"click";case"dblclick":return"dblclick"}return e}function ve(e){if("undefined"!=typeof Touch&&e instanceof Touch)return!0;if("undefined"!=typeof PointerEvent&&e instanceof PointerEvent&&null!=e.pointerType)switch(e.pointerType){case"touch":case"pen":case 2:return!0;case"mouse":case 4:return!1;default:return!(e instanceof MouseEvent)}else if(null!=e.type&&e.type.match(/^mouse/))return!1;return!0}function pe(e,t,i){e.style[t]=i}function ge(e,t){return e.style[t]}function ye(e){if(e.composedPath){var t=e.composedPath();return 0===t.length?null:t[0]}return e.target}function me(e,t){return e.target&&function(e,t){for(var i=t;;){if(e===i)return!0;if(null===i.parentNode){if(null==i.host)return!1;i=i.host}else i=i.parentNode}}(t.root.dom,e.target)}function be(e,t){e.style.pointerEvents=t?"auto":"none"}function _e(){return/apple/i.test(navigator.vendor)&&"ontouchend"in document?1:void 0}function we(e,t){return w(e)?e:null!=e&&w(e.value)&&w(t)?t*e.value:0}function ke(e){var t=(""+e).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return t?Math.max(0,(t[1]?t[1].length:0)-(t[2]?+t[2]:0)):0}function xe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"0";return"string"!=typeof e&&(e=e.toString()),t>e.length?Array(t-e.length+1).join(i)+e:e}function Ce(e){return function(e){return e.replace(/^[\s]*/,"")}(function(e){return e.replace(/[\s]*$/,"")}(e))}function Me(e){return e.replace(/\/(date|number|duration)$/i,"")}function Pe(e){return e?e.replace(/<[^>]*>/g,""):e}function Ze(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}function Ae(e){var t=new Date(e.getFullYear(),0,0),i=e.getTime()-t.getTime()+60*(t.getTimezoneOffset()-e.getTimezoneOffset())*1e3,n=864e5;return Math.floor(i/n)}function Te(e){var t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())),i=t.getUTCDay()||7;t.setUTCDate(t.getUTCDate()+4-i);var n=new Date(Date.UTC(t.getUTCFullYear(),0,1));return Math.ceil(((t.getTime()-n.getTime())/864e5+1)/7)}function Ie(e){var t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())),i=t.getUTCDay()||7;return t.setUTCDate(t.getUTCDate()+4-i),new Date(Date.UTC(t.getUTCFullYear(),0,1)).getFullYear()}function Oe(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=Te(new Date(e.getFullYear(),e.getMonth(),1),t),n=Te(e,t);return 1==n&&(n=53),n-i+1}function De(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=new Date(t,0,4,0,0,0,0);return n&&r.setUTCFullYear(t),7*e+i-((r.getDay()||7)+3)}function Fe(e,t){return e>12?e-=12:0===e&&(e=12),null!=t?e+(t-1):e}function Ee(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(n)return t?"Coordinated Universal Time":"UTC";var r=e.toLocaleString("UTC"),a=e.toLocaleString("UTC",{timeZoneName:t?"long":"short"}).substr(r.length);return!1===i&&(a=a.replace(/ (standard|daylight|summer|winter) /i," ")),a}function Se(e){var t=new Date(Date.UTC(2012,0,1,0,0,0,0)),i=new Date(t.toLocaleString("en-US",{timeZone:"UTC"}));return(new Date(t.toLocaleString("en-US",{timeZone:e})).getTime()-i.getTime())/6e4*-1}function Be(e){return e.charAt(0).toUpperCase()+e.slice(1)}function Le(e){var t,i,n,r=e.h,a=e.s,o=e.l;if(0==a)t=i=n=o;else{var s=function(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+6*(t-e)*i:i<.5?t:i<2/3?e+(t-e)*(2/3-i)*6:e},l=o<.5?o*(1+a):o+a-o*a,u=2*o-l;t=s(u,l,r+1/3),i=s(u,l,r),n=s(u,l,r-1/3)}return{r:Math.round(255*t),g:Math.round(255*i),b:Math.round(255*n)}}function je(e){var t=e.r/255,i=e.g/255,n=e.b/255,r=Math.max(t,i,n),a=Math.min(t,i,n),o=0,s=0,l=(r+a)/2;if(r===a)o=s=0;else{var u=r-a;switch(s=l>.5?u/(2-r-a):u/(r+a),r){case t:o=(i-n)/u+(i<n?6:0);break;case i:o=(n-t)/u+2;break;case n:o=(t-i)/u+4}o/=6}return{h:o,s:s,l:l}}function Re(e,t){var i=t>0?255-e:e;return Math.round(i*t)}function Ne(e){return(299*e.r+587*e.g+114*e.b)/1e3>=128}function He(e,t){return e||(e=[]),[].concat((0,r.Z)(e),(0,r.Z)(t)).filter((function(e,t,i){return i.indexOf(e)===t}))}function ze(e,t){return!!t&&e.left==t.left&&e.right==t.right&&e.top==t.top&&e.bottom==t.bottom}function Ve(e){return"#"===e[0]&&(e=e.substr(1)),3==e.length&&(e=e[0].repeat(2)+e[1].repeat(2)+e[2].repeat(2)),parseInt(e,16)}function We(e){return Ye.fromAny(e)}var Ye=function(){function e(t){(0,d.Z)(this,e),Object.defineProperty(this,"_hex",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._hex=0|t}return(0,h.Z)(e,[{key:"hex",get:function(){return this._hex}},{key:"r",get:function(){return this._hex>>>16}},{key:"g",get:function(){return this._hex>>8&255}},{key:"b",get:function(){return 255&this._hex}},{key:"toCSS",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return"rgba("+this.r+", "+this.g+", "+this.b+", "+e+")"}},{key:"toCSSHex",value:function(){return"#"+xe(this.r.toString(16),2)+xe(this.g.toString(16),2)+xe(this.b.toString(16),2)}},{key:"toHSL",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return je({r:this.r,g:this.g,b:this.b,a:e})}},{key:"toString",value:function(){return this.toCSSHex()}}],[{key:"fromHSL",value:function(e,t,i){var n=Le({h:e,s:t,l:i});return this.fromRGB(n.r,n.g,n.b)}},{key:"fromHex",value:function(t){return new e(t)}},{key:"fromRGB",value:function(t,i,n){return new e((0|n)+(i<<8)+(t<<16))}},{key:"fromString",value:function(t){return new e(Ve(t))}},{key:"fromCSS",value:function(t){return new e(function(e){var t=(e=e.replace(/[ ]/g,"")).match(/^rgb\(([0-9]*),([0-9]*),([0-9]*)\)/i);if(t)t.push("1");else if(!(t=e.match(/^rgba\(([0-9]*),([0-9]*),([0-9]*),([.0-9]*)\)/i)))return 0;for(var i="",n=1;n<=3;n++){var r=parseInt(t[n]).toString(16);1==r.length&&(r="0"+r),i+=r}return Ve(i)}(t))}},{key:"fromAny",value:function(t){if(_(t)){if("#"==t[0])return e.fromString(t);if("rgb"==t.substr(0,3))return e.fromCSS(t)}else{if(w(t))return e.fromHex(t);if(t instanceof e)return e.fromHex(t.hex)}throw new Error("Unknown color syntax: "+t)}},{key:"alternative",value:function(e,t,i){var n=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{r:255,g:255,b:255},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{r:255,g:255,b:255},n=t,r=i;return Ne(i)&&(n=i,r=t),Ne(e)?r:n}({r:e.r,g:e.g,b:e.b},t?{r:t.r,g:t.g,b:t.b}:void 0,i?{r:i.r,g:i.g,b:i.b}:void 0);return this.fromRGB(n.r,n.g,n.b)}},{key:"interpolate",value:function(t,i,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"rgb";if("hsl"==r){var a=i.toHSL(),o=n.toHSL();return e.fromHSL(qe(t,a.h,o.h),qe(t,a.s,o.s),qe(t,a.l,o.l))}return e.fromRGB(qe(t,i.r,n.r),qe(t,i.g,n.g),qe(t,i.b,n.b))}},{key:"lighten",value:function(t,i){var n=function(e,t){return e?{r:Math.max(0,Math.min(255,e.r+Re(e.r,t))),g:Math.max(0,Math.min(255,e.g+Re(e.g,t))),b:Math.max(0,Math.min(255,e.b+Re(e.b,t))),a:e.a}:e}({r:t.r,g:t.g,b:t.b},i);return e.fromRGB(n.r,n.g,n.b)}},{key:"brighten",value:function(t,i){var n=function(e,t){if(e){var i=Re(Math.min(Math.max(e.r,e.g,e.b),230),t);return{r:Math.max(0,Math.min(255,Math.round(e.r+i))),g:Math.max(0,Math.min(255,Math.round(e.g+i))),b:Math.max(0,Math.min(255,Math.round(e.b+i))),a:e.a}}return e}({r:t.r,g:t.g,b:t.b},i);return e.fromRGB(n.r,n.g,n.b)}},{key:"saturate",value:function(t,i){var n=function(e,t){if(void 0===e||1==t)return e;var i=je(e);return i.s=t,Le(i)}({r:t.r,g:t.g,b:t.b},i);return e.fromRGB(n.r,n.g,n.b)}}]),e}();function Ue(e){return(0,f.a)(this,void 0,void 0,(0,s.Z)().mark((function t(){var i;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===e){t.next=5;break}return i=[],ne(e,(function(e,t){i.push(t.waitForStop())})),t.next=5,Promise.all(i);case 5:case"end":return t.stop()}}),t)})))}function qe(e,t,i){return t+e*(i-t)}function Ge(e,t,i){return e>=1?i:t}function Xe(e,t,i){return new $(qe(e,t.percent,i.percent))}function Ke(e,t,i){return Ye.interpolate(e,t,i)}var $e=Math.PI,Qe=$e/180,Je=180/$e;function et(e,t,i){if(!w(t)||t<=0){var n=Math.round(e);return i&&n-e==.5&&n--,n}var r=Math.pow(10,t);return Math.round(e*r)/r}function tt(e,t){if(!w(t)||t<=0)return Math.ceil(e);var i=Math.pow(10,t);return Math.ceil(e*i)/i}function it(e,t,i){return Math.min(Math.max(e,t),i)}function nt(e){return Math.sin(Qe*e)}function rt(e){return Math.cos(Qe*e)}function at(e){return(e%=360)<0&&(e+=360),e}function ot(e,t,i,n,r){var a=Number.MAX_VALUE,o=Number.MAX_VALUE,s=-Number.MAX_VALUE,l=-Number.MAX_VALUE,u=[];u.push(st(r,i)),u.push(st(r,n));for(var c=Math.min(90*Math.floor(i/90),90*Math.floor(n/90)),d=Math.max(90*Math.ceil(i/90),90*Math.ceil(n/90)),h=c;h<=d;h+=90)h>=i&&h<=n&&u.push(st(r,h));for(var f=0;f<u.length;f++){var v=u[f];v.x<a&&(a=v.x),v.y<o&&(o=v.y),v.x>s&&(s=v.x),v.y>l&&(l=v.y)}return{left:e+a,top:t+o,right:e+s,bottom:t+l}}function st(e,t){return{x:e*rt(t),y:e*nt(t)}}function lt(e){var t=e.length;if(t>0){var i=e[0],n=i.left,r=i.top,a=i.right,o=i.bottom;if(t>1)for(var s=1;s<t;s++)i=e[s],n=Math.min(i.left,n),a=Math.max(i.right,a),r=Math.min(i.top,r),o=Math.max(i.bottom,o);return{left:n,right:a,top:r,bottom:o}}return{left:0,right:0,top:0,bottom:0}}function ut(e){return e}function ct(e){return e*e*e}function dt(e){return function(t){return 1-e(1-t)}}var ht=function(){function e(t,i){var n=this;(0,d.Z)(this,e),Object.defineProperty(this,"_entity",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_settings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_userSettings",{enumerable:!0,configurable:!0,writable:!0,value:{}}),this._entity=t,this._settings=i,ne(i,(function(e){n._userSettings[e]=!0}))}return(0,h.Z)(e,[{key:"get",value:function(e,t){var i=this._settings[e];return void 0!==i?i:t}},{key:"setRaw",value:function(e,t){this._settings[e]=t}},{key:"set",value:function(e,t){this._userSettings[e]=!0,this.setRaw(e,t)}},{key:"remove",value:function(e){delete this._userSettings[e],delete this._settings[e]}},{key:"setAll",value:function(e){var t=this;te(e).forEach((function(i){t.set(i,e[i])}))}},{key:"_eachSetting",value:function(e){ne(this._settings,e)}},{key:"apply",value:function(){var e=this,t={stateAnimationEasing:!0,stateAnimationDuration:!0},i=this._entity.states.lookup("default");this._eachSetting((function(n,r){t[n]||(t[n]=!0,e!==i&&(n in i._settings||(i._settings[n]=e._entity.get(n))),e._entity.set(n,r))}))}},{key:"applyAnimate",value:function(e){var t=this;null==e&&(e=this._settings.stateAnimationDuration),null==e&&(e=this.get("stateAnimationDuration",this._entity.get("stateAnimationDuration",0)));var i=this._settings.stateAnimationEasing;null==i&&(i=this.get("stateAnimationEasing",this._entity.get("stateAnimationEasing",ct)));var n=this._entity.states.lookup("default"),r={stateAnimationEasing:!0,stateAnimationDuration:!0},a={};return this._eachSetting((function(o,s){if(!r[o]){r[o]=!0,t!=n&&(o in n._settings||(n._settings[o]=t._entity.get(o)));var l=t._entity.animate({key:o,to:s,duration:e,easing:i});l&&(a[o]=l)}})),a}}]),e}(),ft=function(){function e(t){(0,d.Z)(this,e),Object.defineProperty(this,"_states",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_entity",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._entity=t}return(0,h.Z)(e,[{key:"lookup",value:function(e){return this._states[e]}},{key:"create",value:function(e,t){var i=this._states[e];if(i)return i.setAll(t),i;var n=new ht(this._entity,t);return this._states[e]=n,n}},{key:"remove",value:function(e){delete this._states[e]}},{key:"apply",value:function(e){var t=this._states[e];t&&t.apply(),this._entity._applyState(e)}},{key:"applyAnimate",value:function(e,t){var i,n=this._states[e];return n&&(i=n.applyAnimate(t)),this._entity._applyStateAnimated(e,t),i}}]),e}(),vt=new((0,h.Z)((function e(){(0,d.Z)(this,e),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:"5.3.12"}),Object.defineProperty(this,"licenses",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"entitiesById",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"rootElements",{enumerable:!0,configurable:!0,writable:!0,value:[]})})));function pt(e){vt.licenses.push(e)}function gt(e,t){return e===t?0:e<t?-1:1}function yt(e,t,i){for(var n=e.length,r=t.length,a=Math.min(n,r),o=0;o<a;++o){var s=i(e[o],t[o]);if(0!==s)return s}return gt(n,r)}function mt(e,t){return e===t?0:e<t?-1:1}var bt=function(){function e(t){(0,d.Z)(this,e),Object.defineProperty(this,"_entity",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_callbacks",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_disabled",{enumerable:!0,configurable:!0,writable:!0,value:{}}),this._entity=t}return(0,h.Z)(e,[{key:"add",value:function(e,t){var i=this,n=this._callbacks[e];return void 0===n&&(n=this._callbacks[e]=[]),n.push(t),this._entity._markDirtyKey(e),new H((function(){O(n,t)&&i._entity._markDirtyKey(e)}))}},{key:"remove",value:function(e){var t=this._callbacks[e];void 0!==t&&(delete this._callbacks[e],0!==t.length&&this._entity._markDirtyKey(e))}},{key:"enable",value:function(e){this._disabled[e]&&(delete this._disabled[e],this._entity._markDirtyKey(e))}},{key:"disable",value:function(e){this._disabled[e]||(this._disabled[e]=!0,this._entity._markDirtyKey(e))}},{key:"fold",value:function(e,t){if(!this._disabled[e]){var i=this._callbacks[e];if(void 0!==i)for(var n=0,r=i.length;n<r;++n)t=i[n](t,this._entity,e)}return t}}]),e}(),_t=function(){function e(t,i,n,r,a,o,s){(0,d.Z)(this,e),Object.defineProperty(this,"_animation",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_from",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_to",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_duration",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_easing",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_loops",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_interpolate",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_oldTime",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_time",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_stopped",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_playing",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:new Y}),this._animation=t,this._from=i,this._to=n,this._duration=r,this._easing=a,this._loops=o,this._interpolate=function(e,t){return"number"==typeof e&&"number"==typeof t?qe:e instanceof $&&t instanceof $?Xe:e instanceof Ye&&t instanceof Ye?Ke:Ge}(i,n),this._oldTime=s}return(0,h.Z)(e,[{key:"to",get:function(){return this._to}},{key:"from",get:function(){return this._from}},{key:"playing",get:function(){return this._playing}},{key:"stopped",get:function(){return this._stopped}},{key:"stop",value:function(){this._stopped||(this._stopped=!0,this._playing=!1,this.events.isEnabled("stopped")&&this.events.dispatch("stopped",{type:"stopped",target:this}))}},{key:"pause",value:function(){this._playing=!1,this._oldTime=null}},{key:"play",value:function(){this._stopped||this._playing||(this._playing=!0,this._animation._startAnimation())}},{key:"percentage",get:function(){return this._time/this._duration}},{key:"waitForStop",value:function(){var e=this;return new Promise((function(t,i){if(e._stopped)t();else var n=e.events.on("stopped",(function(){n.dispose(),t()}))}))}},{key:"_checkEnded",value:function(){return!(this._loops>1)||(--this._loops,!1)}},{key:"_run",value:function(e){null!==this._oldTime&&(this._time+=e-this._oldTime,this._time>this._duration&&(this._time=this._duration)),this._oldTime=e}},{key:"_reset",value:function(e){this._oldTime=e,this._time=0}},{key:"_value",value:function(e){return this._interpolate(this._easing(e),this._from,this._to)}}]),e}(),wt=0,kt=function(){function e(t){(0,d.Z)(this,e),Object.defineProperty(this,"uid",{enumerable:!0,configurable:!0,writable:!0,value:++wt}),Object.defineProperty(this,"_settings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_privateSettings",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_settingEvents",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_privateSettingEvents",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_prevSettings",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_prevPrivateSettings",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_animatingSettings",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_animatingPrivateSettings",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_disposed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_userProperties",{enumerable:!0,configurable:!0,writable:!0,value:{}}),this._settings=t}return(0,h.Z)(e,[{key:"_checkDirty",value:function(){var e=this;te(this._settings).forEach((function(t){e._userProperties[t]=!0,e._markDirtyKey(t)}))}},{key:"resetUserSettings",value:function(){this._userProperties={}}},{key:"_runAnimation",value:function(e){var t=this;if(this.isDisposed())return!1;var i=!1;return ne(this._animatingSettings,(function(n,r){if(r._stopped)t._stopAnimation(n);else if(r._playing){r._run(e);var a=r.percentage;a>=1?r._checkEnded()?t.set(n,r._value(1)):(i=!0,r._reset(e),t._set(n,r._value(1))):(i=!0,t._set(n,r._value(a)))}})),ne(this._animatingPrivateSettings,(function(n,r){if(r._stopped)t._stopAnimationPrivate(n);else if(r._playing){r._run(e);var a=r.percentage;a>=1?r._checkEnded()?t.setPrivate(n,r._value(1)):(i=!0,r._reset(e),t._setPrivate(n,r._value(1))):(i=!0,t._setPrivate(n,r._value(a)))}})),i}},{key:"_markDirtyKey",value:function(e){this.markDirty()}},{key:"_markDirtyPrivateKey",value:function(e){this.markDirty()}},{key:"on",value:function(e,t){var i=this,n=this._settingEvents[e];return void 0===n&&(n=this._settingEvents[e]=[]),n.push(t),new H((function(){O(n,t),0===n.length&&delete i._settingEvents[e]}))}},{key:"onPrivate",value:function(e,t){var i=this,n=this._privateSettingEvents[e];return void 0===n&&(n=this._privateSettingEvents[e]=[]),n.push(t),new H((function(){O(n,t),0===n.length&&delete i._privateSettingEvents[e]}))}},{key:"getRaw",value:function(e,t){var i=this._settings[e];return void 0!==i?i:t}},{key:"get",value:function(e,t){return this.getRaw(e,t)}},{key:"_sendKeyEvent",value:function(e,t){var i=this,n=this._settingEvents[e];void 0!==n&&Z(n,(function(n){n(t,i,e)}))}},{key:"_sendPrivateKeyEvent",value:function(e,t){var i=this,n=this._privateSettingEvents[e];void 0!==n&&Z(n,(function(n){n(t,i,e)}))}},{key:"_setRaw",value:function(e,t,i){this._prevSettings[e]=t,this._sendKeyEvent(e,i)}},{key:"setRaw",value:function(e,t){var i=this._settings[e];this._settings[e]=t,i!==t&&this._setRaw(e,i,t)}},{key:"_set",value:function(e,t){var i=this._settings[e];this._settings[e]=t,i!==t&&(this._setRaw(e,i,t),this._markDirtyKey(e))}},{key:"_stopAnimation",value:function(e){var t=this._animatingSettings[e];t&&(delete this._animatingSettings[e],t.stop())}},{key:"set",value:function(e,t){return this._set(e,t),this._stopAnimation(e),t}},{key:"remove",value:function(e){e in this._settings&&(this._prevSettings[e]=this._settings[e],delete this._settings[e],this._sendKeyEvent(e,void 0),this._markDirtyKey(e)),this._stopAnimation(e)}},{key:"removeAll",value:function(){var e=this;Z(te(this._settings),(function(t){e.remove(t)}))}},{key:"getPrivate",value:function(e,t){var i=this._privateSettings[e];return void 0!==i?i:t}},{key:"_setPrivateRaw",value:function(e,t,i){this._prevPrivateSettings[e]=t,this._sendPrivateKeyEvent(e,i)}},{key:"setPrivateRaw",value:function(e,t){var i=this._privateSettings[e];this._privateSettings[e]=t,i!==t&&this._setPrivateRaw(e,i,t)}},{key:"_setPrivate",value:function(e,t){var i=this._privateSettings[e];this._privateSettings[e]=t,i!==t&&(this._setPrivateRaw(e,i,t),this._markDirtyPrivateKey(e))}},{key:"_stopAnimationPrivate",value:function(e){var t=this._animatingPrivateSettings[e];t&&(t.stop(),delete this._animatingPrivateSettings[e])}},{key:"setPrivate",value:function(e,t){return this._setPrivate(e,t),this._stopAnimationPrivate(e),t}},{key:"removePrivate",value:function(e){e in this._privateSettings&&(this._prevPrivateSettings[e]=this._privateSettings[e],delete this._privateSettings[e],this._markDirtyPrivateKey(e)),this._stopAnimationPrivate(e)}},{key:"setAll",value:function(e){var t=this;ne(e,(function(e,i){t.set(e,i)}))}},{key:"animate",value:function(e){var t=e.key,i=e.to,n=e.duration||0,r=e.loops||1,a=void 0===e.from?this.get(t):e.from,o=void 0===e.easing?ut:e.easing;if(0===n)this.set(t,i);else{if(void 0!==a&&a!==i){this.set(t,a);var s=this._animatingSettings[t]=new _t(this,a,i,n,o,r,this._animationTime());return this._startAnimation(),s}this.set(t,i)}var l=new _t(this,a,i,n,o,r,null);return l.stop(),l}},{key:"animatePrivate",value:function(e){var t=e.key,i=e.to,n=e.duration||0,r=e.loops||1,a=void 0===e.from?this.getPrivate(t):e.from,o=void 0===e.easing?ut:e.easing;if(0===n)this.setPrivate(t,i);else{if(void 0!==a&&a!==i){this.setPrivate(t,a);var s=this._animatingPrivateSettings[t]=new _t(this,a,i,n,o,r,this._animationTime());return this._startAnimation(),s}this.setPrivate(t,i)}var l=new _t(this,a,i,n,o,r,null);return l.stop(),l}},{key:"_dispose",value:function(){}},{key:"isDisposed",value:function(){return this._disposed}},{key:"dispose",value:function(){this._disposed||(this._disposed=!0,this._dispose())}}]),e}(),xt=function(e){(0,u.Z)(i,e);var t=(0,c.Z)(i);function i(e,r,a){var o,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];if((0,d.Z)(this,i),o=t.call(this,r),Object.defineProperty((0,l.Z)(o),"_root",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,l.Z)(o),"_user_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,l.Z)(o),"states",{enumerable:!0,configurable:!0,writable:!0,value:new ft((0,l.Z)(o))}),Object.defineProperty((0,l.Z)(o),"adapters",{enumerable:!0,configurable:!0,writable:!0,value:new bt((0,l.Z)(o))}),Object.defineProperty((0,l.Z)(o),"events",{enumerable:!0,configurable:!0,writable:!0,value:o._createEvents()}),Object.defineProperty((0,l.Z)(o),"_userPrivateProperties",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty((0,l.Z)(o),"_dirty",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty((0,l.Z)(o),"_dirtyPrivate",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty((0,l.Z)(o),"_template",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,l.Z)(o),"_templates",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty((0,l.Z)(o),"_internalTemplates",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,l.Z)(o),"_defaultThemes",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty((0,l.Z)(o),"_templateDisposers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty((0,l.Z)(o),"_disposers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty((0,l.Z)(o),"_runSetup",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty((0,l.Z)(o),"_disposerProperties",{enumerable:!0,configurable:!0,writable:!0,value:{}}),!a)throw new Error("You cannot use `new Class()`, instead use `Class.new()`");return o._root=e,o._internalTemplates=s,r.id&&o._registerId(r.id),(0,n.Z)(o)}return(0,h.Z)(i,[{key:"_afterNew",value:function(){var e=this;this._checkDirty();var t=!1,i=this._template;i&&(t=!0,i._setObjectTemplate(this)),Z(this._internalTemplates,(function(i){t=!0,i._setObjectTemplate(e)})),t&&this._applyTemplates(!1),this.states.create("default",{}),this._setDefaults()}},{key:"_afterNewApplyThemes",value:function(){var e=this;this._checkDirty();var t=this._template;t&&t._setObjectTemplate(this),Z(this._internalTemplates,(function(t){t._setObjectTemplate(e)})),this.states.create("default",{}),this._setDefaults(),this._applyThemes()}},{key:"_createEvents",value:function(){return new Y}},{key:"classNames",get:function(){return this.constructor.classNames}},{key:"className",get:function(){return this.constructor.className}},{key:"_setDefaults",value:function(){}},{key:"_setDefault",value:function(e,t){e in this._settings||(0,a.Z)((0,o.Z)(i.prototype),"set",this).call(this,e,t)}},{key:"_setRawDefault",value:function(e,t){e in this._settings||(0,a.Z)((0,o.Z)(i.prototype),"setRaw",this).call(this,e,t)}},{key:"_clearDirty",value:function(){var e=this;te(this._dirty).forEach((function(t){e._dirty[t]=!1})),te(this._dirtyPrivate).forEach((function(t){e._dirtyPrivate[t]=!1}))}},{key:"isDirty",value:function(e){return!!this._dirty[e]}},{key:"isPrivateDirty",value:function(e){return!!this._dirtyPrivate[e]}},{key:"_markDirtyKey",value:function(e){this._dirty[e]=!0,(0,a.Z)((0,o.Z)(i.prototype),"_markDirtyKey",this).call(this,e)}},{key:"_markDirtyPrivateKey",value:function(e){this._dirtyPrivate[e]=!0,(0,a.Z)((0,o.Z)(i.prototype),"_markDirtyKey",this).call(this,e)}},{key:"isType",value:function(e){return-1!==this.classNames.indexOf(e)}},{key:"_pushPropertyDisposer",value:function(e,t){var i=this._disposerProperties[e];return void 0===i&&(i=this._disposerProperties[e]=[]),i.push(t),t}},{key:"_disposeProperty",value:function(e){var t=this._disposerProperties[e];void 0!==t&&(Z(t,(function(e){e.dispose()})),delete this._disposerProperties[e])}},{key:"template",get:function(){return this._template},set:function(e){var t=this._template;t!==e&&(this._template=e,t&&t._removeObjectTemplate(this),e&&e._setObjectTemplate(this),this._applyTemplates())}},{key:"markDirty",value:function(){this._root._addDirtyEntity(this)}},{key:"_startAnimation",value:function(){this._root._addAnimation(this)}},{key:"_animationTime",value:function(){return this._root.animationTime}},{key:"_applyState",value:function(e){}},{key:"_applyStateAnimated",value:function(e,t){}},{key:"get",value:function(e,t){var i=this.adapters.fold(e,this._settings[e]);return void 0!==i?i:t}},{key:"isUserSetting",value:function(e){return this._userProperties[e]||!1}},{key:"set",value:function(e,t){return this._userProperties[e]=!0,(0,a.Z)((0,o.Z)(i.prototype),"set",this).call(this,e,t)}},{key:"setRaw",value:function(e,t){this._userProperties[e]=!0,(0,a.Z)((0,o.Z)(i.prototype),"setRaw",this).call(this,e,t)}},{key:"_setSoft",value:function(e,t){return this._userProperties[e]?t:(0,a.Z)((0,o.Z)(i.prototype),"set",this).call(this,e,t)}},{key:"remove",value:function(e){delete this._userProperties[e],this._removeTemplateProperty(e)}},{key:"setPrivate",value:function(e,t){return this._userPrivateProperties[e]=!0,(0,a.Z)((0,o.Z)(i.prototype),"setPrivate",this).call(this,e,t)}},{key:"setPrivateRaw",value:function(e,t){this._userPrivateProperties[e]=!0,(0,a.Z)((0,o.Z)(i.prototype),"setPrivateRaw",this).call(this,e,t)}},{key:"removePrivate",value:function(e){delete this._userPrivateProperties[e],this._removeTemplatePrivateProperty(e)}},{key:"_setTemplateProperty",value:function(e,t,n){this._userProperties[t]||e===this._findTemplateByKey(t)&&(0,a.Z)((0,o.Z)(i.prototype),"set",this).call(this,t,n)}},{key:"_setTemplatePrivateProperty",value:function(e,t,n){this._userPrivateProperties[t]||e===this._findTemplateByPrivateKey(t)&&(0,a.Z)((0,o.Z)(i.prototype),"setPrivate",this).call(this,t,n)}},{key:"_removeTemplateProperty",value:function(e){if(!this._userProperties[e]){var t=this._findTemplateByKey(e);t?(0,a.Z)((0,o.Z)(i.prototype),"set",this).call(this,e,t._settings[e]):(0,a.Z)((0,o.Z)(i.prototype),"remove",this).call(this,e)}}},{key:"_removeTemplatePrivateProperty",value:function(e){if(!this._userPrivateProperties[e]){var t=this._findTemplateByPrivateKey(e);t?(0,a.Z)((0,o.Z)(i.prototype),"setPrivate",this).call(this,e,t._privateSettings[e]):(0,a.Z)((0,o.Z)(i.prototype),"removePrivate",this).call(this,e)}}},{key:"_walkParents",value:function(e){e(this._root._rootContainer),e(this)}},{key:"_applyStateByKey",value:function(e){var t=this.states.create(e,{}),i={};this._eachTemplate((function(n){var r=n.states.lookup(e);r&&r._apply(t,i)})),ne(t._settings,(function(e){i[e]||t._userSettings[e]||t.remove(e)}))}},{key:"_applyTemplate",value:function(e,t){var n=this;this._templateDisposers.push(e._apply(this,t)),ne(e._settings,(function(e,r){t.settings[e]||n._userProperties[e]||(t.settings[e]=!0,(0,a.Z)((0,o.Z)(i.prototype),"set",n).call(n,e,r))})),ne(e._privateSettings,(function(e,r){t.privateSettings[e]||n._userPrivateProperties[e]||(t.privateSettings[e]=!0,(0,a.Z)((0,o.Z)(i.prototype),"setPrivate",n).call(n,e,r))})),this._runSetup&&e.setup&&(this._runSetup=!1,e.setup(this))}},{key:"_findStaticTemplate",value:function(e){if(this._template&&e(this._template))return this._template}},{key:"_eachTemplate",value:function(e){this._findStaticTemplate((function(t){return e(t),!1})),A(this._internalTemplates,e),Z(this._templates,e)}},{key:"_applyTemplates",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];t&&this._disposeTemplates();var n={settings:{},privateSettings:{},states:{}};this._eachTemplate((function(t){e._applyTemplate(t,n)})),t&&(ne(this._settings,(function(t){e._userProperties[t]||n.settings[t]||(0,a.Z)((0,o.Z)(i.prototype),"remove",e).call(e,t)})),ne(this._privateSettings,(function(t){e._userPrivateProperties[t]||n.privateSettings[t]||(0,a.Z)((0,o.Z)(i.prototype),"removePrivate",e).call(e,t)})))}},{key:"_findTemplate",value:function(e){var t=this._findStaticTemplate(e);if(void 0===t){var i=function(e,t){var i=function(e,t){for(var i=e.length;i>0;)if(t(e[--i],i))return i;return-1}(e,t);if(-1!==i)return e[i]}(this._internalTemplates,e);return void 0===i?L(this._templates,e):i}return t}},{key:"_findTemplateByKey",value:function(e){return this._findTemplate((function(t){return e in t._settings}))}},{key:"_findTemplateByPrivateKey",value:function(e){return this._findTemplate((function(t){return e in t._privateSettings}))}},{key:"_disposeTemplates",value:function(){Z(this._templateDisposers,(function(e){e.dispose()})),this._templateDisposers.length=0}},{key:"_removeTemplates",value:function(){var e=this;Z(this._templates,(function(t){t._removeObjectTemplate(e)})),this._templates.length=0}},{key:"_applyThemes",value:function(){var e=this,t=!1,i=[],n=[],r=new Set,a=this.get("themeTagsSelf");return a&&Z(a,(function(e){r.add(e)})),this._walkParents((function(a){a===e._root._rootContainer&&(t=!0),a._defaultThemes.length>0&&i.push(a._defaultThemes);var o=a.get("themes");o&&n.push(o);var s=a.get("themeTags");s&&Z(s,(function(e){r.add(e)}))})),n=i.concat(n),this._removeTemplates(),t&&A(this.classNames,(function(t){var i=[];Z(n,(function(e){Z(e,(function(e){var n=e._lookupRules(t);n&&A(n,(function(e){if(e.tags.every((function(e){return r.has(e)}))){var t=function(e,t){for(var i=0,n=e.length,r=!1;i<n;){var a=i+n>>1,o=t(e[a]);o<0?i=a+1:0===o?(r=!0,n=a):n=a}return{found:r,index:i}}(i,(function(t){var i=gt(e.tags.length,t.tags.length);return 0===i?yt(e.tags,t.tags,gt):i}));i.splice(t.index,0,e)}}))}))})),Z(i,(function(t){e._templates.push(t.template),t.template._setObjectTemplate(e)}))})),this._applyTemplates(),t&&(this._runSetup=!1),t}},{key:"_changed",value:function(){}},{key:"_beforeChanged",value:function(){if(this.isDirty("id")){var e=this.get("id");e&&this._registerId(e);var t=this._prevSettings.id;t&&delete vt.entitiesById[t]}}},{key:"_registerId",value:function(e){if(vt.entitiesById[e]&&vt.entitiesById[e]!==this)throw new Error('An entity with id "'+e+'" already exists.');vt.entitiesById[e]=this}},{key:"_afterChanged",value:function(){}},{key:"addDisposer",value:function(e){return this._disposers.push(e),e}},{key:"_dispose",value:function(){var e=this;(0,a.Z)((0,o.Z)(i.prototype),"_dispose",this).call(this);var t=this._template;t&&t._removeObjectTemplate(this),Z(this._internalTemplates,(function(t){t._removeObjectTemplate(e)})),this._removeTemplates(),this._disposeTemplates(),this.events.dispose(),this._disposers.forEach((function(e){e.dispose()})),ne(this._disposerProperties,(function(e,t){Z(t,(function(e){e.dispose()}))}));var n=this.get("id");n&&delete vt.entitiesById[n]}},{key:"setTimeout",value:function(e){function t(t,i){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){var i=this,n=setTimeout((function(){i.removeDispose(r),e()}),t),r=new H((function(){clearTimeout(n)}));return this._disposers.push(r),r}))},{key:"removeDispose",value:function(e){if(!this.isDisposed()){var t=M(this._disposers,e);t>-1&&this._disposers.splice(t,1)}e.dispose()}},{key:"hasTag",value:function(e){return-1!==M(this.get("themeTags",[]),e)}},{key:"addTag",value:function(e){if(!this.hasTag(e)){var t=this.get("themeTags",[]);t.push(e),this.set("themeTags",t)}}},{key:"removeTag",value:function(e){if(this.hasTag(e)){var t=this.get("themeTags",[]);I(t,e),this.set("themeTags",t)}}},{key:"_t",value:function(e,t){for(var i,n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];return(i=this._root.language).translate.apply(i,[e,t].concat(r))}},{key:"root",get:function(){return this._root}}],[{key:"new",value:function(e,t,i){var n=new this(e,t,!0);return n._template=i,n._afterNew(),n}},{key:"_new",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=new this(e,t,!0,i);return n._afterNew(),n}}]),i}(kt);Object.defineProperty(xt,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Entity"}),Object.defineProperty(xt,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:["Entity"]});var Ct=function(){function e(t,i,n){(0,d.Z)(this,e),Object.defineProperty(this,"_settings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_template",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._name=t,this._template=i,this._settings=n}return(0,h.Z)(e,[{key:"get",value:function(e,t){var i=this._settings[e];return void 0!==i?i:t}},{key:"set",value:function(e,t){this._settings[e]=t,this._template._stateChanged(this._name)}},{key:"remove",value:function(e){delete this._settings[e],this._template._stateChanged(this._name)}},{key:"setAll",value:function(e){var t=this;te(e).forEach((function(i){t._settings[i]=e[i]})),this._template._stateChanged(this._name)}},{key:"_apply",value:function(e,t){ne(this._settings,(function(i,n){t[i]||e._userSettings[i]||(t[i]=!0,e.setRaw(i,n))}))}}]),e}(),Mt=function(){function e(t){(0,d.Z)(this,e),Object.defineProperty(this,"_template",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_states",{enumerable:!0,configurable:!0,writable:!0,value:{}}),this._template=t}return(0,h.Z)(e,[{key:"lookup",value:function(e){return this._states[e]}},{key:"create",value:function(e,t){var i=this._states[e];if(i)return i.setAll(t),i;var n=new Ct(e,this._template,t);return this._states[e]=n,this._template._stateChanged(e),n}},{key:"remove",value:function(e){delete this._states[e],this._template._stateChanged(e)}},{key:"_apply",value:function(e,t){ne(this._states,(function(i,n){var r=t.states[i];null==r&&(r=t.states[i]={});var a=e.states.create(i,{});n._apply(a,r)}))}}]),e}(),Pt=function(){function e(){(0,d.Z)(this,e),Object.defineProperty(this,"_callbacks",{enumerable:!0,configurable:!0,writable:!0,value:{}})}return(0,h.Z)(e,[{key:"add",value:function(e,t){var i=this,n=this._callbacks[e];return void 0===n&&(n=this._callbacks[e]=[]),n.push(t),new H((function(){O(n,t),0===n.length&&delete i._callbacks[e]}))}},{key:"remove",value:function(e){void 0!==this._callbacks[e]&&delete this._callbacks[e]}},{key:"_apply",value:function(e){var t=[];return ne(this._callbacks,(function(i,n){Z(n,(function(n){t.push(e.adapters.add(i,n))}))})),new V(t)}}]),e}(),Zt=function(){function e(t,i){if((0,d.Z)(this,e),Object.defineProperty(this,"_settings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_privateSettings",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_settingEvents",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_privateSettingEvents",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_entities",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"states",{enumerable:!0,configurable:!0,writable:!0,value:new Mt(this)}),Object.defineProperty(this,"adapters",{enumerable:!0,configurable:!0,writable:!0,value:new Pt}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:new Y}),Object.defineProperty(this,"setup",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),!i)throw new Error("You cannot use `new Class()`, instead use `Class.new()`");this._settings=t}return(0,h.Z)(e,[{key:"entities",get:function(){return this._entities}},{key:"get",value:function(e,t){var i=this._settings[e];return void 0!==i?i:t}},{key:"setRaw",value:function(e,t){this._settings[e]=t}},{key:"set",value:function(e,t){var i=this;this._settings[e]!==t&&(this.setRaw(e,t),this._entities.forEach((function(n){n._setTemplateProperty(i,e,t)})))}},{key:"remove",value:function(e){e in this._settings&&(delete this._settings[e],this._entities.forEach((function(t){t._removeTemplateProperty(e)})))}},{key:"removeAll",value:function(){var e=this;ne(this._settings,(function(t,i){e.remove(t)}))}},{key:"getPrivate",value:function(e,t){var i=this._privateSettings[e];return void 0!==i?i:t}},{key:"setPrivateRaw",value:function(e,t){return this._privateSettings[e]=t,t}},{key:"setPrivate",value:function(e,t){var i=this;return this._privateSettings[e]!==t&&(this.setPrivateRaw(e,t),this._entities.forEach((function(n){n._setTemplatePrivateProperty(i,e,t)}))),t}},{key:"removePrivate",value:function(e){e in this._privateSettings&&(delete this._privateSettings[e],this._entities.forEach((function(t){t._removeTemplatePrivateProperty(e)})))}},{key:"setAll",value:function(e){var t=this;ne(e,(function(e,i){t.set(e,i)}))}},{key:"on",value:function(e,t){var i=this,n=this._settingEvents[e];return void 0===n&&(n=this._settingEvents[e]=[]),n.push(t),new H((function(){O(n,t),0===n.length&&delete i._settingEvents[e]}))}},{key:"onPrivate",value:function(e,t){var i=this,n=this._privateSettingEvents[e];return void 0===n&&(n=this._privateSettingEvents[e]=[]),n.push(t),new H((function(){O(n,t),0===n.length&&delete i._privateSettingEvents[e]}))}},{key:"_apply",value:function(e,t){var i=[];return ne(this._settingEvents,(function(t,n){Z(n,(function(n){i.push(e.on(t,n))}))})),ne(this._privateSettingEvents,(function(t,n){Z(n,(function(n){i.push(e.onPrivate(t,n))}))})),this.states._apply(e,t),i.push(this.adapters._apply(e)),i.push(e.events.copyFrom(this.events)),new V(i)}},{key:"_setObjectTemplate",value:function(e){this._entities.push(e)}},{key:"_removeObjectTemplate",value:function(e){I(this._entities,e)}},{key:"_stateChanged",value:function(e){this._entities.forEach((function(t){t._applyStateByKey(e)}))}}],[{key:"new",value:function(t){return new e(t,!0)}}]),e}(),At=function(e){(0,u.Z)(i,e);var t=(0,c.Z)(i);function i(e){var n;return(0,d.Z)(this,i),n=t.call(this),Object.defineProperty((0,l.Z)(n),"_sprite",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,l.Z)(n),"_rendererDisposers",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty((0,l.Z)(n),"_dispatchParents",{enumerable:!0,configurable:!0,writable:!0,value:!0}),n._sprite=e,n}return(0,h.Z)(i,[{key:"_makePointerEvent",value:function(e,t){return{type:e,originalEvent:t.event,point:t.point,simulated:t.simulated,native:t.native,target:this._sprite}}},{key:"_onRenderer",value:function(e,t){var i=this;this._sprite.set("interactive",!0),this._sprite._display.interactive=!0;var n=this._rendererDisposers[e];if(void 0===n){var r=this._sprite._display.on(e,(function(e){t.call(i,e)}));n=this._rendererDisposers[e]=new W((function(){delete i._rendererDisposers[e],r.dispose()}))}return n.increment()}},{key:"_on",value:function(e,t,n,r,s,l){var u=(0,a.Z)((0,o.Z)(i.prototype),"_on",this).call(this,e,t,n,r,s,l),c=i.RENDERER_EVENTS[t];return void 0!==c&&(u.disposer=new V([u.disposer,this._onRenderer(t,c)])),u}},{key:"stopParentDispatch",value:function(){this._dispatchParents=!1}},{key:"dispatchParents",value:function(e,t){var i=this._dispatchParents;this._dispatchParents=!0;try{this.dispatch(e,t),this._dispatchParents&&this._sprite.parent&&this._sprite.parent.events.dispatchParents(e,t)}finally{this._dispatchParents=i}}}]),i}(Y);Object.defineProperty(At,"RENDERER_EVENTS",{enumerable:!0,configurable:!0,writable:!0,value:{click:function(e){this.isEnabled("click")&&!this._sprite.isDragging()&&this._sprite._hasDown()&&!this._sprite._hasMoved(this._makePointerEvent("click",e))&&this.dispatch("click",this._makePointerEvent("click",e))},rightclick:function(e){this.isEnabled("rightclick")&&this.dispatch("rightclick",this._makePointerEvent("rightclick",e))},middleclick:function(e){this.isEnabled("middleclick")&&this.dispatch("middleclick",this._makePointerEvent("middleclick",e))},dblclick:function(e){this.dispatchParents("dblclick",this._makePointerEvent("dblclick",e))},pointerover:function(e){this.isEnabled("pointerover")&&this.dispatch("pointerover",this._makePointerEvent("pointerover",e))},pointerout:function(e){this.isEnabled("pointerout")&&this.dispatch("pointerout",this._makePointerEvent("pointerout",e))},pointerdown:function(e){this.dispatchParents("pointerdown",this._makePointerEvent("pointerdown",e))},pointerup:function(e){this.isEnabled("pointerup")&&this.dispatch("pointerup",this._makePointerEvent("pointerup",e))},globalpointerup:function(e){this.isEnabled("globalpointerup")&&this.dispatch("globalpointerup",this._makePointerEvent("globalpointerup",e))},globalpointermove:function(e){this.isEnabled("globalpointermove")&&this.dispatch("globalpointermove",this._makePointerEvent("globalpointermove",e))},wheel:function(e){this.dispatchParents("wheel",{type:"wheel",target:this._sprite,originalEvent:e.event,point:e.point})}}});var Tt=function(e){(0,u.Z)(i,e);var t=(0,c.Z)(i);function i(){var e;return(0,d.Z)(this,i),e=t.apply(this,arguments),Object.defineProperty((0,l.Z)(e),"_adjustedLocalBounds",{enumerable:!0,configurable:!0,writable:!0,value:{left:0,right:0,top:0,bottom:0}}),Object.defineProperty((0,l.Z)(e),"_localBounds",{enumerable:!0,configurable:!0,writable:!0,value:{left:0,right:0,top:0,bottom:0}}),Object.defineProperty((0,l.Z)(e),"_parent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,l.Z)(e),"_dataItem",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,l.Z)(e),"_templateField",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,l.Z)(e),"_sizeDirty",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty((0,l.Z)(e),"_isDragging",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty((0,l.Z)(e),"_dragEvent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,l.Z)(e),"_dragPoint",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,l.Z)(e),"_isHidden",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty((0,l.Z)(e),"_isShowing",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty((0,l.Z)(e),"_isHiding",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty((0,l.Z)(e),"_isDown",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty((0,l.Z)(e),"_downPoint",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,l.Z)(e),"_downPoints",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty((0,l.Z)(e),"_toggleDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,l.Z)(e),"_dragDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,l.Z)(e),"_tooltipDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,l.Z)(e),"_hoverDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,l.Z)(e),"_focusDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,l.Z)(e),"_tooltipMoveDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,l.Z)(e),"_tooltipPointerDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,l.Z)(e),"_statesHandled",{enumerable:!0,configurable:!0,writable:!0,value:!1}),e}return(0,h.Z)(i,[{key:"_afterNew",value:function(){this.setPrivateRaw("visible",!0),(0,a.Z)((0,o.Z)(i.prototype),"_afterNew",this).call(this)}},{key:"_markDirtyKey",value:function(e){(0,a.Z)((0,o.Z)(i.prototype),"_markDirtyKey",this).call(this,e),"x"!=e&&"y"!=e&&"dx"!=e&&"dy"!=e||(this.markDirtyBounds(),this._addPercentagePositionChildren(),this.markDirtyPosition())}},{key:"_markDirtyPrivateKey",value:function(e){(0,a.Z)((0,o.Z)(i.prototype),"_markDirtyPrivateKey",this).call(this,e),"x"!=e&&"y"!=e||this.markDirtyPosition()}},{key:"_removeTemplateField",value:function(){this._templateField&&this._templateField._removeObjectTemplate(this)}},{key:"_createEvents",value:function(){return new At(this)}},{key:"_processTemplateField",value:function(){var e,t=this.get("templateField");if(t){var i=this.dataItem;if(i){var n=i.dataContext;n&&((e=n[t])instanceof Zt||!e||(e=Zt.new(e)))}}this._templateField!==e&&(this._removeTemplateField(),this._templateField=e,e&&e._setObjectTemplate(this),this._applyTemplates())}},{key:"_setDataItem",value:function(e){var t=this._dataItem;this._dataItem=e,this._processTemplateField();var i="dataitemchanged";e!=t&&this.events.isEnabled(i)&&this.events.dispatch(i,{type:i,target:this,oldDataItem:t,newDataItem:e})}},{key:"dataItem",get:function(){if(this._dataItem)return this._dataItem;for(var e=this._parent;e;){if(e._dataItem)return e._dataItem;e=e._parent}},set:function(e){this._setDataItem(e)}},{key:"_addPercentageSizeChildren",value:function(){var e=this.parent;e&&(this.get("width")instanceof $||this.get("height")instanceof $?D(e._percentageSizeChildren,this):O(e._percentageSizeChildren,this))}},{key:"_addPercentagePositionChildren",value:function(){var e=this.parent;e&&(this.get("x")instanceof $||this.get("y")instanceof $?D(e._percentagePositionChildren,this):O(e._percentagePositionChildren,this))}},{key:"markDirtyPosition",value:function(){this._root._addDirtyPosition(this)}},{key:"updatePivotPoint",value:function(){var e=this._localBounds;if(e){var t=this.get("centerX");null!=t&&(this._display.pivot.x=e.left+we(t,e.right-e.left));var i=this.get("centerY");null!=i&&(this._display.pivot.y=e.top+we(i,e.bottom-e.top))}}},{key:"_beforeChanged",value:function(){var e=this;if((0,a.Z)((0,o.Z)(i.prototype),"_beforeChanged",this).call(this),this._handleStates(),this.isDirty("tooltip")){var t=this._prevSettings.tooltip;t&&t.dispose()}if((this.isDirty("layer")||this.isDirty("layerMargin"))&&(this._display.setLayer(this.get("layer"),this.get("layerMargin")),this.markDirtyLayer()),this.isDirty("tooltipPosition")){var n=this._tooltipMoveDp;n&&(n.dispose(),this._tooltipMoveDp=void 0);var r=this._tooltipPointerDp;r&&(r.dispose(),this._tooltipPointerDp=void 0),"pointer"==this.get("tooltipPosition")&&(this._tooltipPointerDp=new V([this.events.on("pointerover",(function(){e._tooltipMoveDp=e.events.on("globalpointermove",(function(t){e.showTooltip(t.point)}))})),this.events.on("pointerout",(function(){var t=e._tooltipMoveDp;t&&(t.dispose(),e._tooltipMoveDp=void 0)}))]))}}},{key:"_handleStates",value:function(){this._statesHandled||(this.isDirty("active")&&(this.get("active")?(this.states.applyAnimate("active"),this.set("ariaChecked",!0)):(this.isHidden()||this.states.applyAnimate("default"),this.set("ariaChecked",!1)),this.markDirtyAccessibility()),this.isDirty("disabled")&&(this.get("disabled")?(this.states.applyAnimate("disabled"),this.set("ariaChecked",!1)):(this.isHidden()||this.states.applyAnimate("default"),this.set("ariaChecked",!0)),this.markDirtyAccessibility()),this._statesHandled=!0)}},{key:"_changed",value:function(){var e=this;(0,a.Z)((0,o.Z)(i.prototype),"_changed",this).call(this);var t=this._display,n=this.events;if(this.isDirty("draggable")){var r=this.get("draggable");r?(this.set("interactive",!0),this._dragDp=new V([n.on("pointerdown",(function(t){e.dragStart(t)})),n.on("globalpointermove",(function(t){e.dragMove(t)})),n.on("globalpointerup",(function(t){e.dragStop(t)}))])):this._dragDp&&(this._dragDp.dispose(),this._dragDp=void 0),t.cancelTouch=!!r}if(this.isDirty("tooltipText")||this.isDirty("tooltipHTML")||this.isDirty("showTooltipOn")){var s=this.get("tooltipText"),l=this.get("tooltipHTML"),u=this.get("showTooltipOn","hover");this._tooltipDp&&(this._tooltipDp.dispose(),this._tooltipDp=void 0),(s||l)&&("click"==u?this._tooltipDp=new V([n.on("click",(function(){e.setTimeout((function(){return e.showTooltip()}),10)})),se(document,"click",(function(t){e.hideTooltip()}))]):"always"==u||(this._tooltipDp=new V([n.on("pointerover",(function(){e.showTooltip()})),n.on("pointerout",(function(){e.hideTooltip()}))])))}if(this.isDirty("toggleKey")){var c=this.get("toggleKey");c&&"none"!=c?this._toggleDp=n.on("click",(function(){e._isDragging||e.set(c,!e.get(c))})):this._toggleDp&&(this._toggleDp.dispose(),this._toggleDp=void 0)}if(this.isDirty("opacity")&&(t.alpha=Math.max(0,this.get("opacity",1))),this.isDirty("rotation")&&(this.markDirtyBounds(),t.angle=this.get("rotation",0)),this.isDirty("scale")&&(this.markDirtyBounds(),t.scale=this.get("scale",0)),(this.isDirty("centerX")||this.isDirty("centerY"))&&(this.markDirtyBounds(),this.updatePivotPoint()),(this.isDirty("visible")||this.isPrivateDirty("visible")||this.isDirty("forceHidden"))&&(this.get("visible")&&this.getPrivate("visible")&&!this.get("forceHidden")?t.visible=!0:(t.visible=!1,this.hideTooltip()),this.markDirtyBounds(),this.get("focusable")&&this.markDirtyAccessibility()),this.isDirty("width")||this.isDirty("height")){this.markDirtyBounds(),this._addPercentageSizeChildren();var d=this.parent;d&&(this.isDirty("width")&&this.get("width")instanceof $||this.isDirty("height")&&this.get("height")instanceof $)&&(d.markDirty(),d._prevWidth=0),this._sizeDirty=!0}if((this.isDirty("maxWidth")||this.isDirty("maxHeight")||this.isPrivateDirty("width")||this.isPrivateDirty("height")||this.isDirty("minWidth")||this.isDirty("minHeight")||this.isPrivateDirty("maxWidth")||this.isPrivateDirty("maxHeight")||this.isPrivateDirty("minWidth")||this.isPrivateDirty("minHeight"))&&(this.markDirtyBounds(),this._sizeDirty=!0),this._sizeDirty&&this._updateSize(),this.isDirty("wheelable")){var h=this.get("wheelable");h&&this.set("interactive",!0),t.wheelable=!!h}if((this.isDirty("tabindexOrder")||this.isDirty("focusableGroup"))&&(this.get("focusable")?this._root._registerTabindexOrder(this):this._root._unregisterTabindexOrder(this)),this.isDirty("filter")&&(t.filter=this.get("filter")),this.isDirty("cursorOverStyle")&&(t.cursorOverStyle=this.get("cursorOverStyle")),this.isDirty("hoverOnFocus")&&(this.get("hoverOnFocus")?this._focusDp=new V([n.on("focus",(function(){e.showTooltip()})),n.on("blur",(function(){e.hideTooltip()}))]):this._focusDp&&(this._focusDp.dispose(),this._focusDp=void 0)),this.isDirty("focusable")&&(this.get("focusable")?this._root._registerTabindexOrder(this):this._root._unregisterTabindexOrder(this),this.markDirtyAccessibility()),(this.isDirty("role")||this.isDirty("ariaLive")||this.isDirty("ariaChecked")||this.isDirty("ariaHidden")||this.isDirty("ariaOrientation")||this.isDirty("ariaValueNow")||this.isDirty("ariaValueMin")||this.isDirty("ariaValueMax")||this.isDirty("ariaValueText")||this.isDirty("ariaLabel")||this.isDirty("ariaControls"))&&this.markDirtyAccessibility(),this.isDirty("exportable")&&(t.exportable=this.get("exportable")),this.isDirty("interactive")){var f=this.events;this.get("interactive")?this._hoverDp=new V([f.on("click",(function(t){ve(t.originalEvent)&&(e.getPrivate("touchHovering")||e.setTimeout((function(){e._handleOver(),(e.get("tooltipText")||e.get("tooltipHTML"))&&e.showTooltip(),e.setPrivateRaw("touchHovering",!0),e.events.dispatch("pointerover",{type:"pointerover",target:t.target,originalEvent:t.originalEvent,point:t.point,simulated:t.simulated})}),10))})),f.on("globalpointerup",(function(t){ve(t.originalEvent)&&e.getPrivate("touchHovering")&&(e._handleOut(),(e.get("tooltipText")||e.get("tooltipHTML"))&&e.hideTooltip(),e.setPrivateRaw("touchHovering",!1),e.events.dispatch("pointerout",{type:"pointerout",target:t.target,originalEvent:t.originalEvent,point:t.point,simulated:t.simulated})),e._isDown&&e._handleUp(t)})),f.on("pointerover",(function(){e._handleOver()})),f.on("pointerout",(function(){e._handleOut()})),f.on("pointerdown",(function(t){e._handleDown(t)}))]):(this._display.interactive=!1,this._hoverDp&&(this._hoverDp.dispose(),this._hoverDp=void 0))}this.isDirty("forceInactive")&&(this._display.inactive=this.get("forceInactive",!1)),"always"==this.get("showTooltipOn")&&this._display.visible&&this.showTooltip()}},{key:"dragStart",value:function(e){this._dragEvent=e,this.events.stopParentDispatch()}},{key:"dragStop",value:function(e){if(this._dragEvent=void 0,this._dragPoint=void 0,this.events.stopParentDispatch(),this._isDragging){this._isDragging=!1;var t="dragstop";this.events.isEnabled(t)&&this.events.dispatch(t,{type:t,target:this,originalEvent:e.originalEvent,point:e.point,simulated:e.simulated})}}},{key:"_handleOver",value:function(){this.isHidden()||(this.get("active")&&this.states.lookup("hoverActive")?this.states.applyAnimate("hoverActive"):this.get("disabled")&&this.states.lookup("hoverDisabled")?this.states.applyAnimate("hoverDisabled"):this.states.applyAnimate("hover"),this.get("draggable")&&this._isDown&&this.states.lookup("down")&&this.states.applyAnimate("down"))}},{key:"_handleOut",value:function(){this.isHidden()||(this.get("active")&&this.states.lookup("active")?this.states.applyAnimate("active"):this.get("disabled")&&this.states.lookup("disabled")?this.states.applyAnimate("disabled"):(this.states.lookup("hover")||this.states.lookup("hoverActive"))&&this.states.applyAnimate("default"),this.get("draggable")&&this._isDown&&this.states.lookup("down")&&this.states.applyAnimate("down"))}},{key:"_handleUp",value:function(e){if(!this.isHidden()){this.get("active")&&this.states.lookup("active")?this.states.applyAnimate("active"):this.get("disabled")&&this.states.lookup("disabled")?this.states.applyAnimate("disabled"):this.states.lookup("down")&&(this.isHover()?this.states.applyAnimate("hover"):this.states.applyAnimate("default")),this._downPoint=void 0;var t=ce(e.originalEvent);delete this._downPoints[t],0==te(this._downPoints).length&&(this._isDown=!1)}}},{key:"_hasMoved",value:function(e){var t=ce(e.originalEvent),i=this._downPoints[t];if(i){var n=Math.abs(i.x-e.point.x),r=Math.abs(i.y-e.point.y);return n>5||r>5}return!1}},{key:"_hasDown",value:function(){return te(this._downPoints).length>0}},{key:"_handleDown",value:function(e){var t=this.parent;if(t&&!this.get("draggable")&&t._handleDown(e),this.get("interactive")&&!this.isHidden()){this.states.lookup("down")&&this.states.applyAnimate("down"),this._downPoint={x:e.point.x,y:e.point.y},this._isDown=!0;var i=ce(e.originalEvent);this._downPoints[i]={x:e.point.x,y:e.point.y}}}},{key:"dragMove",value:function(e){var t=this._dragEvent;if(t){if(t.simulated&&!e.simulated)return!0;for(var i=0,n=this.parent;null!=n;)i+=n.get("rotation",0),n=n.parent;var r=e.point.x-t.point.x,a=e.point.y-t.point.y,o=this.events;if(t.simulated&&!this._isDragging){this._isDragging=!0,this._dragEvent=e,this._dragPoint={x:this.x(),y:this.y()};var s="dragstart";o.isEnabled(s)&&o.dispatch(s,{type:s,target:this,originalEvent:e.originalEvent,point:e.point,simulated:e.simulated})}if(this._isDragging){var l=this._dragPoint;this.set("x",l.x+r*rt(i)+a*nt(i)),this.set("y",l.y+a*rt(i)-r*nt(i));var u="dragged";o.isEnabled(u)&&o.dispatch(u,{type:u,target:this,originalEvent:e.originalEvent,point:e.point,simulated:e.simulated})}else if(Math.hypot(r,a)>5){this._isDragging=!0,this._dragEvent=e,this._dragPoint={x:this.x(),y:this.y()};var c="dragstart";o.isEnabled(c)&&o.dispatch(c,{type:c,target:this,originalEvent:e.originalEvent,point:e.point,simulated:e.simulated})}}}},{key:"_updateSize",value:function(){}},{key:"_getBounds",value:function(){this._localBounds=this._display.getLocalBounds()}},{key:"depth",value:function(){for(var e=this.parent,t=0;;){if(!e)return t;++t,e=e.parent}}},{key:"markDirtySize",value:function(){this._sizeDirty=!0,this.markDirty()}},{key:"markDirtyBounds",value:function(){if(this.get("isMeasured")){var e=this._display;this._root._addDirtyBounds(this),e.isMeasured=!0,e.invalidateBounds();var t=this.parent;t&&"absolute"!=this.get("position")&&(null==t.get("width")||null==t.get("height")||t.get("layout"))&&t.markDirtyBounds(),this.get("focusable")&&this.isFocus()&&this.markDirtyAccessibility()}}},{key:"markDirtyAccessibility",value:function(){this._root._invalidateAccessibility(this)}},{key:"markDirtyLayer",value:function(){this._display.markDirtyLayer(!0)}},{key:"markDirty",value:function(){(0,a.Z)((0,o.Z)(i.prototype),"markDirty",this).call(this),this.markDirtyLayer()}},{key:"_updateBounds",value:function(){var e,t=this._adjustedLocalBounds;if(this.get("visible")&&this.getPrivate("visible")&&!this.get("forceHidden")?(this._getBounds(),this._fixMinBounds(this._localBounds),this.updatePivotPoint(),this._adjustedLocalBounds=this._display.getAdjustedBounds(this._localBounds),e=this._adjustedLocalBounds):(e={left:0,right:0,top:0,bottom:0},this._localBounds=e,this._adjustedLocalBounds=e),!t||t.left!==e.left||t.top!==e.top||t.right!==e.right||t.bottom!==e.bottom){var i="boundschanged";this.events.isEnabled(i)&&this.events.dispatch(i,{type:i,target:this}),this.parent&&(this.parent.markDirty(),this.parent.markDirtyBounds())}}},{key:"_fixMinBounds",value:function(e){var t=this.get("minWidth",this.getPrivate("minWidth")),i=this.get("minHeight",this.getPrivate("minHeight"));w(t)&&e.right-e.left<t&&(e.right=e.left+t),w(i)&&e.bottom-e.top<i&&(e.bottom=e.top+i);var n=this.getPrivate("width"),r=this.getPrivate("height");w(n)&&(n>0?e.right=e.left+n:e.left=e.right+n),w(r)&&(r>0?e.bottom=e.top+r:e.top=e.bottom+r)}},{key:"_removeParent",value:function(e){e&&(e.children.removeValue(this),O(e._percentageSizeChildren,this),O(e._percentagePositionChildren,this))}},{key:"_clearDirty",value:function(){(0,a.Z)((0,o.Z)(i.prototype),"_clearDirty",this).call(this),this._sizeDirty=!1,this._statesHandled=!1}},{key:"hover",value:function(){this.showTooltip(),this._handleOver()}},{key:"unhover",value:function(){this.hideTooltip(),this._handleOut()}},{key:"showTooltip",value:function(e){var t=this.getTooltip(),i=this.get("tooltipText"),n=this.get("tooltipHTML");if((i||n)&&t){var r=this.get("tooltipPosition"),a=this.getPrivate("tooltipTarget",this);"fixed"!=r&&e||(this._display._setMatrix(),e=this.toGlobal(a._getTooltipPoint())),t.set("pointTo",e),t.set("tooltipTarget",a),t.get("x")||t.set("x",e.x),t.get("y")||t.set("y",e.y),i&&t.label.set("text",i),n&&t.label.set("html",n);var o=this.dataItem;if(o&&t.label._setDataItem(o),"always"==this.get("showTooltipOn")&&(e.x<0||e.x>this._root.width()||e.y<0||e.y>this._root.height()))return void this.hideTooltip();t.label.text.markDirtyText();var s=t.show();return this.setPrivateRaw("showingTooltip",!0),s}}},{key:"hideTooltip",value:function(){var e=this.getTooltip();if(e&&e.get("tooltipTarget")==this.getPrivate("tooltipTarget",this)){var t=e.get("keepTargetHover")&&0==e.get("stateAnimationDuration",0)?400:void 0,i=e.hide(t);return this.setPrivateRaw("showingTooltip",!1),i}}},{key:"_getTooltipPoint",value:function(){var e=this._localBounds;if(e){var t=0,i=0;return this.get("isMeasured")?(t=e.left+we(this.get("tooltipX",0),e.right-e.left),i=e.top+we(this.get("tooltipY",0),e.bottom-e.top)):(t=we(this.get("tooltipX",0),this.width()),i=we(this.get("tooltipY",0),this.height())),{x:t,y:i}}return{x:0,y:0}}},{key:"getTooltip",value:function(){var e=this.get("tooltip");if(e)return e;var t=this.parent;return t?t.getTooltip():void 0}},{key:"_updatePosition",value:function(){var e=this.parent,t=this.get("dx",0),i=this.get("dy",0),n=this.get("x"),r=this.getPrivate("x"),a=0,o=0,s=this.get("position");n instanceof $&&(n=e?e.innerWidth()*n.value+e.get("paddingLeft",0):0),w(n)?a=n+t:null!=r?a=r:e&&"relative"==s&&(a=e.get("paddingLeft",0)+t);var l=this.get("y"),u=this.getPrivate("y");l instanceof $&&(l=e?e.innerHeight()*l.value+e.get("paddingTop",0):0),w(l)?o=l+i:null!=u?o=u:e&&"relative"==s&&(o=e.get("paddingTop",0)+i);var c=this._display;if(c.x!=a||c.y!=o){c.invalidateBounds(),c.x=a,c.y=o;var d="positionchanged";this.events.isEnabled(d)&&this.events.dispatch(d,{type:d,target:this})}this.getPrivate("showingTooltip")&&this.showTooltip()}},{key:"x",value:function(){var e=this.get("x"),t=this.getPrivate("x"),i=this.parent;return i?e instanceof $?we(e,i.innerWidth())+i.get("paddingLeft",0):w(e)?e:null!=t?t:i.get("paddingLeft",this._display.x):this._display.x}},{key:"y",value:function(){var e=this.getPrivate("y");if(null!=e)return e;var t=this.get("y"),i=this.parent;return i?t instanceof $?we(t,i.innerHeight())+i.get("paddingTop",0):w(t)?t:null!=e?e:i.get("paddingTop",this._display.y):this._display.y}},{key:"_dispose",value:function(){(0,a.Z)((0,o.Z)(i.prototype),"_dispose",this).call(this),this._display.dispose(),this._removeTemplateField(),this._removeParent(this.parent),this._root._removeFocusElement(this);var e=this.get("tooltip");e&&e.dispose(),this.markDirty()}},{key:"adjustedLocalBounds",value:function(){return this._fixMinBounds(this._adjustedLocalBounds),this._adjustedLocalBounds}},{key:"localBounds",value:function(){return this._localBounds}},{key:"bounds",value:function(){var e=this._adjustedLocalBounds,t=this.x(),i=this.y();return{left:e.left+t,right:e.right+t,top:e.top+i,bottom:e.bottom+i}}},{key:"globalBounds",value:function(){var e=this.localBounds(),t=this.toGlobal({x:e.left,y:e.top}),i=this.toGlobal({x:e.right,y:e.top}),n=this.toGlobal({x:e.right,y:e.bottom}),r=this.toGlobal({x:e.left,y:e.bottom});return{left:Math.min(t.x,i.x,n.x,r.x),top:Math.min(t.y,i.y,n.y,r.y),right:Math.max(t.x,i.x,n.x,r.x),bottom:Math.max(t.y,i.y,n.y,r.y)}}},{key:"_onShow",value:function(e){}},{key:"_onHide",value:function(e){}},{key:"appear",value:function(e,t){return(0,f.a)(this,void 0,void 0,(0,s.Z)().mark((function i(){var n=this;return(0,s.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.hide(0);case 2:return i.abrupt("return",t?new Promise((function(i,r){n.setTimeout((function(){i(n.show(e))}),t)})):this.show(e));case 3:case"end":return i.stop()}}),i,this)})))}},{key:"show",value:function(e){return(0,f.a)(this,void 0,void 0,(0,s.Z)().mark((function t(){var i;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._isShowing){t.next=6;break}return this._isHidden=!1,this._isShowing=!0,this._isHiding=!1,this.states.lookup("default").get("visible")&&this.set("visible",!0),this._onShow(e),i=this.states.applyAnimate("default",e),t.next=5,Ue(i);case 5:this._isShowing=!1;case 6:case"end":return t.stop()}}),t,this)})))}},{key:"hide",value:function(e){return(0,f.a)(this,void 0,void 0,(0,s.Z)().mark((function t(){var i;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._isHiding||this._isHidden){t.next=8;break}return this._isHiding=!0,this._isShowing=!1,this.states.lookup("hidden")||this.states.create("hidden",{opacity:0,visible:!1}),this._isHidden=!0,this._onHide(e),i=this.states.applyAnimate("hidden",e),t.next=7,Ue(i);case 7:this._isHiding=!1;case 8:case"end":return t.stop()}}),t,this)})))}},{key:"isHidden",value:function(){return this._isHidden}},{key:"isShowing",value:function(){return this._isShowing}},{key:"isHiding",value:function(){return this._isHiding}},{key:"isHover",value:function(){return this._display.hovering()}},{key:"isFocus",value:function(){return this._root.focused(this)}},{key:"isDragging",value:function(){return this._isDragging}},{key:"isVisible",value:function(){return!(!this.get("visible")||!this.getPrivate("visible")||this.get("forceHidden"))}},{key:"isVisibleDeep",value:function(){return this._parent?this._parent.isVisibleDeep()&&this.isVisible():this.isVisible()}},{key:"compositeOpacity",value:function(){var e=this.get("opacity",1);return this._parent?this._parent.compositeOpacity()*e:e}},{key:"width",value:function(){var e=this.get("width"),t=this.get("maxWidth",this.getPrivate("maxWidth")),i=this.get("minWidth",this.getPrivate("minWidth")),n=this.getPrivate("width"),r=0;if(w(n))r=n;else if(null==e)this._adjustedLocalBounds&&(r=this._adjustedLocalBounds.right-this._adjustedLocalBounds.left);else if(e instanceof $){var a=this.parent;r=a?a.innerWidth()*e.value:this._root.width()*e.value}else w(e)&&(r=e);return w(i)&&(r=Math.max(i,r)),w(t)&&(r=Math.min(t,r)),r}},{key:"maxWidth",value:function(){var e=this.get("maxWidth",this.getPrivate("maxWidth"));if(w(e))return e;var t=this.get("width");if(w(t))return t;var i=this.parent;return i?i.innerWidth():this._root.width()}},{key:"maxHeight",value:function(){var e=this.get("maxHeight",this.getPrivate("maxHeight"));if(w(e))return e;var t=this.get("height");if(w(t))return t;var i=this.parent;return i?i.innerHeight():this._root.height()}},{key:"height",value:function(){var e=this.get("height"),t=this.get("maxHeight",this.getPrivate("maxHeight")),i=this.get("minHeight",this.getPrivate("minHeight")),n=this.getPrivate("height"),r=0;if(w(n))r=n;else if(null==e)this._adjustedLocalBounds&&(r=this._adjustedLocalBounds.bottom-this._adjustedLocalBounds.top);else if(e instanceof $){var a=this.parent;r=a?a.innerHeight()*e.value:this._root.height()*e.value}else w(e)&&(r=e);return w(i)&&(r=Math.max(i,r)),w(t)&&(r=Math.min(t,r)),r}},{key:"_findStaticTemplate",value:function(e){return this._templateField&&e(this._templateField)?this._templateField:(0,a.Z)((0,o.Z)(i.prototype),"_findStaticTemplate",this).call(this,e)}},{key:"_walkParents",value:function(e){this._parent&&this._walkParent(e)}},{key:"_walkParent",value:function(e){this._parent&&this._parent._walkParent(e),e(this)}},{key:"parent",get:function(){return this._parent}},{key:"_setParent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this._parent;e!==i&&(this.markDirtyBounds(),e.markDirty(),this._parent=e,t&&(this._removeParent(i),e&&(this._addPercentageSizeChildren(),this._addPercentagePositionChildren())),this.markDirtyPosition(),this._applyThemes())}},{key:"getNumberFormatter",value:function(){return this.get("numberFormatter",this._root.numberFormatter)}},{key:"getDateFormatter",value:function(){return this.get("dateFormatter",this._root.dateFormatter)}},{key:"getDurationFormatter",value:function(){return this.get("durationFormatter",this._root.durationFormatter)}},{key:"toGlobal",value:function(e){return this._display.toGlobal(e)}},{key:"toLocal",value:function(e){return this._display.toLocal(e)}},{key:"_getDownPoint",value:function(){var e=this._getDownPointId();if(e)return this._downPoints[e]}},{key:"_getDownPointId",value:function(){if(this._downPoints)return function(e,t){return te(e).sort(t)}(this._downPoints,(function(e,t){return e>t?1:e<t?-1:0}))[0]}},{key:"toFront",value:function(){var e=this.parent;e&&e.children.moveValue(this,e.children.length-1)}},{key:"toBack",value:function(){var e=this.parent;e&&e.children.moveValue(this,0)}}]),i}(xt);Object.defineProperty(Tt,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Sprite"}),Object.defineProperty(Tt,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:xt.classNames.concat([Tt.className])});var It=function(e){(0,u.Z)(i,e);var t=(0,c.Z)(i);function i(){var e;return(0,d.Z)(this,i),e=t.apply(this,arguments),Object.defineProperty((0,l.Z)(e),"_display",{enumerable:!0,configurable:!0,writable:!0,value:e._root._renderer.makeGraphics()}),Object.defineProperty((0,l.Z)(e),"_backgroundDisplay",{enumerable:!0,configurable:!0,writable:!0,value:e._root._renderer.makeGraphics()}),Object.defineProperty((0,l.Z)(e),"_clear",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty((0,l.Z)(e),"_pattern",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e}return(0,h.Z)(i,[{key:"_afterNew",value:function(){(0,a.Z)((0,o.Z)(i.prototype),"_afterNewApplyThemes",this).call(this)}},{key:"pattern",get:function(){return this._pattern}},{key:"_draw",value:function(){}},{key:"_beforeChanged",value:function(){(0,a.Z)((0,o.Z)(i.prototype),"_beforeChanged",this).call(this),(this.isDirty("repetition")||this.isDirty("width")||this.isDirty("height")||this.isDirty("rotation")||this.isDirty("color")||this.isDirty("strokeWidth")||this.isDirty("strokeDasharray")||this.isDirty("strokeDashoffset")||this.isDirty("colorOpacity")||this.isDirty("fill")||this.isDirty("fillOpacity"))&&(this._clear=!0)}},{key:"_changed",value:function(){if((0,a.Z)((0,o.Z)(i.prototype),"_changed",this).call(this),this._clear){var e=this.get("repetition",""),t=this.get("width",100),n=this.get("height",100),r=this.get("fill"),s=this.get("fillOpacity",1);this._display.clear(),this._backgroundDisplay.clear(),r&&s>0&&(this._backgroundDisplay.beginFill(r,s),this._backgroundDisplay.drawRect(0,0,t,n),this._backgroundDisplay.endFill()),this._display.angle=this.get("rotation",0),this._draw(),this._pattern=this._root._renderer.createPattern(this._display,this._backgroundDisplay,e,t,n)}}}]),i}(xt);Object.defineProperty(It,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Pattern"}),Object.defineProperty(It,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:xt.classNames.concat([It.className])});var Ot,Dt,Ft=function(e){(0,u.Z)(i,e);var t=(0,c.Z)(i);function i(){var e;return(0,d.Z)(this,i),e=t.apply(this,arguments),Object.defineProperty((0,l.Z)(e),"_image",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e}return(0,h.Z)(i,[{key:"_beforeChanged",value:function(){(0,a.Z)((0,o.Z)(i.prototype),"_beforeChanged",this).call(this),this._clear=!0,this.isDirty("src")&&this._load()}},{key:"_draw",value:function(){(0,a.Z)((0,o.Z)(i.prototype),"_draw",this).call(this);var e=this._image;if(e){var t=this.get("width",100),n=this.get("height",100),r=this.get("fit","image"),s=0,l=0;"pattern"==r?(s=t,l=n):(s=e.width,l=e.height,"image"==r&&(this.set("width",s),this.set("height",l)));var u=0,c=0;this.get("centered",!0)&&(u=t/2-s/2,c=n/2-l/2),this._display.image(e,s,l,u,c)}}},{key:"_load",value:function(){var e=this,t=this.get("src");if(t){var i=new Image;i.src=t,i.decode().then((function(){e._image=i,e._draw(),e.events.isEnabled("loaded")&&e.events.dispatch("loaded",{type:"loaded",target:e})})).catch((function(e){}))}}}]),i}(It);Object.defineProperty(Ft,"className",{enumerable:!0,configurable:!0,writable:!0,value:"PicturePattern"}),Object.defineProperty(Ft,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:It.classNames.concat([Ft.className])}),(Dt=Ot||(Ot={})).ADD="lighter",Dt.COLOR="color",Dt.COLOR_BURN="color-burn",Dt.COLOR_DODGE="color-dodge",Dt.DARKEN="darken",Dt.DIFFERENCE="difference",Dt.DST_OVER="destination-over",Dt.EXCLUSION="exclusion",Dt.HARD_LIGHT="hard-light",Dt.HUE="hue",Dt.LIGHTEN="lighten",Dt.LUMINOSITY="luminosity",Dt.MULTIPLY="multiply",Dt.NORMAL="source-over",Dt.OVERLAY="overlay",Dt.SATURATION="saturation",Dt.SCREEN="screen",Dt.SOFT_LIGHT="soft-light",Dt.SRC_ATOP="source-atop",Dt.XOR="xor";var Et=["fill","fillOpacity","stroke","strokeWidth","strokeOpacity","fillPattern","strokePattern","fillGradient","strokeGradient","strokeDasharray","strokeDashoffset"],St=function(e){(0,u.Z)(i,e);var t=(0,c.Z)(i);function i(){var e;return(0,d.Z)(this,i),e=t.apply(this,arguments),Object.defineProperty((0,l.Z)(e),"_display",{enumerable:!0,configurable:!0,writable:!0,value:e._root._renderer.makeGraphics()}),Object.defineProperty((0,l.Z)(e),"_clear",{enumerable:!0,configurable:!0,writable:!0,value:!1}),e}return(0,h.Z)(i,[{key:"_beforeChanged",value:function(){var e=this;if((0,a.Z)((0,o.Z)(i.prototype),"_beforeChanged",this).call(this),(this.isDirty("draw")||this.isDirty("svgPath"))&&this.markDirtyBounds(),(this.isDirty("fill")||this.isDirty("stroke")||this.isDirty("visible")||this.isDirty("forceHidden")||this.isDirty("scale")||this.isDirty("fillGradient")||this.isDirty("strokeGradient")||this.isDirty("fillPattern")||this.isDirty("strokePattern")||this.isDirty("fillOpacity")||this.isDirty("strokeOpacity")||this.isDirty("strokeWidth")||this.isDirty("draw")||this.isDirty("blendMode")||this.isDirty("strokeDasharray")||this.isDirty("strokeDashoffset")||this.isDirty("svgPath")||this.isDirty("lineJoin")||this.isDirty("shadowColor")||this.isDirty("shadowBlur")||this.isDirty("shadowOffsetX")||this.isDirty("shadowOffsetY"))&&(this._clear=!0),this._display.crisp=this.get("crisp",!1),this.isDirty("fillGradient")){var t=this.get("fillGradient");if(t){this._display.isMeasured=!0;var n=t.get("target");n&&(this._disposers.push(n.events.on("boundschanged",(function(){e._markDirtyKey("fill")}))),this._disposers.push(n.events.on("positionchanged",(function(){e._markDirtyKey("fill")}))))}}if(this.isDirty("strokeGradient")){var r=this.get("strokeGradient");if(r){this._display.isMeasured=!0;var s=r.get("target");s&&(this._disposers.push(s.events.on("boundschanged",(function(){e._markDirtyKey("stroke")}))),this._disposers.push(s.events.on("positionchanged",(function(){e._markDirtyKey("stroke")}))))}}}},{key:"_changed",value:function(){if((0,a.Z)((0,o.Z)(i.prototype),"_changed",this).call(this),this._clear){this.markDirtyBounds(),this.markDirtyLayer(),this._display.clear();var e=this.get("strokeDasharray");w(e)&&(e=e<.5?[0]:[e]),this._display.setLineDash(e);var t=this.get("strokeDashoffset");t&&this._display.setLineDashOffset(t);var n=this.get("blendMode",Ot.NORMAL);this._display.blendMode=n;var r=this.get("draw");r&&r(this._display,this);var s=this.get("svgPath");null!=s&&this._display.svgPath(s)}}},{key:"_afterChanged",value:function(){var e=this;if((0,a.Z)((0,o.Z)(i.prototype),"_afterChanged",this).call(this),this._clear){var t=this.get("fill"),n=this.get("fillGradient"),r=this.get("fillPattern"),s=this.get("fillOpacity"),l=this.get("stroke"),u=this.get("strokeGradient"),c=this.get("strokePattern"),d=this.get("shadowColor"),h=this.get("shadowBlur"),f=this.get("shadowOffsetX"),v=this.get("shadowOffsetY"),p=this.get("shadowOpacity");if(d&&(h||f||v)&&this._display.shadow(d,h,f,v,p),r){var g=!1;!t||r.get("fill")&&!r.get("fillInherited")||(r.set("fill",t),r.set("fillInherited",!0),g=!0),!l||r.get("color")&&!r.get("colorInherited")||(r.set("color",l),r.set("colorInherited",!0),g=!0),g&&r._changed();var y=r.pattern;y&&(this._display.beginFill(y,s),this._display.endFill(),r instanceof Ft&&r.events.once("loaded",(function(){e._clear=!0,e.markDirty()})))}else if(n){if(t){var m=n.get("stops",[]);m.length&&Z(m,(function(e){e.color&&!e.colorInherited||!t||(e.color=t,e.colorInherited=!0),(null==e.opacity||e.opacityInherited)&&(e.opacity=s,e.opacityInherited=!0)}))}var b=n.getFill(this);b&&(this._display.beginFill(b,s),this._display.endFill())}else t&&(this._display.beginFill(t,s),this._display.endFill());if(l||u||c){var _=this.get("strokeOpacity"),w=this.get("strokeWidth",1);this.get("nonScalingStroke")&&(w/=this.get("scale",1)),this.get("crisp")&&(w/=this._root._renderer.resolution);var k=this.get("lineJoin");if(c){var x=!1;!l||c.get("color")&&!c.get("colorInherited")||(c.set("color",l),c.set("colorInherited",!0),x=!0),x&&c._changed();var C=c.pattern;C&&(this._display.lineStyle(w,C,_,k),this._display.endStroke(),c instanceof Ft&&c.events.once("loaded",(function(){e._clear=!0,e.markDirty()})))}else if(u){var M=u.get("stops",[]);M.length&&Z(M,(function(e){e.color&&!e.colorInherited||!l||(e.color=l,e.colorInherited=!0),(null==e.opacity||e.opacityInherited)&&(e.opacity=_,e.opacityInherited=!0)}));var P=u.getFill(this);P&&(this._display.lineStyle(w,P,_,k),this._display.endStroke())}else l&&(this._display.lineStyle(w,l,_,k),this._display.endStroke())}this.getPrivate("showingTooltip")&&this.showTooltip()}this._clear=!1}}]),i}(Tt);Object.defineProperty(St,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Graphics"}),Object.defineProperty(St,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Tt.classNames.concat([St.className])});var Bt=function(e){(0,u.Z)(i,e);var t=(0,c.Z)(i);function i(){return(0,d.Z)(this,i),t.apply(this,arguments)}return(0,h.Z)(i,[{key:"_beforeChanged",value:function(){(0,a.Z)((0,o.Z)(i.prototype),"_beforeChanged",this).call(this),(this.isDirty("width")||this.isDirty("height")||this.isPrivateDirty("width")||this.isPrivateDirty("height"))&&(this._clear=!0)}},{key:"_changed",value:function(){(0,a.Z)((0,o.Z)(i.prototype),"_changed",this).call(this),this._clear&&!this.get("draw")&&this._draw()}},{key:"_draw",value:function(){this._display.drawRect(0,0,this.width(),this.height())}},{key:"_updateSize",value:function(){this.markDirty(),this._clear=!0}}]),i}(St);function Lt(e,t){e.get("reverseChildren",!1)?e.children.eachReverse(t):e.children.each(t)}Object.defineProperty(Bt,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Rectangle"}),Object.defineProperty(Bt,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:St.classNames.concat([Bt.className])});var jt=function(e){(0,u.Z)(i,e);var t=(0,c.Z)(i);function i(){return(0,d.Z)(this,i),t.apply(this,arguments)}return(0,h.Z)(i)}(xt);Object.defineProperty(jt,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Layout"}),Object.defineProperty(jt,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:xt.classNames.concat([jt.className])});var Rt=function(e){(0,u.Z)(i,e);var t=(0,c.Z)(i);function i(){return(0,d.Z)(this,i),t.apply(this,arguments)}return(0,h.Z)(i,[{key:"updateContainer",value:function(e){var t=e.get("paddingLeft",0),i=e.innerWidth(),n=0;Lt(e,(function(e){if(e.isVisible()&&"relative"==e.get("position")){var t=e.get("width");if(t instanceof $){n+=t.value;var r=i*t.value,a=e.get("minWidth",e.getPrivate("minWidth",-1/0));a>r&&(i-=a,n-=t.value);var o=e.get("maxWidth",e.getPrivate("maxWidth",1/0));r>o&&(i-=o,n-=t.value)}else w(t)||(t=e.width()),i-=t+e.get("marginLeft",0)+e.get("marginRight",0)}})),(i<=0||i==1/0)&&(i=.1),Lt(e,(function(e){if(e.isVisible()&&"relative"==e.get("position")){var t=e.get("width");if(t instanceof $){var r=i*t.value/n-e.get("marginLeft",0)-e.get("marginRight",0),a=e.get("minWidth",e.getPrivate("minWidth",-1/0)),o=e.get("maxWidth",e.getPrivate("maxWidth",1/0));r=Math.min(Math.max(a,r),o),e.setPrivate("width",r)}}}));var r=t;Lt(e,(function(e){if("relative"==e.get("position"))if(e.isVisible()){var t=e.adjustedLocalBounds(),i=e.get("marginLeft",0),n=e.get("marginRight",0),a=e.get("maxWidth"),o=t.left,s=t.right;a&&s-o>a&&(s=o+a);var l=r+i-o;e.setPrivate("x",l),r=l+s+n}else e.setPrivate("x",void 0)}))}}]),i}(jt);Object.defineProperty(Rt,"className",{enumerable:!0,configurable:!0,writable:!0,value:"HorizontalLayout"}),Object.defineProperty(Rt,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:jt.classNames.concat([Rt.className])});var Nt=function(e){(0,u.Z)(i,e);var t=(0,c.Z)(i);function i(){return(0,d.Z)(this,i),t.apply(this,arguments)}return(0,h.Z)(i,[{key:"updateContainer",value:function(e){var t=e.get("paddingTop",0),i=e.innerHeight(),n=0;Lt(e,(function(e){if(e.isVisible()&&"relative"==e.get("position")){var t=e.get("height");if(t instanceof $){n+=t.value;var r=i*t.value,a=e.get("minHeight",e.getPrivate("minHeight",-1/0));a>r&&(i-=a,n-=t.value);var o=e.get("maxHeight",e.getPrivate("maxHeight",1/0));r>o&&(i-=o,n-=t.value)}else w(t)||(t=e.height()),i-=t+e.get("marginTop",0)+e.get("marginBottom",0)}})),(i<=0||i==1/0)&&(i=.1),Lt(e,(function(e){if(e.isVisible()&&"relative"==e.get("position")){var t=e.get("height");if(t instanceof $){var r=i*t.value/n-e.get("marginTop",0)-e.get("marginBottom",0),a=e.get("minHeight",e.getPrivate("minHeight",-1/0)),o=e.get("maxHeight",e.getPrivate("maxHeight",1/0));r=Math.min(Math.max(a,r),o),e.setPrivate("height",r)}}}));var r=t;Lt(e,(function(e){if("relative"==e.get("position"))if(e.isVisible()){var t=e.adjustedLocalBounds(),i=e.get("marginTop",0),n=t.top,a=t.bottom,o=e.get("maxHeight");o&&a-n>o&&(a=n+o);var s=e.get("marginBottom",0),l=r+i-n;e.setPrivate("y",l),r=l+a+s}else e.setPrivate("y",void 0)}))}}]),i}(jt);Object.defineProperty(Nt,"className",{enumerable:!0,configurable:!0,writable:!0,value:"VerticalLayout"}),Object.defineProperty(Nt,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:jt.classNames.concat([Nt.className])});var Ht=function(e){(0,u.Z)(i,e);var t=(0,c.Z)(i);function i(){return(0,d.Z)(this,i),t.apply(this,arguments)}return(0,h.Z)(i,[{key:"_afterNew",value:function(){this._setRawDefault("maxColumns",Number.MAX_VALUE),(0,a.Z)((0,o.Z)(i.prototype),"_afterNew",this).call(this)}},{key:"updateContainer",value:function(e){var t=e.get("paddingLeft",0),i=e.get("paddingRight",0),n=e.get("paddingTop",0),r=e.maxWidth()-t-i,a=r,o=1;Lt(e,(function(e){if(e.get("visible")&&e.getPrivate("visible")&&!e.get("forceHidden")&&"absolute"!=e.get("position")){var t=e.width();t<a&&(a=t),t>o&&(o=t)}})),a=it(a,1,r),o=it(o,1,r);var s=1;s=this.get("fixedWidthGrid")?r/o:r/a,s=Math.max(1,Math.floor(s)),s=Math.min(this.get("maxColumns",Number.MAX_VALUE),s);var l=this.getColumnWidths(e,s,o,r),u=n,c=0,d=0;s=l.length;var h=t;Lt(e,(function(e){if("relative"==e.get("position")&&e.isVisible()){var i=e.get("marginTop",0),n=e.get("marginBottom",0),r=e.adjustedLocalBounds(),a=e.get("marginLeft",0),o=e.get("marginRight",0),f=h+a-r.left,v=u+i-r.top;e.setPrivate("x",f),e.setPrivate("y",v),h+=l[c]+o,d=Math.max(d,e.height()+i+n),++c>=s&&(c=0,h=t,u+=d)}}))}},{key:"getColumnWidths",value:function(e,t,i,n){var r=this,a=0,o=[],s=0;return Lt(e,(function(n){var a=n.adjustedLocalBounds();"absolute"!=n.get("position")&&n.isVisible()&&(r.get("fixedWidthGrid")?o[s]=i:o[s]=Math.max(0|o[s],a.right-a.left+n.get("marginLeft",0)+n.get("marginRight",0)),s<e.children.length-1&&(++s==t&&(s=0)))})),Z(o,(function(e){a+=e})),a>n?t>2?(t-=1,this.getColumnWidths(e,t,i,n)):[n]:o}}]),i}(jt);Object.defineProperty(Ht,"className",{enumerable:!0,configurable:!0,writable:!0,value:"GridLayout"}),Object.defineProperty(Ht,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:jt.classNames.concat([Ht.className])});var zt=function(){function e(){(0,d.Z)(this,e)}return(0,h.Z)(e,null,[{key:"escape",value:function(e){return e.replace(/\[\[/g,this.prefix+"1").replace(/([^\/\]]{1})\]\]/g,"$1"+this.prefix+"2").replace(/\]\]/g,this.prefix+"2").replace(/\{\{/g,this.prefix+"3").replace(/\}\}/g,this.prefix+"4").replace(/\'\'/g,this.prefix+"5")}},{key:"unescape",value:function(e){return e.replace(new RegExp(this.prefix+"1","g"),"[[").replace(new RegExp(this.prefix+"2","g"),"]]").replace(new RegExp(this.prefix+"3","g"),"{{").replace(new RegExp(this.prefix+"4","g"),"}}").replace(new RegExp(this.prefix+"5","g"),"''")}},{key:"cleanUp",value:function(e){return e.replace(/\[\[/g,"[").replace(/\]\]/g,"]").replace(/\{\{/g,"{").replace(/\}\}/g,"}").replace(/\'\'/g,"'")}},{key:"chunk",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=[];e=this.escape(e);for(var r=t?e.split("'"):[e],a=0;a<r.length;a++){var o=r[a];if(""!==o)if(a%2==0)for(var s=(o=(o=o.replace(/\]\[/g,"]"+x+"[")).replace(/\[\]/g,"[ ]")).split(/[\[\]]+/),l=0;l<s.length;l++){var u=this.cleanUp(this.unescape(s[l]));u!==x&&""!==u&&(l%2==0?n.push({type:"value",text:u}):n.push({type:i?"value":"format",text:"["+u+"]"}))}else for(var c=o.split(/[\[\]]+/),d=0;d<c.length;d++){var h=this.cleanUp(this.unescape(c[d]));""!==h&&(d%2==0?n.push({type:"text",text:h}):this.isImage(h)?n.push({type:"image",text:"["+h+"]"}):n.push({type:"format",text:"["+h+"]"}))}}return n}},{key:"isImage",value:function(e){return!!e.match(/img[ ]?:/)}},{key:"getTextStyle",value:function(e){var t={};if(""==e||"[ ]"==e)return{};var i=e.match(/('[^']*')|("[^"]*")/gi);if(i)for(var n=0;n<i.length;n++)e=e.replace(i[n],i[n].replace(/['"]*/g,"").replace(/[ ]+/g,"+"));var r=e.match(/([\w\-]*:[\s]?[^;\s\]]*)|(\#[\w]{1,6})|([\w\-]+)|(\/)/gi);if(!r)return{};for(var a=0;a<r.length;a++)if(r[a].match(/^(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)$/i))t.fontWeight=r[a];else if(r[a].match(/^(underline|line-through)$/i))t.textDecoration=r[a];else if("/"==r[a]);else if(r[a].match(/:/)){var o=r[a].replace("+"," ").split(/:[ ]*/);t[o[0]]=o[1]}else t.fill=Ye.fromString(r[a]);return t}}]),e}();function Vt(e,t){if(null!=t){t=""+t;var i,n=(t=zt.escape(t)).match(/\{([^}]+)\}/g);if(n)for(i=0;i<n.length;i++){var r=Wt(e,n[i].replace(/\{([^}]+)\}/,"$1"));null==r&&(r=""),t=t.split(n[i]).join(r)}t=zt.unescape(t)}else t="";return t}function Wt(e,t,i){for(var n,r,a=e.dataItem,o=[],s=/(format[a-zA-Z]*)\((.*)\)|([^.]+)/g;null!==(r=s.exec(t));)if(r[3]){o.push({prop:r[3]});var l=e.getDateFormatter().get("dateFields",[]),u=e.getNumberFormatter().get("numericFields",[]),c=e.getDurationFormatter().get("durationFields",[]);-1!==l.indexOf(r[3])?o.push({method:"formatDate",params:[]}):-1!==u.indexOf(r[3])?o.push({method:"formatNumber",params:[]}):-1!==c.indexOf(r[3])&&o.push({method:"formatDuration",params:[]})}else{var d=[];if(""!=Ce(r[2]))for(var h=void 0,f=/'([^']*)'|"([^"]*)"|([0-9\-]+)/g;null!==(h=f.exec(r[2]));)d.push(h[1]||h[2]||h[3]);o.push({method:r[1],params:d})}if(a){(null==(n=Ut(e,o,a._settings))||k(n))&&(n=Ut(e,o,a));var v=a.dataContext;null==n&&v&&(null==(n=Ut(e,o,v))&&(n=Ut(e,[{prop:t}],v)),null==n&&v.dataContext&&(n=Ut(e,o,v.dataContext))),null==n&&a.component&&a.component.dataItem!==a&&(n=Wt(a.component,t))}return null==n&&(n=Ut(e,o,e)),null==n&&e.parent&&(n=Wt(e.parent,t)),n}function Yt(e,t){var i=e.getPrivate("customData");if(k(i))return i[t]}function Ut(e,t,i,n){for(var r=i,a=!1,o=0,s=t.length;o<s;o++){var l=t[o];if(l.prop){if(r instanceof Tt){var u=r.get(l.prop);null==u&&(u=r.getPrivate(l.prop)),null==u&&(u=Yt(r,l.prop)),null==u&&(u=r[l.prop]),r=u}else if(r.get){var c=r.get(l.prop);null==c&&(c=r[l.prop]),r=c}else r=r[l.prop];if(null==r)return}else switch(l.method){case"formatNumber":var d=p(r);null!=d&&(r=e.getNumberFormatter().format(d,n||l.params[0]||void 0),a=!0);break;case"formatDate":var h=g(r);if(!b(h)||v(h.getTime()))return;null!=h&&(r=e.getDateFormatter().format(h,n||l.params[0]||void 0),a=!0);break;case"formatDuration":var f=p(r);null!=f&&(r=e.getDurationFormatter().format(f,n||l.params[0]||void 0,l.params[1]||void 0),a=!0);break;case"urlEncode":case"encodeURIComponent":r=encodeURIComponent(r);break;default:r[l.method]&&r[l.method].apply(i,l.params)}}if(!a){var y=[{method:"",params:n}];if(null==n)w(r)?(y[0].method="formatNumber",y[0].params=""):b(r)&&(y[0].method="formatDate",y[0].params="");else{var m=function(e){if(void 0===e)return"string";var t=(e=(e=(e=e.toLowerCase().replace(/^\[[^\]]*\]/,"")).replace(/\[[^\]]+\]/,"")).trim()).match(/\/(date|number|duration)$/);return t?t[1]:"number"===e?"number":"date"===e?"date":"duration"===e?"duration":e.match(/[#0]/)?"number":e.match(/[ymwdhnsqaxkzgtei]/)?"date":"string"}(n);"number"===m?y[0].method="formatNumber":"date"===m?y[0].method="formatDate":"duration"===m&&(y[0].method="formatDuration")}y[0].method&&(r=Ut(e,y,r))}return r}Object.defineProperty(zt,"prefix",{enumerable:!0,configurable:!0,writable:!0,value:"__amcharts__"});var qt=function(e){(0,u.Z)(i,e);var t=(0,c.Z)(i);function i(){var e;return(0,d.Z)(this,i),e=t.apply(this,arguments),Object.defineProperty((0,l.Z)(e),"_display",{enumerable:!0,configurable:!0,writable:!0,value:e._root._renderer.makeContainer()}),Object.defineProperty((0,l.Z)(e),"_childrenDisplay",{enumerable:!0,configurable:!0,writable:!0,value:e._root._renderer.makeContainer()}),Object.defineProperty((0,l.Z)(e),"children",{enumerable:!0,configurable:!0,writable:!0,value:new K((0,l.Z)(e))}),Object.defineProperty((0,l.Z)(e),"_percentageSizeChildren",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty((0,l.Z)(e),"_percentagePositionChildren",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty((0,l.Z)(e),"_prevWidth",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty((0,l.Z)(e),"_prevHeight",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty((0,l.Z)(e),"_contentWidth",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty((0,l.Z)(e),"_contentHeight",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty((0,l.Z)(e),"_contentMask",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,l.Z)(e),"_vsbd0",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,l.Z)(e),"_vsbd1",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e}return(0,h.Z)(i,[{key:"_afterNew",value:function(){(0,a.Z)((0,o.Z)(i.prototype),"_afterNew",this).call(this),this._display.addChild(this._childrenDisplay)}},{key:"_dispose",value:function(){A(this.allChildren(),(function(e){e.dispose()})),this.getPrivate("htmlElement")&&this._root._removeHTMLContent(this),(0,a.Z)((0,o.Z)(i.prototype),"_dispose",this).call(this)}},{key:"_changed",value:function(){if((0,a.Z)((0,o.Z)(i.prototype),"_changed",this).call(this),this.isDirty("interactiveChildren")&&(this._display.interactiveChildren=this.get("interactiveChildren",!1)),this.isDirty("layout")&&(this._prevWidth=0,this._prevHeight=0,this.markDirtyBounds(),this._prevSettings.layout&&this.children.each((function(e){e.removePrivate("x"),e.removePrivate("y")}))),(this.isDirty("paddingTop")||this.isDirty("paddingBottom")||this.isDirty("paddingLeft")||this.isDirty("paddingRight"))&&this.children.each((function(e){e.markDirtyPosition()})),this.isDirty("maskContent")){var e=this._childrenDisplay,t=this._contentMask;this.get("maskContent")?t||(t=Bt.new(this._root,{x:-.5,y:-.5,width:this.width()+1,height:this.height()+1}),this._contentMask=t,e.addChildAt(t._display,0),e.mask=t._display):t&&(e.removeChild(t._display),e.mask=null,t.dispose(),this._contentMask=void 0)}}},{key:"_updateSize",value:function(){(0,a.Z)((0,o.Z)(i.prototype),"_updateSize",this).call(this),Z(this._percentageSizeChildren,(function(e){e._updateSize()})),Z(this._percentagePositionChildren,(function(e){e.markDirtyPosition(),e._updateSize()})),this.updateBackground()}},{key:"updateBackground",value:function(){var e=this.get("background"),t=this._localBounds;if(t&&!this.isHidden()){var i=t.left,n=t.top,r=t.right-i,a=t.bottom-n,o=this.get("maxWidth"),s=this.get("maxHeight");s&&a>s&&(a=s),o&&r>o&&(r=o);var l=this.width(),u=this.height();e&&(e.setAll({width:r,height:a,x:i,y:n}),this._display.interactive&&(e._display.interactive=!0));var c=this._contentMask;c&&c.setAll({width:l+1,height:u+1});var d=this.get("verticalScrollbar");if(d){d.set("height",u),d.set("x",l-d.width()-d.get("marginRight",0)),d.set("end",d.get("start",0)+u/this._contentHeight);var h=d.get("background");h&&h.setAll({width:d.width(),height:u});var f=!0;this._contentHeight<=u&&(f=!1),d.setPrivate("visible",f)}}}},{key:"_applyThemes",value:function(){return!!(0,a.Z)((0,o.Z)(i.prototype),"_applyThemes",this).call(this)&&(this.eachChildren((function(e){e._applyThemes()})),!0)}},{key:"_applyState",value:function(e){(0,a.Z)((0,o.Z)(i.prototype),"_applyState",this).call(this,e),this.get("setStateOnChildren")&&this.eachChildren((function(t){t.states.apply(e)}))}},{key:"_applyStateAnimated",value:function(e,t){(0,a.Z)((0,o.Z)(i.prototype),"_applyStateAnimated",this).call(this,e,t),this.get("setStateOnChildren")&&this.eachChildren((function(i){i.states.applyAnimate(e,t)}))}},{key:"innerWidth",value:function(){return this.width()-this.get("paddingRight",0)-this.get("paddingLeft",0)}},{key:"innerHeight",value:function(){return this.height()-this.get("paddingTop",0)-this.get("paddingBottom",0)}},{key:"_getBounds",value:function(){var e=this.get("width"),t=this.get("height"),i=this.getPrivate("width"),n=this.getPrivate("height"),r={left:0,top:0,right:this.width(),bottom:this.height()},a=this.get("layout"),o=!1,s=!1;if((a instanceof Rt||a instanceof Ht)&&(o=!0),a instanceof Nt&&(s=!0),null==e&&null==i||null==t&&null==n||this.get("verticalScrollbar")){var l=Number.MAX_VALUE,u=l,c=-l,d=l,h=-l,f=this.get("paddingLeft",0),v=this.get("paddingTop",0),p=this.get("paddingRight",0),g=this.get("paddingBottom",0);this.children.each((function(e){if("absolute"!=e.get("position")&&e.get("isMeasured")){var t=e.adjustedLocalBounds(),i=e.x(),n=e.y(),r=i+t.left,a=i+t.right,l=n+t.top,f=n+t.bottom;o&&(r-=e.get("marginLeft",0),a+=e.get("marginRight",0)),s&&(l-=e.get("marginTop",0),f+=e.get("marginBottom",0)),r<u&&(u=r),a>c&&(c=a),l<d&&(d=l),f>h&&(h=f)}})),u==l&&(u=0),c==-l&&(c=0),d==l&&(d=0),h==-l&&(h=0),r.left=u-f,r.top=d-v,r.right=c+p,r.bottom=h+g}this._contentWidth=r.right-r.left,this._contentHeight=r.bottom-r.top,w(e)&&(r.left=0,r.right=e),w(i)&&(r.left=0,r.right=i),w(t)&&(r.top=0,r.bottom=t),w(n)&&(r.top=0,r.bottom=n),this._localBounds=r}},{key:"_updateBounds",value:function(){var e=this.get("layout");e&&e.updateContainer(this),(0,a.Z)((0,o.Z)(i.prototype),"_updateBounds",this).call(this),this.updateBackground()}},{key:"markDirty",value:function(){(0,a.Z)((0,o.Z)(i.prototype),"markDirty",this).call(this),this._root._addDirtyParent(this)}},{key:"_prepareChildren",value:function(){var e=this.innerWidth(),t=this.innerHeight();if(e!=this._prevWidth||t!=this._prevHeight){var i=this.get("layout"),n=!1,r=!1;i&&((i instanceof Rt||i instanceof Ht)&&(n=!0),i instanceof Nt&&(r=!0)),Z(this._percentageSizeChildren,(function(i){if(!n){var a=i.get("width");a instanceof $&&i.setPrivate("width",a.value*e)}if(!r){var o=i.get("height");o instanceof $&&i.setPrivate("height",o.value*t)}})),Z(this._percentagePositionChildren,(function(e){e.markDirtyPosition(),e.markDirtyBounds()})),this._prevWidth=e,this._prevHeight=t,this._sizeDirty=!0,this.updateBackground()}this._handleStates()}},{key:"_updateChildren",value:function(){var e=this;if(this.isDirty("html")){var t=this.get("html");t&&""!==t?this._root._setHTMLContent(this,Vt(this,this.get("html",""))):this._root._removeHTMLContent(this),this._root._positionHTMLElement(this)}if(this.isDirty("verticalScrollbar")){var i=this.get("verticalScrollbar");if(i){i._setParent(this),i.children.removeValue(i.startGrip),i.children.removeValue(i.endGrip),this.set("maskContent",!0),this.set("paddingRight",i.width()+i.get("marginRight",0)+i.get("marginLeft",0));var n=this.get("background");n||(n=this.set("background",Bt.new(this._root,{themeTags:["background"],fillOpacity:0,fill:this._root.interfaceColors.get("alternativeBackground")}))),this._vsbd0=this.events.on("wheel",(function(t){var n=t.originalEvent;if(me(n,e)){n.preventDefault();var r=n.deltaY/5e3,a=i.get("start",0),o=i.get("end",1);a+r<=0&&(r=-a),o+r>=1&&(r=1-o),a+r>=0&&o+r<=1&&(i.set("start",a+r),i.set("end",o+r))}})),this._disposers.push(this._vsbd0),this._vsbd1=i.events.on("rangechanged",(function(){var t=e._contentHeight,n=e._childrenDisplay,r=e._contentMask;n.y=-i.get("start")*t,n.markDirtyLayer(),r&&(r._display.y=-n.y,n.mask=r._display)})),this._disposers.push(this._vsbd1),this._display.addChild(i._display)}else{var r=this._prevSettings.verticalScrollbar;r&&(this._display.removeChild(r._display),this._vsbd0&&this._vsbd0.dispose(),this._vsbd1&&this._vsbd1.dispose(),this._childrenDisplay.y=0,this.setPrivate("height",void 0),this.set("maskContent",!1),this.set("paddingRight",void 0))}}if(this.isDirty("background")){var a=this._prevSettings.background;a&&this._display.removeChild(a._display);var o=this.get("background");o instanceof Tt&&(o.set("isMeasured",!1),o._setParent(this),this._display.addChildAt(o._display,0))}if(this.isDirty("mask")){var s=this.get("mask"),l=this._prevSettings.mask;if(l&&(this._display.removeChild(l._display),l!=s&&l.dispose()),s){var u=s.parent;u&&u.children.removeValue(s),s._setParent(this),this._display.addChildAt(s._display,0),this._childrenDisplay.mask=s._display}}}},{key:"_processTemplateField",value:function(){(0,a.Z)((0,o.Z)(i.prototype),"_processTemplateField",this).call(this),this.children.each((function(e){e._processTemplateField()}))}},{key:"walkChildren",value:function(e){this.children.each((function(t){t instanceof i&&t.walkChildren(e),e(t)}))}},{key:"eachChildren",value:function(e){var t=this.get("background");t&&e(t);var i=this.get("verticalScrollbar");i&&e(i);var n=this.get("mask");n&&e(n),this.children.values.forEach((function(t){e(t)}))}},{key:"allChildren",value:function(){var e=[];return this.eachChildren((function(t){e.push(t)})),e}},{key:"_setDataItem",value:function(e){var t=e!==this._dataItem;(0,a.Z)((0,o.Z)(i.prototype),"_setDataItem",this).call(this,e);var n=this.get("html","");n&&""!==n&&t&&this._root._setHTMLContent(this,Vt(this,n))}}]),i}(Tt);Object.defineProperty(qt,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Container"}),Object.defineProperty(qt,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Tt.classNames.concat([qt.className])});var Gt=function(e){(0,u.Z)(i,e);var t=(0,c.Z)(i);function i(){var e;return(0,d.Z)(this,i),e=t.apply(this,arguments),Object.defineProperty((0,l.Z)(e),"textStyle",{enumerable:!0,configurable:!0,writable:!0,value:e._root._renderer.makeTextStyle()}),Object.defineProperty((0,l.Z)(e),"_display",{enumerable:!0,configurable:!0,writable:!0,value:e._root._renderer.makeText("",e.textStyle)}),Object.defineProperty((0,l.Z)(e),"_textStyles",{enumerable:!0,configurable:!0,writable:!0,value:["textAlign","fontFamily","fontSize","fontStyle","fontWeight","fontStyle","fontVariant","textDecoration","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","shadowOpacity","lineHeight","baselineRatio","direction","textBaseline","oversizedBehavior","breakWords","ellipsis","minScale"]}),Object.defineProperty((0,l.Z)(e),"_originalScale",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e}return(0,h.Z)(i,[{key:"_updateBounds",value:function(){if(this.get("text"))(0,a.Z)((0,o.Z)(i.prototype),"_updateBounds",this).call(this);else{this._adjustedLocalBounds={left:0,right:0,top:0,bottom:0}}}},{key:"_changed",value:function(){var e=this;(0,a.Z)((0,o.Z)(i.prototype),"_changed",this).call(this),this._display.clear();var t=this.textStyle;if(this.isDirty("opacity")){var n=this.get("opacity",1);this._display.alpha=n}if((this.isDirty("text")||this.isDirty("populateText"))&&(this._display.text=this._getText(),this.markDirtyBounds(),"tooltip"==this.get("role")&&this._root.updateTooltip(this)),this.isPrivateDirty("tooltipElement")&&this.getPrivate("tooltipElement")&&this._disposers.push(new H((function(){e._root._removeTooltipElement(e)}))),this.isDirty("width")&&(t.wordWrapWidth=this.width(),this.markDirtyBounds()),this.isDirty("oversizedBehavior")&&(t.oversizedBehavior=this.get("oversizedBehavior","none"),this.markDirtyBounds()),this.isDirty("breakWords")&&(t.breakWords=this.get("breakWords",!1),this.markDirtyBounds()),this.isDirty("ellipsis")&&(t.ellipsis=this.get("ellipsis"),this.markDirtyBounds()),this.isDirty("ignoreFormatting")&&(t.ignoreFormatting=this.get("ignoreFormatting",!1),this.markDirtyBounds()),this.isDirty("minScale")&&(t.minScale=this.get("minScale",0),this.markDirtyBounds()),this.isDirty("fill")){var r=this.get("fill");r&&(t.fill=r)}if(this.isDirty("fillOpacity")){var s=this.get("fillOpacity",1);s&&(t.fillOpacity=s)}(this.isDirty("maxWidth")||this.isPrivateDirty("maxWidth"))&&(t.maxWidth=this.get("maxWidth",this.getPrivate("maxWidth")),this.markDirtyBounds()),(this.isDirty("maxHeight")||this.isPrivateDirty("maxHeight"))&&(t.maxHeight=this.get("maxHeight",this.getPrivate("maxHeight")),this.markDirtyBounds()),Z(this._textStyles,(function(i){e._dirty[i]&&(t[i]=e.get(i),e.markDirtyBounds())})),t.fontSize=this.get("fontSize"),t.fontFamily=this.get("fontFamily"),this._display.style=t,this.isDirty("role")&&"tooltip"==this.get("role")&&this._root.updateTooltip(this)}},{key:"_getText",value:function(){var e=this.get("text","");return this.get("populateText")?Vt(this,e):e}},{key:"markDirtyText",value:function(){this._display.text=this._getText(),"tooltip"==this.get("role")&&this._root.updateTooltip(this),this.markDirtyBounds(),this.markDirty()}},{key:"_setDataItem",value:function(e){(0,a.Z)((0,o.Z)(i.prototype),"_setDataItem",this).call(this,e),this.get("populateText")&&this.markDirtyText()}},{key:"getNumberFormatter",value:function(){return this.parent?this.parent.getNumberFormatter():(0,a.Z)((0,o.Z)(i.prototype),"getNumberFormatter",this).call(this)}},{key:"getDateFormatter",value:function(){return this.parent?this.parent.getDateFormatter():(0,a.Z)((0,o.Z)(i.prototype),"getDateFormatter",this).call(this)}},{key:"getDurationFormatter",value:function(){return this.parent?this.parent.getDurationFormatter():(0,a.Z)((0,o.Z)(i.prototype),"getDurationFormatter",this).call(this)}}]),i}(Tt);Object.defineProperty(Gt,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Text"}),Object.defineProperty(Gt,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Tt.classNames.concat([Gt.className])});var Xt=function(e){(0,u.Z)(i,e);var t=(0,c.Z)(i);function i(){var e;return(0,d.Z)(this,i),e=t.apply(this,arguments),Object.defineProperty((0,l.Z)(e),"_text",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,l.Z)(e),"_textKeys",{enumerable:!0,configurable:!0,writable:!0,value:["text","fill","fillOpacity","textAlign","fontFamily","fontSize","fontStyle","fontWeight","fontStyle","fontVariant","textDecoration","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","shadowOpacity","lineHeight","baselineRatio","direction","textBaseline","oversizedBehavior","breakWords","ellipsis","minScale","populateText","role","ignoreFormatting"]}),e}return(0,h.Z)(i,[{key:"text",get:function(){return this._text}},{key:"_afterNew",value:function(){var e=this;(0,a.Z)((0,o.Z)(i.prototype),"_afterNew",this).call(this),this._makeText(),Z(this._textKeys,(function(t){var i=e.get(t);null!=i&&e._text.set(t,i)})),""!==this.get("html","")&&this._text.set("text",""),this.onPrivate("maxWidth",(function(){e._setMaxDimentions()})),this.onPrivate("maxHeight",(function(){e._setMaxDimentions()}))}},{key:"_makeText",value:function(){this._text=this.children.push(Gt.new(this._root,{}))}},{key:"_updateChildren",value:function(){var e=this;if((0,a.Z)((0,o.Z)(i.prototype),"_updateChildren",this).call(this),Z(this._textKeys,(function(t){e._text.set(t,e.get(t))})),this.isDirty("maxWidth")&&this._setMaxDimentions(),this.isDirty("maxHeight")&&this._setMaxDimentions(),this.isDirty("rotation")&&this._setMaxDimentions(),""!==this.get("html","")?this._text.set("text",""):this._text.set("text",this.get("text")),this.isDirty("textAlign")||this.isDirty("width")){var t,n=this.get("textAlign");null!=this.get("width")?t="right"==n?J:"center"==n?ee:0:"left"==n||"start"==n?t=this.get("paddingLeft"):"right"!=n&&"end"!=n||(t=-this.get("paddingRight")),this.text.set("x",t)}}},{key:"_setMaxDimentions",value:function(){var e=this.get("rotation"),t=90==e||270==e||-90==e,i=this.get("maxWidth",this.getPrivate("maxWidth",1/0));w(i)?this.text.set(t?"maxHeight":"maxWidth",i-this.get("paddingLeft",0)-this.get("paddingRight",0)):this.text.set(t?"maxHeight":"maxWidth",void 0);var n=this.get("maxHeight",this.getPrivate("maxHeight",1/0));w(n)?this.text.set(t?"maxWidth":"maxHeight",n-this.get("paddingTop",0)-this.get("paddingBottom",0)):this.text.set(t?"maxWidth":"maxHeight",void 0)}},{key:"_setDataItem",value:function(e){(0,a.Z)((0,o.Z)(i.prototype),"_setDataItem",this).call(this,e),this._markDirtyKey("text"),this.text.get("populateText")&&this.text.markDirtyText()}},{key:"getText",value:function(){return this._text._getText()}}]),i}(qt);Object.defineProperty(Xt,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Label"}),Object.defineProperty(Xt,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:qt.classNames.concat([Xt.className])});var Kt=function(){function e(t,i){if((0,d.Z)(this,e),Object.defineProperty(this,"_root",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_rules",{enumerable:!0,configurable:!0,writable:!0,value:{}}),this._root=t,!i)throw new Error("You cannot use `new Class()`, instead use `Class.new()`")}return(0,h.Z)(e,[{key:"setupDefaultRules",value:function(){}},{key:"_lookupRules",value:function(e){return this._rules[e]}},{key:"ruleRaw",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=this._rules[e];i||(i=this._rules[e]=[]),t.sort(gt);var n=j(i,(function(e){var i=gt(e.tags.length,t.length);return 0===i?yt(e.tags,t,gt):i})),r=n.index,a=n.found;if(a)return i[r].template;var o=Zt.new({});return i.splice(r,0,{tags:t,template:o}),o}},{key:"rule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return this.ruleRaw(e,t)}}],[{key:"new",value:function(e){var t=new this(e,!0);return t.setupDefaultRules(),t}}]),e}()},32390:function(e,t,i){i.d(t,{T:function(){return h}});var n=i(97326),r=i(15671),a=i(43144),o=i(11752),s=i(61120),l=i(60136),u=i(29388),c=i(24390),d=function(e){(0,l.Z)(i,e);var t=(0,u.Z)(i);function i(){return(0,r.Z)(this,i),t.apply(this,arguments)}return(0,a.Z)(i,[{key:"_beforeChanged",value:function(){(0,o.Z)((0,s.Z)(i.prototype),"_beforeChanged",this).call(this),(this.isDirty("pointerBaseWidth")||this.isDirty("cornerRadius")||this.isDirty("pointerLength")||this.isDirty("pointerX")||this.isDirty("pointerY")||this.isDirty("width")||this.isDirty("height"))&&(this._clear=!0)}},{key:"_changed",value:function(){if((0,o.Z)((0,s.Z)(i.prototype),"_changed",this).call(this),this._clear){this.markDirtyBounds();var e=this.width(),t=this.height();if(e>0&&t>0){var n=this.get("cornerRadius",8);n=(0,c.aj)(n,0,Math.min(e/2,t/2));var r=this.get("pointerX",0),a=this.get("pointerY",0),l=this.get("pointerBaseWidth",15)/2,u=(r-0)*(t-0)-(a-0)*(e-0),d=(r-0)*(0-t)-(a-t)*(e-0),h=this._display;if(h.moveTo(n,0),u>0&&d>0){var f=Math.round((0,c.aj)(r,n+l,e-l-n));a=(0,c.aj)(a,-1/0,0),h.lineTo(f-l,0),h.lineTo(r,a),h.lineTo(f+l,0)}if(h.lineTo(e-n,0),h.arcTo(e,0,e,n,n),u>0&&d<0){var v=Math.round((0,c.aj)(a,n+l,t-l-n));r=(0,c.aj)(r,e,1/0),h.lineTo(e,n),h.lineTo(e,Math.max(v-l,n)),h.lineTo(r,a),h.lineTo(e,v+l)}if(h.lineTo(e,t-n),h.arcTo(e,t,e-n,t,n),u<0&&d<0){var p=Math.round((0,c.aj)(r,n+l,e-l-n));a=(0,c.aj)(a,t,1/0),h.lineTo(e-n,t),h.lineTo(p+l,t),h.lineTo(r,a),h.lineTo(p-l,t)}if(h.lineTo(n,t),h.arcTo(0,t,0,t-n,n),u<0&&d>0){var g=Math.round((0,c.aj)(a,n+l,t-n-l));r=(0,c.aj)(r,-1/0,0),h.lineTo(0,t-n),h.lineTo(0,g+l),h.lineTo(r,a),h.lineTo(0,Math.max(g-l,n))}h.lineTo(0,n),h.arcTo(0,0,n,0,n),h.closePath()}}}}]),i}(c.a7);Object.defineProperty(d,"className",{enumerable:!0,configurable:!0,writable:!0,value:"PointedRectangle"}),Object.defineProperty(d,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:c.a7.classNames.concat([d.className])});var h=function(e){(0,l.Z)(i,e);var t=(0,u.Z)(i);function i(e,a,o){var s,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return(0,r.Z)(this,i),s=t.call(this,e,a,o,l),Object.defineProperty((0,n.Z)(s),"_fx",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty((0,n.Z)(s),"_fy",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty((0,n.Z)(s),"_label",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,n.Z)(s),"_fillDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,n.Z)(s),"_strokeDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,n.Z)(s),"_labelDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,n.Z)(s),"_w",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty((0,n.Z)(s),"_h",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty((0,n.Z)(s),"_keepHoverDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,n.Z)(s),"_htmlContentHovered",{enumerable:!0,configurable:!0,writable:!0,value:!1}),s}return(0,a.Z)(i,[{key:"_afterNew",value:function(){var e=this;this._settings.themeTags=(0,c.ak)(this._settings.themeTags,["tooltip"]),(0,o.Z)((0,s.Z)(i.prototype),"_afterNew",this).call(this),this.set("background",d.new(this._root,{themeTags:["tooltip","background"]})),this._label=this.children.push(c.al.new(this._root,{})),this._disposers.push(this._label.events.on("boundschanged",(function(){e._updateBackground()}))),this._disposers.push(this.on("bounds",(function(){e._updateBackground()}))),this._updateTextColor(),this._root.tooltipContainer.children.push(this),this.hide(0),this._disposers.push(this.label.onPrivate("htmlElement",(function(t){t&&((0,c.z)(t,"pointerover",(function(t){e._htmlContentHovered=!0})),(0,c.z)(t,"pointerout",(function(t){e._htmlContentHovered=!1})))}))),this._root._tooltips.push(this)}},{key:"label",get:function(){return this._label}},{key:"dispose",value:function(){(0,o.Z)((0,s.Z)(i.prototype),"dispose",this).call(this),(0,c.ad)(this._root._tooltips,this)}},{key:"_updateChildren",value:function(){(0,o.Z)((0,s.Z)(i.prototype),"_updateChildren",this).call(this),(this.isDirty("pointerOrientation")||this.isPrivateDirty("minWidth")||this.isPrivateDirty("minHeight"))&&this.get("background")._markDirtyKey("width"),null!=this.get("labelText")&&this.label.set("text",this.get("labelText")),null!=this.get("labelHTML")&&this.label.set("html",this.get("labelHTML"))}},{key:"_changed",value:function(){var e=this;if((0,o.Z)((0,s.Z)(i.prototype),"_changed",this).call(this),(this.isDirty("pointTo")||this.isDirty("pointerOrientation"))&&this._updateBackground(),this.isDirty("tooltipTarget")&&this.updateBackgroundColor(),this.isDirty("keepTargetHover"))if(this.get("keepTargetHover")){var t=this.get("background");this._keepHoverDp=new c.M([t.events.on("pointerover",(function(t){var i=e.get("tooltipTarget");i&&(i.parent&&i.parent.getPrivate("tooltipTarget")==i&&(i=i.parent),i.hover())})),t.events.on("pointerout",(function(t){var i=e.get("tooltipTarget");i&&(i.parent&&i.parent.getPrivate("tooltipTarget")==i&&(i=i.parent),e._htmlContentHovered||i.unhover())}))])}else this._keepHoverDp&&(this._keepHoverDp.dispose(),this._keepHoverDp=void 0)}},{key:"_onShow",value:function(){(0,o.Z)((0,s.Z)(i.prototype),"_onShow",this).call(this),this.updateBackgroundColor()}},{key:"updateBackgroundColor",value:function(){var e,t,i=this,n=this.get("tooltipTarget"),r=this.get("background");n&&r&&(e=n.get("fill"),t=n.get("stroke"),null==e&&(e=t),this.get("getFillFromSprite")&&(this._fillDp&&this._fillDp.dispose(),null!=e&&r.set("fill",e),this._fillDp=n.on("fill",(function(e){null!=e&&(r.set("fill",e),i._updateTextColor(e))})),this._disposers.push(this._fillDp)),this.get("getStrokeFromSprite")&&(this._strokeDp&&this._strokeDp.dispose(),null!=e&&r.set("stroke",e),this._strokeDp=n.on("fill",(function(e){null!=e&&r.set("stroke",e)})),this._disposers.push(this._strokeDp)),this.get("getLabelFillFromSprite")&&(this._labelDp&&this._labelDp.dispose(),null!=e&&this.label.set("fill",e),this._labelDp=n.on("fill",(function(e){null!=e&&i.label.set("fill",e)})),this._disposers.push(this._labelDp))),this._updateTextColor(e)}},{key:"_updateTextColor",value:function(e){this.get("autoTextColor")&&(null==e&&(e=this.get("background").get("fill")),null==e&&(e=this._root.interfaceColors.get("background")),e instanceof c.C&&this.label.set("fill",c.C.alternative(e,this._root.interfaceColors.get("alternativeText"),this._root.interfaceColors.get("text"))))}},{key:"_setDataItem",value:function(e){(0,o.Z)((0,s.Z)(i.prototype),"_setDataItem",this).call(this,e),this.label._setDataItem(e)}},{key:"_updateBackground",value:function(){(0,o.Z)((0,s.Z)(i.prototype),"updateBackground",this).call(this);var e=this._root.container;if(e){var t=.5,n=.5,r=this.get("centerX");r instanceof c.Q&&(t=r.value);var a=this.get("centerY");a instanceof c.Q&&(n=a.value);var l=e.width(),u=e.height(),h=this.parent,f=0,v=0;if(h){f=h.x(),v=h.y();var p=h.get("layerMargin");p&&(f+=p.left||0,v+=p.top||0,l+=(p.left||0)+(p.right||0),u+=(p.top||0)+(p.bottom||0))}var g=this.get("bounds",{left:-f,top:-v,right:l-f,bottom:u-v});this._updateBounds();var y=this.width(),m=this.height();0===y&&(y=this._w),0===m&&(m=this._h);var b=this.get("pointTo",{x:l/2,y:u/2}),_=b.x,w=b.y,k=this.get("pointerOrientation"),x=this.get("background"),C=0,M=0,P=0;x instanceof d&&(C=x.get("pointerLength",0),P=M=x.get("strokeWidth",0)/2,x.set("width",y),x.set("height",m));var Z,A,T=g.right-g.left,I=g.bottom-g.top;"horizontal"==k||"left"==k||"right"==k?(M=0,"horizontal"==k?_>g.left+T/2?(_-=y*(1-t)+C,P*=-1):_+=y*t+C:"left"==k?_+=y*(1-t)+C:(_-=y*t+C,P*=-1)):(P=0,"vertical"==k?w>g.top+m/2+C?w-=m*(1-n)+C:(w+=m*n+C,M*=-1):"down"==k?w-=m*(1-n)+C:(w+=m*n+C,M*=-1)),_=(0,c.aj)(_,g.left+y*t,g.left+T-y*(1-t))+P,w=(0,c.aj)(w,g.top+m*n,g.top+I-m*(1-n))-M,Z=b.x-_+y*t+P,A=b.y-w+m*n-M,this._fx=_,this._fy=w;var O=this.get("animationDuration",0);if(O>0&&this.get("visible")&&this.get("opacity")>.1){var D=this.get("animationEasing");this.animate({key:"x",to:_,duration:O,easing:D}),this.animate({key:"y",to:w,duration:O,easing:D})}else this.set("x",_),this.set("y",w);x instanceof d&&(x.set("pointerX",Z),x.set("pointerY",A)),y>0&&(this._w=y),m>0&&(this._h=m)}}}]),i}(c.a3);Object.defineProperty(h,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Tooltip"}),Object.defineProperty(h,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:c.a3.classNames.concat([h.className])})},14916:function(e,t,i){function n(e,t,i,n){var r=null,a=1e3;"number"==typeof t?(a=t,n=i):(r=null!==t&&void 0!==t?t:null,a=i);var o,s=0,l=function(){s=0,e.apply(n,o)},u=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];r&&r.apply(n,t),o=t,a?s||(s=setTimeout(l,a)):l()};return u.remove=function(){s&&(clearTimeout(s),s=0)},u.forceUpdate=function(){s&&(clearTimeout(s),l())},u.hasPendingUpdates=function(){return!!s},u}i.d(t,{P:function(){return n}})},11812:function(e,t,i){i.d(t,{Z:function(){return g}});var n,r=i(15671),a=i(43144),o=i(60136),s=i(29388),l=i(27366),u=i(46784),c=i(49861),d=i(25243),h=(i(63780),i(93169),i(69912));function f(e){var t=e.exifInfo,i=e.exifName,n=e.tagName;if(!t||!i||!n)return null;var r=t.find((function(e){return e.name===i}));return r?function(e){var t=e.tagName,i=e.tags;if(!i||!t)return null;var n=i.find((function(e){return e.name===t}));return n&&n.value||null}({tagName:n,tags:r.tags}):null}var v={1:{id:1,rotation:0,mirrored:!1},2:{id:2,rotation:0,mirrored:!0},3:{id:3,rotation:180,mirrored:!1},4:{id:4,rotation:180,mirrored:!0},5:{id:5,rotation:-90,mirrored:!0},6:{id:6,rotation:90,mirrored:!1},7:{id:7,rotation:90,mirrored:!0},8:{id:8,rotation:-90,mirrored:!1}},p=n=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(e){var n;return(0,r.Z)(this,i),(n=t.call(this,e)).contentType=null,n.exifInfo=null,n.id=null,n.globalId=null,n.keywords=null,n.name=null,n.parentGlobalId=null,n.parentObjectId=null,n.size=null,n.url=null,n}return(0,a.Z)(i,[{key:"orientationInfo",get:function(){var e=f({exifName:"Exif IFD0",tagName:"Orientation",exifInfo:this.exifInfo});return v[e]||null}},{key:"clone",value:function(){return new n({contentType:this.contentType,exifInfo:this.exifInfo,id:this.id,globalId:this.globalId,keywords:this.keywords,name:this.name,parentGlobalId:this.parentGlobalId,parentObjectId:this.parentObjectId,size:this.size,url:this.url})}}]),i}(u.wq);(0,l._)([(0,c.Cb)({type:String})],p.prototype,"contentType",void 0),(0,l._)([(0,c.Cb)()],p.prototype,"exifInfo",void 0),(0,l._)([(0,c.Cb)({readOnly:!0})],p.prototype,"orientationInfo",null),(0,l._)([(0,c.Cb)({type:d.z8})],p.prototype,"id",void 0),(0,l._)([(0,c.Cb)({type:String})],p.prototype,"globalId",void 0),(0,l._)([(0,c.Cb)({type:String})],p.prototype,"keywords",void 0),(0,l._)([(0,c.Cb)({type:String})],p.prototype,"name",void 0),(0,l._)([(0,c.Cb)({json:{read:!1}})],p.prototype,"parentGlobalId",void 0),(0,l._)([(0,c.Cb)({json:{read:!1}})],p.prototype,"parentObjectId",void 0),(0,l._)([(0,c.Cb)({type:d.z8})],p.prototype,"size",void 0),(0,l._)([(0,c.Cb)({json:{read:!1}})],p.prototype,"url",void 0);var g=p=n=(0,l._)([(0,h.j)("esri.layers.support.AttachmentInfo")],p)},13357:function(e,t,i){i.r(t),i.d(t,{default:function(){return lr}});var n=i(74165),r=i(15861),a=i(4942),o=i(1413),s=i(29439),l=i(15671),u=i(43144),c=i(60136),d=i(29388),h=i(27366),f=(i(59166),i(40281)),v=i(44927),p=i(98928),g=i(100),y=i(32718),m=i(94172),b=i(14916),_=i(49861),w=i(89125),k=i(63780),x=(i(93169),i(69912)),C=i(33565),M=(i(25243),i(10064)),P=i(70116),Z=(i(17768),i(16889)),A=i(643),T=(i(68860),i(6291));new Map;var I=["B","kB","MB","GB","TB"];var O=i(52639),D=i(7138),F=i(11812),E=i(99837),S=i(93433),B=i(76969),L=i(37270),j=i(37933),R=i(91738),N=i(819),H=y.Z.getLogger("esri.widgets.Feature.support.featureUtils"),z=/href=(""|'')/gi,V=/(\{([^\{\r\n]+)\})/g,W=/\'/g,Y=/^\s*expression\//i,U=/(\n)/gi,q=/[\u00A0-\u9999<>\&]/gim,G=/href\s*=\s*(?:\"([^\"]+)\"|\'([^\']+)\')/gi,X=/^(?:mailto:|tel:)/,K="relationships/",$=(0,B.Ze)("short-date-short-time");function Q(e){if(null!=e)return e.get("sourceLayer")||e.get("layer")}function J(e,t){return ee.apply(this,arguments)}function ee(){return ee=(0,r.Z)((0,n.Z)().mark((function e(t,i){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return","function"==typeof t?t(i):t);case 1:case"end":return e.stop()}}),e)}))),ee.apply(this,arguments)}function te(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(e)return!X.test(e.trim().toLowerCase())}function ie(e){return!!e&&Y.test(e)}function ne(e,t){var i=function(e,t){if(!ie(t)||!e)return null;var i=t.replace(Y,"").toLowerCase(),n=null;return e.some((function(e){return e.name.toLowerCase()===i&&(n=e,!0)})),n}(t,null===e||void 0===e?void 0:e.fieldName);return i?i.title||null:e?e.label||e.fieldName:null}function re(e,t){var i=ae(t,e);return i?i.name:e}function ae(e,t){var i;return e&&"function"==typeof e.getField&&t&&null!==(i=e.getField(t))&&void 0!==i?i:null}function oe(e){return"".concat(e).trim()}function se(e){var t=e.attributes,i=e.globalAttributes,n=e.layer,r=e.text,a=e.expressionAttributes,s=e.fieldInfoMap;return r?le({formattedAttributes:i,template:he(r,(0,o.Z)((0,o.Z)((0,o.Z)({},i),a),t),n),fieldInfoMap:s}):""}function le(e){var t=e.formattedAttributes,i=e.template,n=e.fieldInfoMap;return oe(function(e){return e.replaceAll(z,"")}((0,A.gx)((0,A.gx)(i,(function(e){return function(e,t){var i=t.get(e.toLowerCase());return"{".concat(i&&i.fieldName||e,"}")}(e,n)})),t)))}function ue(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=t[e];if("string"==typeof n){var r="%27",a=(i?encodeURIComponent(n):n).replaceAll(W,r);t[e]=a}}function ce(e,t,i){var n=(t=oe(t))&&"{"!==t[0];return(0,A.gx)(e,function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=(0,o.Z)({},e);return Object.keys(i).forEach((function(e){return ue(e,i,t)})),i}(i,n||!1))}function de(e,t){return e.replaceAll(V,(function(e,i,n){var r=ae(t,n);return r?"{".concat(r.name,"}"):i}))}function he(e,t,i){var n=de(e,i);return n?n.replaceAll(G,(function(e,i,n){return ce(e,i||n,t)})):n}function fe(e){return null!=e&&"object"==typeof e&&"layer"in e&&!!e.layer}function ve(e){return function(e){return null!=e&&"object"==typeof e&&"fieldsIndex"in e&&"geometryType"in e&&"getField"in e&&"load"in e&&"loaded"in e&&"objectIdField"in e&&"spatialReference"in e&&"type"in e&&"feature"===e.type&&"when"in e}(e)&&function(e){return null!=e&&"object"==typeof e&&"createQuery"in e&&"queryFeatureCount"in e&&"queryObjectIds"in e&&"queryRelatedFeatures"in e&&"queryRelatedFeaturesCount"in e&&"relationships"in e}(e)}function pe(e,t){var i=t.fieldInfos,n=t.fieldName,r=t.preventPlacesFormatting,a=t.layer,s=ge(i,n),l=null===s||void 0===s?void 0:s.clone(),u=ae(a,n);if(l&&!(0,L.Ec)(n)){var c,d=null===u||void 0===u?void 0:u.type;if("date"===d||"date-only"===d||"time-only"===d||"timestamp-offset"===d||null!==(c=l.format)&&void 0!==c&&c.dateFormat){var h,f,v=null!==(h=l.format)&&void 0!==h?h:new R.Z;if(null!==(f=v.dateFormat)&&void 0!==f||(v.dateFormat="date-only"===d?"short-date":"short-date-short-time"),"number"==typeof e){var p=!fe(a)&&(0,j.Te)(a)&&a.datesInUnknownTimezone||fe(a)&&function(e){return null!=e&&"object"==typeof e&&"type"in e&&"map-image"===e.type}(a.layer)&&a.layer.datesInUnknownTimezone;return v.formatDate(e,p)}switch(d){case"date-only":return v.formatDateOnly(e);case"time-only":return v.formatTimeOnly(e);case"timestamp-offset":return v.formatTimestamp(e)}}}var g=null===l||void 0===l?void 0:l.format;return"string"==typeof e&&(0,L.Ec)(n)&&g?g.formatRasterPixelValue(e):"string"==typeof(e=function(e,t){if("string"==typeof e&&t&&null==t.dateFormat&&(null!=t.places||null!=t.digitSeparator)){var i=Number(e);if(!isNaN(i))return i}return e}(e,g))||null==e||null==g?be(e):r?(0,T.uf)(e,(0,o.Z)((0,o.Z)({},(0,T.sh)(g)),{},{minimumFractionDigits:0,maximumFractionDigits:20})):g.formatNumber(e)}function ge(e,t){if(e&&e.length&&t)return e.find((function(e){var i;return(null===(i=e.fieldName)||void 0===i?void 0:i.toLowerCase())===t.toLowerCase()}))}function ye(e){var t=[];if(!e)return t;var i=e.fieldInfos,n=e.content;return i&&t.push.apply(t,(0,S.Z)(i)),n&&Array.isArray(n)?(n.forEach((function(e){if("fields"===e.type){var i=e&&e.fieldInfos;i&&t.push.apply(t,(0,S.Z)(i))}})),t):t}function me(e){return e.replaceAll(q,(function(e){return"&#".concat(e.charCodeAt(0),";")}))}function be(e){return"string"==typeof e?e.replaceAll(U,'<br class="esri-text-new-line" />'):e}function _e(e){var t,i,n=e.value,r=e.fieldName,a=e.fieldInfos,o=e.fieldInfoMap,s=e.layer,l=e.graphic;if(null==n)return"";var u=function(e){var t=e.fieldName,i=e.value,n=e.graphic,r=e.layer;if(Ae(t))return null;if(!r||"function"!=typeof r.getFieldDomain)return null;var a=n&&r.getFieldDomain(t,{feature:n});return a&&"coded-value"===a.type?a.getName(i):null}({fieldName:r,value:n,graphic:l,layer:s});if(u)return u;var c=function(e){var t=e.fieldName,i=e.graphic,n=e.layer;if(Ae(t))return null;if(!n||"function"!=typeof n.getFeatureType)return null;var r=n.typeIdField;if(!r||t!==r)return null;var a=n.getFeatureType(i);return a?a.name:null}({fieldName:r,graphic:l,layer:s});if(c)return c;if(o.get(r.toLowerCase()))return pe(n,{fieldInfos:a||Array.from(o.values()),fieldName:r,layer:s});switch(null===s||void 0===s||null===(t=s.fieldsIndex)||void 0===t||null===(i=t.get(r))||void 0===i?void 0:i.type){case"date":return(0,B.p6)(n);case"date-only":return(0,B.o8)(n);case"time-only":return(0,B.LJ)(n);case"timestamp-offset":return(0,B.i$)(n)}return be(n)}function we(e){var t=e.fieldInfos,i=e.attributes,n=e.layer,r=e.graphic,a=e.fieldInfoMap,o=e.relatedInfos,s={};return null!==o&&void 0!==o&&o.forEach((function(e){return function(e){var t=e.attributes,i=e.relatedInfo,n=e.fieldInfoMap,r=e.fieldInfos,a=e.layer;t&&i&&(i.relatedFeatures&&i.relatedFeatures&&i.relatedFeatures.forEach((function(e){return Te({attributes:t,graphic:e,relatedInfo:i,fieldInfoMap:n,fieldInfos:r,layer:a})})),i.relatedStatsFeatures&&i.relatedStatsFeatures&&i.relatedStatsFeatures.forEach((function(e){return Te({attributes:t,graphic:e,relatedInfo:i,fieldInfoMap:n,fieldInfos:r,layer:a})})))}({attributes:s,relatedInfo:e,fieldInfoMap:a,fieldInfos:t,layer:n})})),i&&Object.keys(i).forEach((function(e){var o=i[e];s[e]=_e({fieldName:e,fieldInfos:t,fieldInfoMap:a,layer:n,value:o,graphic:r})})),s}function ke(e,t){return xe.apply(this,arguments)}function xe(){return xe=(0,r.Z)((0,n.Z)().mark((function e(t,i){var r,a,o,s,l,u,c,d,h,f,v,p;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=t.layer,s=t.graphic,l=t.outFields,u=t.objectIds,c=t.returnGeometry,d=t.spatialReference,"number"==typeof(h=u[0])||"string"==typeof h){e.next=4;break}return"Could not query required fields for the specified feature. The feature's ID is invalid.",f={layer:o,graphic:s,objectId:h,requiredFields:l},e.abrupt("return",(H.warn("Could not query required fields for the specified feature. The feature's ID is invalid.",f),null));case 4:if(null!==(r=(0,j.S1)(o))&&void 0!==r&&null!==(a=r.operations)&&void 0!==a&&a.supportsQuery){e.next=7;break}return"The specified layer cannot be queried. The following fields will not be available.",v={layer:o,graphic:s,requiredFields:l,returnGeometry:c},e.abrupt("return",(H.warn("The specified layer cannot be queried. The following fields will not be available.",v),null));case 7:return(p=o.createQuery()).objectIds=u,p.outFields=null!==l&&void 0!==l&&l.length?l:[o.objectIdField],p.returnGeometry=!!c,p.returnZ=!!c,p.returnM=!!c,p.outSpatialReference=d,e.next=11,o.queryFeatures(p,i);case 11:return e.abrupt("return",e.sent.features[0]);case 12:case"end":return e.stop()}}),e)}))),xe.apply(this,arguments)}function Ce(e){return Me.apply(this,arguments)}function Me(){return Me=(0,r.Z)((0,n.Z)().mark((function e(t){var i,r,a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(i=t.expressionInfos)&&void 0!==i&&i.length){e.next=2;break}return e.abrupt("return",!1);case 2:return e.next=4,(0,N.LC)();case 4:return r=e.sent,a=r.arcadeUtils.hasGeometryFunctions,e.abrupt("return",a(t));case 7:case"end":return e.stop()}}),e)}))),Me.apply(this,arguments)}function Pe(e,t){return Ze.apply(this,arguments)}function Ze(){return Ze=(0,r.Z)((0,n.Z)().mark((function e(t,i){var r,a,s,l,u,c,d,h,f,v,p;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.graphic,a=t.popupTemplate,s=t.layer,l=t.spatialReference,s&&a){e.next=3;break}return e.abrupt("return");case 3:if(e.t0="function"==typeof s.load,!e.t0){e.next=7;break}return e.next=7,s.load(i);case 7:if(r.attributes){e.next=9;break}return e.abrupt("return");case 9:if(null!=(u=r.attributes[s.objectIdField])){e.next=12;break}return e.abrupt("return");case 12:return c=[u],e.next=15,a.getRequiredFields(s.fieldsIndex);case 15:if(d=e.sent,h=(0,L.R9)(d,r),f=h?[]:d,e.t1=a.returnGeometry,e.t1){e.next=23;break}return e.next=22,Ce(a);case 22:e.t1=e.sent;case 23:if(v=e.t1,!h||v){e.next=26;break}return e.abrupt("return");case 26:return e.next=28,ke({layer:s,graphic:r,outFields:f,objectIds:c,returnGeometry:v,spatialReference:l},i);case 28:(p=e.sent)&&(p.geometry&&(r.geometry=p.geometry),p.attributes&&(r.attributes=(0,o.Z)((0,o.Z)({},r.attributes),p.attributes)));case 30:case"end":return e.stop()}}),e)}))),Ze.apply(this,arguments)}function Ae(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return!!e&&e.includes(K)}function Te(e){var t=e.attributes,i=e.graphic,n=e.relatedInfo,r=e.fieldInfos,a=e.fieldInfoMap,o=e.layer;t&&i&&n&&Object.keys(i.attributes).forEach((function(e){var s=function(e){return e?"".concat(K).concat(e.layerId,"/").concat(e.fieldName):""}({layerId:n.relation.id.toString(),fieldName:e}),l=i.attributes[e];t[s]=_e({fieldName:s,fieldInfos:r,fieldInfoMap:a,layer:o,value:l,graphic:i})}))}var Ie=function(e){if(!e)return!1;var t=e.toUpperCase();return t.includes("CURRENT_TIMESTAMP")||t.includes("CURRENT_DATE")||t.includes("CURRENT_TIME")},Oe=function(e){var t,i,n=e.layer,r=e.method,a=e.query,o=e.definitionExpression;if(null!==(t=n.capabilities)&&void 0!==t&&null!==(i=t.query)&&void 0!==i&&i.supportsCacheHint&&"attachments"!==r){var s=null!=a.where?a.where:null,l=null!=a.geometry?a.geometry:null;Ie(o)||Ie(s)||"extent"===(null===l||void 0===l?void 0:l.type)||"tile"===a.resultType||(a.cacheHint=!0)}};function De(e,t,i){return e.filter(ve).find((function(e){return e!==t&&e.url===t.url&&e.layerId===i.relatedTableId}))}var Fe={editing:!1,operations:{add:!0,update:!0,delete:!0}},Ee=f.Z.ofType(F.Z),Se=function(e){(0,c.Z)(i,e);var t=(0,d.Z)(i);function i(e){var n;return(0,l.Z)(this,i),(n=t.call(this,e))._getAttachmentsPromise=null,n._attachmentLayer=null,n.capabilities=(0,o.Z)({},Fe),n.activeAttachmentInfo=null,n.activeFileInfo=null,n.attachmentInfos=new Ee,n.fileInfos=new f.Z,n.graphic=null,n.mode="view",n.filesEnabled=!1,n.addHandles((0,m.YP)((function(){return n.graphic}),(function(){return n._graphicChanged()}),m.nn)),n}return(0,u.Z)(i,[{key:"destroy",value:function(){this._attachmentLayer=null,this.graphic=null}},{key:"castCapabilities",value:function(e){return(0,o.Z)((0,o.Z)({},Fe),e)}},{key:"state",get:function(){return this._getAttachmentsPromise?"loading":this.graphic?"ready":"disabled"}},{key:"supportsResizeAttachments",get:function(){var e=this.graphic;if(!e)return!1;var t=e.layer||e.sourceLayer;return(null===t||void 0===t?void 0:t.loaded)&&"capabilities"in t&&t.capabilities&&"operations"in t.capabilities&&"supportsResizeAttachments"in t.capabilities.operations&&t.capabilities.operations.supportsResizeAttachments||!1}},{key:"getAttachments",value:function(){var e=(0,r.Z)((0,n.Z)().mark((function e(){var t,i,r,a,o,s,l;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this._attachmentLayer,i=this.attachmentInfos,t&&"function"==typeof t.queryAttachments){e.next=3;break}throw new M.Z("invalid-layer","getAttachments(): A valid layer is required.");case 3:return r=this._getObjectId(),a=new E.Z({objectIds:[r],returnMetadata:!0}),o=[],s=t.queryAttachments(a).then((function(e){return e[r]||o})).catch((function(){return o})),this._getAttachmentsPromise=s,this.notifyChange("state"),e.next=7,s;case 7:return l=e.sent,e.abrupt("return",(i.removeAll(),l.length&&i.addMany(l),this._getAttachmentsPromise=null,this.notifyChange("state"),l));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"addAttachment",value:function(){var e=(0,r.Z)((0,n.Z)().mark((function e(t){var i,r,a,o,s,l,u,c=this,d=arguments;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=d.length>1&&void 0!==d[1]?d[1]:this.graphic,a=this._attachmentLayer,o=this.attachmentInfos,s=this.capabilities,r){e.next=4;break}throw new M.Z("invalid-graphic","addAttachment(): A valid graphic is required.",{graphic:r});case 4:if(t){e.next=6;break}throw new M.Z("invalid-attachment","addAttachment(): An attachment is required.",{attachment:t});case 6:if(null!==(i=s.operations)&&void 0!==i&&i.add){e.next=8;break}throw new M.Z("invalid-capabilities","addAttachment(): add capabilities are required.");case 8:if(a&&"function"==typeof a.addAttachment){e.next=10;break}throw new M.Z("invalid-layer","addAttachment(): A valid layer is required.");case 10:return l=a.addAttachment(r,t).then((function(e){return c._queryAttachment(e.objectId,r)})),e.next=13,l;case 13:return u=e.sent,e.abrupt("return",(o.add(u),u));case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteAttachment",value:function(){var e=(0,r.Z)((0,n.Z)().mark((function e(t){var i,r,a,o,s,l,u;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this._attachmentLayer,a=this.attachmentInfos,o=this.graphic,s=this.capabilities,t){e.next=3;break}throw new M.Z("invalid-attachment-info","deleteAttachment(): An attachmentInfo is required.",{attachmentInfo:t});case 3:if(null!==(i=s.operations)&&void 0!==i&&i.delete){e.next=5;break}throw new M.Z("invalid-capabilities","deleteAttachment(): delete capabilities are required.");case 5:if(r&&"function"==typeof r.deleteAttachments){e.next=7;break}throw new M.Z("invalid-layer","deleteAttachment(): A valid layer is required.");case 7:if(o){e.next=9;break}throw new M.Z("invalid-graphic","deleteAttachment(): A graphic is required.");case 9:return l=r.deleteAttachments(o,[t.id]).then((function(){return t})),e.next=12,l;case 12:return u=e.sent,e.abrupt("return",(a.remove(u),u));case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateAttachment",value:function(){var e=(0,r.Z)((0,n.Z)().mark((function e(t){var i,r,a,o,s,l,u,c,d,h=this,f=arguments;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=f.length>1&&void 0!==f[1]?f[1]:this.activeAttachmentInfo,a=this._attachmentLayer,o=this.attachmentInfos,s=this.graphic,l=this.capabilities,t){e.next=4;break}throw new M.Z("invalid-attachment","updateAttachment(): An attachment is required.",{attachment:t});case 4:if(r){e.next=6;break}throw new M.Z("invalid-attachment-info","updateAttachment(): An attachmentInfo is required.",{attachmentInfo:r});case 6:if(null!==(i=l.operations)&&void 0!==i&&i.update){e.next=8;break}throw new M.Z("invalid-capabilities","updateAttachment(): Update capabilities are required.");case 8:if(u=o.findIndex((function(e){return e===r})),a&&"function"==typeof a.updateAttachment){e.next=11;break}throw new M.Z("invalid-layer","updateAttachment(): A valid layer is required.");case 11:if(s){e.next=13;break}throw new M.Z("invalid-graphic","updateAttachment(): A graphic is required.");case 13:return c=a.updateAttachment(s,r.id,t).then((function(e){return h._queryAttachment(e.objectId)})),e.next=16,c;case 16:return d=e.sent,e.abrupt("return",(o.splice(u,1,d),d));case 18:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"commitFiles",value:function(){var e=(0,r.Z)((0,n.Z)().mark((function e(){var t=this;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(this.fileInfos.items.map((function(e){return t.addAttachment(e.form)})));case 2:return this.fileInfos.removeAll(),e.abrupt("return",this.getAttachments());case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"addFile",value:function(e,t){if(!e||!t)return null;var i={file:e,form:t};return this.fileInfos.add(i),i}},{key:"updateFile",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.activeFileInfo;if(!e||!t||!i)return null;var n=this.fileInfos.findIndex((function(e){return i===e}));return n>-1&&this.fileInfos.splice(n,1,{file:e,form:t}),this.fileInfos.items[n]}},{key:"deleteFile",value:function(e){var t=this.fileInfos.find((function(t){return t.file===e}));return t?(this.fileInfos.remove(t),t):null}},{key:"_queryAttachment",value:function(){var e=(0,r.Z)((0,n.Z)().mark((function e(t,i){var r,a,o;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this._attachmentLayer,t&&null!==r&&void 0!==r&&r.queryAttachments){e.next=3;break}throw new M.Z("invalid-attachment-id","Could not query attachment.");case 3:return a=this._getObjectId(i),o=new E.Z({objectIds:[a],attachmentsWhere:"AttachmentId=".concat(t),returnMetadata:!0}),e.abrupt("return",r.queryAttachments(o).then((function(e){return e[a][0]})));case 5:case"end":return e.stop()}}),e,this)})));return function(t,i){return e.apply(this,arguments)}}()},{key:"_getObjectId",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.graphic;return null!==(e=null===t||void 0===t?void 0:t.getObjectId())&&void 0!==e?e:null}},{key:"_graphicChanged",value:function(){this.graphic&&(this._setAttachmentLayer(),this.getAttachments().catch((function(){})))}},{key:"_setAttachmentLayer",value:function(){var e=Q(this.graphic);this._attachmentLayer=e?"scene"===e.type&&null!=e.associatedLayer?e.associatedLayer:e:null}}]),i}(D.Z);(0,h._)([(0,_.Cb)()],Se.prototype,"capabilities",void 0),(0,h._)([(0,w.p)("capabilities")],Se.prototype,"castCapabilities",null),(0,h._)([(0,_.Cb)()],Se.prototype,"activeAttachmentInfo",void 0),(0,h._)([(0,_.Cb)()],Se.prototype,"activeFileInfo",void 0),(0,h._)([(0,_.Cb)({readOnly:!0,type:Ee})],Se.prototype,"attachmentInfos",void 0),(0,h._)([(0,_.Cb)()],Se.prototype,"fileInfos",void 0),(0,h._)([(0,_.Cb)({type:O.Z})],Se.prototype,"graphic",void 0),(0,h._)([(0,_.Cb)()],Se.prototype,"mode",void 0),(0,h._)([(0,_.Cb)({readOnly:!0})],Se.prototype,"state",null),(0,h._)([(0,_.Cb)()],Se.prototype,"filesEnabled",void 0),(0,h._)([(0,_.Cb)({readOnly:!0})],Se.prototype,"supportsResizeAttachments",null);var Be=Se=(0,h._)([(0,x.j)("esri.widgets.Attachments.AttachmentsViewModel")],Se),Le=i(65905);function je(e){var t=e.toLowerCase();return"image/bmp"===t||"image/emf"===t||"image/exif"===t||"image/gif"===t||"image/x-icon"===t||"image/jpeg"===t||"image/png"===t||"image/tiff"===t||"image/x-wmf"===t}var Re=i(8905),Ne=i(80975),He=i(80532),ze=i(67005),Ve={addButton:!0,addSubmitButton:!0,cancelAddButton:!0,cancelUpdateButton:!0,deleteButton:!0,errorMessage:!0,progressBar:!0,updateButton:!0},We="esri-attachments",Ye="esri-button",Ue={base:We,loaderContainer:"".concat(We,"__loader-container"),loader:"".concat(We,"__loader"),fadeIn:"".concat(We,"--fade-in"),container:"".concat(We,"__container"),containerList:"".concat(We,"__container--list"),containerPreview:"".concat(We,"__container--preview"),actions:"".concat(We,"__actions"),deleteButton:"".concat(We,"__delete-button"),addAttachmentButton:"".concat(We,"__add-attachment-button"),errorMessage:"".concat(We,"__error-message"),items:"".concat(We,"__items"),item:"".concat(We,"__item"),itemButton:"".concat(We,"__item-button"),itemMask:"".concat(We,"__item-mask"),itemMaskIcon:"".concat(We,"__item-mask--icon"),itemImage:"".concat(We,"__image"),itemImageResizable:"".concat(We,"__image--resizable"),itemLabel:"".concat(We,"__label"),itemFilename:"".concat(We,"__filename"),itemChevronIcon:"".concat(We,"__item-chevron-icon"),itemLink:"".concat(We,"__item-link"),itemLinkOverlay:"".concat(We,"__item-link-overlay"),itemLinkOverlayIcon:"".concat(We,"__item-link-overlay-icon"),itemEditIcon:"".concat(We,"__item-edit-icon"),itemAddIcon:"".concat(We,"__item-add-icon"),itemAddButton:"".concat(We,"__item-add-button"),formNode:"".concat(We,"__form-node"),fileFieldset:"".concat(We,"__file-fieldset"),fileLabel:"".concat(We,"__file-label"),fileName:"".concat(We,"__file-name"),fileInput:"".concat(We,"__file-input"),metadata:"".concat(We,"__metadata"),metadataFieldset:"".concat(We,"__metadata-fieldset"),progressBar:"".concat(We,"__progress-bar"),esriWidget:"esri-widget",esriButton:Ye,buttonDisabled:"".concat(Ye,"--disabled"),esriButtonSecondary:"".concat(Ye,"--secondary"),esriButtonTertiary:"".concat(Ye,"--tertiary"),esriButtonThird:"".concat(Ye,"--third"),esriButtonSmall:"".concat(Ye,"--small"),esriButtonHalf:"".concat(Ye,"--half"),empty:"esri-widget__content--empty",iconExternalLink:"esri-icon-link-external",iconEdit:"esri-icon-edit",iconRight:"esri-icon-right",iconLeft:"esri-icon-left",iconPlus:"esri-icon-plus"},qe=window.CSS,Ge=function(e){(0,c.Z)(n,e);var t=(0,d.Z)(n);function n(e,i){var r;return(0,l.Z)(this,n),(r=t.call(this,e,i)).displayType="auto",r.messages=null,r.messagesUnits=null,r.selectedFile=null,r.submitting=!1,r.viewModel=null,r.visibleElements=(0,o.Z)({},Ve),r._supportsImageOrientation=qe&&qe.supports&&qe.supports("image-orientation","from-image"),r._addAttachmentForm=null,r._updateAttachmentForm=null,r}return(0,u.Z)(n,[{key:"initialize",value:function(){var e=this;this.viewModel||(this.viewModel=new Be),this.addHandles([(0,m.on)((function(){var t;return null===(t=e.viewModel)||void 0===t?void 0:t.attachmentInfos}),"change",(function(){return e.scheduleRender()})),(0,m.on)((function(){var t;return null===(t=e.viewModel)||void 0===t?void 0:t.fileInfos}),"change",(function(){return e.scheduleRender()})),(0,m.YP)((function(){var t;return null===(t=e.viewModel)||void 0===t?void 0:t.mode}),(function(){return e._modeChanged()}),m.nn)])}},{key:"loadDependencies",value:function(){return(0,Re.h)({icon:function(){return i.e(7474).then(i.bind(i,87474))}})}},{key:"capabilities",get:function(){return this.viewModel.capabilities},set:function(e){this.viewModel.capabilities=e}},{key:"effectiveDisplayType",get:function(){var e=this.displayType;return e&&"auto"!==e?e:this.viewModel.supportsResizeAttachments?"preview":"list"}},{key:"graphic",get:function(){return this.viewModel.graphic},set:function(e){this.viewModel.graphic=e}},{key:"label",get:function(){var e,t;return null!==(e=null===(t=this.messages)||void 0===t?void 0:t.widgetLabel)&&void 0!==e?e:""},set:function(e){this._overrideIfSome("label",e)}},{key:"castVisibleElements",value:function(e){return(0,o.Z)((0,o.Z)({},Ve),e)}},{key:"addAttachment",value:function(){var e=this,t=this._addAttachmentForm,i=this.viewModel;return this._set("submitting",!0),this._set("error",null),i.addAttachment(t).then((function(t){return e._set("submitting",!1),e._set("error",null),i.mode="view",t})).catch((function(t){throw e._set("submitting",!1),e._set("error",new M.Z("attachments:add-attachment",e.messages.addErrorMessage,t)),t}))}},{key:"deleteAttachment",value:function(e){var t=this,i=this.viewModel;return this._set("submitting",!0),this._set("error",null),i.deleteAttachment(e).then((function(e){return t._set("submitting",!1),t._set("error",null),i.mode="view",e})).catch((function(e){throw t._set("submitting",!1),t._set("error",new M.Z("attachments:delete-attachment",t.messages.deleteErrorMessage,e)),e}))}},{key:"updateAttachment",value:function(){var e=this,t=this.viewModel,i=this._updateAttachmentForm;return this._set("submitting",!0),this._set("error",null),t.updateAttachment(i).then((function(i){return e._set("submitting",!1),e._set("error",null),t.mode="view",i})).catch((function(t){throw e._set("submitting",!1),e._set("error",new M.Z("attachments:update-attachment",e.messages.updateErrorMessage,t)),t}))}},{key:"addFile",value:function(){var e=this.viewModel.addFile(this.selectedFile,this._addAttachmentForm);return this.viewModel.mode="view",e}},{key:"updateFile",value:function(){var e=this.viewModel,t=e.updateFile(this.selectedFile,this._updateAttachmentForm,e.activeFileInfo);return e.mode="view",t}},{key:"deleteFile",value:function(e){var t,i=this.viewModel.deleteFile(e||(null===(t=this.viewModel.activeFileInfo)||void 0===t?void 0:t.file));return this.viewModel.mode="view",i}},{key:"render",value:function(){var e=this.submitting,t=this.viewModel.state;return(0,ze.u)("div",{class:this.classes(Ue.base,Ue.esriWidget)},e?this.renderProgressBar():null,"loading"===t?this.renderLoading():this.renderAttachments(),this.renderErrorMessage())}},{key:"renderErrorMessage",value:function(){var e=this.error,t=this.visibleElements;return e&&t.errorMessage?(0,ze.u)("div",{key:"error-message",class:Ue.errorMessage},e.message):null}},{key:"renderAttachments",value:function(){var e=this.viewModel,t=e.activeFileInfo,i=e.mode,n=e.activeAttachmentInfo;return"add"===i?this.renderAddForm():"edit"===i?this.renderDetailsForm(n||t):this.renderAttachmentContainer()}},{key:"renderLoading",value:function(){return(0,ze.u)("div",{class:Ue.loaderContainer,key:"loader"},(0,ze.u)("div",{class:Ue.loader}))}},{key:"renderProgressBar",value:function(){return this.visibleElements.progressBar?(0,ze.u)("div",{class:Ue.progressBar,key:"progress-bar"}):null}},{key:"renderAddForm",value:function(){var e=this.submitting,t=this.selectedFile,i=e||!t,n=this.visibleElements.cancelAddButton?(0,ze.u)("button",{type:"button",bind:this,disabled:e,onclick:this._cancelForm,class:this.classes(Ue.esriButton,Ue.esriButtonTertiary,Ue.esriButtonSmall,Ue.esriButtonHalf,e&&Ue.buttonDisabled)},this.messages.cancel):null,r=this.visibleElements.addSubmitButton?(0,ze.u)("button",{type:"submit",disabled:i,class:this.classes(Ue.esriButton,Ue.esriButtonSecondary,Ue.esriButtonSmall,Ue.esriButtonHalf,(0,a.Z)({},Ue.buttonDisabled,i))},this.messages.add):null,o=t?(0,ze.u)("span",{key:"file-name",class:Ue.fileName},t.name):null,s=(0,ze.u)("form",{bind:this,afterCreate:Ne.Yo,afterRemoved:Ne.pV,"data-node-ref":"_addAttachmentForm",onsubmit:this._submitAddAttachment},(0,ze.u)("fieldset",{class:Ue.fileFieldset},o,(0,ze.u)("label",{class:this.classes(Ue.fileLabel,Ue.esriButton,Ue.esriButtonSecondary)},t?this.messages.changeFile:this.messages.selectFile,(0,ze.u)("input",{class:Ue.fileInput,type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))),r,n);return(0,ze.u)("div",{key:"add-form-container",class:Ue.formNode},s)}},{key:"renderDetailsForm",value:function(e){var t,i,n,r,o,s,l,u,c=this,d=this.visibleElements,h=this.viewModel,f=this.selectedFile,v=this.submitting,p=h.capabilities,g=v||!f;f?(o=f.type,s=f.name,l=f.size):e&&"file"in e?(o=e.file.type,s=e.file.name,l=e.file.size):e&&"contentType"in e&&(o=e.contentType,s=e.name,l=e.size,u=e.url);var y=p.editing&&null!==(t=p.operations)&&void 0!==t&&t.delete&&d.deleteButton?(0,ze.u)("button",{key:"delete-button",type:"button",disabled:v,bind:this,onclick:function(t){return c._submitDeleteAttachment(t,e)},class:this.classes(Ue.esriButton,Ue.esriButtonSmall,Ue.esriButtonTertiary,Ue.deleteButton,(0,a.Z)({},Ue.buttonDisabled,v))},this.messages.delete):void 0,m=p.editing&&null!==(i=p.operations)&&void 0!==i&&i.update&&d.updateButton?(0,ze.u)("button",{disabled:g,key:"update-button",type:"submit",class:this.classes(Ue.esriButton,Ue.esriButtonSmall,Ue.esriButtonThird,(0,a.Z)({},Ue.buttonDisabled,g))},this.messages.update):void 0,b=this.visibleElements.cancelUpdateButton?(0,ze.u)("button",{disabled:v,key:"cancel-button",type:"button",bind:this,onclick:this._cancelForm,class:this.classes(Ue.esriButton,Ue.esriButtonSmall,Ue.esriButtonTertiary,Ue.esriButtonThird,(0,a.Z)({},Ue.buttonDisabled,v))},this.messages.cancel):void 0,_=p.editing&&null!==(n=p.operations)&&void 0!==n&&n.update?(0,ze.u)("fieldset",{key:"file",class:Ue.fileFieldset},(0,ze.u)("span",{key:"file-name",class:Ue.fileName},s),(0,ze.u)("label",{class:this.classes(Ue.fileLabel,Ue.esriButton,Ue.esriButtonSecondary)},this.messages.changeFile,(0,ze.u)("input",{class:Ue.fileInput,type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))):void 0,w=(0,ze.u)("fieldset",{key:"size",class:Ue.metadataFieldset},(0,ze.u)("label",null,function(e,t){var i=0===t?0:Math.floor(Math.log(t)/Math.log(P.Y.KILOBYTES));i=(0,Z.uZ)(i,0,I.length-1);var n=(0,T.uf)(t/Math.pow(P.Y.KILOBYTES,i),{maximumFractionDigits:2});return(0,A.gx)(e.units.bytes[I[i]],{fileSize:n})}(this.messagesUnits,null!==(r=l)&&void 0!==r?r:0))),k=(0,ze.u)("fieldset",{key:"content-type",class:Ue.metadataFieldset},(0,ze.u)("label",null,o)),x=null!=u?(0,ze.u)("a",{class:Ue.itemLink,href:u,rel:"noreferrer",target:"_blank"},this.renderImageMask(e,400),(0,ze.u)("div",{class:Ue.itemLinkOverlay},(0,ze.u)("span",{class:Ue.itemLinkOverlayIcon},(0,ze.u)("calcite-icon",{icon:"launch"})))):this.renderImageMask(e,400),C=(0,ze.u)("form",{bind:this,afterCreate:Ne.Yo,afterRemoved:Ne.pV,"data-node-ref":"_updateAttachmentForm",onsubmit:function(t){return c._submitUpdateAttachment(t,e)}},(0,ze.u)("div",{class:Ue.metadata},w,k),_,(0,ze.u)("div",{class:Ue.actions},y,b,m));return(0,ze.u)("div",{key:"edit-form-container",class:Ue.formNode},x,C)}},{key:"renderImageMask",value:function(e,t){return e?"file"in e?this.renderGenericImageMask(e.file.name,e.file.type):this.renderImageMaskForAttachment(e,t):null}},{key:"renderGenericImageMask",value:function(e,t){var i=this.viewModel.supportsResizeAttachments,n=function(e){var t=(0,Le.V)("esri/themes/base/images/files/");return e?"text/plain"===e?"".concat(t,"text-32.svg"):"application/pdf"===e?"".concat(t,"pdf-32.svg"):"text/csv"===e?"".concat(t,"csv-32.svg"):"application/gpx+xml"===e?"".concat(t,"gpx-32.svg"):"application/x-dwf"===e?"".concat(t,"cad-32.svg"):"application/postscript"===e||"application/json"===e||"text/xml"===e||"model/vrml"===e?"".concat(t,"code-32.svg"):"application/x-zip-compressed"===e||"application/x-7z-compressed"===e||"application/x-gzip"===e||"application/x-tar"===e||"application/x-gtar"===e||"application/x-bzip2"===e||"application/gzip"===e||"application/x-compress"===e||"application/x-apple-diskimage"===e||"application/x-rar-compressed"===e||"application/zip"===e?"".concat(t,"zip-32.svg"):e.includes("image/")?"".concat(t,"image-32.svg"):e.includes("audio/")?"".concat(t,"sound-32.svg"):e.includes("video/")?"".concat(t,"video-32.svg"):e.includes("msexcel")||e.includes("ms-excel")||e.includes("spreadsheetml")?"".concat(t,"excel-32.svg"):e.includes("msword")||e.includes("ms-word")||e.includes("wordprocessingml")?"".concat(t,"word-32.svg"):e.includes("powerpoint")||e.includes("presentationml")?"".concat(t,"report-32.svg"):"".concat(t,"generic-32.svg"):"".concat(t,"generic-32.svg")}(t),r=(0,a.Z)({},Ue.itemImageResizable,i);return(0,ze.u)("div",{key:n,class:this.classes(Ue.itemMaskIcon,Ue.itemMask)},(0,ze.u)("img",{title:e,alt:e,src:n,class:this.classes(r,Ue.itemImage)}))}},{key:"renderImageMaskForAttachment",value:function(e,t){var i=this.viewModel.supportsResizeAttachments;if(!e)return null;var n=e.contentType,r=e.name,o=e.url;if(!i||!je(n))return this.renderGenericImageMask(r,n);var s=this._getCSSTransform(e),l=s?{transform:s,"image-orientation":"none"}:{},u="".concat(o).concat(null!==o&&void 0!==o&&o.includes("?")?"&":"?","w=").concat(t),c=(0,a.Z)({},Ue.itemImageResizable,i);return(0,ze.u)("div",{key:u,class:this.classes(Ue.itemMask)},(0,ze.u)("img",{styles:l,alt:r,title:r,src:u,class:this.classes(c,Ue.itemImage)}))}},{key:"renderFile",value:function(e){var t=this,i=e.file;return(0,ze.u)("li",{class:Ue.item,key:i},(0,ze.u)("button",{key:"details-button",bind:this,class:Ue.itemButton,title:this.messages.attachmentDetails,"aria-label":this.messages.attachmentDetails,onclick:function(){return t._startEditFile(e)},type:"button"},this.renderImageMask(e),(0,ze.u)("label",{class:Ue.itemLabel},(0,ze.u)("span",{class:Ue.itemFilename},i.name||this.messages.noTitle),(0,ze.u)("span",{"aria-hidden":"true",class:this.classes(Ue.itemChevronIcon,(0,Ne.dZ)(this.container)?Ue.iconLeft:Ue.iconRight)}))))}},{key:"renderAttachmentInfo",value:function(e){var t=this,i=e.attachmentInfo,n=e.displayType,r=this.viewModel,a=this.effectiveDisplayType,o=r.capabilities,s=r.supportsResizeAttachments,l=i.contentType,u=i.name,c=i.url,d=this.renderImageMask(i,"list"===n?48:400),h=o.editing?(0,ze.u)("span",{"aria-hidden":"true",class:this.classes(Ue.itemChevronIcon,(0,Ne.dZ)(this.container)?Ue.iconLeft:Ue.iconRight)}):null,f=[d,"preview"===a&&s&&je(l)?null:(0,ze.u)("label",{class:Ue.itemLabel},(0,ze.u)("span",{class:Ue.itemFilename},u||this.messages.noTitle),h)],v=o.editing?(0,ze.u)("button",{key:"details-button",bind:this,class:Ue.itemButton,title:this.messages.attachmentDetails,"aria-label":this.messages.attachmentDetails,"data-attachment-info-id":i.id,onclick:function(){return t._startEditAttachment(i)},type:"button"},f):(0,ze.u)("a",{key:"details-link",class:Ue.itemButton,href:null!==c&&void 0!==c?c:void 0,target:"_blank"},f);return(0,ze.u)("li",{class:Ue.item,key:i},v)}},{key:"renderAttachmentContainer",value:function(){var e,t,i=this,n=this.effectiveDisplayType,r=this.viewModel,o=this.visibleElements,s=r.attachmentInfos,l=r.capabilities,u=r.fileInfos,c=!(null===s||void 0===s||!s.length),d=!(null===u||void 0===u||!u.length),h=(e={},(0,a.Z)(e,Ue.containerList,"preview"!==n),(0,a.Z)(e,Ue.containerPreview,"preview"===n),e),f=l.editing&&null!==(t=l.operations)&&void 0!==t&&t.add&&o.addButton?(0,ze.u)("button",{bind:this,onclick:function(){return i._startAddAttachment()},class:this.classes(Ue.esriButton,Ue.esriButtonTertiary,Ue.addAttachmentButton),type:"button"},(0,ze.u)("span",{"aria-hidden":"true",class:this.classes(Ue.itemAddIcon,Ue.iconPlus)}),this.messages.add):void 0,v=c?(0,ze.u)("ul",{key:"attachments-list",class:Ue.items},s.toArray().map((function(e){return i.renderAttachmentInfo({attachmentInfo:e,displayType:n})}))):void 0,p=d?(0,ze.u)("ul",{key:"file-list",class:Ue.items},u.toArray().map((function(e){return i.renderFile(e)}))):void 0,g=d||c?void 0:(0,ze.u)("div",{class:Ue.empty},this.messages.noAttachments);return(0,ze.u)("div",{key:"attachments-container",class:this.classes(Ue.container,h)},v,p,g,f)}},{key:"_modeChanged",value:function(){this._set("error",null),this._set("selectedFile",null)}},{key:"_handleFileInputChange",value:function(e){var t=e.target,i=t&&t.files&&t.files.item(0);this._set("selectedFile",i)}},{key:"_submitDeleteAttachment",value:function(e,t){e.preventDefault(),t&&("file"in t?this.deleteFile(t.file):t&&this.deleteAttachment(t))}},{key:"_submitAddAttachment",value:function(e){e.preventDefault(),this.viewModel.filesEnabled?this.addFile():this.addAttachment()}},{key:"_submitUpdateAttachment",value:function(e,t){e.preventDefault(),t&&"file"in t?this.updateFile():this.updateAttachment()}},{key:"_startEditAttachment",value:function(e){var t=this.viewModel;t.activeFileInfo=null,t.activeAttachmentInfo=e,t.mode="edit"}},{key:"_startEditFile",value:function(e){var t=this.viewModel;t.activeAttachmentInfo=null,t.activeFileInfo=e,t.mode="edit"}},{key:"_startAddAttachment",value:function(){this.viewModel.mode="add"}},{key:"_cancelForm",value:function(e){e.preventDefault(),this.viewModel.mode="view"}},{key:"_getCSSTransform",value:function(e){var t=e.orientationInfo;return!this._supportsImageOrientation&&t?[t.rotation?"rotate(".concat(t.rotation,"deg)"):"",t.mirrored?"scaleX(-1)":""].join(" "):""}}]),n}(C.Z);(0,h._)([(0,_.Cb)()],Ge.prototype,"capabilities",null),(0,h._)([(0,_.Cb)()],Ge.prototype,"displayType",void 0),(0,h._)([(0,_.Cb)({readOnly:!0})],Ge.prototype,"effectiveDisplayType",null),(0,h._)([(0,_.Cb)()],Ge.prototype,"graphic",null),(0,h._)([(0,_.Cb)()],Ge.prototype,"label",null),(0,h._)([(0,_.Cb)(),(0,He.H)("esri/widgets/Attachments/t9n/Attachments")],Ge.prototype,"messages",void 0),(0,h._)([(0,_.Cb)(),(0,He.H)("esri/core/t9n/Units")],Ge.prototype,"messagesUnits",void 0),(0,h._)([(0,_.Cb)({readOnly:!0})],Ge.prototype,"selectedFile",void 0),(0,h._)([(0,_.Cb)({readOnly:!0})],Ge.prototype,"submitting",void 0),(0,h._)([(0,_.Cb)({readOnly:!0})],Ge.prototype,"error",void 0),(0,h._)([(0,_.Cb)({type:Be})],Ge.prototype,"viewModel",void 0),(0,h._)([(0,_.Cb)()],Ge.prototype,"visibleElements",void 0),(0,h._)([(0,w.p)("visibleElements")],Ge.prototype,"castVisibleElements",null);var Xe=Ge=(0,h._)([(0,x.j)("esri.widgets.Attachments")],Ge),Ke=function(e){(0,c.Z)(i,e);var t=(0,d.Z)(i);function i(e){var n;return(0,l.Z)(this,i),(n=t.call(this,e)).description=null,n.title=null,n}return(0,u.Z)(i)}(Be);(0,h._)([(0,_.Cb)()],Ke.prototype,"description",void 0),(0,h._)([(0,_.Cb)()],Ke.prototype,"title",void 0);var $e=Ke=(0,h._)([(0,x.j)("esri.widgets.Feature.FeatureAttachments.FeatureAttachmentsViewModel")],Ke),Qe=i(96919),Je="esri-feature-element-info",et={base:Je,title:"".concat(Je,"__title"),description:"".concat(Je,"__description")},tt=function(e){(0,c.Z)(i,e);var t=(0,d.Z)(i);function i(e,n){var r;return(0,l.Z)(this,i),(r=t.call(this,e,n)).description=null,r.headingLevel=2,r.title=null,r}return(0,u.Z)(i,[{key:"render",value:function(){return(0,ze.u)("div",{class:et.base},this.renderTitle(),this.renderDescription())}},{key:"renderTitle",value:function(){var e=this.title;return e?(0,ze.u)(Qe.X6,{level:this.headingLevel,class:et.title},e):null}},{key:"renderDescription",value:function(){var e=this.description;return e?(0,ze.u)("div",{key:"description",class:et.description},e):null}}]),i}(C.Z);(0,h._)([(0,_.Cb)()],tt.prototype,"description",void 0),(0,h._)([(0,_.Cb)()],tt.prototype,"headingLevel",void 0),(0,h._)([(0,_.Cb)()],tt.prototype,"title",void 0);var it=tt=(0,h._)([(0,x.j)("esri.widgets.Feature.support.FeatureElementInfo")],tt),nt="esri-feature-attachments",rt=function(e){(0,c.Z)(i,e);var t=(0,d.Z)(i);function i(e,n){var r;return(0,l.Z)(this,i),(r=t.call(this,e,n))._featureElementInfo=null,r.attachmentsWidget=new Xe,r.headingLevel=2,r.viewModel=new $e,r}return(0,u.Z)(i,[{key:"initialize",value:function(){var e=this;this._featureElementInfo=new it,this.addHandles([(0,m.YP)((function(){var t,i;return[null===(t=e.viewModel)||void 0===t?void 0:t.description,null===(i=e.viewModel)||void 0===i?void 0:i.title,e.headingLevel]}),(function(){return e._setupFeatureElementInfo()}),m.nn),(0,m.YP)((function(){return e.viewModel}),(function(t){return e.attachmentsWidget.viewModel=t}),m.nn)])}},{key:"destroy",value:function(){var e;this.attachmentsWidget.viewModel=null,this.attachmentsWidget.destroy(),null===(e=this._featureElementInfo)||void 0===e||e.destroy()}},{key:"description",get:function(){return this.viewModel.description},set:function(e){this.viewModel.description=e}},{key:"displayType",get:function(){return this.attachmentsWidget.displayType},set:function(e){this.attachmentsWidget.displayType=e}},{key:"graphic",get:function(){return this.viewModel.graphic},set:function(e){this.viewModel.graphic=e}},{key:"title",get:function(){return this.viewModel.title},set:function(e){this.viewModel.title=e}},{key:"render",value:function(){var e,t=this.attachmentsWidget;return(0,ze.u)("div",{class:nt},null===(e=this._featureElementInfo)||void 0===e?void 0:e.render(),null===t||void 0===t?void 0:t.render())}},{key:"_setupFeatureElementInfo",value:function(){var e,t=this.description,i=this.title,n=this.headingLevel;null===(e=this._featureElementInfo)||void 0===e||e.set({description:t,title:i,headingLevel:n})}}]),i}(C.Z);(0,h._)([(0,_.Cb)({readOnly:!0})],rt.prototype,"attachmentsWidget",void 0),(0,h._)([(0,_.Cb)()],rt.prototype,"description",null),(0,h._)([(0,_.Cb)()],rt.prototype,"displayType",null),(0,h._)([(0,_.Cb)()],rt.prototype,"graphic",null),(0,h._)([(0,_.Cb)()],rt.prototype,"headingLevel",void 0),(0,h._)([(0,_.Cb)()],rt.prototype,"title",null),(0,h._)([(0,_.Cb)({type:$e})],rt.prototype,"viewModel",void 0);var at=rt=(0,h._)([(0,x.j)("esri.widgets.Feature.FeatureAttachments")],rt),ot=i(41691),st=function(e){(0,c.Z)(i,e);var t=(0,d.Z)(i);function i(e){var n;return(0,l.Z)(this,i),(n=t.call(this,e))._loadingPromise=null,n.created=null,n.creator=null,n.destroyer=null,n.graphic=null,n.handles.add((0,m.YP)((function(){return n.creator}),(function(e){n._destroyContent(),n._createContent(e)}),m.nn)),n}return(0,u.Z)(i,[{key:"destroy",value:function(){this._destroyContent()}},{key:"state",get:function(){return this._loadingPromise?"loading":"ready"}},{key:"_destroyContent",value:function(){var e=this.created,t=this.graphic,i=this.destroyer;e&&t&&(J(i,{graphic:t}).catch((function(){return null})),this._set("created",null))}},{key:"_createContent",value:function(){var e=(0,r.Z)((0,n.Z)().mark((function e(t){var i,r,a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((i=this.graphic)&&t){e.next=3;break}return e.abrupt("return");case 3:return r=J(t,{graphic:i}).catch((function(){return null})),this._loadingPromise=r,this.notifyChange("state"),e.next=7,r;case 7:a=e.sent,r===this._loadingPromise&&(this._loadingPromise=null,this.notifyChange("state"),this._set("created",a));case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),i}((0,ot.p)(D.Z));(0,h._)([(0,_.Cb)({readOnly:!0})],st.prototype,"created",void 0),(0,h._)([(0,_.Cb)()],st.prototype,"creator",void 0),(0,h._)([(0,_.Cb)()],st.prototype,"destroyer",void 0),(0,h._)([(0,_.Cb)({type:O.Z})],st.prototype,"graphic",void 0),(0,h._)([(0,_.Cb)({readOnly:!0})],st.prototype,"state",null);var lt=st=(0,h._)([(0,x.j)("esri.widgets.Feature.FeatureContent.FeatureContentViewModel")],st),ut=i(53963),ct="esri-feature-content",dt={base:ct,loaderContainer:"".concat(ct,"__loader-container"),loader:"".concat(ct,"__loader")},ht=function(e){(0,c.Z)(i,e);var t=(0,d.Z)(i);function i(e,n){var r;return(0,l.Z)(this,i),(r=t.call(this,e,n)).viewModel=null,r._addTargetToAnchors=function(e){Array.from(e.querySelectorAll("a")).forEach((function(e){te(e.href)&&!e.hasAttribute("target")&&e.setAttribute("target","_blank")}))},r}return(0,u.Z)(i,[{key:"creator",get:function(){var e;return null===(e=this.viewModel)||void 0===e?void 0:e.creator},set:function(e){this.viewModel&&(this.viewModel.creator=e)}},{key:"graphic",get:function(){var e;return null===(e=this.viewModel)||void 0===e?void 0:e.graphic},set:function(e){this.viewModel&&(this.viewModel.graphic=e)}},{key:"renderLoading",value:function(){return(0,ze.u)("div",{class:dt.loaderContainer,key:"loader"},(0,ze.u)("div",{class:dt.loader}))}},{key:"renderCreated",value:function(){var e,t=null===(e=this.viewModel)||void 0===e?void 0:e.created;return t?t instanceof HTMLElement?(0,ze.u)("div",{key:t,bind:t,afterCreate:this._attachToNode}):(0,ut.Qd)(t)?(0,ze.u)("div",{key:t},!t.destroyed&&t.render()):(0,ze.u)("div",{key:t,innerHTML:t,afterCreate:this._addTargetToAnchors}):null}},{key:"render",value:function(){var e,t=null===(e=this.viewModel)||void 0===e?void 0:e.state;return(0,ze.u)("div",{class:dt.base},"loading"===t?this.renderLoading():this.renderCreated())}},{key:"_attachToNode",value:function(e){e.appendChild(this)}}]),i}(C.Z);(0,h._)([(0,_.Cb)()],ht.prototype,"creator",null),(0,h._)([(0,_.Cb)()],ht.prototype,"graphic",null),(0,h._)([(0,_.Cb)({type:lt})],ht.prototype,"viewModel",void 0);var ft=ht=(0,h._)([(0,x.j)("esri.widgets.Feature.FeatureContent")],ht),vt=i(89860),pt=i(16698),gt=function(e){(0,c.Z)(i,e);var t=(0,d.Z)(i);function i(e){var n;return(0,l.Z)(this,i),(n=t.call(this,e)).attributes=null,n.expressionInfos=null,n.description=null,n.fieldInfos=null,n.title=null,n}return(0,u.Z)(i,[{key:"formattedFieldInfos",get:function(){var e=this.expressionInfos,t=this.fieldInfos,i=[];return null!==t&&void 0!==t&&t.forEach((function(t){if(!t.hasOwnProperty("visible")||t.visible){var n=t.clone();n.label=ne(n,e),i.push(n)}})),i}}]),i}(D.Z);(0,h._)([(0,_.Cb)()],gt.prototype,"attributes",void 0),(0,h._)([(0,_.Cb)({type:[vt.Z]})],gt.prototype,"expressionInfos",void 0),(0,h._)([(0,_.Cb)()],gt.prototype,"description",void 0),(0,h._)([(0,_.Cb)({type:[pt.Z]})],gt.prototype,"fieldInfos",void 0),(0,h._)([(0,_.Cb)({readOnly:!0})],gt.prototype,"formattedFieldInfos",null),(0,h._)([(0,_.Cb)()],gt.prototype,"title",void 0);var yt=gt=(0,h._)([(0,x.j)("esri.widgets.Feature.FeatureFields.FeatureFieldsViewModel")],gt),mt=[{pattern:/^\s*(https?:\/\/([^\s]+))\s*$/i,target:"_blank",label:"{messages.view}"},{pattern:/^\s*(tel:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(mailto:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(arcgis-appstudio-player:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"App Studio Player"},{pattern:/^\s*(arcgis-collector:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Collector"},{pattern:/^\s*(arcgis-explorer:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Explorer"},{pattern:/^\s*(arcgis-navigator:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Navigator"},{pattern:/^\s*(arcgis-survey123:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Survey123"},{pattern:/^\s*(arcgis-trek2there:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Trek2There"},{pattern:/^\s*(arcgis-workforce:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Workforce"},{pattern:/^\s*(iform:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"iForm"},{pattern:/^\s*(flow:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"FlowFinity"},{pattern:/^\s*(lfmobile:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Laserfische"},{pattern:/^\s*(mspbi:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Microsoft Power Bi"}];function bt(e,t){if("string"!=typeof t||!t)return t;var i=function(e){var t=null;return mt.some((function(i){return i.pattern.test(e)&&(t=i),!!t})),t}(t);if(!i)return t;var n=t.match(i.pattern),r=n&&n[2],a=(0,A.gx)((0,A.gx)(i.label,{messages:e,hierPart:r}),{appName:i.appName}),o=i.target?' target="'.concat(i.target,'"'):"",s="_blank"===i.target?' rel="noreferrer"':"";return t.replace(i.pattern,"<a".concat(o,' href="$1"').concat(s,">").concat(a,"</a>"))}var _t="esri-feature-fields",wt={base:_t,fieldHeader:"".concat(_t,"__field-header"),fieldData:"".concat(_t,"__field-data"),fieldDataDate:"".concat(_t,"__field-data--date"),esriTable:"esri-widget__table"},kt=function(e){(0,c.Z)(i,e);var t=(0,d.Z)(i);function i(e,n){var r;return(0,l.Z)(this,i),(r=t.call(this,e,n))._featureElementInfo=null,r.viewModel=new yt,r.messages=null,r.messagesURIUtils=null,r}return(0,u.Z)(i,[{key:"initialize",value:function(){var e=this;this._featureElementInfo=new it,this.addHandles((0,m.YP)((function(){var t,i;return[null===(t=e.viewModel)||void 0===t?void 0:t.description,null===(i=e.viewModel)||void 0===i?void 0:i.title]}),(function(){return e._setupFeatureElementInfo()}),m.nn))}},{key:"destroy",value:function(){var e;null===(e=this._featureElementInfo)||void 0===e||e.destroy()}},{key:"attributes",get:function(){return this.viewModel.attributes},set:function(e){this.viewModel.attributes=e}},{key:"description",get:function(){return this.viewModel.description},set:function(e){this.viewModel.description=e}},{key:"expressionInfos",get:function(){return this.viewModel.expressionInfos},set:function(e){this.viewModel.expressionInfos=e}},{key:"fieldInfos",get:function(){return this.viewModel.fieldInfos},set:function(e){this.viewModel.fieldInfos=e}},{key:"title",get:function(){return this.viewModel.title},set:function(e){this.viewModel.title=e}},{key:"renderFieldInfo",value:function(e,t){var i=this.viewModel.attributes,n=e.fieldName,r=e.label||n,o=i?null==i[n]?"":i[n]:"",s=!(!e.format||!e.format.dateFormat),l="number"!=typeof o||s?bt(this.messagesURIUtils,o):this._forceLTR(o),u=(0,a.Z)({},wt.fieldDataDate,s);return(0,ze.u)("tr",{key:"fields-element-info-row-".concat(n,"-").concat(t)},(0,ze.u)("th",{key:"fields-element-info-row-header-".concat(n,"-").concat(t),class:wt.fieldHeader,innerHTML:r}),(0,ze.u)("td",{key:"fields-element-info-row-data-".concat(n,"-").concat(t),class:this.classes(wt.fieldData,u),innerHTML:l}))}},{key:"renderFields",value:function(){var e=this,t=this.viewModel.formattedFieldInfos;return null!==t&&void 0!==t&&t.length?(0,ze.u)("table",{class:wt.esriTable,summary:this.messages.fieldsSummary},(0,ze.u)("tbody",null,t.map((function(t,i){return e.renderFieldInfo(t,i)})))):null}},{key:"render",value:function(){var e;return(0,ze.u)("div",{class:wt.base},null===(e=this._featureElementInfo)||void 0===e?void 0:e.render(),this.renderFields())}},{key:"_setupFeatureElementInfo",value:function(){var e,t=this.description,i=this.title;null===(e=this._featureElementInfo)||void 0===e||e.set({description:t,title:i})}},{key:"_forceLTR",value:function(e){return"&lrm;".concat(e)}}]),i}(C.Z);(0,h._)([(0,_.Cb)()],kt.prototype,"attributes",null),(0,h._)([(0,_.Cb)()],kt.prototype,"description",null),(0,h._)([(0,_.Cb)()],kt.prototype,"expressionInfos",null),(0,h._)([(0,_.Cb)()],kt.prototype,"fieldInfos",null),(0,h._)([(0,_.Cb)()],kt.prototype,"title",null),(0,h._)([(0,_.Cb)({type:yt,nonNullable:!0})],kt.prototype,"viewModel",void 0),(0,h._)([(0,_.Cb)(),(0,He.H)("esri/widgets/Feature/t9n/Feature")],kt.prototype,"messages",void 0),(0,h._)([(0,_.Cb)(),(0,He.H)("esri/widgets/support/t9n/uriUtils")],kt.prototype,"messagesURIUtils",void 0);var xt=kt=(0,h._)([(0,x.j)("esri.widgets.Feature.FeatureFields")],kt),Ct=i(97326),Mt=i(99388),Pt=i(60260),Zt=i(37762),At=i(76200),Tt=i(66978),It=(i(64020),i(77946)),Ot=(i(42265),i(19545),i(35995),i(92975),i(83406),i(53866),i(32238),i(77577),i(585)),Dt=(i(80885),i(29909),i(91340),i(78084),i(49818),i(21149)),Ft=(i(59486),i(99086)),Et=(i(54307),i(33997)),St=y.Z.getLogger("esri.widgets.Feature.support.relatedFeatureUtils"),Bt=new Map;function Lt(e){if(!Ae(e))return null;var t=e.split("/").slice(1),i=(0,s.Z)(t,2);return{layerId:i[0],fieldName:i[1]}}function jt(e){var t=e.originRelationship,i=e.relationships,n=e.layerId,r=null;return i&&i.some((function(e){return"".concat(e.relatedTableId)===n&&e.id===(null===t||void 0===t?void 0:t.id)&&(r=e),!!r})),r}function Rt(e,t){var i=t.toLowerCase();for(var n in e)if(n.toLowerCase()===i)return e[n];return null}function Nt(e,t){var i=function(e,t){if(!t.relationships)return null;var i=null;return t.relationships.some((function(t){return t.id===parseInt(e,10)&&(i=t,!0)})),i}(e,t);if(i)return{url:"".concat(t.url,"/").concat(i.relatedTableId),sourceSpatialReference:t.spatialReference,relation:i,relatedFields:[],outStatistics:[]}}function Ht(e,t){if(t&&e){var i=e.features,n=e.statsFeatures,r=i&&i.value;t.relatedFeatures=r?r.features:[];var a=n&&n.value;t.relatedStatsFeatures=a?a.features:[]}}function zt(e,t,i,n){var r,a,o=new Ft.default;return o.outFields=["*"],o.relationshipId="number"==typeof t.id?t.id:parseInt(t.id,10),o.objectIds=[e.attributes[i.objectIdField]],null!==(r=null===(a=i.queryRelatedFeatures)||void 0===a?void 0:a.call(i,o,n))&&void 0!==r?r:Promise.resolve({})}function Vt(e,t,i){for(var n=0,r=[];n<t.length;)r.push("".concat(e," IN (").concat(t.slice(n,i+n),")")),n+=i;return r.join(" OR ")}function Wt(){return Wt=(0,r.Z)((0,n.Z)().mark((function e(t,i,r,a){var o,s,l,u,c,d,h,f,v,p,g,y,m,b,_,w,k,x,C;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=r.layerId.toString(),s=i.layerInfo,l=i.relation,u=i.relatedFields,c=i.outStatistics,d=i.url,h=i.sourceSpatialReference,s&&l){e.next=3;break}return e.abrupt("return",null);case 3:if(null===(f=jt({originRelationship:l,relationships:s.relationships,layerId:o}))||void 0===f||!f.relationshipTableId||!f.keyFieldInRelationshipTable){e.next=17;break}return e.next=7,zt(t,f,r,a);case 7:if(e.t0=t.attributes[r.objectIdField],v=e.sent[e.t0]){e.next=11;break}return e.abrupt("return",null);case 11:if(p=v.features.map((function(e){return e.attributes[s.objectIdField]})),null===c||void 0===c||!c.length||!s.supportsStatistics){e.next=17;break}return(g=new Dt.Z).where=Vt(s.objectIdField,p,1e3),g.outFields=u,g.outStatistics=c,g.sourceSpatialReference=h,y={features:Promise.resolve(v),statsFeatures:(0,It.e)(d,g)},e.abrupt("return",(0,Tt.as)(y));case 17:if(!(m=null===f||void 0===f?void 0:f.keyField)){e.next=21;break}return b=(0,L.H7)(qt(s.fields,m)),_=Rt(t.attributes,l.keyField),w=b?"".concat(m,"=").concat(_):"".concat(m,"='").concat(_,"'"),k=(0,It.e)(d,new Dt.Z({where:w,outFields:i.relatedFields,sourceSpatialReference:h}),a),x=i.outStatistics&&i.outStatistics.length>0&&s.supportsStatistics?(0,It.e)(d,new Dt.Z({where:w,outFields:i.relatedFields,outStatistics:i.outStatistics,sourceSpatialReference:h}),a):null,C={features:k},e.abrupt("return",(x&&(C.statsFeatures=x),(0,Tt.as)(C)));case 21:return e.abrupt("return",null);case 22:case"end":return e.stop()}}),e)}))),Wt.apply(this,arguments)}function Yt(e,t){var i=e.relatedInfos,n=e.layer,r={};return i.forEach((function(e,t){var i=e.relation;if(!i){var a=new M.Z("relation-required","A relation is required on a layer to retrieve related records.");throw St.error(a),a}var o=i.relatedTableId;if("number"!=typeof o){var s=new M.Z("A related table ID is required on a layer to retrieve related records.");throw St.error(s),s}var l="".concat(n.url,"/").concat(o),u=Bt.get(l),c=null!==u&&void 0!==u?u:function(e,t){return(0,At.default)(e,{query:{f:"json"},signal:t&&t.signal})}(l);u||Bt.set(l,c),r[t]=c})),(0,Tt.Hl)((0,Tt.as)(r),t)}function Ut(e,t){var i=e.graphic,n=e.relatedInfos,r=e.layer,a={};return n.forEach((function(e,n){e.layerInfo&&(a[n]=function(e,t,i,n){return Wt.apply(this,arguments)}(i,e,r,t))})),(0,Tt.as)(a)}function qt(e,t){if(null!=e){t=t.toLowerCase();var i,n=(0,Zt.Z)(e);try{for(n.s();!(i=n.n()).done;){var r=i.value;if(r&&r.name.toLowerCase()===t)return r}}catch(a){n.e(a)}finally{n.f()}}return null}var Gt={chartAnimation:!0},Xt=function(e){(0,c.Z)(i,e);var t=(0,d.Z)(i);function i(e){var n;return(0,l.Z)(this,i),(n=t.call(this,e)).abilities=(0,o.Z)({},Gt),n.activeMediaInfoIndex=0,n.attributes=null,n.description=null,n.fieldInfoMap=null,n.formattedAttributes=null,n.expressionAttributes=null,n.isAggregate=!1,n.layer=null,n.mediaInfos=null,n.popupTemplate=null,n.relatedInfos=null,n.title=null,n}return(0,u.Z)(i,[{key:"castAbilities",value:function(e){return(0,o.Z)((0,o.Z)({},Gt),e)}},{key:"activeMediaInfo",get:function(){return this.formattedMediaInfos[this.activeMediaInfoIndex]||null}},{key:"formattedMediaInfos",get:function(){return this._formatMediaInfos()||[]}},{key:"formattedMediaInfoCount",get:function(){return this.formattedMediaInfos.length}},{key:"setActiveMedia",value:function(e){this._setContentElementMedia(e)}},{key:"next",value:function(){this._pageContentElementMedia(1)}},{key:"previous",value:function(){this._pageContentElementMedia(-1)}},{key:"_setContentElementMedia",value:function(e){var t=this.formattedMediaInfoCount,i=(e+t)%t;this.activeMediaInfoIndex=i}},{key:"_pageContentElementMedia",value:function(e){var t=this.activeMediaInfoIndex+e;this._setContentElementMedia(t)}},{key:"_formatMediaInfos",value:function(){var e,t,i,n,r,a=this,o=this.mediaInfos,s=this.layer,l=null!==(e=this.attributes)&&void 0!==e?e:{},u=null!==(t=this.formattedAttributes)&&void 0!==t?t:{},c=null!==(i=this.expressionAttributes)&&void 0!==i?i:{},d=null!==(n=this.fieldInfoMap)&&void 0!==n?n:new Map;return null!==(r=null===o||void 0===o?void 0:o.map((function(e){var t=null===e||void 0===e?void 0:e.clone();if(!t)return null;if(t.title=se({attributes:l,fieldInfoMap:d,globalAttributes:u,expressionAttributes:c,layer:s,text:t.title}),t.caption=se({attributes:l,fieldInfoMap:d,globalAttributes:u,expressionAttributes:c,layer:s,text:t.caption}),t.altText=se({attributes:l,fieldInfoMap:d,globalAttributes:u,expressionAttributes:c,layer:s,text:t.altText}),"image"===t.type){var i=t.value;return a._setImageValue({value:i,formattedAttributes:u,layer:s}),t.value.sourceURL?t:void 0}if("pie-chart"===t.type||"line-chart"===t.type||"column-chart"===t.type||"bar-chart"===t.type){var n=t.value;return a._setChartValue({value:n,chartType:t.type,attributes:l,formattedAttributes:u,layer:s,expressionAttributes:c}),t}return null})).filter(k.pC))&&void 0!==r?r:[]}},{key:"_setImageValue",value:function(e){var t,i=null!==(t=this.fieldInfoMap)&&void 0!==t?t:new Map,n=e.value,r=e.formattedAttributes,a=e.layer,o=n.linkURL,s=n.sourceURL;if(s){var l=de(s,a);n.sourceURL=le({formattedAttributes:r,template:l,fieldInfoMap:i})}if(o){var u=de(o,a);n.linkURL=le({formattedAttributes:r,template:u,fieldInfoMap:i})}}},{key:"_setChartValue",value:function(e){var t,i=this,n=e.value,r=e.attributes,a=e.formattedAttributes,o=e.chartType,s=e.layer,l=e.expressionAttributes,u=this.popupTemplate,c=this.relatedInfos,d=n.fields,h=n.normalizeField,f=s;if(n.fields=function(e,t){return e&&e.map((function(e){return re(e,t)}))}(d,f),h&&(n.normalizeField=re(h,f)),d.some((function(e){return!!(null!=a[e]||Ae(e)&&null!==c&&void 0!==c&&c.size)}))){var v=null!==(t=null===u||void 0===u?void 0:u.fieldInfos)&&void 0!==t?t:[];d.forEach((function(e){if(Ae(e))n.series=[].concat((0,S.Z)(n.series),(0,S.Z)(i._getRelatedChartInfos({fieldInfos:v,fieldName:e,formattedAttributes:a,chartType:o,value:n})));else{var t=i._getChartOption({value:n,attributes:r,chartType:o,formattedAttributes:a,expressionAttributes:l,fieldName:e,fieldInfos:v});n.series.push(t)}}))}}},{key:"_getRelatedChartInfos",value:function(e){var t,i=this,n=e.fieldInfos,r=e.fieldName,a=e.formattedAttributes,o=e.chartType,s=e.value,l=[],u=Lt(r),c=u&&(null===(t=this.relatedInfos)||void 0===t?void 0:t.get(u.layerId.toString()));if(!c)return l;var d=c.relatedFeatures,h=c.relation;if(!h||!d)return l;var f=h.cardinality;return d.forEach((function(e){var t=e.attributes;t&&Object.keys(t).forEach((function(e){e===u.fieldName&&l.push(i._getChartOption({value:s,attributes:t,formattedAttributes:a,fieldName:r,chartType:o,relatedFieldName:e,hasMultipleRelatedFeatures:(null===d||void 0===d?void 0:d.length)>1,fieldInfos:n}))}))})),"one-to-many"===f||"many-to-many"===f?l:[l[0]]}},{key:"_getTooltip",value:function(e){var t=e.label,i=e.value;return"pie-chart"===e.chartType?"".concat(t):"".concat(t,": ").concat(i)}},{key:"_getChartOption",value:function(e){var t,i,n=e.value,r=e.attributes,a=e.formattedAttributes,o=e.expressionAttributes,s=e.fieldName,l=e.relatedFieldName,u=e.fieldInfos,c=e.chartType,d=e.hasMultipleRelatedFeatures,h=this.layer,f=null!==(t=this.fieldInfoMap)&&void 0!==t?t:new Map,v=n.normalizeField,p=n.tooltipField,g=v?Ae(v)?r[Lt(v).fieldName]:r[v]:null,y=ie(s)&&o&&void 0!==o[s]?o[s]:l&&void 0!==r[l]?r[l]:void 0!==r[s]?r[s]:a[s],m=new Pt.Z({fieldName:s,value:void 0===y?null:y&&g?y/g:y});if(Ae(s)){var b,_,w,k,x,C=f.get(s.toLowerCase()),M=p&&f.get(p.toLowerCase()),P=null!==(b=null===C||void 0===C?void 0:C.fieldName)&&void 0!==b?b:s,Z=d&&p?Lt(p).fieldName:null!==(_=null===M||void 0===M?void 0:M.fieldName)&&void 0!==_?_:p,A=d&&Z?r[Z]:null!==(w=null!==(k=null!==(x=a[Z])&&void 0!==x?x:null===C||void 0===C?void 0:C.label)&&void 0!==k?k:null===C||void 0===C?void 0:C.fieldName)&&void 0!==w?w:l,T=d&&l?r[l]:a[P];return m.tooltip=this._getTooltip({label:A,value:T,chartType:c}),m}var I=ge(u,s),O=re(s,h),D=p&&void 0!==a[p]?a[p]:ne(I||new pt.Z({fieldName:O}),null===(i=this.popupTemplate)||void 0===i?void 0:i.expressionInfos),F=a[O];return m.tooltip=this._getTooltip({label:D,value:F,chartType:c}),m}}]),i}(D.Z);(0,h._)([(0,_.Cb)()],Xt.prototype,"abilities",void 0),(0,h._)([(0,w.p)("abilities")],Xt.prototype,"castAbilities",null),(0,h._)([(0,_.Cb)()],Xt.prototype,"activeMediaInfoIndex",void 0),(0,h._)([(0,_.Cb)({readOnly:!0})],Xt.prototype,"activeMediaInfo",null),(0,h._)([(0,_.Cb)()],Xt.prototype,"attributes",void 0),(0,h._)([(0,_.Cb)()],Xt.prototype,"description",void 0),(0,h._)([(0,_.Cb)()],Xt.prototype,"fieldInfoMap",void 0),(0,h._)([(0,_.Cb)()],Xt.prototype,"formattedAttributes",void 0),(0,h._)([(0,_.Cb)()],Xt.prototype,"expressionAttributes",void 0),(0,h._)([(0,_.Cb)({readOnly:!0})],Xt.prototype,"formattedMediaInfos",null),(0,h._)([(0,_.Cb)()],Xt.prototype,"isAggregate",void 0),(0,h._)([(0,_.Cb)()],Xt.prototype,"layer",void 0),(0,h._)([(0,_.Cb)({readOnly:!0})],Xt.prototype,"formattedMediaInfoCount",null),(0,h._)([(0,_.Cb)()],Xt.prototype,"mediaInfos",void 0),(0,h._)([(0,_.Cb)()],Xt.prototype,"popupTemplate",void 0),(0,h._)([(0,_.Cb)()],Xt.prototype,"relatedInfos",void 0),(0,h._)([(0,_.Cb)()],Xt.prototype,"title",void 0);var Kt=Xt=(0,h._)([(0,x.j)("esri.widgets.Feature.FeatureMedia.FeatureMediaViewModel")],Xt),$t=i(86798),Qt=i(37384),Jt=i(8704),ei="esri-feature-media",ti={base:ei,mediaContainer:"".concat(ei,"__container"),mediaItemContainer:"".concat(ei,"__item-container"),mediaItem:"".concat(ei,"__item"),mediaItemText:"".concat(ei,"__item-text"),mediaItemTitle:"".concat(ei,"__item-title"),mediaItemCaption:"".concat(ei,"__item-caption"),mediaNavigation:"".concat(ei,"__item-navigation"),mediaPagination:"".concat(ei,"__pagination"),mediaPaginationText:"".concat(ei,"__pagination-text"),mediaPrevious:"".concat(ei,"__previous"),mediaPreviousIconLTR:"".concat(ei,"__previous-icon"),mediaPreviousIconRTL:"".concat(ei,"__previous-icon--rtl"),mediaNext:"".concat(ei,"__next"),mediaNextIconLTR:"".concat(ei,"__next-icon"),mediaNextIconRTL:"".concat(ei,"__next-icon--rtl"),mediaChart:"".concat(ei,"__chart"),mediaPaginationButton:"".concat(ei,"__pagination-button"),mediaPaginationIcon:"".concat(ei,"__pagination-icon"),mediaChartRendered:"".concat(ei,"__chart--rendered")},ii="category",ni="value",ri="rgba(50, 50, 50, 1)",ai=function(e){(0,c.Z)(o,e);var t=(0,d.Z)(o);function o(e,a){var s;return(0,l.Z)(this,o),(s=t.call(this,e,a))._refreshTimer=null,s._refreshIntervalInfo=null,s._featureElementInfo=null,s._chartRootMap=new WeakMap,s.viewModel=new Kt,s.messages=null,s._disposeChart=function(e){var t;null!==(t=s._chartRootMap.get(e))&&void 0!==t&&t.dispose(),s._chartRootMap.delete(e)},s._createChart=function(){var e=(0,r.Z)((0,n.Z)().mark((function e(t){var r,a,o,l,u,c;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=(0,Ct.Z)(s),a=r.destroyed,o=r.viewModel,!a&&o&&t){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,Promise.resolve().then(i.bind(i,86798));case 5:return l=e.sent,u=l.createRoot,e.next=9,u(t);case 9:c=e.sent,s._chartRootMap.set(t,c),s._renderChart({mediaInfo:o.activeMediaInfo,root:c});case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s}return(0,u.Z)(o,[{key:"initialize",value:function(){var e=this;this._featureElementInfo=new it,this.addHandles([(0,m.YP)((function(){var t,i;return[null===(t=e.viewModel)||void 0===t?void 0:t.activeMediaInfo,null===(i=e.viewModel)||void 0===i?void 0:i.activeMediaInfoIndex]}),(function(){return e._setupMediaRefreshTimer()}),m.nn),(0,m.YP)((function(){var t,i;return[null===(t=e.viewModel)||void 0===t?void 0:t.description,null===(i=e.viewModel)||void 0===i?void 0:i.title]}),(function(){return e._setupFeatureElementInfo()}),m.nn)])}},{key:"loadDependencies",value:function(){return(0,Re.h)({icon:function(){return i.e(7474).then(i.bind(i,87474))}})}},{key:"destroy",value:function(){var e;this._clearMediaRefreshTimer(),null===(e=this._featureElementInfo)||void 0===e||e.destroy()}},{key:"attributes",get:function(){return this.viewModel.attributes},set:function(e){this.viewModel.attributes=e}},{key:"activeMediaInfoIndex",get:function(){return this.viewModel.activeMediaInfoIndex},set:function(e){this.viewModel.activeMediaInfoIndex=e}},{key:"description",get:function(){return this.viewModel.description},set:function(e){this.viewModel.description=e}},{key:"fieldInfoMap",get:function(){return this.viewModel.fieldInfoMap},set:function(e){this.viewModel.fieldInfoMap=e}},{key:"layer",get:function(){return this.viewModel.layer},set:function(e){this.viewModel.layer=e}},{key:"mediaInfos",get:function(){return this.viewModel.mediaInfos},set:function(e){this.viewModel.mediaInfos=e}},{key:"popupTemplate",get:function(){return this.viewModel.popupTemplate},set:function(e){this.viewModel.popupTemplate=e}},{key:"relatedInfos",get:function(){return this.viewModel.relatedInfos},set:function(e){this.viewModel.relatedInfos=e}},{key:"title",get:function(){return this.viewModel.title},set:function(e){this.viewModel.title=e}},{key:"render",value:function(){var e;return(0,ze.u)("div",{bind:this,class:ti.base,onkeyup:this._handleMediaKeyup},null===(e=this._featureElementInfo)||void 0===e?void 0:e.render(),this.renderMedia())}},{key:"renderMedia",value:function(){var e=this.viewModel,t=e.formattedMediaInfoCount,i=e.activeMediaInfoIndex,n=this.renderMediaText();return t?(0,ze.u)("div",{key:"media-element-container",class:ti.mediaContainer},this.renderMediaInfo(),(0,ze.u)("div",{class:ti.mediaNavigation},n,(0,ze.u)("div",{class:ti.mediaPagination},this.renderMediaPageButton("previous"),(0,ze.u)("span",{class:ti.mediaPaginationText},(0,Jt.n)(this.messages.pageText,{index:i+1,total:t})),this.renderMediaPageButton("next")))):null}},{key:"renderMediaText",value:function(){var e=this.viewModel.activeMediaInfo;if(!e)return null;var t=e&&e.title?(0,ze.u)("div",{key:"media-title",class:ti.mediaItemTitle,innerHTML:e.title}):null,i=e&&e.caption?(0,ze.u)("div",{key:"media-caption",class:ti.mediaItemCaption,innerHTML:e.caption}):null;return t||i?(0,ze.u)("div",{key:"media-text",class:ti.mediaItemText},t,i):null}},{key:"renderImageMediaInfo",value:function(e){var t,i=this._refreshIntervalInfo,n=this.viewModel,r=n.activeMediaInfoIndex,a=n.formattedMediaInfoCount,o=e.value,s=e.refreshInterval,l=e.altText,u=e.title,c=e.type,d=o.sourceURL,h=o.linkURL,f=te(null!==h&&void 0!==h?h:void 0)?"_blank":"_self",v="_blank"===f?"noreferrer":"",p=s?i:null,g=p?p.timestamp:0,y=p?p.sourceURL:d,m=(0,ze.u)("img",{alt:l||u,key:"media-".concat(c,"-").concat(r,"-").concat(a,"-").concat(g),src:null!==y&&void 0!==y?y:void 0});return null!==(t=h?(0,ze.u)("a",{title:u,href:h,rel:v,target:f},m):null)&&void 0!==t?t:m}},{key:"renderChartMediaInfo",value:function(e){var t=this.viewModel,i=t.activeMediaInfoIndex,n=t.formattedMediaInfoCount;return(0,ze.u)("div",{key:"media-".concat(e.type,"-").concat(i,"-").concat(n),bind:this,class:ti.mediaChart,afterCreate:this._createChart,afterRemoved:this._disposeChart})}},{key:"renderMediaInfoType",value:function(){var e=this.viewModel.activeMediaInfo;return e?"image"===e.type?this.renderImageMediaInfo(e):e.type.includes("chart")?this.renderChartMediaInfo(e):null:null}},{key:"renderMediaInfo",value:function(){return this.viewModel.activeMediaInfo?(0,ze.u)("div",{key:"media-container",class:ti.mediaItemContainer},(0,ze.u)("div",{key:"media-item-container",class:ti.mediaItem},this.renderMediaInfoType())):null}},{key:"renderMediaPageButton",value:function(e){if(this.viewModel.formattedMediaInfoCount<2)return null;var t="previous"===e,i=t?this.messages.previous:this.messages.next,n=t?"chevron-left":"chevron-right",r=t?"media-previous":"media-next",a=t?this._previous:this._next;return(0,ze.u)("button",{type:"button",key:r,title:i,"aria-label":i,tabIndex:0,class:ti.mediaPaginationButton,bind:this,onclick:a},(0,ze.u)("calcite-icon",{class:ti.mediaPaginationIcon,scale:"s",icon:n}))}},{key:"_setupFeatureElementInfo",value:function(){var e,t=this.description,i=this.title;null===(e=this._featureElementInfo)||void 0===e||e.set({description:t,title:i})}},{key:"_next",value:function(){this.viewModel.next()}},{key:"_previous",value:function(){this.viewModel.previous()}},{key:"_getRenderer",value:function(){if(this.viewModel){var e=this.viewModel,t=e.isAggregate,i=e.layer;return t&&null!==i&&void 0!==i&&i.featureReduction&&"renderer"in i.featureReduction?i.featureReduction.renderer:null===i||void 0===i?void 0:i.renderer}}},{key:"_getRendererColors",value:function(){var e=(0,r.Z)((0,n.Z)().mark((function e(){var t,r,a,o,s,l;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.e(6715).then(i.bind(i,96715));case 2:if(t=e.sent,r=t.colorAm5,a=new Map,o=this._getRenderer(),s="default",o){e.next=9;break}return e.abrupt("return",a);case 9:return e.next=11,(0,Mt.zB)(o);case 11:return(l=e.sent).delete(s),e.abrupt("return",Array.from(l.values()).every((function(e){return 1===(null===e||void 0===e?void 0:e.length)}))?(Array.from(l.keys()).forEach((function(e){var t,i,n=null===(t=l.get(e))||void 0===t||null===(i=t[0])||void 0===i?void 0:i.toCss(!0);n&&a.set(e,r(n))})),a):a);case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_handleMediaKeyup",value:function(e){var t=(0,p.kK)(e);"ArrowLeft"===t&&(e.stopPropagation(),this.viewModel.previous()),"ArrowRight"===t&&(e.stopPropagation(),this.viewModel.next())}},{key:"_canAnimateChart",value:function(){return!!this.viewModel&&!!this.viewModel.abilities.chartAnimation&&!window.matchMedia("(prefers-reduced-motion: reduce)").matches}},{key:"_getChartAnimationMS",value:function(){return this._canAnimateChart()?250:0}},{key:"_getChartSeriesAnimationMS",value:function(){return this._canAnimateChart()?500:0}},{key:"_renderChart",value:function(){var e=(0,r.Z)((0,n.Z)().mark((function e(t){var r,o,s,l,u,c,d,h,f,v,p,g,y,m,b;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.root,o=t.mediaInfo,s=o.value,l=o.type,e.next=6,i.e(6715).then(i.bind(i,96715));case 6:return u=e.sent,c=u.ResponsiveThemeAm5,d=u.DarkThemeAm5,h=u.AnimatedThemeAm5,f=u.ColorSetAm5,v=u.ThemeAm5,(p=v.new(r)).rule("ColorSet").set("colors",$t.esriChartColorSet),g=[c.new(r),p],(0,Qt.$o)()&&g.push(d.new(r)),this._canAnimateChart()&&g.push(h.new(r)),r.setThemes(g),e.next=18,this._getRendererColors();case 18:y=e.sent,m=f.new(r,{}),b=s.series.map((function(e,t){var i,n=y.get(e.fieldName)||m.getIndex(t);return i={},(0,a.Z)(i,ii,e.tooltip),(0,a.Z)(i,ni,e.value),(0,a.Z)(i,"columnSettings",{fill:n,stroke:n}),i})).filter((function(e){return"pie-chart"!==l||null!=e.value&&e.value>0})),"pie-chart"===l?this._createPieChart(t,b):this._createXYChart(t,b);case 22:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_getDirection",value:function(){return(0,Ne.dZ)(this.container)?"rtl":"ltr"}},{key:"_isInversed",value:function(){return!!(0,Ne.dZ)(this.container)}},{key:"_customizeChartTooltip",value:function(){var e=(0,r.Z)((0,n.Z)().mark((function e(t){var r,a,o,s,l=arguments;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=l.length>1&&void 0!==l[1]?l[1]:"horizontal",e.next=3,i.e(6715).then(i.bind(i,96715));case 3:o=e.sent,s=o.colorAm5,t.setAll({pointerOrientation:a}),null!==(r=t.get("background"))&&void 0!==r&&r.setAll({stroke:s(ri)}),t.label.setAll({direction:this._getDirection(),oversizedBehavior:"wrap",maxWidth:200});case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_createPieChart",value:function(){var e=(0,r.Z)((0,n.Z)().mark((function e(t,r){var a,o,s,l,u,c,d,h,f,v,p,g,y;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.e(6715).then(i.bind(i,96715));case 2:return a=e.sent,o=a.TooltipAm5,e.next=6,Promise.all([i.e(7228),i.e(6568)]).then(i.bind(i,77011));case 6:s=e.sent,l=s.PieChartAm5,u=s.PieSeriesAm5,c=t.mediaInfo,d=t.root,h=c.title,5,f=(null===c||void 0===c?void 0:c.altText)||(null===c||void 0===c?void 0:c.title)||"",v=d.container.children.push(l.new(d,{ariaLabel:f,focusable:!0,paddingBottom:5,paddingTop:5,paddingLeft:5,paddingRight:5})),p="{category}: {valuePercentTotal.formatNumber('0.00')}%\n ({value})",g=o.new(d,{labelText:p}),(y=v.series.push(u.new(d,{name:h,valueField:ni,categoryField:ii,tooltip:g}))).ticks.template.set("forceHidden",!0),y.labels.template.set("forceHidden",!0),y.slices.template.states.create("active",{shiftRadius:5}),this._customizeChartTooltip(g),y.slices.template.setAll({ariaLabel:p,focusable:!0,templateField:"columnSettings"}),y.data.setAll(r),y.appear(this._getChartSeriesAnimationMS()),v.appear(this._getChartAnimationMS()),v.root.dom.classList.toggle(ti.mediaChartRendered,!0);case 19:case"end":return e.stop()}}),e,this)})));return function(t,i){return e.apply(this,arguments)}}()},{key:"_getMinSeriesValue",value:function(e){var t=0;return e.forEach((function(e){return t=Math.min(e.value,t)})),t}},{key:"_createColumnChart",value:function(){var e=(0,r.Z)((0,n.Z)().mark((function e(t,r,a){var o,s,l,u,c,d,h,f,v,p,g,y,m,b,_,w,k,x;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.e(6715).then(i.bind(i,96715));case 2:return o=e.sent,s=o.TooltipAm5,l=o.ScrollbarAm5,e.next=7,Promise.all([i.e(7228),i.e(6436)]).then(i.bind(i,96436));case 7:u=e.sent,c=u.CategoryAxisAm5,d=u.AxisRendererXAm5,h=u.ValueAxisAm5,f=u.AxisRendererYAm5,v=u.ColumnSeriesAm5,p=r.mediaInfo,g=r.root,y=p.value,m=p.title,t.setAll({wheelX:"panX",wheelY:"zoomX"}),(b=t.xAxes.push(c.new(g,{renderer:d.new(g,{inversed:this._isInversed()}),categoryField:ii}))).get("renderer").labels.template.setAll({forceHidden:!0}),(_=t.yAxes.push(h.new(g,{renderer:f.new(g,{inside:!1}),min:this._getMinSeriesValue(y.series)}))).get("renderer").labels.template.setAll({direction:this._getDirection()}),w="{categoryX}",k=s.new(g,{labelText:w}),x=t.series.push(v.new(g,{name:m,xAxis:b,yAxis:_,valueYField:ni,categoryXField:ii,tooltip:k})),this._customizeChartTooltip(k),x.columns.template.setAll({ariaLabel:w,focusable:!0,templateField:"columnSettings"}),y.series.length>15&&t.set("scrollbarX",l.new(g,{orientation:"horizontal"})),b.data.setAll(a),x.data.setAll(a),x.appear(this._getChartSeriesAnimationMS()),t.appear(this._getChartAnimationMS());case 24:case"end":return e.stop()}}),e,this)})));return function(t,i,n){return e.apply(this,arguments)}}()},{key:"_createBarChart",value:function(){var e=(0,r.Z)((0,n.Z)().mark((function e(t,r,a){var o,s,l,u,c,d,h,f,v,p,g,y,m,b,_,w,k,x;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.e(6715).then(i.bind(i,96715));case 2:return o=e.sent,s=o.TooltipAm5,l=o.ScrollbarAm5,e.next=7,Promise.all([i.e(7228),i.e(6436)]).then(i.bind(i,96436));case 7:u=e.sent,c=u.CategoryAxisAm5,d=u.AxisRendererXAm5,h=u.ValueAxisAm5,f=u.AxisRendererYAm5,v=u.ColumnSeriesAm5,p=r.mediaInfo,g=r.root,y=p.value,m=p.title,t.setAll({wheelX:"panY",wheelY:"zoomY"}),(b=t.yAxes.push(c.new(g,{renderer:f.new(g,{inversed:!0}),categoryField:ii}))).get("renderer").labels.template.setAll({forceHidden:!0}),(_=t.xAxes.push(h.new(g,{renderer:d.new(g,{inside:!1,inversed:this._isInversed()}),min:this._getMinSeriesValue(y.series)}))).get("renderer").labels.template.setAll({direction:this._getDirection()}),w="{categoryY}",k=s.new(g,{labelText:w}),x=t.series.push(v.new(g,{name:m,xAxis:_,yAxis:b,valueXField:ni,categoryYField:ii,tooltip:k})),this._customizeChartTooltip(k,"vertical"),x.columns.template.setAll({ariaLabel:w,focusable:!0,templateField:"columnSettings"}),y.series.length>15&&t.set("scrollbarY",l.new(g,{orientation:"vertical"})),b.data.setAll(a),x.data.setAll(a),x.appear(this._getChartSeriesAnimationMS()),t.appear(this._getChartAnimationMS());case 24:case"end":return e.stop()}}),e,this)})));return function(t,i,n){return e.apply(this,arguments)}}()},{key:"_createLineChart",value:function(){var e=(0,r.Z)((0,n.Z)().mark((function e(t,r,a){var o,s,l,u,c,d,h,f,v,p,g,y,m,b,_,w,k;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.e(6715).then(i.bind(i,96715));case 2:return o=e.sent,s=o.TooltipAm5,l=o.ScrollbarAm5,e.next=7,Promise.all([i.e(7228),i.e(6436)]).then(i.bind(i,96436));case 7:u=e.sent,c=u.CategoryAxisAm5,d=u.AxisRendererXAm5,h=u.ValueAxisAm5,f=u.AxisRendererYAm5,v=u.LineSeriesAm5,p=r.root,g=r.mediaInfo,y=g.value,m=g.title,t.setAll({wheelX:"panX",wheelY:"zoomX"}),(b=t.xAxes.push(c.new(p,{renderer:d.new(p,{inversed:this._isInversed()}),categoryField:ii}))).get("renderer").labels.template.setAll({forceHidden:!0}),(_=t.yAxes.push(h.new(p,{renderer:f.new(p,{inside:!1}),min:this._getMinSeriesValue(y.series)}))).get("renderer").labels.template.setAll({direction:this._getDirection()}),"{categoryX}",w=s.new(p,{labelText:"{categoryX}"}),k=t.series.push(v.new(p,{name:m,xAxis:b,yAxis:_,valueYField:ni,categoryXField:ii,tooltip:w})),this._customizeChartTooltip(w,"vertical"),y.series.length>15&&t.set("scrollbarX",l.new(p,{orientation:"horizontal"})),b.data.setAll(a),k.data.setAll(a),k.appear(this._getChartSeriesAnimationMS()),t.appear(this._getChartAnimationMS());case 24:case"end":return e.stop()}}),e,this)})));return function(t,i,n){return e.apply(this,arguments)}}()},{key:"_createXYChart",value:function(){var e=(0,r.Z)((0,n.Z)().mark((function e(t,r){var a,o,s,l,u,c,d,h;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([i.e(7228),i.e(6436)]).then(i.bind(i,96436));case 2:if(a=e.sent,o=a.XYChartAm5,s=a.XYCursorAm5,l=t.root,u=t.mediaInfo,c=u.type,d=(null===u||void 0===u?void 0:u.altText)||(null===u||void 0===u?void 0:u.title)||"",(h=l.container.children.push(o.new(l,{ariaLabel:d,focusable:!0,panX:!0,panY:!0}))).set("cursor",s.new(l,{})),e.t0="column-chart"===c,!e.t0){e.next=15;break}return e.next=15,this._createColumnChart(h,t,r);case 15:if(e.t1="bar-chart"===c,!e.t1){e.next=19;break}return e.next=19,this._createBarChart(h,t,r);case 19:if(e.t2="line-chart"===c,!e.t2){e.next=23;break}return e.next=23,this._createLineChart(h,t,r);case 23:h.root.dom.classList.toggle(ti.mediaChartRendered,!0);case 24:case"end":return e.stop()}}),e,this)})));return function(t,i){return e.apply(this,arguments)}}()},{key:"_clearMediaRefreshTimer",value:function(){var e=this._refreshTimer;e&&(clearTimeout(e),this._refreshTimer=null)}},{key:"_updateMediaInfoTimestamp",value:function(e){var t=Date.now();this._refreshIntervalInfo={timestamp:t,sourceURL:e&&this._getImageSource(e,t)}}},{key:"_setupMediaRefreshTimer",value:function(){this._clearMediaRefreshTimer();var e=this.viewModel.activeMediaInfo;e&&"image"===e.type&&e.refreshInterval&&this._setRefreshTimeout(e)}},{key:"_setRefreshTimeout",value:function(e){var t=this,i=e.refreshInterval,n=e.value;if(i){var r=6e4*i;this._updateMediaInfoTimestamp(n.sourceURL);var a=setInterval((function(){t._updateMediaInfoTimestamp(n.sourceURL)}),r);this._refreshTimer=a}}},{key:"_getImageSource",value:function(e,t){var i=e.includes("?")?"&":"?",n=e.split("#"),r=(0,s.Z)(n,2),a=r[0],o=r[1],l=void 0===o?"":o;return"".concat(a).concat(i,"timestamp=").concat(t).concat(l?"#":"").concat(l)}}]),o}(C.Z);(0,h._)([(0,_.Cb)()],ai.prototype,"_refreshIntervalInfo",void 0),(0,h._)([(0,_.Cb)()],ai.prototype,"attributes",null),(0,h._)([(0,_.Cb)()],ai.prototype,"activeMediaInfoIndex",null),(0,h._)([(0,_.Cb)()],ai.prototype,"description",null),(0,h._)([(0,_.Cb)()],ai.prototype,"fieldInfoMap",null),(0,h._)([(0,_.Cb)()],ai.prototype,"layer",null),(0,h._)([(0,_.Cb)()],ai.prototype,"mediaInfos",null),(0,h._)([(0,_.Cb)()],ai.prototype,"popupTemplate",null),(0,h._)([(0,_.Cb)()],ai.prototype,"relatedInfos",null),(0,h._)([(0,_.Cb)()],ai.prototype,"title",null),(0,h._)([(0,_.Cb)({type:Kt})],ai.prototype,"viewModel",void 0),(0,h._)([(0,_.Cb)(),(0,He.H)("esri/widgets/Feature/t9n/Feature")],ai.prototype,"messages",void 0);var oi=ai=(0,h._)([(0,x.j)("esri.widgets.Feature.FeatureMedia")],ai),si=(i(26418),i(23046),i(1374),i(39384),i(29230)),li=i(29514),ui=(i(44051),i(98752)),ci=i(26538),di=i(64326),hi=["$datastore","$map","$layer","$aggregatedfeatures"],fi=y.Z.getLogger("esri.widgets.Feature.support.arcadeFeatureUtils");function vi(e){return"string"==typeof e?be(me(e)):Array.isArray(e)?function(e){return'<ul class="esri-widget__list">'.concat(e.map((function(e){return"<li>".concat("string"==typeof e?be(me(e)):e,"</li>")})).join(""),"</ul>")}(e):"esri.arcade.Dictionary"===(null===e||void 0===e?void 0:e.declaredClass)?function(e){return'<table class="esri-widget__table">'.concat(e.keys().map((function(t){var i=e.field(t);return"<tr><th>".concat(t,"</th><td>").concat("string"==typeof i?be(me(i)):i,"</td></tr>")})).join(""),"</table>")}(e):e}function pi(e){var t=e.aggregatedFeatures,i=e.arcadeUtils,n=e.featureSetVars,r=e.context,a=e.viewInfo,s=e.map,l=e.graphic,u=e.interceptor;n.forEach((function(e){var n=e.toLowerCase(),c=a.sr,d={map:s,spatialReference:c,interceptor:u};if("$map"===n&&(r.vars[n]=i.convertMapToFeatureSetCollection(d)),"$layer"===n&&(r.vars[n]=i.convertFeatureLayerToFeatureSet({layer:l.sourceLayer,spatialReference:c,interceptor:u})),"$datastore"===n&&(r.vars[n]=i.convertServiceUrlToWorkspace({url:l.sourceLayer.url,spatialReference:c,interceptor:u})),"$aggregatedfeatures"===n){var h=l.layer,f=h.fields,v=h.objectIdField,p=h.geometryType,g=h.spatialReference,y=h.displayField,m=new di.default((0,o.Z)((0,o.Z)({fields:f,objectIdField:v,geometryType:p,spatialReference:g,displayField:y},"feature"===h.type?{templates:h.templates,typeIdField:h.typeIdField,types:h.types}:null),{},{source:t}));r.vars[n]=i.convertFeatureLayerToFeatureSet({layer:m,spatialReference:g,interceptor:u})}}))}function gi(){return Promise.all([i.e(8016),i.e(7027)]).then(i.bind(i,70718))}function yi(e){return"createQuery"in e&&"queryFeatures"in e}function mi(e){return bi.apply(this,arguments)}function bi(){return bi=(0,r.Z)((0,n.Z)().mark((function e(t){var i,r,a,o,s,l,u,c,d;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.graphic,r=t.view,a=i.isAggregate,o=i.layer,a&&o&&"2d"===(null===r||void 0===r?void 0:r.type)){e.next=4;break}return e.abrupt("return",[]);case 4:return e.next=6,r.whenLayerView(o);case 6:if(yi(s=e.sent)){e.next=9;break}return e.abrupt("return",[]);case 9:return l=s.createQuery(),u=i.getObjectId(),l.aggregateIds=null!=u?[u]:[],e.next=13,s.queryFeatures(l);case 13:return c=e.sent,d=c.features,e.abrupt("return",d);case 16:case"end":return e.stop()}}),e)}))),bi.apply(this,arguments)}function _i(e){return wi.apply(this,arguments)}function wi(){return wi=(0,r.Z)((0,n.Z)().mark((function e(t){var i,r,a,o,l,u,c,d,h,f,v,p,g,y,m;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.expressionInfo,r=t.arcadeUtils,a=t.interceptor,o=t.spatialReference,l=t.map,u=t.graphic,c=t.view,i&&i.expression){e.next=3;break}return e.abrupt("return",null);case 3:return d=r.createSyntaxTree(i.expression),h=hi.filter((function(e){return r.hasVariable(d,e)})),e.next=7,Promise.all([mi({graphic:u,view:c}),r.loadScriptDependencies(d,!0,h)]);case 7:return f=e.sent,v=(0,s.Z)(f,1),p=v[0],g=r.getViewInfo({spatialReference:o}),(y=r.createExecContext(u,g)).interceptor=a,y.useAsync=!0,pi({aggregatedFeatures:p,arcadeUtils:r,featureSetVars:h,context:y,viewInfo:g,map:l,graphic:u,interceptor:a}),m=r.createFunction(d,y),e.abrupt("return",r.executeAsyncFunction(m,y).catch((function(e){return fi.error("arcade-execution-error",{error:e,graphic:u,expressionInfo:i})})));case 15:case"end":return e.stop()}}),e)}))),wi.apply(this,arguments)}function ki(e){return xi.apply(this,arguments)}function xi(){return xi=(0,r.Z)((0,n.Z)().mark((function e(t){var i,r,a,o,s,l,u,c,d,h,f,v,p,g;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.expressionInfos,r=t.spatialReference,a=t.graphic,o=t.interceptor,s=t.map,l=t.view,i&&i.length){e.next=3;break}return e.abrupt("return",{});case 3:return e.next=5,gi();case 5:u=e.sent,c={},d=(0,Zt.Z)(i);try{for(d.s();!(h=d.n()).done;)f=h.value,c["expression/".concat(f.name)]=_i({expressionInfo:f,arcadeUtils:u,interceptor:o,spatialReference:r,map:s,graphic:a,view:l})}catch(n){d.e(n)}finally{d.f()}return e.next=11,(0,Tt.as)(c);case 11:for(g in v=e.sent,p={},v)p[g]=vi(v[g].value);return e.abrupt("return",p);case 15:case"end":return e.stop()}}),e)}))),xi.apply(this,arguments)}var Ci=function(e){(0,c.Z)(i,e);var t=(0,d.Z)(i);function i(e){var a;return(0,l.Z)(this,i),(a=t.call(this,e))._abortController=null,a.expressionInfo=null,a.graphic=null,a.contentElement=null,a.contentElementViewModel=null,a.interceptor=null,a.view=null,a._cancelQuery=function(){var e=(0,Ct.Z)(a)._abortController;e&&e.abort(),a._abortController=null},a._createVM=function(){var e,t,i=null===(e=a.contentElement)||void 0===e?void 0:e.type;null===(t=a.contentElementViewModel)||void 0===t||t.destroy();var n="fields"===i?new yt:"media"===i?new Kt:"text"===i?new lt:null;a._set("contentElementViewModel",n)},a._compile=(0,r.Z)((0,n.Z)().mark((function e(){var t;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a._cancelQuery(),t=new AbortController,a._abortController=t,e.next=5,a._compileExpression();case 5:a._abortController===t&&(a._abortController=null);case 6:case"end":return e.stop()}}),e)}))),a._compileThrottled=(0,b.P)(a._compile,1,(0,Ct.Z)(a)),a._compileExpression=(0,r.Z)((0,n.Z)().mark((function e(){var t,i,r,o,s,l,u,c,d,h,f,v,p;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=(0,Ct.Z)(a),i=t.expressionInfo,r=t.graphic,o=t.interceptor,s=t.spatialReference,l=t.map,u=t.view,c=t._abortController,i&&r&&s&&l){e.next=3;break}return e.abrupt("return",void a._set("contentElement",null));case 3:return e.next=5,gi();case 5:if(d=e.sent,c===a._abortController){e.next=8;break}return e.abrupt("return");case 8:return e.next=10,_i({arcadeUtils:d,expressionInfo:i,graphic:r,interceptor:o,map:l,spatialReference:s,view:u});case 10:if((h=e.sent)&&"esri.arcade.Dictionary"===h.declaredClass){e.next=13;break}return e.abrupt("return",void a._set("contentElement",null));case 13:return e.next=15,h.castAsJsonAsync(null===c||void 0===c?void 0:c.signal);case 15:f=e.sent,v=null===f||void 0===f?void 0:f.type,p="media"===v?li.Z.fromJSON(f):"text"===v?ui.Z.fromJSON(f):"fields"===v?si.Z.fromJSON(f):null,a._set("contentElement",p);case 19:case"end":return e.stop()}}),e)}))),a.handles.add([(0,m.YP)((function(){return[a.expressionInfo,a.graphic,a.map,a.spatialReference,a.view]}),(function(){return a._compileThrottled()}),m.nn),(0,m.YP)((function(){return[a.contentElement]}),(function(){return a._createVM()}),m.nn)]),a}return(0,u.Z)(i,[{key:"initialize",value:function(){this.addHandles(this._compileThrottled)}},{key:"destroy",value:function(){var e;this._cancelQuery(),null!==(e=this.contentElementViewModel)&&void 0!==e&&e.destroy(),this._set("contentElementViewModel",null),this._set("contentElement",null)}},{key:"spatialReference",get:function(){var e,t;return null!==(e=null===(t=this.view)||void 0===t?void 0:t.spatialReference)&&void 0!==e?e:null},set:function(e){this._override("spatialReference",e)}},{key:"state",get:function(){var e=this._abortController,t=this.contentElement,i=this.contentElementViewModel;return e?"loading":t||i?"ready":"disabled"}},{key:"map",get:function(){var e,t;return null!==(e=null===(t=this.view)||void 0===t?void 0:t.map)&&void 0!==e?e:null},set:function(e){this._override("map",e)}}]),i}((0,ot.p)(D.Z));(0,h._)([(0,_.Cb)()],Ci.prototype,"_abortController",void 0),(0,h._)([(0,_.Cb)({type:ci.Z})],Ci.prototype,"expressionInfo",void 0),(0,h._)([(0,_.Cb)({type:O.Z})],Ci.prototype,"graphic",void 0),(0,h._)([(0,_.Cb)({readOnly:!0})],Ci.prototype,"contentElement",void 0),(0,h._)([(0,_.Cb)({readOnly:!0})],Ci.prototype,"contentElementViewModel",void 0),(0,h._)([(0,_.Cb)()],Ci.prototype,"interceptor",void 0),(0,h._)([(0,_.Cb)()],Ci.prototype,"spatialReference",null),(0,h._)([(0,_.Cb)({readOnly:!0})],Ci.prototype,"state",null),(0,h._)([(0,_.Cb)()],Ci.prototype,"map",null),(0,h._)([(0,_.Cb)()],Ci.prototype,"view",void 0);var Mi=Ci=(0,h._)([(0,x.j)("esri.widgets.Feature.FeatureExpression.FeatureExpressionViewModel")],Ci),Pi="esri-icon-loading-indicator esri-rotating",Zi="esri-feature-expression",Ai="esri-feature__loading-container",Ti="esri-feature__loading-spinner",Ii=function(e){(0,c.Z)(i,e);var t=(0,d.Z)(i);function i(e,n){var r;return(0,l.Z)(this,i),(r=t.call(this,e,n))._contentWidget=null,r.viewModel=new Mi,r}return(0,u.Z)(i,[{key:"initialize",value:function(){var e=this;this.addHandles((0,m.YP)((function(){var t;return null===(t=e.viewModel)||void 0===t?void 0:t.contentElementViewModel}),(function(){return e._setupExpressionWidget()}),m.nn))}},{key:"destroy",value:function(){this._destroyContentWidget()}},{key:"renderLoading",value:function(){return(0,ze.u)("div",{key:"loading-container",class:Ai},(0,ze.u)("span",{class:this.classes(Pi,Ti)}))}},{key:"render",value:function(){var e,t=this.viewModel.state;return(0,ze.u)("div",{class:Zi},"loading"===t?this.renderLoading():"disabled"===t?null:null===(e=this._contentWidget)||void 0===e?void 0:e.render())}},{key:"_destroyContentWidget",value:function(){var e=this._contentWidget;e&&(e.viewModel=null,e.destroy()),this._contentWidget=null}},{key:"_setupExpressionWidget",value:function(){var e=this.viewModel,t=e.contentElementViewModel,i=e.contentElement,n=null===i||void 0===i?void 0:i.type;this._destroyContentWidget();var r=t?"fields"===n?new xt({viewModel:t}):"media"===n?new oi({viewModel:t}):"text"===n?new ft({viewModel:t}):null:null;this._contentWidget=r,this.scheduleRender()}}]),i}(C.Z);(0,h._)([(0,_.Cb)({type:Mi})],Ii.prototype,"viewModel",void 0);var Oi=Ii=(0,h._)([(0,x.j)("esri.widgets.Feature.FeatureExpression")],Ii),Di=i(92026),Fi=i(11582),Ei=i(79056);i(39638);function Si(e,t,i){var n=Object.keys(t).filter((function(t){return(0,A.pZ)(e,t)})),r=n.map((function(e){return t[e]})),a=n.map((function(e){return i.get(e)})).filter(k.pC);return function(e,t){return(0,A.gx)((0,A.gx)(e,(function(e){return"{".concat(e.toLowerCase(),"}")})),Object.fromEntries(Object.entries(t).map((function(e){var t=(0,s.Z)(e,2),i=t[0],n=t[1];return[i.toLowerCase(),n]}))))}(e,Bi(r,a))}function Bi(e,t){var i=t.map((function(t,i){var n=e[i];if(t.domain&&"coded-value"===t.domain.type){var r=t.domain.codedValues.find((function(e){return e.code===n}));(null===r||void 0===r?void 0:r.name)&&(n=r.name)}return(0,L.y2)(t)&&(n=function(e,t){if(!e||null==t)return null;switch(e.type){case"date":return(0,B.p6)(t);case"date-only":return(0,B.o8)(t);case"time-only":return(0,B.LJ)(t);case"timestamp-offset":return(0,B.i$)(t);default:return null}}(t,n)),[t.name,n]}));return Object.fromEntries(i)}new Set(["date-only","time-only","timestamp-offset"]);var Li;!function(e){e.TOO_SHORT="length-validation-error::too-short"}(Li||(Li={}));var ji=function(e){var t=[];if(e.formTemplate){var i,n=e.formTemplate,r=n.description,a=n.title;null===(i=e.fields)||void 0===i||i.forEach((function(e){var i=a&&(0,A.pZ)(a,e.name),n=r&&(0,A.pZ)(r,e.name);(i||n)&&t.push(e.name)}))}return t};var Ri=function(e){(0,c.Z)(i,e);var t=(0,d.Z)(i);function i(e){var a;return(0,l.Z)(this,i),(a=t.call(this,e))._loaded=!1,a._queryAbortController=null,a._queryPageAbortController=null,a._queryFeatureCountAbortController=null,a.featuresPerPage=10,a.description=null,a.graphic=null,a.layer=null,a.map=null,a.orderByFields=null,a.featureCount=0,a.relationshipId=null,a.showAllEnabled=!1,a.title=null,a._cancelQuery=function(){var e=(0,Ct.Z)(a)._queryAbortController;e&&e.abort(),a._queryAbortController=null},a._cancelQueryFeatureCount=function(){var e=(0,Ct.Z)(a)._queryFeatureCountAbortController;e&&e.abort(),a._queryFeatureCountAbortController=null},a._cancelQueryPage=function(){var e=(0,Ct.Z)(a)._queryPageAbortController;e&&e.abort(),a._queryPageAbortController=null},a._queryController=(0,r.Z)((0,n.Z)().mark((function e(){var t;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a._cancelQuery(),t=new AbortController,a._queryAbortController=t,e.next=5,(0,Tt.R8)(a._query());case 5:a._queryAbortController===t&&(a._queryAbortController=null);case 6:case"end":return e.stop()}}),e)}))),a._queryFeatureCountController=(0,r.Z)((0,n.Z)().mark((function e(){var t;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a._loaded=!1,a._cancelQueryFeatureCount(),t=new AbortController,a._queryFeatureCountAbortController=t,e.next=5,(0,Tt.R8)(a._queryFeatureCount());case 5:a._queryFeatureCountAbortController===t&&(a._queryFeatureCountAbortController=null),a._loaded=!0;case 7:case"end":return e.stop()}}),e)}))),a._queryPageController=(0,r.Z)((0,n.Z)().mark((function e(){var t;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new AbortController,a._queryPageAbortController=t,e.next=4,(0,Tt.R8)(a._queryPage());case 4:a._queryPageAbortController===t&&(a._queryPageAbortController=null);case 5:case"end":return e.stop()}}),e)}))),a._queryDebounced=(0,Tt.Ds)(a._queryController,100),a._queryFeatureCountDebounced=(0,Tt.Ds)(a._queryFeatureCountController,100),a._queryPageDebounced=(0,Tt.Ds)(a._queryPageController,100),a._query=(0,r.Z)((0,n.Z)().mark((function e(){var t,i,r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=(0,Ct.Z)(a),i=t._queryAbortController,r=t.relatedFeatures,e.t0=a.featureCount,!e.t0){e.next=15;break}if(a._destroyRelatedFeatureViewModels(),a.featurePage=1,r.removeAll(),e.t1=a.destroyed,e.t1){e.next=15;break}return e.t2=r,e.t3=a,e.next=12,a._queryRelatedFeatures({signal:null===i||void 0===i?void 0:i.signal});case 12:e.t4=e.sent,e.t5=e.t3._sliceFeatures.call(e.t3,e.t4),e.t2.addMany.call(e.t2,e.t5);case 15:case"end":return e.stop()}}),e)}))),a.handles.add([(0,m.YP)((function(){var e;return[a.displayCount,a.graphic,a.layer,null===(e=a.layer)||void 0===e?void 0:e.loaded,a.map,a.orderByFields,a.relationshipId,a.featuresPerPage,a.showAllEnabled,a.canQuery,a.featureCount]}),(function(){return a._queryDebounced()}),m.nn),(0,m.YP)((function(){return[a.featurePage,a.showAllEnabled]}),(function(){return a._queryPageDebounced()})),(0,m.YP)((function(){return[a.layer,a.relationshipId,a.objectId,a.canQuery]}),(function(){return a._queryFeatureCountDebounced()}))]),a}return(0,u.Z)(i,[{key:"destroy",value:function(){this._destroyRelatedFeatureViewModels(),this.relatedFeatures.removeAll(),this._cancelQuery(),this._cancelQueryFeatureCount(),this._cancelQueryPage()}},{key:"featurePage",get:function(){return this._get("featurePage")},set:function(e){var t=this.featuresPerPage,i=this.featureCount,n=Math.ceil(i/t)||1;this._set("featurePage",Math.min(Math.max(e,1),n))}},{key:"orderByFieldsFixedCasing",get:function(){var e=this.orderByFields,t=this.relatedLayer;return e&&null!==t&&void 0!==t&&t.loaded?e.map((function(e){var i=e.clone();return i.field=re(e.field,t),i})):null!==e&&void 0!==e?e:[]}},{key:"supportsCacheHint",get:function(){var e,t,i;return!(null===(e=this.layer)||void 0===e||null===(t=e.capabilities)||void 0===t||null===(i=t.queryRelated)||void 0===i||!i.supportsCacheHint)}},{key:"canLoad",get:function(){return!!this.map&&"number"==typeof this.relationshipId&&"number"==typeof this.objectId}},{key:"canQuery",get:function(){var e,t,i=null===(e=this.layer)||void 0===e||null===(t=e.capabilities)||void 0===t?void 0:t.queryRelated;return!!(this.relatedLayer&&this.relationship&&"number"==typeof this.relationshipId&&"number"==typeof this.objectId&&null!==i&&void 0!==i&&i.supportsCount&&null!==i&&void 0!==i&&i.supportsPagination)}},{key:"itemDescriptionFieldName",get:function(){var e;return(null===(e=this.orderByFieldsFixedCasing[0])||void 0===e?void 0:e.field)||null}},{key:"displayCount",get:function(){return this._get("displayCount")},set:function(e){this._set("displayCount",Math.min(Math.max(e,0),10))}},{key:"objectId",get:function(){var e,t,i;return null!==(e=this.objectIdField&&(null===(t=this.graphic)||void 0===t||null===(i=t.attributes)||void 0===i?void 0:i[this.objectIdField]))&&void 0!==e?e:null}},{key:"objectIdField",get:function(){var e;return(null===(e=this.layer)||void 0===e?void 0:e.objectIdField)||null}},{key:"relatedFeatures",get:function(){return this._get("relatedFeatures")||new f.Z}},{key:"relatedFeatureInfos",get:function(){var e=this.itemDescriptionFieldName,t=this.relatedFeatures,i=this.relatedLayer;if(!t.length||!i)return[];var n=i&&"formTemplate"in i&&i.formTemplate,r=n&&(null===n||void 0===n?void 0:n.title)||void 0;return t.map((function(t){var n;if(e){var a=t.getAttribute(e),o=i.fieldsIndex.get(e);if(o){var s=Bi([a],[o])[e];null!=s&&(n=s.toString())}}return{feature:t,description:n,title:r?Si(r,t.attributes,i.fieldsIndex):void 0}})).toArray()}},{key:"relatedLayer",get:function(){var e,t=this.layer,i=this.map,n=this.relationship;return null!==t&&void 0!==t&&t.loaded&&i&&n&&null!==(e=function(e,t,i){return e&&t&&i?De(e.allLayers,t,i)||De(e.allTables,t,i):null}(i,t,n))&&void 0!==e?e:null}},{key:"relationship",get:function(){var e,t,i=this.relationshipId,n=this.layer;return"number"==typeof i&&null!==(e=null===n||void 0===n||null===(t=n.relationships)||void 0===t?void 0:t.find((function(e){return e.id===i})))&&void 0!==e?e:null}},{key:"relatedFeatureViewModels",get:function(){return this._get("relatedFeatureViewModels")||new f.Z}},{key:"state",get:function(){var e=this._queryAbortController,t=this._queryFeatureCountAbortController,i=this._queryPageAbortController,n=this.canQuery,r=this._loaded,a=this.canLoad;return t||a&&!r?"loading":e||i?"querying":n?"ready":"disabled"}},{key:"getRelatedFeatureByObjectId",value:function(e){return this.relatedFeatures.find((function(t){return t.getObjectId()===e}))}},{key:"_destroyRelatedFeatureViewModels",value:function(){var e;null!==(e=this.relatedFeatureViewModels)&&void 0!==e&&e.forEach((function(e){return!e.destroyed&&e.destroy()})),this.relatedFeatureViewModels.removeAll()}},{key:"_queryFeatureCount",value:function(){var e=(0,r.Z)((0,n.Z)().mark((function e(){var t,i,r,a,o,s,l,u,c,d,h;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.layer,r=this.relatedLayer,a=this.relationshipId,o=this.objectId,s=this._queryFeatureCountAbortController,l=this.canQuery,u=this.supportsCacheHint,e.next=3,null===i||void 0===i?void 0:i.load();case 3:return e.next=5,null===r||void 0===r?void 0:r.load();case 5:if(l&&i&&r){e.next=7;break}return e.abrupt("return",void this._set("featureCount",0));case 7:return c=r.createQuery(),d=new Ft.default({cacheHint:u,relationshipId:a,returnGeometry:!1,objectIds:[o],where:null!==(t=c.where)&&void 0!==t?t:void 0}),e.next=11,i.queryRelatedFeaturesCount(d,{signal:null===s||void 0===s?void 0:s.signal});case 11:h=e.sent,this._set("featureCount",h[o]||0);case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_sliceFeatures",value:function(e){var t=this.showAllEnabled,i=this.displayCount;return t?e:i?e.slice(0,i):[]}},{key:"_queryPage",value:function(){var e=(0,r.Z)((0,n.Z)().mark((function e(){var t,i,r,a,o;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.relatedFeatures,i=this.featurePage,r=this.showAllEnabled,a=this._queryPageAbortController,o=this.featureCount,e.t0=!r||i<2||!o,e.t0){e.next=8;break}return e.t1=t,e.next=6,this._queryRelatedFeatures({signal:null===a||void 0===a?void 0:a.signal});case 6:e.t2=e.sent,e.t1.addMany.call(e.t1,e.t2);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_queryRelatedFeatures",value:function(){var e=(0,r.Z)((0,n.Z)().mark((function e(t){var i,r,a,o,s,l,u,c,d,h,f,v,p,g,y,m,b,_,w,x,C,M,P;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=this.orderByFieldsFixedCasing,o=this.showAllEnabled,s=this.featuresPerPage,l=this.displayCount,u=this.layer,c=this.relationshipId,d=this.featurePage,h=this.featureCount,f=this.relatedLayer,v=this.supportsCacheHint,p=this.canQuery,g=this.objectId,p&&u&&f){e.next=3;break}return e.abrupt("return",[]);case 3:return y=o?((d-1)*s+h)%h:0,m=o?s:l,b=f.objectIdField,_=[].concat((0,S.Z)(a.map((function(e){return e.field}))),(0,S.Z)(ji(f)),[b]).filter(k.pC),w=a.map((function(e){return"".concat(e.field," ").concat(e.order)})),x=f.createQuery(),C=new Ft.default({orderByFields:w,start:y,num:m,outFields:_,cacheHint:v,relationshipId:c,returnGeometry:!1,objectIds:[g],where:null!==(i=x.where)&&void 0!==i?i:void 0}),e.next=12,u.queryRelatedFeatures(C,{signal:null===t||void 0===t?void 0:t.signal});case 12:return M=e.sent,P=(null===(r=M[g])||void 0===r?void 0:r.features)||[],e.abrupt("return",(P.forEach((function(e){e.sourceLayer=f,e.layer=f})),P));case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),i}((0,Fi.J)((0,Ei.IG)((0,ot.p)(D.Z))));(0,h._)([(0,_.Cb)()],Ri.prototype,"_loaded",void 0),(0,h._)([(0,_.Cb)()],Ri.prototype,"_queryAbortController",void 0),(0,h._)([(0,_.Cb)()],Ri.prototype,"_queryPageAbortController",void 0),(0,h._)([(0,_.Cb)()],Ri.prototype,"_queryFeatureCountAbortController",void 0),(0,h._)([(0,_.Cb)({value:1})],Ri.prototype,"featurePage",null),(0,h._)([(0,_.Cb)()],Ri.prototype,"featuresPerPage",void 0),(0,h._)([(0,_.Cb)({readOnly:!0})],Ri.prototype,"orderByFieldsFixedCasing",null),(0,h._)([(0,_.Cb)({readOnly:!0})],Ri.prototype,"supportsCacheHint",null),(0,h._)([(0,_.Cb)({readOnly:!0})],Ri.prototype,"canLoad",null),(0,h._)([(0,_.Cb)({readOnly:!0})],Ri.prototype,"canQuery",null),(0,h._)([(0,_.Cb)()],Ri.prototype,"description",void 0),(0,h._)([(0,_.Cb)({readOnly:!0})],Ri.prototype,"itemDescriptionFieldName",null),(0,h._)([(0,_.Cb)({value:3})],Ri.prototype,"displayCount",null),(0,h._)([(0,_.Cb)({type:O.Z})],Ri.prototype,"graphic",void 0),(0,h._)([(0,_.Cb)()],Ri.prototype,"layer",void 0),(0,h._)([(0,_.Cb)()],Ri.prototype,"map",void 0),(0,h._)([(0,_.Cb)({readOnly:!0})],Ri.prototype,"objectId",null),(0,h._)([(0,_.Cb)({readOnly:!0})],Ri.prototype,"objectIdField",null),(0,h._)([(0,_.Cb)()],Ri.prototype,"orderByFields",void 0),(0,h._)([(0,_.Cb)({readOnly:!0})],Ri.prototype,"relatedFeatures",null),(0,h._)([(0,_.Cb)({readOnly:!0})],Ri.prototype,"relatedFeatureInfos",null),(0,h._)([(0,_.Cb)({readOnly:!0})],Ri.prototype,"relatedLayer",null),(0,h._)([(0,_.Cb)({readOnly:!0})],Ri.prototype,"relationship",null),(0,h._)([(0,_.Cb)()],Ri.prototype,"featureCount",void 0),(0,h._)([(0,_.Cb)({readOnly:!0})],Ri.prototype,"relatedFeatureViewModels",null),(0,h._)([(0,_.Cb)()],Ri.prototype,"relationshipId",void 0),(0,h._)([(0,_.Cb)()],Ri.prototype,"showAllEnabled",void 0),(0,h._)([(0,_.Cb)()],Ri.prototype,"state",null),(0,h._)([(0,_.Cb)()],Ri.prototype,"title",void 0),(0,h._)([(0,_.Cb)()],Ri.prototype,"getRelatedFeatureByObjectId",null);var Ni=Ri=(0,h._)([(0,x.j)("esri.widgets.Feature.FeatureRelationship.FeatureRelationshipViewModel")],Ri),Hi="esri-feature",zi="".concat(Hi,"-relationship"),Vi={base:zi,esriWidget:"esri-widget",listContainer:"".concat(zi,"__list"),listItem:"".concat(zi,"__list-item"),listItemHidden:"".concat(zi,"__list-item--hidden"),listContainerQuerying:"".concat(zi,"__list--querying"),featureObserver:"".concat(Hi,"__feature-observer"),stickySpinnerContainer:"".concat(Hi,"__sticky-loading-container"),loadingSpinnerContainer:"".concat(Hi,"__loading-container"),spinner:"".concat(Hi,"__loading-spinner"),iconLoading:"esri-icon-loading-indicator esri-rotating"},Wi={title:!0,description:!0},Yi=function(e){(0,c.Z)(h,e);var t=(0,d.Z)(h);function h(e,i){var n;return(0,l.Z)(this,h),(n=t.call(this,e,i))._featureElementInfo=null,n._relatedFeatureIntersectionObserverNode=null,n._relatedFeatureIntersectionObserver=new IntersectionObserver((function(e){var t=(0,s.Z)(e,1)[0];(null===t||void 0===t?void 0:t.isIntersecting)&&n._increaseFeaturePage()}),{root:window.document}),n.headingLevel=2,n.viewModel=new Ni,n.messages=null,n.messagesCommon=null,n.visibleElements=(0,o.Z)({},Wi),n._increaseFeaturePage=function(){var e=n.viewModel,t=e.state,i=e.showAllEnabled,r=e.relatedFeatures,a=e.featuresPerPage,o=e.featurePage;"ready"===t&&i&&r.length>=a*o&&n.viewModel.featurePage++},n}return(0,u.Z)(h,[{key:"initialize",value:function(){var e=this;this._featureElementInfo=new it,this.addHandles([(0,m.YP)((function(){return[e.viewModel.description,e.viewModel.title,e.headingLevel]}),(function(){return e._setupFeatureElementInfo()}),m.nn),(0,m.YP)((function(){return[e.viewModel.state,e.viewModel.showAllEnabled,e._relatedFeatureIntersectionObserverNode]}),(function(){return e._handleRelatedFeatureObserverChange()})),(0,m.on)((function(){return e.viewModel.relatedFeatureViewModels}),"change",(function(){return e._setupRelatedFeatureViewModels()}))])}},{key:"loadDependencies",value:function(){return(0,Re.h)({icon:function(){return i.e(7474).then(i.bind(i,87474))},list:function(){return Promise.all([i.e(2655),i.e(6820),i.e(9424)]).then(i.bind(i,39424))},"list-item":function(){return Promise.all([i.e(2655),i.e(6820),i.e(5138),i.e(7205)]).then(i.bind(i,7205))},notice:function(){return Promise.all([i.e(2655),i.e(1617)]).then(i.bind(i,51617))}})}},{key:"destroy",value:function(){this._unobserveRelatedFeatureObserver(),this._featureElementInfo=(0,Di.SC)(this._featureElementInfo)}},{key:"displayShowAllButton",get:function(){var e=this.viewModel,t=e.showAllEnabled,i=e.featureCount,n=e.displayCount,r=e.state;return!t&&!!i&&"ready"===r&&(i>n||0===n)}},{key:"displayListItems",get:function(){return this.displayShowAllButton||this.viewModel.relatedFeatureViewModels.length>0}},{key:"description",get:function(){return this.viewModel.description},set:function(e){this.viewModel.description=e}},{key:"featureCountDescription",get:function(){var e=this.messages,t=this.viewModel.featureCount;return(0,Jt.n)(null===e||void 0===e?void 0:e.numberRecords,{number:t})}},{key:"title",get:function(){return this.viewModel.title},set:function(e){this.viewModel.title=e}},{key:"castVisibleElements",value:function(e){return(0,o.Z)((0,o.Z)({},Wi),e)}},{key:"renderStickyLoading",value:function(){return"querying"===this.viewModel.state?(0,ze.u)("div",{key:"sticky-loader",class:Vi.stickySpinnerContainer},this.renderLoadingIcon()):null}},{key:"renderLoadingIcon",value:function(){return(0,ze.u)("span",{class:this.classes(Vi.iconLoading,Vi.spinner)})}},{key:"renderLoading",value:function(){return(0,ze.u)("div",{key:"loading-container",class:Vi.loadingSpinnerContainer},this.renderLoadingIcon())}},{key:"renderShowAllIconNode",value:function(){return(0,ze.u)("calcite-icon",{scale:"s",icon:"list",slot:"content-end"})}},{key:"renderChevronIconNode",value:function(){var e=(0,Ne.dZ)(this.container)?"chevron-left":"chevron-right";return(0,ze.u)("calcite-icon",{scale:"s",icon:e,slot:"content-end"})}},{key:"renderRelatedFeature",value:function(e){var t,i,n=this,r=this.viewModel.itemDescriptionFieldName,o=e.title;e.description=r&&(null===(t=e.formattedAttributes)||void 0===t?void 0:t.global[r]);var s="loading"===e.state;return(0,ze.u)("calcite-list-item",{class:this.classes(Vi.listItem,(0,a.Z)({},Vi.listItemHidden,s)),key:e.uid,label:o,description:null!==(i=e.description)&&void 0!==i?i:"",onCalciteListItemSelect:function(){return n.emit("select-record",{featureViewModel:e})}},this.renderChevronIconNode())}},{key:"renderShowAllListItem",value:function(){var e,t=this;return this.displayShowAllButton?(0,ze.u)("calcite-list-item",{key:"show-all-item",label:null===(e=this.messages)||void 0===e?void 0:e.showAll,description:this.featureCountDescription,onCalciteListItemSelect:function(){return t.emit("show-all-records")}},this.renderShowAllIconNode()):null}},{key:"renderNoRelatedFeaturesMessage",value:function(){var e;return(0,ze.u)("calcite-notice",{key:"no-related-features-message",icon:"information",open:!0,kind:"brand",scale:"s",width:"full"},(0,ze.u)("div",{slot:"message"},null===(e=this.messages)||void 0===e?void 0:e.noRelatedFeatures))}},{key:"renderFeatureObserver",value:function(){return(0,ze.u)("div",{key:"feature-observer",class:Vi.featureObserver,bind:this,afterCreate:this._relatedFeatureIntersectionObserverCreated})}},{key:"renderList",value:function(){var e=this,t=this.viewModel.relatedFeatureViewModels;return(0,ze.u)("calcite-list",null,t.toArray().map((function(t){return e.renderRelatedFeature(t)})),this.renderShowAllListItem())}},{key:"renderRelatedFeatures",value:function(){var e=this.displayListItems,t=this.viewModel.state;return(0,ze.u)("div",{key:"list-container",class:this.classes(Vi.listContainer,(0,a.Z)({},Vi.listContainerQuerying,"querying"===t))},e?this.renderList():"ready"===t?this.renderNoRelatedFeaturesMessage():null,this.renderStickyLoading(),this.renderFeatureObserver())}},{key:"renderRelationshipNotFound",value:function(){var e;return(0,ze.u)("calcite-notice",{key:"relationship-not-found",icon:"exclamation-mark-triangle",open:!0,kind:"danger",scale:"s",width:"full"},(0,ze.u)("div",{slot:"message"},null===(e=this.messages)||void 0===e?void 0:e.relationshipNotFound))}},{key:"render",value:function(){var e,t=this.viewModel.state;return(0,ze.u)("div",{class:this.classes(Vi.base,Vi.esriWidget)},null===(e=this._featureElementInfo)||void 0===e?void 0:e.render(),"loading"===t?this.renderLoading():"disabled"===t?this.renderRelationshipNotFound():this.renderRelatedFeatures())}},{key:"_setupRelatedFeatureViewModels",value:function(){var e=this,t=this.viewModel.relatedFeatureViewModels,i="related-feature-viewmodels";this.removeHandles(i),null!==t&&void 0!==t&&t.forEach((function(t){e.addHandles((0,m.YP)((function(){return[t.title,t.state]}),(function(){return e.scheduleRender()}),m.nn),i)})),this.scheduleRender()}},{key:"_setupFeatureElementInfo",value:function(){var e,t=this.headingLevel,i=this.visibleElements,n=i.description&&this.description,r=i.title&&this.title;null===(e=this._featureElementInfo)||void 0===e||e.set({description:n,title:r,headingLevel:t})}},{key:"_handleRelatedFeatureObserverChange",value:function(){var e=(0,r.Z)((0,n.Z)().mark((function e(){var t,i,r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._unobserveRelatedFeatureObserver(),t=this.viewModel,i=t.state,r=t.showAllEnabled,e.next=4,(0,Tt.e4)(0);case 4:this._relatedFeatureIntersectionObserverNode&&"ready"===i&&r&&this._relatedFeatureIntersectionObserver.observe(this._relatedFeatureIntersectionObserverNode);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_relatedFeatureIntersectionObserverCreated",value:function(e){this._relatedFeatureIntersectionObserverNode=e}},{key:"_unobserveRelatedFeatureObserver",value:function(){this._relatedFeatureIntersectionObserverNode&&this._relatedFeatureIntersectionObserver.unobserve(this._relatedFeatureIntersectionObserverNode)}}]),h}(C.Z);(0,h._)([(0,_.Cb)()],Yi.prototype,"_relatedFeatureIntersectionObserverNode",void 0),(0,h._)([(0,_.Cb)({readOnly:!0})],Yi.prototype,"displayShowAllButton",null),(0,h._)([(0,_.Cb)({readOnly:!0})],Yi.prototype,"displayListItems",null),(0,h._)([(0,_.Cb)()],Yi.prototype,"description",null),(0,h._)([(0,_.Cb)({readOnly:!0})],Yi.prototype,"featureCountDescription",null),(0,h._)([(0,_.Cb)()],Yi.prototype,"headingLevel",void 0),(0,h._)([(0,_.Cb)()],Yi.prototype,"title",null),(0,h._)([(0,_.Cb)({type:Ni})],Yi.prototype,"viewModel",void 0),(0,h._)([(0,_.Cb)(),(0,He.H)("esri/widgets/Feature/t9n/Feature")],Yi.prototype,"messages",void 0),(0,h._)([(0,_.Cb)(),(0,He.H)("esri/t9n/common")],Yi.prototype,"messagesCommon",void 0),(0,h._)([(0,_.Cb)()],Yi.prototype,"visibleElements",void 0),(0,h._)([(0,w.p)("visibleElements")],Yi.prototype,"castVisibleElements",null);var Ui,qi=Yi=(0,h._)([(0,x.j)("esri.widgets.Feature.FeatureRelationship")],Yi),Gi=(0,u.Z)((function e(t,i){(0,l.Z)(this,e),this.preLayerQueryCallback=t,this.preRequestCallback=i,this.preLayerQueryCallback||(this.preLayerQueryCallback=function(e){}),this.preRequestCallback||(this.preLayerQueryCallback=function(e){})})),Xi="content-view-models",Ki="relationship-view-models",$i={attachmentsContent:!0,chartAnimation:!0,customContent:!0,expressionContent:!0,fieldsContent:!0,mediaContent:!0,textContent:!0,relationshipContent:!0},Qi=Ui=function(e){(0,c.Z)(i,e);var t=(0,d.Z)(i);function i(e){var n;return(0,l.Z)(this,i),(n=t.call(this,e))._handles=new g.Z,n._error=null,n._featureAbortController=null,n._graphicChangedThrottled=(0,b.P)(n._graphicChanged,1,(0,Ct.Z)(n)),n._expressionAttributes=null,n._graphicExpressionAttributes=null,n.abilities=(0,o.Z)({},$i),n.content=null,n.contentViewModels=[],n.description=null,n.defaultPopupTemplateEnabled=!1,n.formattedAttributes=null,n.lastEditInfo=null,n.relatedInfos=new Map,n.title="",n.view=null,n._isAllowedContentType=function(e){var t=(0,Ct.Z)(n).abilities;return"attachments"===e.type&&!!t.attachmentsContent||"custom"===e.type&&!!t.customContent||"fields"===e.type&&!!t.fieldsContent||"media"===e.type&&!!t.mediaContent||"text"===e.type&&!!t.textContent||"expression"===e.type&&!!t.expressionContent||"relationship"===e.type&&!!t.relationshipContent},n._handles.add((0,m.YP)((function(){return[n.graphic,n._effectivePopupTemplate,n.abilities]}),(function(){return n._graphicChangedThrottled()}),m.nn)),n}return(0,u.Z)(i,[{key:"initialize",value:function(){this.addHandles(this._graphicChangedThrottled)}},{key:"destroy",value:function(){this._clear(),this._cancelFeatureQuery(),this._error=null,this._handles.destroy(),this.graphic=null,this._destroyContentViewModels(),this.relatedInfos.clear()}},{key:"_effectivePopupTemplate",get:function(){return null!=this.graphic?this.graphic.getEffectivePopupTemplate(this.defaultPopupTemplateEnabled):null}},{key:"_fieldInfoMap",get:function(){return function(e,t){var i=new Map;return e?(e.forEach((function(e){var n=re(e.fieldName,t);e.fieldName=n,i.set(n.toLowerCase(),e)})),i):i}(ye(this._effectivePopupTemplate),this._sourceLayer)}},{key:"_sourceLayer",get:function(){return Q(this.graphic)}},{key:"castAbilities",value:function(e){return(0,o.Z)((0,o.Z)({},$i),e)}},{key:"isTable",get:function(){var e;return(null===(e=this._sourceLayer)||void 0===e?void 0:e.isTable)||!1}},{key:"state",get:function(){return this.graphic?this._error?"error":this.waitingForContent?"loading":"ready":"disabled"}},{key:"graphic",set:function(e){this._set("graphic",e?e.clone():null)}},{key:"spatialReference",get:function(){var e,t;return null!==(e=null===(t=this.view)||void 0===t?void 0:t.spatialReference)&&void 0!==e?e:null},set:function(e){this._override("spatialReference",e)}},{key:"map",get:function(){var e;return(null===(e=this.view)||void 0===e?void 0:e.map)||null},set:function(e){this._override("map",e)}},{key:"waitingForContent",get:function(){return!!this._featureAbortController}},{key:"setActiveMedia",value:function(e,t){var i=this.contentViewModels[e];i instanceof Kt&&i.setActiveMedia(t)}},{key:"nextMedia",value:function(e){var t=this.contentViewModels[e];t instanceof Kt&&t.next()}},{key:"previousMedia",value:function(e){var t=this.contentViewModels[e];t instanceof Kt&&t.previous()}},{key:"updateGeometry",value:function(){var e=(0,r.Z)((0,n.Z)().mark((function e(){var t,i,r,a,o,s,l,u,c;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.graphic,r=this.spatialReference,a=this._sourceLayer,e.next=3,null===a||void 0===a?void 0:a.load();case 3:if((o=null===a||void 0===a?void 0:a.objectIdField)&&i&&a){e.next=6;break}return e.abrupt("return");case 6:if(null!=(s=null===i||void 0===i||null===(t=i.attributes)||void 0===t?void 0:t[o])){e.next=9;break}return e.abrupt("return");case 9:if(l=[s],i.geometry){e.next=16;break}return e.next=13,ke({layer:a,graphic:i,outFields:[],objectIds:l,returnGeometry:!0,spatialReference:r});case 13:u=e.sent,(c=null===u||void 0===u?void 0:u.geometry)&&(i.geometry=c);case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_clear",value:function(){this._set("title",""),this._set("content",null),this._set("formattedAttributes",null)}},{key:"_graphicChanged",value:function(){var e=(0,r.Z)((0,n.Z)().mark((function e(){var t,i;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._cancelFeatureQuery(),this._error=null,this._clear(),t=this.graphic){e.next=4;break}return e.abrupt("return");case 4:return i=new AbortController,this._featureAbortController=i,e.prev=6,e.next=9,this._queryFeature({signal:i.signal});case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(6),(0,Tt.D_)(e.t0)||(this._error=e.t0,y.Z.getLogger(this).error("error","The popupTemplate could not be displayed for this feature.",{error:e.t0,graphic:t,popupTemplate:this._effectivePopupTemplate}));case 14:this._featureAbortController===i&&(this._featureAbortController=null);case 15:case"end":return e.stop()}}),e,this,[[6,11]])})));return function(){return e.apply(this,arguments)}}()},{key:"_cancelFeatureQuery",value:function(){var e=this._featureAbortController;e&&e.abort(),this._featureAbortController=null}},{key:"_compileContentElement",value:function(e,t){return"attachments"===e.type?this._compileAttachments(e,t):"custom"===e.type?this._compileCustom(e,t):"fields"===e.type?this._compileFields(e,t):"media"===e.type?this._compileMedia(e,t):"text"===e.type?this._compileText(e,t):"expression"===e.type?this._compileExpression(e,t):"relationship"===e.type?this._compileRelationship(e,t):void 0}},{key:"_compileContent",value:function(e){var t=this;if(this._destroyContentViewModels(),this.graphic)return Array.isArray(e)?e.filter(this._isAllowedContentType).map((function(e,i){return t._compileContentElement(e,i)})).filter(k.pC):"string"==typeof e?this._compileText(new ui.Z({text:e}),0).text:e}},{key:"_destroyContentViewModels",value:function(){var e,t;null!==(e=this._handles)&&void 0!==e&&e.remove(Ki),null!==(t=this._handles)&&void 0!==t&&t.remove(Xi),this.contentViewModels.forEach((function(e){return e&&!e.destroyed&&e.destroy()})),this._set("contentViewModels",[])}},{key:"_matchesFeature",value:function(e,t){var i,n=null===e||void 0===e||null===(i=e.graphic)||void 0===i?void 0:i.getObjectId(),r=null===t||void 0===t?void 0:t.getObjectId();return null!=n&&null!=r&&n===r}},{key:"_setRelatedFeaturesViewModels",value:function(e){var t=this,i=e.relatedFeatureViewModels,n=e.relatedFeatures,r=e.map,a=this.view,o=this.spatialReference;null!==n&&void 0!==n&&n.filter(Boolean).forEach((function(e){i.find((function(i){return t._matchesFeature(i,e)}))||i.add(new Ui({abilities:{relationshipContent:!1},map:r,view:a,spatialReference:o,graphic:e}))})),i.forEach((function(e){var r=null===n||void 0===n?void 0:n.find((function(i){return t._matchesFeature(e,i)}));r||i.remove(e)}))}},{key:"_setExpressionContentVM",value:function(e,t){var i=this.formattedAttributes,n=e.contentElement,r=e.contentElementViewModel,a=null===n||void 0===n?void 0:n.type;r&&a&&("fields"===a&&(this._createFieldsFormattedAttributes({contentElement:n,contentElementIndex:t,formattedAttributes:i}),r.set(this._createFieldsVMParams(n,t))),"media"===a&&(this._createMediaFormattedAttributes({contentElement:n,contentElementIndex:t,formattedAttributes:i}),r.set(this._createMediaVMParams(n,t))),"text"===a&&r.set(this._createTextVMParams(n)))}},{key:"_compileRelationship",value:function(e,t){var i=this,n=e.displayCount,r=e.orderByFields,a=e.relationshipId,s=e.title,l=e.description,u=this._sourceLayer,c=this.graphic,d=this.map;if(ve(u)){var h=new Ni((0,o.Z)({displayCount:n,graphic:c,orderByFields:r,relationshipId:a,layer:u,map:d},this._compileTitleAndDesc({title:s,description:l})));return this.contentViewModels[t]=h,this._handles.add((0,m.on)((function(){return h.relatedFeatures}),"change",(function(){return i._setRelatedFeaturesViewModels(h)})),Ki),e}}},{key:"_compileExpression",value:function(e,t){var i=this,n=e.expressionInfo,r=this.graphic,a=this.map,o=this.spatialReference,s=this.view,l=new Mi({expressionInfo:n,graphic:r,interceptor:Ui.interceptor,map:a,spatialReference:o,view:s});return this.contentViewModels[t]=l,this._handles.add((0,m.YP)((function(){return l.contentElementViewModel}),(function(){return i._setExpressionContentVM(l,t)}),m.nn),Xi),e}},{key:"_compileAttachments",value:function(e,t){var i=this.graphic,n=e.description,r=e.title;return this.contentViewModels[t]=new $e((0,o.Z)({graphic:i},this._compileTitleAndDesc({title:r,description:n}))),e}},{key:"_compileCustom",value:function(e,t){var i=this.graphic,n=e.creator,r=e.destroyer;return this.contentViewModels[t]=new lt({graphic:i,creator:n,destroyer:r}),e}},{key:"_compileTitleAndDesc",value:function(e){var t=e.title,i=e.description,n=this._fieldInfoMap,r=this._sourceLayer,a=this.graphic,o=this.formattedAttributes,s=null===a||void 0===a?void 0:a.attributes,l=this._expressionAttributes,u=o.global;return{title:se({attributes:s,fieldInfoMap:n,globalAttributes:u,expressionAttributes:l,layer:r,text:t}),description:se({attributes:s,fieldInfoMap:n,globalAttributes:u,expressionAttributes:l,layer:r,text:i})}}},{key:"_createFieldsVMParams",value:function(e,t){var i=this._effectivePopupTemplate,n=this.formattedAttributes,r=(0,o.Z)((0,o.Z)({},null===n||void 0===n?void 0:n.global),null===n||void 0===n?void 0:n.content[t]),a=(null===e||void 0===e?void 0:e.fieldInfos)||(null===i||void 0===i?void 0:i.fieldInfos),s=null===a||void 0===a?void 0:a.filter((function(e){var t=e.fieldName;return ie(t)||Ae(t)||r.hasOwnProperty(t)})),l=null===i||void 0===i?void 0:i.expressionInfos,u=e.description,c=e.title;return(0,o.Z)({attributes:r,expressionInfos:l,fieldInfos:s},this._compileTitleAndDesc({title:c,description:u}))}},{key:"_compileFields",value:function(e,t){var i=e.clone(),n=new yt(this._createFieldsVMParams(e,t));return this.contentViewModels[t]=n,i.fieldInfos=n.formattedFieldInfos.slice(0),i}},{key:"_createMediaVMParams",value:function(e,t){var i,n=this.abilities,r=this.graphic,a=this._fieldInfoMap,s=this._effectivePopupTemplate,l=this.relatedInfos,u=this._sourceLayer,c=this._expressionAttributes,d=this.formattedAttributes,h=null!==(i=null===r||void 0===r?void 0:r.attributes)&&void 0!==i?i:{},f=e.description,v=e.mediaInfos,p=e.title;return(0,o.Z)({abilities:{chartAnimation:n.chartAnimation},activeMediaInfoIndex:e.activeMediaInfoIndex||0,attributes:h,isAggregate:null===r||void 0===r?void 0:r.isAggregate,layer:u,fieldInfoMap:a,formattedAttributes:(0,o.Z)((0,o.Z)({},null===d||void 0===d?void 0:d.global),null===d||void 0===d?void 0:d.content[t]),expressionAttributes:c,mediaInfos:v,popupTemplate:s,relatedInfos:l},this._compileTitleAndDesc({title:p,description:f}))}},{key:"_compileMedia",value:function(e,t){var i=e.clone(),n=new Kt(this._createMediaVMParams(e,t));return i.mediaInfos=n.formattedMediaInfos.slice(0),this.contentViewModels[t]=n,i}},{key:"_createTextVMParams",value:function(e){var t=this.graphic,i=this._fieldInfoMap,n=this._sourceLayer,r=this._expressionAttributes;if(e&&e.text){var a,o,s,l=null!==(a=null===t||void 0===t?void 0:t.attributes)&&void 0!==a?a:{},u=null!==(o=null===(s=this.formattedAttributes)||void 0===s?void 0:s.global)&&void 0!==o?o:{};e.text=se({attributes:l,fieldInfoMap:i,globalAttributes:u,expressionAttributes:r,layer:n,text:e.text})}return{graphic:t,creator:e.text}}},{key:"_compileText",value:function(e,t){var i=e.clone();return this.contentViewModels[t]=new lt(this._createTextVMParams(i)),i}},{key:"_compileLastEditInfo",value:function(){var e=this._effectivePopupTemplate,t=this._sourceLayer,i=this.graphic;if(e){var n=e.lastEditInfoEnabled,r=null===t||void 0===t?void 0:t.editFieldsInfo;return n&&r?function(e,t){var i=e.creatorField,n=e.creationDateField,r=e.editorField,a=e.editDateField;if(t){var o=t[a];if("number"==typeof o){var s=t[r];return{type:"edit",date:(0,B.p6)(o,$),user:s}}var l=t[n];if("number"==typeof l){var u=t[i];return{type:"create",date:(0,B.p6)(l,$),user:u}}return null}}(r,null===i||void 0===i?void 0:i.attributes):void 0}}},{key:"_compileTitle",value:function(e){var t,i,n,r=this._fieldInfoMap,a=this._sourceLayer,o=this.graphic,s=this._expressionAttributes;return se({attributes:null!==(t=null===o||void 0===o?void 0:o.attributes)&&void 0!==t?t:{},fieldInfoMap:r,globalAttributes:null!==(i=null===(n=this.formattedAttributes)||void 0===n?void 0:n.global)&&void 0!==i?i:{},expressionAttributes:s,layer:a,text:e})}},{key:"_getTitle",value:function(){var e=(0,r.Z)((0,n.Z)().mark((function e(){var t,i,r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this._effectivePopupTemplate,i=this.graphic){e.next=3;break}return e.abrupt("return",null);case 3:return r=null===t||void 0===t?void 0:t.title,e.abrupt("return",J(r,{graphic:i}));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_getContent",value:function(){var e=(0,r.Z)((0,n.Z)().mark((function e(){var t,i,r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this._effectivePopupTemplate,i=this.graphic){e.next=3;break}return e.abrupt("return",null);case 3:return r=null===t||void 0===t?void 0:t.content,e.abrupt("return",J(r,{graphic:i}));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_queryFeature",value:function(){var e=(0,r.Z)((0,n.Z)().mark((function e(t){var i,r,a,s,l,u,c,d,h,f,v,p;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this._featureAbortController,r=this._sourceLayer,a=this.graphic,s=this._effectivePopupTemplate,l=this.map,u=this.view,c=this.spatialReference,i===this._featureAbortController&&a){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,Pe({graphic:a,popupTemplate:s,layer:r,spatialReference:c},t);case 5:return e.next=7,(0,Tt.as)({content:this._getContent(),title:this._getTitle()});case 7:return d=e.sent,h=d.content.value,f=d.title.value,e.next=12,(0,Tt.as)({checkForRelatedFeatures:this._checkForRelatedFeatures(t),expressionAttributes:ki({expressionInfos:null===s||void 0===s?void 0:s.expressionInfos,spatialReference:c,graphic:a,map:l,interceptor:Ui.interceptor,view:u})});case 12:v=e.sent,p=v.expressionAttributes.value,i===this._featureAbortController&&a&&(this._expressionAttributes=p,this._graphicExpressionAttributes=(0,o.Z)((0,o.Z)({},a.attributes),p),this._set("formattedAttributes",this._createFormattedAttributes(h)),this._set("title",this._compileTitle(f)),this._set("lastEditInfo",this._compileLastEditInfo()||null),this._set("content",this._compileContent(h)||null));case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_createMediaFormattedAttributes",value:function(e){var t=e.contentElement,i=e.contentElementIndex,n=e.formattedAttributes,r=this._effectivePopupTemplate,a=this.graphic,s=this.relatedInfos,l=this._sourceLayer,u=this._fieldInfoMap,c=this._graphicExpressionAttributes;n.content[i]=we({fieldInfos:null===r||void 0===r?void 0:r.fieldInfos,graphic:a,attributes:(0,o.Z)((0,o.Z)({},c),t.attributes),layer:l,fieldInfoMap:u,relatedInfos:s})}},{key:"_createFieldsFormattedAttributes",value:function(e){var t=e.contentElement,i=e.contentElementIndex,n=e.formattedAttributes;if(t.fieldInfos){var r=this.graphic,a=this.relatedInfos,s=this._sourceLayer,l=this._fieldInfoMap,u=this._graphicExpressionAttributes;n.content[i]=we({fieldInfos:t.fieldInfos,graphic:r,attributes:(0,o.Z)((0,o.Z)({},u),t.attributes),layer:s,fieldInfoMap:l,relatedInfos:a})}}},{key:"_createFormattedAttributes",value:function(e){var t=this,i=this._effectivePopupTemplate,n=this.graphic,r=this.relatedInfos,a=this._sourceLayer,o=this._fieldInfoMap,s=this._graphicExpressionAttributes,l={global:we({fieldInfos:null===i||void 0===i?void 0:i.fieldInfos,graphic:n,attributes:s,layer:a,fieldInfoMap:o,relatedInfos:r}),content:[]};return Array.isArray(e)&&e.forEach((function(e,i){"fields"===e.type&&t._createFieldsFormattedAttributes({contentElement:e,contentElementIndex:i,formattedAttributes:l}),"media"===e.type&&t._createMediaFormattedAttributes({contentElement:e,contentElementIndex:i,formattedAttributes:l})})),l}},{key:"_checkForRelatedFeatures",value:function(e){var t=this.graphic,i=this._effectivePopupTemplate;return this._queryRelatedInfos(t,ye(i),e)}},{key:"_queryRelatedInfos",value:function(){var e=(0,r.Z)((0,n.Z)().mark((function e(t,i,r){var a,o,s,l,u,c,d=this;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=this.relatedInfos,o=this._sourceLayer,a.clear(),null==(null===o||void 0===o?void 0:o.associatedLayer)){e.next=8;break}return e.next=5,null===o||void 0===o?void 0:o.associatedLayer.load(r);case 5:e.t0=e.sent,e.next=9;break;case 8:e.t0=o;case 9:if((s=e.t0)&&t){e.next=12;break}return e.abrupt("return");case 12:if(l=i.filter((function(e){return e&&Ae(e.fieldName)})),l&&l.length){e.next=15;break}return e.abrupt("return");case 15:return i.forEach((function(e){return d._configureRelatedInfo(e,s)})),e.next=18,Yt({relatedInfos:a,layer:s},r);case 18:return u=e.sent,Object.keys(u).forEach((function(e){var t,i=a.get(e.toString()),n=null===(t=u[e])||void 0===t?void 0:t.value;i&&n&&(i.layerInfo=n.data)})),e.next=22,Ut({graphic:t,relatedInfos:a,layer:s},r);case 22:c=e.sent,Object.keys(c).forEach((function(e){var t;Ht(null===(t=c[e])||void 0===t?void 0:t.value,a.get(e.toString()))}));case 24:case"end":return e.stop()}}),e,this)})));return function(t,i,n){return e.apply(this,arguments)}}()},{key:"_configureRelatedInfo",value:function(e,t){var i=this.relatedInfos,n=Lt(e.fieldName);if(n){var r=n.layerId,a=n.fieldName;if(r){var o=i.get(r.toString())||Nt(r,t);o&&(function(e){var t,i=e.relatedInfo,n=e.fieldName,r=e.fieldInfo;if(null!==(t=i.relatedFields)&&void 0!==t&&t.push(n),r.statisticType){var a,o=new Et.Z({statisticType:r.statisticType,onStatisticField:n,outStatisticFieldName:n});null===(a=i.outStatistics)||void 0===a||a.push(o)}}({relatedInfo:o,fieldName:a,fieldInfo:e}),this.relatedInfos.set(r,o))}}}}]),i}((0,Ei.IG)(D.Z));Qi.interceptor=new Gi((function(e){var t=e.query,i=e.layer,n=e.method;Oe({layer:i,method:n,query:t,definitionExpression:"".concat(i.definitionExpression," ").concat(i.serviceDefinitionExpression)})}),(function(e){var t=e.queryPayload,i=e.layer,n=e.method;Oe({layer:i,method:n,query:t,definitionExpression:"".concat(i.definitionExpression," ").concat(i.serviceDefinitionExpression)})})),(0,h._)([(0,_.Cb)()],Qi.prototype,"_error",void 0),(0,h._)([(0,_.Cb)()],Qi.prototype,"_featureAbortController",void 0),(0,h._)([(0,_.Cb)({readOnly:!0})],Qi.prototype,"_effectivePopupTemplate",null),(0,h._)([(0,_.Cb)({readOnly:!0})],Qi.prototype,"_fieldInfoMap",null),(0,h._)([(0,_.Cb)({readOnly:!0})],Qi.prototype,"_sourceLayer",null),(0,h._)([(0,_.Cb)()],Qi.prototype,"abilities",void 0),(0,h._)([(0,w.p)("abilities")],Qi.prototype,"castAbilities",null),(0,h._)([(0,_.Cb)({readOnly:!0})],Qi.prototype,"content",void 0),(0,h._)([(0,_.Cb)({readOnly:!0})],Qi.prototype,"contentViewModels",void 0),(0,h._)([(0,_.Cb)()],Qi.prototype,"description",void 0),(0,h._)([(0,_.Cb)({type:Boolean})],Qi.prototype,"defaultPopupTemplateEnabled",void 0),(0,h._)([(0,_.Cb)({readOnly:!0})],Qi.prototype,"isTable",null),(0,h._)([(0,_.Cb)({readOnly:!0})],Qi.prototype,"state",null),(0,h._)([(0,_.Cb)({readOnly:!0})],Qi.prototype,"formattedAttributes",void 0),(0,h._)([(0,_.Cb)({type:O.Z,value:null})],Qi.prototype,"graphic",null),(0,h._)([(0,_.Cb)({readOnly:!0})],Qi.prototype,"lastEditInfo",void 0),(0,h._)([(0,_.Cb)({readOnly:!0})],Qi.prototype,"relatedInfos",void 0),(0,h._)([(0,_.Cb)()],Qi.prototype,"spatialReference",null),(0,h._)([(0,_.Cb)({readOnly:!0})],Qi.prototype,"title",void 0),(0,h._)([(0,_.Cb)()],Qi.prototype,"map",null),(0,h._)([(0,_.Cb)({readOnly:!0})],Qi.prototype,"waitingForContent",null),(0,h._)([(0,_.Cb)()],Qi.prototype,"view",void 0);var Ji,en=Qi=Ui=(0,h._)([(0,x.j)("esri.widgets.FeatureViewModel")],Qi),tn="esri-feature",nn={iconText:"esri-icon-font-fallback-text",iconLoading:"esri-icon-loading-indicator esri-rotating",esriTable:"esri-widget__table",esriWidget:"esri-widget",base:tn,container:"".concat(tn,"__size-container"),title:"".concat(tn,"__title"),main:"".concat(tn,"__main-container"),btn:"".concat(tn,"__button"),icon:"".concat(tn,"__icon"),content:"".concat(tn,"__content"),contentNode:"".concat(tn,"__content-node"),contentElement:"".concat(tn,"__content-element"),text:"".concat(tn,"__text"),lastEditedInfo:"".concat(tn,"__last-edited-info"),fields:"".concat(tn,"__fields"),fieldHeader:"".concat(tn,"__field-header"),fieldData:"".concat(tn,"__field-data"),fieldDataDate:"".concat(tn,"__field-data--date"),loadingSpinnerContainer:"".concat(tn,"__loading-container"),spinner:"".concat(tn,"__loading-spinner")},rn=function(e){var t=function(e){(0,c.Z)(i,e);var t=(0,d.Z)(i);function i(){var e;return(0,l.Z)(this,i),(e=t.apply(this,arguments)).renderNodeContent=function(t){return(0,ut.Qd)(t)&&!t.destroyed?(0,ze.u)("div",{class:nn.contentNode,key:t},t.render()):t instanceof HTMLElement?(0,ze.u)("div",{class:nn.contentNode,key:t,bind:t,afterCreate:e._attachToNode}):(0,ut.o)(t)?(0,ze.u)("div",{class:nn.contentNode,key:t,bind:t.domNode,afterCreate:e._attachToNode}):null},e}return(0,u.Z)(i,[{key:"_attachToNode",value:function(e){e.appendChild(this)}}]),i}(e);return t=(0,h._)([(0,x.j)("esri.widgets.Feature.ContentMixin")],t)},an={title:!0,content:!0,lastEditedInfo:!0},on="relationship-handles",sn=Ji=function(e){(0,c.Z)(n,e);var t=(0,d.Z)(n);function n(e,i){var r;return(0,l.Z)(this,n),(r=t.call(this,e,i))._contentWidgets=[],r.flowItems=null,r.headingLevel=2,r.messages=null,r.messagesCommon=null,r.messagesURIUtils=null,r.visibleElements=(0,o.Z)({},an),r.viewModel=new en,r}return(0,u.Z)(n,[{key:"initialize",value:function(){var e=this;this.addHandles((0,m.YP)((function(){var t;return null===(t=e.viewModel)||void 0===t?void 0:t.contentViewModels}),(function(){return e._setupContentWidgets()}),m.nn))}},{key:"loadDependencies",value:function(){return(0,Re.h)({notice:function(){return Promise.all([i.e(2655),i.e(1617)]).then(i.bind(i,51617))}})}},{key:"destroy",value:function(){this._destroyContentWidgets()}},{key:"graphic",get:function(){return this.viewModel.graphic},set:function(e){this.viewModel.graphic=e}},{key:"defaultPopupTemplateEnabled",get:function(){return this.viewModel.defaultPopupTemplateEnabled},set:function(e){this.viewModel.defaultPopupTemplateEnabled=e}},{key:"isTable",get:function(){return this.viewModel.isTable}},{key:"label",get:function(){var e,t;return null!==(e=null===(t=this.messages)||void 0===t?void 0:t.widgetLabel)&&void 0!==e?e:""},set:function(e){this._overrideIfSome("label",e)}},{key:"spatialReference",get:function(){return this.viewModel.spatialReference},set:function(e){this.viewModel.spatialReference=e}},{key:"title",get:function(){return this.viewModel.title}},{key:"castVisibleElements",value:function(e){return(0,o.Z)((0,o.Z)({},an),e)}},{key:"map",get:function(){return this.viewModel.map},set:function(e){this.viewModel.map=e}},{key:"view",get:function(){return this.viewModel.view},set:function(e){this.viewModel.view=e}},{key:"render",value:function(){var e=this.viewModel.state,t=(0,ze.u)("div",{class:nn.container,key:"container"},this.renderTitle(),"error"===e?this.renderError():"loading"===e?this.renderLoading():this.renderContentContainer());return(0,ze.u)("div",{class:this.classes(nn.base,nn.esriWidget)},t)}},{key:"setActiveMedia",value:function(e,t){return this.viewModel.setActiveMedia(e,t)}},{key:"nextMedia",value:function(e){return this.viewModel.nextMedia(e)}},{key:"previousMedia",value:function(e){return this.viewModel.previousMedia(e)}},{key:"renderError",value:function(){var e=this.messagesCommon,t=this.messages,i=this.visibleElements;return(0,ze.u)("calcite-notice",{open:!0,kind:"danger",icon:"exclamation-mark-circle",scale:"s"},i.title?(0,ze.u)("div",{key:"error-title",slot:"title"},e.errorMessage):null,(0,ze.u)("div",{key:"error-message",slot:"message"},t.loadingError))}},{key:"renderLoading",value:function(){return(0,ze.u)("div",{key:"loading-container",class:nn.loadingSpinnerContainer},(0,ze.u)("span",{class:this.classes(nn.iconLoading,nn.spinner)}))}},{key:"renderContentContainer",value:function(){return this.visibleElements.content?(0,ze.u)("div",{class:nn.main},[this.renderContent(),this.renderLastEditInfo()]):null}},{key:"renderTitle",value:function(){var e=this.visibleElements,t=this.title;return e.title?(0,ze.u)(Qe.X6,{level:this.headingLevel,class:nn.title,innerHTML:t}):null}},{key:"renderContent",value:function(){var e=this.viewModel.content,t="content";if(!e)return null;if(Array.isArray(e))return e.length?(0,ze.u)("div",{class:nn.contentNode,key:"".concat(t,"-content-elements")},e.map(this.renderContentElement,this)):null;if("string"==typeof e){var i=this._contentWidgets[0];return!i||i.destroyed?null:(0,ze.u)("div",{class:nn.contentNode,key:"".concat(t,"-content")},i.render())}return this.renderNodeContent(e)}},{key:"renderContentElement",value:function(e,t){var i,n=this.visibleElements;if("boolean"!=typeof n.content&&(null===(i=n.content)||void 0===i||!i[e.type]))return null;switch(e.type){case"attachments":return this.renderAttachments(t);case"custom":return this.renderCustom(e,t);case"fields":return this.renderFields(t);case"media":return this.renderMedia(t);case"text":return this.renderText(e,t);case"expression":return this.renderExpression(t);case"relationship":return this.renderRelationship(t);default:return null}}},{key:"renderAttachments",value:function(e){var t=this._contentWidgets[e];if(!t||t.destroyed)return null;var i=t.viewModel,n=i.state,r=i.attachmentInfos;return"loading"===n||r.length>0?(0,ze.u)("div",{key:this._buildKey("attachments-element",e),class:this.classes(nn.contentElement)},t.render()):null}},{key:"renderRelationship",value:function(e){var t=this._contentWidgets[e];return t&&!t.destroyed&&this.flowItems?(0,ze.u)("div",{key:this._buildKey("relationship-element",e),class:nn.contentElement},t.render()):null}},{key:"renderExpression",value:function(e){var t=this._contentWidgets[e];return!t||t.destroyed?null:(0,ze.u)("div",{key:this._buildKey("expression-element",e),class:nn.contentElement},t.render())}},{key:"renderCustom",value:function(e,t){var i=e.creator,n=this._contentWidgets[t];return!n||n.destroyed?null:i?(0,ze.u)("div",{key:this._buildKey("custom-element",t),class:nn.contentElement},n.render()):null}},{key:"renderFields",value:function(e){var t=this._contentWidgets[e];return!t||t.destroyed?null:(0,ze.u)("div",{key:this._buildKey("fields-element",e),class:nn.contentElement},t.render())}},{key:"renderMedia",value:function(e){var t=this._contentWidgets[e];return!t||t.destroyed?null:(0,ze.u)("div",{key:this._buildKey("media-element",e),class:nn.contentElement},t.render())}},{key:"renderLastEditInfo",value:function(){var e=this.visibleElements,t=this.messages,i=this.viewModel.lastEditInfo;if(!i||!e.lastEditedInfo)return null;var n=i.date,r=i.user,a="edit"===i.type?r?t.lastEditedByUser:t.lastEdited:r?t.lastCreatedByUser:t.lastCreated,o=(0,Jt.n)(a,{date:n,user:r});return(0,ze.u)("div",{key:"edit-info-element",class:this.classes(nn.lastEditedInfo,nn.contentElement)},o)}},{key:"renderText",value:function(e,t){var i=e.text,n=this._contentWidgets[t];return!n||n.destroyed?null:i?(0,ze.u)("div",{key:this._buildKey("text-element",t),class:this.classes(nn.contentElement,nn.text)},n.render()):null}},{key:"_buildKey",value:function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return"".concat(e,"__").concat(this.get("viewModel.graphic.uid")||"0","-").concat(i.join("-"))}},{key:"_destroyContentWidget",value:function(e){e&&(e.viewModel=null,!e.destroyed&&e.destroy())}},{key:"_destroyContentWidgets",value:function(){var e=this;this.removeHandles(on),this._contentWidgets.forEach((function(t){return e._destroyContentWidget(t)})),this._contentWidgets=[]}},{key:"_addFeatureRelationshipHandles",value:function(e){var t=this,i=this.flowItems,n=this.visibleElements;this.addHandles([(0,m.on)((function(){return e}),"select-record",(function(e){var t=e.featureViewModel;i&&(t.abilities={relationshipContent:!0},i.push(new Ji({flowItems:i,viewModel:t,visibleElements:n})))})),(0,m.on)((function(){return e}),"show-all-records",(function(){if(i){var n=e.viewModel;n.showAllEnabled=!0;var r=new qi({visibleElements:{title:!1,description:!1},viewModel:n});t._addFeatureRelationshipHandles(r),i.push(r)}}))],on)}},{key:"_setupContentWidgets",value:function(){var e=this;this._destroyContentWidgets();var t=this.headingLevel,i=this.visibleElements,n=this.get("viewModel.content"),r=this.viewModel.contentViewModels;if(Array.isArray(n))n.forEach((function(n,a){if("attachments"===n.type&&(e._contentWidgets[a]=new at({displayType:n.displayType,headingLevel:i.title?t+1:t,viewModel:r[a]})),"fields"===n.type&&(e._contentWidgets[a]=new xt({viewModel:r[a]})),"media"===n.type&&(e._contentWidgets[a]=new oi({viewModel:r[a]})),"text"===n.type&&(e._contentWidgets[a]=new ft({viewModel:r[a]})),"custom"===n.type&&(e._contentWidgets[a]=new ft({viewModel:r[a]})),"expression"===n.type&&(e._contentWidgets[a]=new Oi({viewModel:r[a]})),"relationship"===n.type){var o=new qi({viewModel:r[a]});e._addFeatureRelationshipHandles(o),e._contentWidgets[a]=o}}),this);else{var a=r[0];a&&!a.destroyed&&(this._contentWidgets[0]=new ft({viewModel:a}))}this.scheduleRender()}}]),n}(rn(C.Z));(0,h._)([(0,_.Cb)()],sn.prototype,"graphic",null),(0,h._)([(0,_.Cb)()],sn.prototype,"defaultPopupTemplateEnabled",null),(0,h._)([(0,_.Cb)()],sn.prototype,"flowItems",void 0),(0,h._)([(0,_.Cb)()],sn.prototype,"headingLevel",void 0),(0,h._)([(0,_.Cb)({readOnly:!0})],sn.prototype,"isTable",null),(0,h._)([(0,_.Cb)()],sn.prototype,"label",null),(0,h._)([(0,_.Cb)(),(0,He.H)("esri/widgets/Feature/t9n/Feature")],sn.prototype,"messages",void 0),(0,h._)([(0,_.Cb)(),(0,He.H)("esri/t9n/common")],sn.prototype,"messagesCommon",void 0),(0,h._)([(0,_.Cb)(),(0,He.H)("esri/widgets/support/t9n/uriUtils")],sn.prototype,"messagesURIUtils",void 0),(0,h._)([(0,_.Cb)()],sn.prototype,"spatialReference",null),(0,h._)([(0,_.Cb)({readOnly:!0})],sn.prototype,"title",null),(0,h._)([(0,_.Cb)()],sn.prototype,"visibleElements",void 0),(0,h._)([(0,w.p)("visibleElements")],sn.prototype,"castVisibleElements",null),(0,h._)([(0,_.Cb)()],sn.prototype,"map",null),(0,h._)([(0,_.Cb)()],sn.prototype,"view",null),(0,h._)([(0,_.Cb)({type:en})],sn.prototype,"viewModel",void 0);var ln,un=sn=Ji=(0,h._)([(0,x.j)("esri.widgets.Feature")],sn),cn=i(91505),dn=Symbol("anchorHandles"),hn=function(e){(0,c.Z)(i,e);var t=(0,d.Z)(i);function i(e){var n;return(0,l.Z)(this,i),(n=t.call(this,e))[ln]=new g.Z,n.location=null,n.screenLocationEnabled=!1,n.view=null,n[dn].add([(0,m.gx)((function(){return(0,Di.yw)(n.screenLocationEnabled?n.view:null,(function(e){return[e.size,"3d"===e.type?e.camera:e.viewpoint]}))}),(function(){return n.notifyChange("screenLocation")})),(0,m.YP)((function(){return n.screenLocation}),(function(e,t){null!=e&&null!=t&&n.emit("view-change")}))]),n}return(0,u.Z)(i,[{key:"destroy",value:function(){this.view=null,this[dn]=(0,Di.SC)(this[dn])}},{key:"screenLocation",get:function(){var e,t=this.location,i=this.view;return this.screenLocationEnabled&&null!=t&&null!=i&&i.ready?null===(e=i.toScreen)||void 0===e?void 0:e.call(i,t):null}}]),i}(cn.Z.EventedAccessor);ln=dn,(0,h._)([(0,_.Cb)()],hn.prototype,"location",void 0),(0,h._)([(0,_.Cb)()],hn.prototype,"screenLocation",null),(0,h._)([(0,_.Cb)()],hn.prototype,"screenLocationEnabled",void 0),(0,h._)([(0,_.Cb)()],hn.prototype,"view",void 0);var fn=hn=(0,h._)([(0,x.j)("esri.widgets.support.AnchorElementViewModel")],hn),vn=function(e){(0,c.Z)(i,e);var t=(0,d.Z)(i);function i(e){var n;return(0,l.Z)(this,i),(n=t.call(this,e)).visible=!1,n}return(0,u.Z)(i)}(fn);(0,h._)([(0,_.Cb)()],vn.prototype,"visible",void 0);var pn=vn=(0,h._)([(0,x.j)("esri.widgets.CompassViewModel")],vn),gn="esri-spinner",yn={base:gn,spinnerStart:"".concat(gn,"--start"),spinnerFinish:"".concat(gn,"--finish")},mn=function(e){(0,c.Z)(i,e);var t=(0,d.Z)(i);function i(e,n){var r;return(0,l.Z)(this,i),(r=t.call(this,e,n))._animationDelay=500,r._animationPromise=null,r.viewModel=new pn,r}return(0,u.Z)(i,[{key:"initialize",value:function(){var e=this;this.addHandles((0,m.YP)((function(){return e.visible}),(function(t){return e._visibleChange(t)})))}},{key:"destroy",value:function(){this._animationPromise=null}},{key:"location",get:function(){return this.viewModel.location},set:function(e){this.viewModel.location=e}},{key:"view",get:function(){return this.viewModel.view},set:function(e){this.viewModel.view=e}},{key:"visible",get:function(){return this.viewModel.visible},set:function(e){this.viewModel.visible=e}},{key:"show",value:function(e){var t=this,i=null!==e&&void 0!==e?e:{},n=i.location,r=i.promise;n&&(this.viewModel.location=n),this.visible=!0;r&&r.catch((function(){})).then((function(){return t.hide()}))}},{key:"hide",value:function(){this.visible=!1}},{key:"render",value:function(){var e,t=this.visible,i=!!this.viewModel.screenLocation,n=t&&i,r=!t&&i,o=(e={},(0,a.Z)(e,yn.spinnerStart,n),(0,a.Z)(e,yn.spinnerFinish,r),e),s=this._getPositionStyles();return(0,ze.u)("div",{class:this.classes(yn.base,o),styles:s})}},{key:"_visibleChange",value:function(e){var t=this;if(e)this.viewModel.screenLocationEnabled=!0;else{var i=(0,Tt.e4)(this._animationDelay);this._animationPromise=i,i.catch((function(){})).then((function(){t._animationPromise===i&&(t.viewModel.screenLocationEnabled=!1,t._animationPromise=null)}))}}},{key:"_getPositionStyles",value:function(){var e=this.viewModel,t=e.screenLocation,i=e.view;if(null==i||null==t)return{};var n=i.padding;return{left:t.x-n.left+"px",top:t.y-n.top+"px"}}}]),i}(C.Z);(0,h._)([(0,_.Cb)()],mn.prototype,"location",null),(0,h._)([(0,_.Cb)()],mn.prototype,"view",null),(0,h._)([(0,_.Cb)({type:pn})],mn.prototype,"viewModel",void 0),(0,h._)([(0,_.Cb)()],mn.prototype,"visible",null);var bn=mn=(0,h._)([(0,x.j)("esri.widgets.Spinner")],mn),_n=i(65497),wn=y.Z.getLogger("esri.widgets.Popup.PopupViewModel"),kn=function(e){var t=e.event,i=e.view,n=e.viewModel,r=t.action;if(!r)return Promise.reject(new M.Z("trigger-action:missing-arguments","Event has no action"));var a=r.disabled,o=r.id;if(!o)return Promise.reject(new M.Z("trigger-action:invalid-action","action.id is missing"));if(a)return Promise.reject(new M.Z("trigger-action:invalid-action","Action is disabled"));if(o===_n.OO.id)return function(e){return Zn.apply(this,arguments)}(n).catch(Tt.H9);if(o===_n.wS.id)return function(e){return An.apply(this,arguments)}(n);if(o===_n.iA.id)return n.browseClusterEnabled=!n.browseClusterEnabled,n.featureMenuOpen=n.browseClusterEnabled,Promise.resolve();if(o===_n.tP.id){n.visible=!1;var s=n.selectedFeature;if(!s)return Promise.reject(new M.Z("trigger-action:".concat(_n.tP.id),"selectedFeature is required",{selectedFeature:s}));var l=s.sourceLayer;return l?l.remove(s):null===i||void 0===i||i.graphics.remove(s),Promise.resolve()}return Promise.resolve()};function xn(e){var t,i=e.selectedFeature,n=e.location,r=e.view;return r?"3d"===r.type?null!==(t=null!==i&&void 0!==i?i:n)&&void 0!==t?t:null:e.get("selectedFeature.geometry")||n:null}function Cn(e){var t,i;return!!e&&e.isAggregate&&"cluster"===(null===(t=e.sourceLayer)||void 0===t||null===(i=t.featureReduction)||void 0===i?void 0:i.type)}function Mn(e,t){return Pn.apply(this,arguments)}function Pn(){return Pn=(0,r.Z)((0,n.Z)().mark((function e(t,i){var r,a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("3d"===(null===i||void 0===i?void 0:i.type)&&t&&"esri.Graphic"===t.declaredClass){e.next=2;break}return e.abrupt("return",!0);case 2:if(!(r=i.getViewForGraphic(t))||!("whenGraphicBounds"in r)){e.next=13;break}return e.prev=4,e.next=7,r.whenGraphicBounds(t,{useViewElevation:!0});case 7:a=e.sent,e.next=12;break;case 10:e.prev=10,e.t0=e.catch(4);case 12:return e.abrupt("return",!a||!a.boundingBox||a.boundingBox[0]===a.boundingBox[3]&&a.boundingBox[1]===a.boundingBox[4]&&a.boundingBox[2]===a.boundingBox[5]);case 13:return e.abrupt("return",!0);case 14:case"end":return e.stop()}}),e,null,[[4,10]])}))),Pn.apply(this,arguments)}function Zn(){return Zn=(0,r.Z)((0,n.Z)().mark((function e(t){var i,r,a,o,s,l,u,c,d,h,f,v;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.location,a=t.selectedFeature,o=t.view,s=t.zoomFactor,l=xn(t),o&&l){e.next=4;break}throw u=new M.Z("zoom-to:invalid-target-or-view","Cannot zoom to location without a target and view.",{target:l,view:o}),wn.error(u),u;case 4:if(c=o.scale/s,d=null===(i=t.selectedFeature)||void 0===i?void 0:i.geometry,h=null!==d&&void 0!==d?d:r,e.t0=null!=h&&"point"===h.type,!e.t0){e.next=12;break}return e.next=11,Mn(a,o);case 11:e.t0=e.sent;case 12:return f=e.t0,_n.OO.active=!0,_n.OO.disabled=!0,e.prev=14,e.next=17,t.zoomTo({target:{target:l,scale:f?c:void 0}});case 17:e.next=23;break;case 19:e.prev=19,e.t1=e.catch(14),v=new M.Z("zoom-to:invalid-graphic","Could not zoom to the location of the graphic.",{graphic:a}),wn.error(v);case 23:return e.prev=23,_n.OO.active=!1,_n.OO.disabled=!1,t.zoomToLocation=null,f&&(t.location=h),e.finish(23);case 26:case"end":return e.stop()}}),e,null,[[14,19,23,26]])}))),Zn.apply(this,arguments)}function An(){return An=(0,r.Z)((0,n.Z)().mark((function e(t){var i,r,a,o,l,u,c,d,h,f;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.selectedFeature,"2d"===(null===(r=t.view)||void 0===r?void 0:r.type)){e.next=4;break}throw a=new M.Z("zoomToCluster:invalid-view","View must be 2d MapView.",{view:r}),wn.error(a),a;case 4:if(i&&Cn(i)){e.next=7;break}throw o=new M.Z("zoomToCluster:invalid-selectedFeature","Selected feature must represent an aggregate/cluster graphic.",{selectedFeature:i}),wn.error(o),o;case 7:return e.next=9,Fn(r,i);case 9:return l=e.sent,u=(0,s.Z)(l,2),c=u[0],d=u[1],_n.wS.active=!0,_n.wS.disabled=!0,e.next=16,c.queryExtent(d);case 16:return h=e.sent,f=h.extent,e.next=20,t.zoomTo({target:f});case 20:_n.wS.active=!1,_n.wS.disabled=!1;case 22:case"end":return e.stop()}}),e)}))),An.apply(this,arguments)}function Tn(e){return In.apply(this,arguments)}function In(){return In=(0,r.Z)((0,n.Z)().mark((function e(t){var i,r,a,o,l,u,c,d;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.view,r=t.selectedFeature,i&&r){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,Fn(i,r);case 5:return a=e.sent,o=(0,s.Z)(a,2),l=o[0],u=o[1],e.next=11,l.queryExtent(u);case 11:c=e.sent,d=c.extent,t.selectedClusterBoundaryFeature.geometry=d,i.graphics.add(t.selectedClusterBoundaryFeature);case 14:case"end":return e.stop()}}),e)}))),In.apply(this,arguments)}function On(e){return Dn.apply(this,arguments)}function Dn(){return Dn=(0,r.Z)((0,n.Z)().mark((function e(t){var i,r,a,o,l,u,c,d;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.selectedFeature,(r=t.view)&&i){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,Fn(r,i);case 5:return a=e.sent,o=(0,s.Z)(a,2),l=o[0],u=o[1],_n.iA.active=!0,_n.iA.disabled=!0,e.next=12,l.queryFeatures(u);case 12:c=e.sent,d=c.features,_n.iA.active=!1,_n.iA.disabled=!1,_n.iA.value=!0,null===t||void 0===t||t.open({features:[i].concat(d),featureMenuOpen:!0});case 15:case"end":return e.stop()}}),e)}))),Dn.apply(this,arguments)}function Fn(e,t){return En.apply(this,arguments)}function En(){return En=(0,r.Z)((0,n.Z)().mark((function e(t,i){var r,a,o;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.whenLayerView(i.sourceLayer);case 2:return r=e.sent,a=r.createQuery(),o=i.getObjectId(),e.abrupt("return",(a.aggregateIds=null!=o?[o]:[],[r,a]));case 6:case"end":return e.stop()}}),e)}))),En.apply(this,arguments)}function Sn(e){var t;if(null==e)return null;switch(e.type){case"point":return e;case"extent":return e.center;case"polygon":return e.centroid;case"multipoint":case"polyline":return null===(t=e.extent)||void 0===t?void 0:t.center;default:return null}}var Bn="esri-popup",Ln="".concat(Bn,"__header"),jn="".concat(Bn,"--is-docked"),Rn={calciteThemeLight:"calcite-mode-light",calciteThemeDark:"calcite-mode-dark",iconLeftTriangleArrow:"esri-icon-left-triangle-arrow",iconRightTriangleArrow:"esri-icon-right-triangle-arrow",iconDockToTop:"esri-icon-maximize",iconDockToBottom:"esri-icon-dock-bottom",iconDockToLeft:"esri-icon-dock-left",iconDockToRight:"esri-icon-dock-right",iconClose:"esri-icon-close",iconUndock:"esri-icon-minimize",iconCheckMark:"esri-icon-check-mark",iconLoading:"esri-icon-loading-indicator",iconDefaultAction:"esri-icon-default-action",iconActionsMenu:"esri-icon-handle-horizontal",rotating:"esri-rotating",base:Bn,widget:"esri-widget",main:"".concat(Bn,"__main-container"),loadingContainer:"".concat(Bn,"__loading-container"),isCollapsible:"".concat(Bn,"--is-collapsible"),isCollapsed:"".concat(Bn,"--is-collapsed"),shadow:"".concat(Bn,"--shadow"),isDocked:jn,isDockedTopLeft:"".concat(jn,"-top-left"),isDockedTopCenter:"".concat(jn,"-top-center"),isDockedTopRight:"".concat(jn,"-top-right"),isDockedBottomLeft:"".concat(jn,"-bottom-left"),isDockedBottomCenter:"".concat(jn,"-bottom-center"),isDockedBottomRight:"".concat(jn,"-bottom-right"),alignTopCenter:"".concat(Bn,"--aligned-top-center"),alignBottomCenter:"".concat(Bn,"--aligned-bottom-center"),alignTopLeft:"".concat(Bn,"--aligned-top-left"),alignBottomLeft:"".concat(Bn,"--aligned-bottom-left"),alignTopRight:"".concat(Bn,"--aligned-top-right"),alignBottomRight:"".concat(Bn,"--aligned-bottom-right"),isFeatureMenuOpen:"".concat(Bn,"--feature-menu-open"),isActionsMenuOpen:"".concat(Bn,"--actions-menu-open"),hasFeatureUpdated:"".concat(Bn,"--feature-updated"),header:Ln,headerButtons:"".concat(Ln,"-buttons"),headerContainer:"".concat(Ln,"-container"),headerContainerButton:"".concat(Ln,"-container--button"),headerTitle:"".concat(Ln,"-title"),content:"".concat(Bn,"__content"),contentHasFlows:"esri-content--has-flows",contentFlowItem:"esri-content__flow-item",footer:"".concat(Bn,"__footer"),footerHasPagination:"".concat(Bn,"__footer--has-pagination"),footerHasActions:"".concat(Bn,"__footer--has-actions"),footerHasActionsMenu:"".concat(Bn,"__footer--has-actions-menu"),button:"".concat(Bn,"__button"),buttonDisabled:"".concat(Bn,"__button--disabled"),buttonDock:"".concat(Bn,"__button--dock"),icon:"".concat(Bn,"__icon"),iconDock:"".concat(Bn,"__icon--dock-icon"),inlineActionsContainer:"".concat(Bn,"__inline-actions-container"),actionsMenuButton:"".concat(Bn,"__actions-menu-button"),actions:"".concat(Bn,"__actions"),action:"".concat(Bn,"__action"),actionImage:"".concat(Bn,"__action-image"),actionText:"".concat(Bn,"__action-text"),actionToggle:"".concat(Bn,"__action-toggle"),actionToggleOn:"".concat(Bn,"__action-toggle--on"),actionExit:"".concat(Bn,"__action--exit"),actionSelectFeature:"".concat(Bn,"__action--select-feature"),pointer:"".concat(Bn,"__pointer"),pointerDirection:"".concat(Bn,"__pointer-direction"),navigation:"".concat(Bn,"__navigation"),paginationIcon:"".concat(Bn,"__pagination-icon"),paginationPrevious:"".concat(Bn,"__pagination-previous"),paginationNext:"".concat(Bn,"__pagination-next"),featureMenu:"".concat(Bn,"__feature-menu"),featureMenuList:"".concat(Bn,"__feature-menu-list"),featureMenuItem:"".concat(Bn,"__feature-menu-item"),featureMenuViewport:"".concat(Bn,"__feature-menu-viewport"),featureMenuHeader:"".concat(Bn,"__feature-menu-header"),featureMenuNote:"".concat(Bn,"__feature-menu-note"),featureMenuSelected:"".concat(Bn,"__feature-menu-item--selected"),featureMenuButton:"".concat(Bn,"__feature-menu-button"),featureMenuButtonIcon:"".concat(Bn,"__feature-menu-button-icon"),featureMenuTitle:"".concat(Bn,"__feature-menu-title"),featureMenuObserver:"".concat(Bn,"__feature-menu-observer"),featureMenuLoader:"".concat(Bn,"__feature-menu-loader"),collapseButton:"".concat(Bn,"__collapse-button"),collapseIcon:"".concat(Bn,"__collapse-icon")},Nn=(i(51508),i(81753)),Hn=i(30651),zn=i(57976),Vn=i(6945),Wn=i(9676),Yn=i(86828),Un=i(69787),qn=i(99505),Gn=i(61459),Xn=f.Z.ofType({key:"type",defaultKeyValue:"button",base:zn.Z,typeMap:{button:Vn.Z,toggle:Wn.Z}}),Kn=function(e){(0,c.Z)(i,e);var t=(0,d.Z)(i);function i(e){var n;return(0,l.Z)(this,i),(n=t.call(this,e))._handles=new g.Z,n._pendingPromises=new Set,n._fetchFeaturesController=null,n._highlightSelectedFeaturePromise=null,n._highlightActiveFeaturePromise=null,n._selectedClusterFeature=null,n.featurePage=null,n.actions=new Xn,n.activeFeature=null,n.defaultPopupTemplateEnabled=!1,n.autoCloseEnabled=!1,n.autoOpenEnabled=!0,n.browseClusterEnabled=!1,n.content=null,n.featuresPerPage=20,n.featureMenuOpen=!1,n.featureViewModelAbilities=null,n.featureViewModels=[],n.highlightEnabled=!0,n.includeDefaultActions=!0,n.selectedClusterBoundaryFeature=new O.Z({symbol:new Gn.Z({outline:{width:1.5,color:"cyan"},style:"none"})}),n.title=null,n.updateLocationEnabled=!1,n.view=null,n.visible=!1,n.zoomFactor=4,n.zoomToLocation=null,n}return(0,u.Z)(i,[{key:"isLoadingFeature",get:function(){return this.featureViewModels.some((function(e){return e.waitingForContent}))}},{key:"initialize",value:function(){var e=this;this._handles.add([this.on("view-change",(function(){return e._autoClose()})),(0,m.YP)((function(){return[e.highlightEnabled,e.selectedFeature,e.visible,e.view]}),(function(){return e._highlightSelectedFeature()})),(0,m.YP)((function(){return[e.highlightEnabled,e.activeFeature,e.visible,e.view]}),(function(){return e._highlightActiveFeature()})),(0,m.YP)((function(){var t,i;return null===(t=e.view)||void 0===t||null===(i=t.animation)||void 0===i?void 0:i.state}),(function(t){return e._animationStateChange(t)})),(0,m.YP)((function(){return e.location}),(function(t){return e._locationChange(t)})),(0,m.YP)((function(){return e.selectedFeature}),(function(t){return e._selectedFeatureChange(t)})),(0,m.YP)((function(){return[e.selectedFeatureIndex,e.featureCount,e.featuresPerPage]}),(function(){return e._selectedFeatureIndexChange()})),(0,m.YP)((function(){return[e.featurePage,e.selectedFeatureIndex,e.featureCount,e.featuresPerPage,e.featureViewModels]}),(function(){return e._setGraphicOnFeatureViewModels()})),(0,m.YP)((function(){return e.featureViewModels}),(function(){return e._featureViewModelsChange()})),this.on("trigger-action",(function(t){return kn({event:t,viewModel:e,view:e.view})})),(0,m.gx)((function(){return!e.waitingForResult}),(function(){return e._waitingForResultChange()}),m.Z_),(0,m.YP)((function(){var t,i;return[e.features,null===(t=e.view)||void 0===t?void 0:t.map,null===(i=e.view)||void 0===i?void 0:i.spatialReference]}),(function(){return e._updateFeatureVMs()})),(0,m.YP)((function(){var t;return null===(t=e.view)||void 0===t?void 0:t.scale}),(function(){return e._viewScaleChange()})),(0,m.gx)((function(){return!e.visible}),(function(){return e.browseClusterEnabled=!1})),(0,m.YP)((function(){return e.browseClusterEnabled}),(function(t){return t?e.enableClusterBrowsing():e.disableClusterBrowsing()}))])}},{key:"destroy",value:function(){this._cancelFetchingFeatures(),this._handles.destroy(),this._pendingPromises.clear(),this.browseClusterEnabled=!1,this.view=null}},{key:"active",get:function(){return!(!this.visible||this.waitingForResult)}},{key:"allActions",get:function(){var e=this._get("allActions")||new Xn;e.removeAll();var t=this.actions,i=this.defaultActions,n=this.defaultPopupTemplateEnabled,r=this.includeDefaultActions,a=this.selectedFeature,o=r?i.concat(t):t,s=a&&("function"==typeof a.getEffectivePopupTemplate&&a.getEffectivePopupTemplate(n)||a.popupTemplate),l=s&&s.actions,u=s&&s.overwriteActions?l:l?l.concat(o):o;return u&&u.filter(Boolean).forEach((function(t){return e.add(t)})),e}},{key:"defaultActions",get:function(){var e=this._get("defaultActions")||new Xn;return e.removeAll(),e.addMany(Cn(this.selectedFeature)?[_n.wS.clone(),_n.iA.clone()]:[_n.OO.clone()]),e}},{key:"featureCount",get:function(){return this.features.length}},{key:"features",get:function(){return this._get("features")||[]},set:function(e){var t=e||[];this._set("features",t);var i=this.pendingPromisesCount,n=this.promiseCount,r=this.selectedFeatureIndex,a=n&&t.length;a&&i&&-1===r?this.selectedFeatureIndex=0:a&&-1!==r||(this.selectedFeatureIndex=t.length?0:-1)}},{key:"location",get:function(){return this._get("location")||null},set:function(e){var t,i,n,r=e,a=null===(t=this.view)||void 0===t||null===(i=t.spatialReference)||void 0===i?void 0:i.isWebMercator;e&&null!==e&&void 0!==e&&null!==(n=e.spatialReference)&&void 0!==n&&n.isWGS84&&a&&(r=(0,Nn.$)(e)),this._set("location",r)}},{key:"pendingPromisesCount",get:function(){return this._pendingPromises.size}},{key:"waitingForResult",get:function(){return!(!(this._fetchFeaturesController||this.pendingPromisesCount>0)||0!==this.featureCount)}},{key:"promiseCount",get:function(){return this.promises.length}},{key:"promises",get:function(){return this._get("promises")||[]},set:function(e){var t=this;if(this._pendingPromises.clear(),this.features=[],!Array.isArray(e)||!e.length)return this._set("promises",[]),void this.notifyChange("pendingPromisesCount");this._set("promises",e),(e=e.slice(0)).forEach((function(e){t._pendingPromises.add(e);e.then((function(i){t._pendingPromises.has(e)&&t._updateFeatures(i),t._updatePendingPromises(e)}),(function(){return t._updatePendingPromises(e)}))})),this.notifyChange("pendingPromisesCount")}},{key:"selectedFeature",get:function(){var e=this.features,t=this.selectedFeatureIndex;return-1===t?null:e[t]||null}},{key:"selectedFeatureIndex",get:function(){var e=this._get("selectedFeatureIndex");return"number"==typeof e?e:-1},set:function(e){var t=this.featureCount;e=isNaN(e)||e<-1||!t?-1:(e+t)%t,this.activeFeature=null,this._set("selectedFeatureIndex",e)}},{key:"selectedFeatureViewModel",get:function(){return this.featureViewModels[this.selectedFeatureIndex]||null}},{key:"state",get:function(){return this.get("view.ready")?"ready":"disabled"}},{key:"centerAtLocation",value:function(){var e=this.view,t=xn(this);return t&&e?this.callGoTo({target:{target:t,scale:e.scale}}):Promise.reject(new M.Z("center-at-location:invalid-target-or-view","Cannot center at a location without a target and view.",{target:t,view:e}))}},{key:"zoomTo",value:function(e){return this.callGoTo(e)}},{key:"clear",value:function(){this.set({promises:[],features:[],content:null,title:null,location:null,activeFeature:null})}},{key:"fetchFeatures",value:function(e,t){var i=this.view;if(!i||!e)throw new M.Z("fetch-features:invalid-screenpoint-or-view","Cannot fetch features without a screenPoint and view.",{screenPoint:e,view:i});return i.fetchPopupFeatures(e,{event:t&&t.event,defaultPopupTemplateEnabled:this.defaultPopupTemplateEnabled,signal:t&&t.signal})}},{key:"open",value:function(e){var t=(0,o.Z)((0,o.Z)({updateLocationEnabled:!1,promises:[],fetchFeatures:!1},e),{},{visible:!0}),i=t.fetchFeatures;delete t.fetchFeatures,i&&this._setFetchFeaturesPromises(t.location);for(var n=0,r=["actionsMenuOpen","collapsed"];n<r.length;n++){delete t[r[n]]}this.set(t)}},{key:"triggerAction",value:function(e){var t=this.allActions.at(e);t&&!t.disabled&&this.emit("trigger-action",{action:t})}},{key:"next",value:function(){return this.selectedFeatureIndex=this.selectedFeatureIndex+1,this}},{key:"previous",value:function(){return this.selectedFeatureIndex=this.selectedFeatureIndex-1,this}},{key:"disableClusterBrowsing",value:function(){(function(e){_n.iA.value=!1;var t=e.features.filter((function(e){return Cn(e)}));t.length&&(e.features=t)})(this),this._clearBrowsedClusterGraphics()}},{key:"enableClusterBrowsing",value:function(){var e=(0,r.Z)((0,n.Z)().mark((function e(){var t,i;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.view,i=this.selectedFeature,"2d"!==(null===t||void 0===t?void 0:t.type)){e.next=12;break}if(!Cn(i)){e.next=9;break}return e.next=5,Tn(this);case 5:return e.next=7,On(this);case 7:e.next=10;break;case 9:y.Z.getLogger(this).warn("enableClusterBrowsing:invalid-selectedFeature: Selected feature must represent an aggregate/cluster graphic.",i);case 10:e.next=13;break;case 12:y.Z.getLogger(this).warn("enableClusterBrowsing:invalid-view: View must be 2d MapView.",i);case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleViewClick",value:function(e){this.autoOpenEnabled&&this._fetchFeaturesAndOpen(e)}},{key:"_animationStateChange",value:function(e){this.zoomToLocation||(_n.OO.disabled="waiting-for-target"===e)}},{key:"_clearBrowsedClusterGraphics",value:function(){var e,t=null===(e=this.view)||void 0===e?void 0:e.graphics;t&&(t.remove(this.selectedClusterBoundaryFeature),this._selectedClusterFeature&&t.remove(this._selectedClusterFeature)),this._selectedClusterFeature=null,this.selectedClusterBoundaryFeature.geometry=null}},{key:"_viewScaleChange",value:function(){if(Cn(this.selectedFeature))return this.browseClusterEnabled=!1,this.visible=!1,void this.clear();this.browseClusterEnabled&&(this.features=this.selectedFeature?[this.selectedFeature]:[])}},{key:"_locationChange",value:function(e){var t=this.selectedFeature;this.updateLocationEnabled&&e&&(!t||t.geometry)&&this.centerAtLocation()}},{key:"_selectedFeatureIndexChange",value:function(){this.featurePage=this.featureCount>1?Math.floor(this.selectedFeatureIndex/this.featuresPerPage)+1:null}},{key:"_featureViewModelsChange",value:function(){this.featurePage=this.featureCount>1?1:null}},{key:"_setGraphicOnFeatureViewModels",value:function(){var e=this.features,t=this.featureCount,i=this.featurePage,n=this.featuresPerPage,r=this.featureViewModels;if(null!==i){var a=((i-1)*n+t)%t,o=a+n;r.slice(a,o).forEach((function(t,i){t&&!t.graphic&&(t.graphic=e[a+i])}))}}},{key:"_selectedFeatureChange",value:function(){var e=(0,r.Z)((0,n.Z)().mark((function e(t){var i,r,a,o=this;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.location,r=this.updateLocationEnabled,a=this.view,!t||!a){e.next=11;break}if(!this.browseClusterEnabled){e.next=10;break}if(this._selectedClusterFeature&&(a.graphics.remove(this._selectedClusterFeature),this._selectedClusterFeature=null),!Cn(t)){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,(0,Yn.zd)(t);case 7:return t.symbol=e.sent,this._selectedClusterFeature=t,e.abrupt("return",void a.graphics.add(this._selectedClusterFeature));case 10:!r&&i||!t.geometry?r&&!t.geometry&&this.centerAtLocation().then((function(){var e,t=null===(e=a.center)||void 0===e?void 0:e.clone();t&&(o.location=t)})):this.location=Sn(t.geometry);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_waitingForResultChange",value:function(){!this.featureCount&&this.promises&&(this.visible=!1)}},{key:"_setFetchFeaturesPromises",value:function(e){var t=this;return this._fetchFeaturesWithController(this._getScreenPoint(e||this.location)).then((function(e){var i=e.clientOnlyGraphics,n=e.promisesPerLayerView,r=Promise.resolve(i),a=n.map((function(e){return e.promise}));t.promises=[r].concat((0,S.Z)(a))}))}},{key:"_destroyFeatureVMs",value:function(){this.featureViewModels.forEach((function(e){return e&&!e.destroyed&&e.destroy()})),this._set("featureViewModels",[])}},{key:"_updateFeatureVMs",value:function(){var e=this,t=this.selectedFeature,i=this.features,n=this.featureViewModels;if(Cn(t)||(this.browseClusterEnabled=!1),this._destroyFeatureVMs(),i&&i.length){var r=n.slice(0),a=[];i.forEach((function(i,n){if(i){var o=null;if(r.some((function(e,t){return e&&e.graphic===i&&(o=e,r.splice(t,1)),!!o})),o)a[n]=o;else{var s,l,u=new en({abilities:e.featureViewModelAbilities,defaultPopupTemplateEnabled:e.defaultPopupTemplateEnabled,spatialReference:null===(s=e.view)||void 0===s?void 0:s.spatialReference,graphic:i===t?i:null,map:null===(l=e.view)||void 0===l?void 0:l.map,view:e.view});a[n]=u}}})),r.forEach((function(e){return e&&!e.destroyed&&e.destroy()})),this._set("featureViewModels",a)}}},{key:"_getScreenPoint",value:function(e){var t=this.view;return t&&e&&"function"==typeof t.toScreen?t.toScreen(e):null}},{key:"_cancelFetchingFeatures",value:function(){var e=this._fetchFeaturesController;e&&e.abort(),this._fetchFeaturesController=null,this.notifyChange("waitingForResult")}},{key:"_fetchFeaturesWithController",value:function(e,t){var i=this;this._cancelFetchingFeatures();var n=new AbortController,r=n.signal;this._fetchFeaturesController=n,this.notifyChange("waitingForResult");var a=this.fetchFeatures(e,{signal:r,event:t});return a.catch((function(){})).then((function(){i._fetchFeaturesController=null,i.notifyChange("waitingForResult")})),a}},{key:"_fetchFeaturesAndOpen",value:function(e){var t=e.screenPoint,i=e.mapPoint,n=this.view;this._fetchFeaturesWithController(t,e).then((function(e){var t=e.clientOnlyGraphics,r=e.promisesPerLayerView,a=e.location,o=[Promise.resolve(t)].concat((0,S.Z)(r.map((function(e){return e.promise}))));return null!==n&&void 0!==n&&n.popup&&"open"in n.popup&&n.popup.open({location:a||i,promises:o}),e}))}},{key:"_updatePendingPromises",value:function(e){e&&this._pendingPromises.has(e)&&(this._pendingPromises.delete(e),this.notifyChange("pendingPromisesCount"))}},{key:"_autoClose",value:function(){this.autoCloseEnabled&&(this.visible=!1)}},{key:"_getLayerView",value:function(){var e=(0,r.Z)((0,n.Z)().mark((function e(t,i){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.when();case 2:return e.abrupt("return",t.whenLayerView(i));case 3:case"end":return e.stop()}}),e)})));return function(t,i){return e.apply(this,arguments)}}()},{key:"_getHighlightLayer",value:function(e){var t=e.layer,i=e.sourceLayer;return i&&"layer"in i&&i.layer?i.layer:"map-notes"===(null===i||void 0===i?void 0:i.type)||"subtype-group"===(null===i||void 0===i?void 0:i.type)?i:t}},{key:"_getHighlightTarget",value:function(e,t){var i="imagery"===t.type?void 0:"objectIdField"in t?t.objectIdField||"OBJECTID":null,n=e.attributes;return n&&i&&n[i]||e}},{key:"_highlightActiveFeature",value:function(){var e=(0,r.Z)((0,n.Z)().mark((function e(){var t,i,r,a,o,s,l,u,c;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t="highlight-active-feature",this._handles.remove(t),i=this.highlightEnabled,r=this.view,a=this.activeFeature,o=this.visible,a&&r&&i&&o){e.next=5;break}return e.abrupt("return");case 5:if((s=this._getHighlightLayer(a))&&s instanceof Hn.Z){e.next=8;break}return e.abrupt("return");case 8:return l=this._getLayerView(r,s),this._highlightActiveFeaturePromise=l,e.next=12,l;case 12:if((u=e.sent)&&(0,Un.tl)(u)&&this._highlightActiveFeaturePromise===l&&this.activeFeature&&this.highlightEnabled){e.next=15;break}return e.abrupt("return");case 15:c=u.highlight(this._getHighlightTarget(a,s)),this._handles.add(c,t);case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_highlightSelectedFeature",value:function(){var e=(0,r.Z)((0,n.Z)().mark((function e(){var t,i,r,a,o,s,l,u,c;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t="highlight-selected-feature",this._handles.remove(t),i=this.selectedFeature,r=this.highlightEnabled,a=this.view,o=this.visible,i&&a&&r&&o){e.next=5;break}return e.abrupt("return");case 5:if((s=this._getHighlightLayer(i))&&s instanceof Hn.Z){e.next=8;break}return e.abrupt("return");case 8:return l=this._getLayerView(a,s),this._highlightSelectedFeaturePromise=l,e.next=12,l;case 12:if((u=e.sent)&&(0,Un.tl)(u)&&this._highlightSelectedFeaturePromise===l&&this.selectedFeature&&this.highlightEnabled&&this.visible){e.next=15;break}return e.abrupt("return");case 15:c=u.highlight(this._getHighlightTarget(i,s)),this._handles.add(c,t);case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_updateFeatures",value:function(e){var t=this.features;if(e&&e.length)if(t.length){var i=e.filter((function(e){return!t.includes(e)}));this.features=t.concat(i)}else this.features=e}}]),i}((0,qn._)(fn));(0,h._)([(0,_.Cb)()],Kn.prototype,"featurePage",void 0),(0,h._)([(0,_.Cb)()],Kn.prototype,"isLoadingFeature",null),(0,h._)([(0,_.Cb)({type:Xn})],Kn.prototype,"actions",void 0),(0,h._)([(0,_.Cb)({readOnly:!0})],Kn.prototype,"active",null),(0,h._)([(0,_.Cb)()],Kn.prototype,"activeFeature",void 0),(0,h._)([(0,_.Cb)({readOnly:!0})],Kn.prototype,"allActions",null),(0,h._)([(0,_.Cb)({type:Boolean})],Kn.prototype,"defaultPopupTemplateEnabled",void 0),(0,h._)([(0,_.Cb)()],Kn.prototype,"autoCloseEnabled",void 0),(0,h._)([(0,_.Cb)()],Kn.prototype,"autoOpenEnabled",void 0),(0,h._)([(0,_.Cb)()],Kn.prototype,"browseClusterEnabled",void 0),(0,h._)([(0,_.Cb)()],Kn.prototype,"content",void 0),(0,h._)([(0,_.Cb)({type:Xn,readOnly:!0})],Kn.prototype,"defaultActions",null),(0,h._)([(0,_.Cb)({readOnly:!0})],Kn.prototype,"featureCount",null),(0,h._)([(0,_.Cb)()],Kn.prototype,"features",null),(0,h._)([(0,_.Cb)()],Kn.prototype,"featuresPerPage",void 0),(0,h._)([(0,_.Cb)()],Kn.prototype,"featureMenuOpen",void 0),(0,h._)([(0,_.Cb)()],Kn.prototype,"featureViewModelAbilities",void 0),(0,h._)([(0,_.Cb)({readOnly:!0})],Kn.prototype,"featureViewModels",void 0),(0,h._)([(0,_.Cb)()],Kn.prototype,"highlightEnabled",void 0),(0,h._)([(0,_.Cb)()],Kn.prototype,"includeDefaultActions",void 0),(0,h._)([(0,_.Cb)({type:Ot.Z})],Kn.prototype,"location",null),(0,h._)([(0,_.Cb)({readOnly:!0})],Kn.prototype,"pendingPromisesCount",null),(0,h._)([(0,_.Cb)({readOnly:!0})],Kn.prototype,"selectedClusterBoundaryFeature",void 0),(0,h._)([(0,_.Cb)({readOnly:!0})],Kn.prototype,"waitingForResult",null),(0,h._)([(0,_.Cb)({readOnly:!0})],Kn.prototype,"promiseCount",null),(0,h._)([(0,_.Cb)()],Kn.prototype,"promises",null),(0,h._)([(0,_.Cb)({value:null,readOnly:!0})],Kn.prototype,"selectedFeature",null),(0,h._)([(0,_.Cb)({value:-1})],Kn.prototype,"selectedFeatureIndex",null),(0,h._)([(0,_.Cb)({readOnly:!0})],Kn.prototype,"selectedFeatureViewModel",null),(0,h._)([(0,_.Cb)({readOnly:!0})],Kn.prototype,"state",null),(0,h._)([(0,_.Cb)()],Kn.prototype,"title",void 0),(0,h._)([(0,_.Cb)()],Kn.prototype,"updateLocationEnabled",void 0),(0,h._)([(0,_.Cb)()],Kn.prototype,"view",void 0),(0,h._)([(0,_.Cb)()],Kn.prototype,"visible",void 0),(0,h._)([(0,_.Cb)()],Kn.prototype,"zoomFactor",void 0),(0,h._)([(0,_.Cb)()],Kn.prototype,"zoomToLocation",void 0),(0,h._)([(0,_.Cb)()],Kn.prototype,"centerAtLocation",null);var $n=Kn=(0,h._)([(0,x.j)("esri.widgets.Popup.PopupViewModel")],Kn),Qn=i(78088),Jn=i(28907),er="selected-index",tr="popup-spinner",ir={buttonEnabled:!0,position:"auto",breakpoint:{width:544}},nr="esri-popup";function rr(e,t){return void 0===t?"".concat(nr,"__").concat(e):"".concat(nr,"__").concat(e,"-").concat(t)}var ar={closeButton:!0,featureNavigation:!0},or=function(e){(0,c.Z)(h,e);var t=(0,d.Z)(h);function h(e,i){var n;return(0,l.Z)(this,h),(n=t.call(this,e,i))._blurClose=!1,n._blurContainer=!1,n._containerNode=null,n._mainContainerNode=null,n._featureMenuNode=null,n._actionsMenuNode=null,n._focusClose=!1,n._focusContainer=!1,n._focusDockButton=!1,n._focusFeatureMenuButton=!1,n._focusActionsMenuButton=!1,n._focusFirstFeature=!1,n._focusFirstAction=!1,n._handles=new g.Z,n._pointerOffsetInPx=16,n._spinner=null,n._feature=null,n._featureMenuIntersectionObserverNode=null,n._featureMenuViewportNode=null,n._rootFlowItemNode=null,n._featureMenuIntersectionObserverCallback=function(e){var t=(0,s.Z)(e,1)[0];(null===t||void 0===t?void 0:t.isIntersecting)&&null!=n.viewModel.featurePage&&n.viewModel.featurePage++},n._featureMenuIntersectionObserver=new IntersectionObserver(n._featureMenuIntersectionObserverCallback,{root:window.document}),n._displaySpinnerThrottled=(0,b.P)((function(){return n._displaySpinner()}),0),n._exitRelatedRecordsActions=new WeakMap,n._featureSelectionActions=new WeakMap,n._flowItems=new f.Z,n.alignment="auto",n.collapsed=!1,n.collapseEnabled=!0,n.dockEnabled=!1,n.headingLevel=2,n.maxInlineActions=3,n.messages=null,n.messagesCommon=null,n.spinnerEnabled=!0,n.viewModel=new $n,n.visibleElements=(0,o.Z)({},ar),n._handleOpenRelatedFeature=function(e){n._openRelatedFeature(e)},n._addSelectedFeatureIndexHandle(),n.addHandles([n._displaySpinnerThrottled,(0,m.YP)((function(){var e;return null===(e=n.viewModel)||void 0===e?void 0:e.screenLocation}),(function(){return n._positionContainer()})),(0,m.YP)((function(){var e;return[null===(e=n.viewModel)||void 0===e?void 0:e.active,n.dockEnabled]}),(function(){return n._toggleScreenLocationEnabled()})),(0,m.YP)((function(){var e;return null===(e=n.viewModel)||void 0===e?void 0:e.screenLocation}),(function(e,t){!!e!=!!t&&n.reposition()})),(0,m.YP)((function(){var e,t,i,r,a,o;return[null===(e=n.viewModel)||void 0===e||null===(t=e.view)||void 0===t?void 0:t.padding,null===(i=n.viewModel)||void 0===i||null===(r=i.view)||void 0===r?void 0:r.size,null===(a=n.viewModel)||void 0===a?void 0:a.active,null===(o=n.viewModel)||void 0===o?void 0:o.location,n.alignment]}),(function(){return n.reposition()})),(0,m.YP)((function(){return n.spinnerEnabled}),(function(e){return n._spinnerEnabledChange(e)})),(0,m.YP)((function(){var e,t;return null===(e=n.viewModel)||void 0===e||null===(t=e.view)||void 0===t?void 0:t.size}),(function(e,t){return n._updateDockEnabledForViewSize(e,t)})),(0,m.YP)((function(){var e;return null===(e=n.viewModel)||void 0===e?void 0:e.view}),(function(e,t){return n._viewChange(e,t)})),(0,m.YP)((function(){var e,t;return null===(e=n.viewModel)||void 0===e||null===(t=e.view)||void 0===t?void 0:t.ready}),(function(e,t){return n._viewReadyChange(null!==e&&void 0!==e&&e,null!==t&&void 0!==t&&t)})),(0,m.YP)((function(){var e,t;return[null===(e=n.viewModel)||void 0===e?void 0:e.waitingForResult,null===(t=n.viewModel)||void 0===t?void 0:t.location]}),(function(){n._hideSpinner(),n._displaySpinnerThrottled()})),(0,m.YP)((function(){return n.selectedFeatureWidget}),(function(){return n._destroyFlowItemWidgets()})),(0,m.YP)((function(){var e,t,i,r;return[null===(e=n.selectedFeatureWidget)||void 0===e||null===(t=e.viewModel)||void 0===t?void 0:t.title,null===(i=n.selectedFeatureWidget)||void 0===i||null===(r=i.viewModel)||void 0===r?void 0:r.state]}),(function(){return n._setTitleFromFeatureWidget()})),(0,m.YP)((function(){var e,t,i,r;return[null===(e=n.selectedFeatureWidget)||void 0===e||null===(t=e.viewModel)||void 0===t?void 0:t.content,null===(i=n.selectedFeatureWidget)||void 0===i||null===(r=i.viewModel)||void 0===r?void 0:r.state]}),(function(){return n._setContentFromFeatureWidget()})),(0,m.gx)((function(){return!n.collapsed}),(function(){var e,t;"xsmall"===(null===(e=n.viewModel)||void 0===e||null===(t=e.view)||void 0===t?void 0:t.widthBreakpoint)&&n.viewModel.active&&n.collapseEnabled&&n.viewModel.centerAtLocation()})),(0,m.on)((function(){var e;return null===(e=n.viewModel)||void 0===e?void 0:e.allActions}),"change",(function(){return n._watchActions()})),(0,m.YP)((function(){var e;return null===(e=n.viewModel)||void 0===e?void 0:e.allActions}),(function(){return n._watchActions()}),m.nn),(0,m.YP)((function(){var e;return null===(e=n.viewModel)||void 0===e?void 0:e.featureViewModels}),(function(){return n._featureMenuViewportScrollTop()})),(0,m.on)((function(){return n._flowItems}),"change",(function(){n.notifyChange("_activeFlowItemWidget"),n.scheduleRender()})),(0,m.YP)((function(){var e,t,i,r;return[null===(e=n._activeFlowItemWidget)||void 0===e||null===(t=e.viewModel)||void 0===t?void 0:t.state,null===(i=n._activeFlowItemWidget)||void 0===i||null===(r=i.viewModel)||void 0===r?void 0:r.title]}),(function(){return n.scheduleRender()}))]),n}return(0,u.Z)(h,[{key:"loadDependencies",value:function(){return(0,Re.h)({action:function(){return Promise.all([i.e(2655),i.e(6820),i.e(5138),i.e(6814)]).then(i.bind(i,6814))},flow:function(){return i.e(3049).then(i.bind(i,53049))},"flow-item":function(){return Promise.all([i.e(2655),i.e(6820),i.e(5138),i.e(6290),i.e(6861)]).then(i.bind(i,59308))},icon:function(){return i.e(7474).then(i.bind(i,87474))},tooltip:function(){return Promise.all([i.e(6290),i.e(5097)]).then(i.bind(i,94730))}})}},{key:"initialize",value:function(){this.addHandles(this._displaySpinnerThrottled)}},{key:"destroy",value:function(){var e,t;this._destroyFlowItemWidgets(),this._destroySelectedFeatureWidget(),this._destroySpinner(),null!==(e=this._handles)&&void 0!==e&&e.destroy(),this._unobserveFeatureMenuObserver(),null===(t=this._featureMenuIntersectionObserver)||void 0===t||t.disconnect()}},{key:"actionsMenuId",get:function(){return"".concat(this.id,"-actions-menu")}},{key:"actionsMenuButtonId",get:function(){return"".concat(this.id,"-actions-menu-button")}},{key:"featureMenuId",get:function(){return"".concat(this.id,"-feature-menu")}},{key:"titleId",get:function(){return"".concat(this.id,"-popup-title")}},{key:"contentId",get:function(){return"".concat(this.id,"-popup-content")}},{key:"hasContent",get:function(){var e=this.selectedFeatureWidget,t=this.viewModel;if(!e)return!(null===t||void 0===t||!t.content);var i=e.viewModel;if(null!==i&&void 0!==i&&i.waitingForContent||"error"===(null===i||void 0===i?void 0:i.state))return!0;var n=null===i||void 0===i?void 0:i.content;return Array.isArray(n)?!!n.length:!!n}},{key:"featureNavigationVisible",get:function(){return this.viewModel.active&&this.viewModel.featureCount>1&&!!this.visibleElements.featureNavigation}},{key:"collapsible",get:function(){return!!(this.collapseEnabled&&this.viewModel.title&&this.hasContent)}},{key:"featureMenuVisible",get:function(){return this.featureNavigationVisible&&this.featureMenuOpen}},{key:"contentCollapsed",get:function(){return this.collapsible&&!this.featureMenuVisible&&this.collapsed}},{key:"dividedActions",get:function(){return this._divideActions()}},{key:"_activeFlowItemWidget",get:function(){var e;return null!==(e=this._flowItems.at(-1))&&void 0!==e?e:null}},{key:"actions",get:function(){return this.viewModel.actions},set:function(e){this.viewModel.actions=e}},{key:"actionsMenuOpen",get:function(){return!!this.viewModel.active&&this._get("actionsMenuOpen")},set:function(e){this._set("actionsMenuOpen",!!e)}},{key:"autoCloseEnabled",get:function(){return this.viewModel.autoCloseEnabled},set:function(e){this.viewModel.autoCloseEnabled=e}},{key:"autoOpenEnabled",get:function(){return(0,v.Mr)(y.Z.getLogger(this),"autoOpenEnabled",{replacement:"MapView/SceneView.popupEnabled",version:"4.27"}),this.viewModel.autoOpenEnabled},set:function(e){(0,v.Mr)(y.Z.getLogger(this),"autoOpenEnabled",{replacement:"MapView/SceneView.popupEnabled",version:"4.27"}),this.viewModel.autoOpenEnabled=e}},{key:"defaultPopupTemplateEnabled",get:function(){return this.viewModel.defaultPopupTemplateEnabled},set:function(e){this.viewModel.defaultPopupTemplateEnabled=e}},{key:"content",get:function(){return this.viewModel.content},set:function(e){this.viewModel.content=e}},{key:"currentAlignment",get:function(){return this._getCurrentAlignment()}},{key:"currentDockPosition",get:function(){return this._getCurrentDockPosition()}},{key:"dockOptions",get:function(){return this._get("dockOptions")||ir},set:function(e){var t,i,n=(0,o.Z)({},ir),r=null===(t=this.viewModel)||void 0===t||null===(i=t.view)||void 0===i?void 0:i.breakpoints,a={};r&&(a.width=r.xsmall,a.height=r.xsmall);var s=(0,o.Z)((0,o.Z)({},n),e),l=(0,o.Z)((0,o.Z)({},n.breakpoint),a),u=s.breakpoint;"object"==typeof u?s.breakpoint=(0,o.Z)((0,o.Z)({},l),u):u&&(s.breakpoint=l),this._set("dockOptions",s),this._setCurrentDockPosition(),this.reposition()}},{key:"featureCount",get:function(){return this.viewModel.featureCount}},{key:"featureMenuOpen",get:function(){return this.viewModel.featureMenuOpen},set:function(e){this.viewModel.featureMenuOpen=e}},{key:"features",get:function(){return this.viewModel.features},set:function(e){this.viewModel.features=e}},{key:"goToOverride",get:function(){return this.viewModel.goToOverride},set:function(e){this.viewModel.goToOverride=e}},{key:"highlightEnabled",get:function(){return this.viewModel.highlightEnabled},set:function(e){this.viewModel.highlightEnabled=e}},{key:"location",get:function(){return this.viewModel.location},set:function(e){this.viewModel.location=e}},{key:"label",get:function(){var e,t;return null!==(e=null===(t=this.messages)||void 0===t?void 0:t.widgetLabel)&&void 0!==e?e:""},set:function(e){this._overrideIfSome("label",e)}},{key:"promises",get:function(){return this.viewModel.promises},set:function(e){this.viewModel.promises=e}},{key:"selectedFeature",get:function(){return this.viewModel.selectedFeature}},{key:"selectedFeatureIndex",get:function(){return this.viewModel.selectedFeatureIndex},set:function(e){this.viewModel.selectedFeatureIndex=e}},{key:"selectedFeatureWidget",get:function(){var e=this._feature,t=this.visibleElements,i=this.headingLevel,n=this._flowItems,r=this.viewModel.selectedFeatureViewModel,a=(0,o.Z)((0,o.Z)({},t),{},{title:!1});return r?(e?(e.viewModel=r,e.visibleElements=a):this._feature=new un({flowItems:n,headingLevel:i+1,viewModel:r,visibleElements:a}),this._feature):null}},{key:"title",get:function(){return this.viewModel.title},set:function(e){this.viewModel.title=e}},{key:"updateLocationEnabled",get:function(){return this.viewModel.updateLocationEnabled},set:function(e){this.viewModel.updateLocationEnabled=e}},{key:"view",get:function(){return this.viewModel.view},set:function(e){this.viewModel.view=e}},{key:"visible",get:function(){return this.viewModel.visible},set:function(e){this.viewModel.visible=e}},{key:"castVisibleElements",value:function(e){return(0,o.Z)((0,o.Z)({},ar),e)}},{key:"blur",value:function(){this.viewModel.active||y.Z.getLogger(this).warn("Popup can only be blurred when currently active."),this.visibleElements.closeButton?this._blurClose=!0:this._blurContainer=!0,this.scheduleRender()}},{key:"clear",value:function(){return this.viewModel.clear()}},{key:"close",value:function(){this.visible=!1}},{key:"fetchFeatures",value:function(e,t){return this.viewModel.fetchFeatures(e,t)}},{key:"focus",value:function(){this.viewModel.active||y.Z.getLogger(this).warn("Popup can only be focused when currently active."),this.visibleElements.closeButton?this._focusClose=!0:this._focusContainer=!0,this.scheduleRender()}},{key:"next",value:function(){return this.viewModel.next()}},{key:"open",value:function(e){var t,i;this._handles.remove(er);var n=!!e&&!!e.featureMenuOpen,r=!!e&&!!e.actionsMenuOpen,a={collapsed:!!e&&!!e.collapsed,actionsMenuOpen:r,featureMenuOpen:n};"xsmall"===(null===(t=this.viewModel)||void 0===t||null===(i=t.view)||void 0===i?void 0:i.widthBreakpoint)&&(a.collapsed=!0),this.set(a),this.viewModel.open(e),this._shouldFocus(e),this._addSelectedFeatureIndexHandle()}},{key:"previous",value:function(){return this.viewModel.previous()}},{key:"reposition",value:function(){this.renderNow(),this._positionContainer(),this._setCurrentAlignment()}},{key:"triggerAction",value:function(e){return this.viewModel.triggerAction(e)}},{key:"render",value:function(){var e,t,i,n,r,o=this.actionsMenuOpen,s=this.dockEnabled,l=this.featureMenuVisible,u=this.dividedActions,c=this.currentAlignment,d=this.currentDockPosition,h=this.viewModel.active,f=u.menuActions,v=h&&f.length>1&&o,p=h&&s,g=h&&!s,y=null===(e=this.selectedFeature)||void 0===e||null===(t=e.layer)||void 0===t?void 0:t.title,m=null===(i=this.selectedFeature)||void 0===i||null===(n=i.layer)||void 0===n?void 0:n.id,b=(r={},(0,a.Z)(r,Rn.alignTopCenter,"top-center"===c),(0,a.Z)(r,Rn.alignBottomCenter,"bottom-center"===c),(0,a.Z)(r,Rn.alignTopLeft,"top-left"===c),(0,a.Z)(r,Rn.alignBottomLeft,"bottom-left"===c),(0,a.Z)(r,Rn.alignTopRight,"top-right"===c),(0,a.Z)(r,Rn.alignBottomRight,"bottom-right"===c),(0,a.Z)(r,Rn.isDocked,p),(0,a.Z)(r,Rn.shadow,g),(0,a.Z)(r,Rn.isDockedTopLeft,"top-left"===d),(0,a.Z)(r,Rn.isDockedTopCenter,"top-center"===d),(0,a.Z)(r,Rn.isDockedTopRight,"top-right"===d),(0,a.Z)(r,Rn.isDockedBottomLeft,"bottom-left"===d),(0,a.Z)(r,Rn.isDockedBottomCenter,"bottom-center"===d),(0,a.Z)(r,Rn.isDockedBottomRight,"bottom-right"===d),(0,a.Z)(r,Rn.isFeatureMenuOpen,l),(0,a.Z)(r,Rn.isActionsMenuOpen,v),r);return(0,ze.u)("div",{class:this.classes(Rn.base,b),role:"presentation","data-layer-title":y,"data-layer-id":m,bind:this,afterCreate:this._positionContainer,afterUpdate:this._positionContainer},h?[this.renderMainContainer(),this.renderPointer()]:null)}},{key:"renderLoadingIcon",value:function(){return(0,ze.u)("span",{"aria-hidden":"true",class:this.classes(Rn.icon,Rn.iconLoading,Rn.rotating)})}},{key:"renderNavigationLoading",value:function(){var e=this.messagesCommon;return this.viewModel.pendingPromisesCount?(0,ze.u)("div",{key:rr("loading-container"),role:"presentation",class:Rn.loadingContainer,"aria-label":e.loading,title:e.loading},this.renderLoadingIcon()):null}},{key:"renderPreviousButton",value:function(){var e=this.messages;return(0,ze.u)("div",{role:"button",tabIndex:0,bind:this,onclick:this._previous,onkeydown:this._previous,class:this.classes(Rn.button,Rn.paginationPrevious),"aria-label":e.previous,title:e.previous},(0,ze.u)("calcite-icon",{icon:"chevron-left",scale:"s",class:Rn.paginationIcon}))}},{key:"renderNextButton",value:function(){var e=this.messages;return(0,ze.u)("div",{role:"button",tabIndex:0,bind:this,onclick:this._next,onkeydown:this._next,class:this.classes(Rn.button,Rn.paginationNext),"aria-label":e.next,title:e.next},(0,ze.u)("calcite-icon",{icon:"chevron-right",scale:"s",class:Rn.paginationIcon}))}},{key:"renderFeatureMenuButton",value:function(){var e=this.featureMenuOpen,t=this.featureMenuId,i=this.messagesCommon,n=this.viewModel,r=n.featureCount,a=n.selectedFeatureIndex;return(0,ze.u)("div",{role:"button",tabIndex:0,bind:this,onclick:this._toggleFeatureMenu,onkeydown:this._toggleFeatureMenu,afterCreate:this._focusFeatureMenuButtonNode,afterUpdate:this._focusFeatureMenuButtonNode,class:Rn.featureMenuButton,"aria-haspopup":"true","aria-controls":t,"aria-expanded":e.toString(),"aria-label":i.menu,title:i.menu},(0,ze.u)("calcite-icon",{icon:"list-bullet",scale:"s",class:Rn.featureMenuButtonIcon}),this._getPageText(r,a))}},{key:"renderNavigationButtons",value:function(){return this.featureNavigationVisible?[this.renderPreviousButton(),this.renderNextButton(),this.renderNavigationLoading()||this.renderFeatureMenuButton()]:[]}},{key:"renderDockIcon",value:function(){var e,t=this.dockEnabled,i=this._wouldDockTo(),n=(e={},(0,a.Z)(e,Rn.iconUndock,t),(0,a.Z)(e,Rn.iconDock,!t),(0,a.Z)(e,Rn.iconDockToRight,!t&&("top-right"===i||"bottom-right"===i)),(0,a.Z)(e,Rn.iconDockToLeft,!t&&("top-left"===i||"bottom-left"===i)),(0,a.Z)(e,Rn.iconDockToTop,!t&&"top-center"===i),(0,a.Z)(e,Rn.iconDockToBottom,!t&&"bottom-center"===i),e);return(0,ze.u)("span",{"aria-hidden":"true",class:this.classes(n,Rn.icon)})}},{key:"renderDockButton",value:function(){var e,t,i,n=this.dockEnabled,r=this.messages,a=null===(e=this.viewModel)||void 0===e||null===(t=e.view)||void 0===t?void 0:t.widthBreakpoint,o=n?r.undock:r.dock;return"xsmall"!==a&&null!==(i=this.dockOptions)&&void 0!==i&&i.buttonEnabled?(0,ze.u)("div",{role:"button","aria-label":o,title:o,tabIndex:0,bind:this,onclick:this._toggleDockEnabled,onkeydown:this._toggleDockEnabled,afterCreate:this._focusDockButtonNode,afterUpdate:this._focusDockButtonNode,class:this.classes(Rn.button,Rn.buttonDock)},this.renderDockIcon()):null}},{key:"renderTitle",value:function(){var e=this.viewModel.title,t=this.titleId,i=this.collapsible,n=this.contentCollapsed,r=this.messagesCommon,o=(0,a.Z)({},Rn.headerContainerButton,i),s=(0,ze.u)(Qe.X6,{level:this.headingLevel,class:Rn.headerTitle,innerHTML:null!==e&&void 0!==e?e:""}),l=i?(0,ze.u)("button",{key:"".concat(e,"--collapsible"),id:t,title:n?r.expand:r.collapse,bind:this,enterAnimation:this._createFeatureUpdatedAnimation(),class:this.classes(Rn.headerContainer,o),"aria-expanded":n?"false":"true",onclick:this._toggleCollapsed,type:"button"},s,(0,ze.u)("calcite-icon",{class:Rn.collapseIcon,key:"collapse-icon",icon:n?"chevron-down":"chevron-up",scale:"m"})):(0,ze.u)("div",{key:null!==e&&void 0!==e?e:"title",id:t,bind:this,enterAnimation:this._createFeatureUpdatedAnimation(),class:this.classes(Rn.headerContainer,o)},s);return e?l:null}},{key:"renderCloseIcon",value:function(){return(0,ze.u)("span",{"aria-hidden":"true",class:this.classes(Rn.icon,Rn.iconClose)})}},{key:"renderCloseButton",value:function(){var e=this.visibleElements,t=this.messagesCommon;return e.closeButton?(0,ze.u)("div",{role:"button",tabIndex:0,bind:this,onclick:this._close,onkeydown:this._close,class:Rn.button,"aria-label":t.close,title:t.close,afterCreate:this._closeButtonNodeUpdated,afterUpdate:this._closeButtonNodeUpdated},this.renderCloseIcon()):null}},{key:"renderHeader",value:function(){return(0,ze.u)("header",{class:Rn.header},this.renderTitle(),(0,ze.u)("div",{class:Rn.headerButtons},this.renderDockButton(),this.renderCloseButton()))}},{key:"renderContentContainer",value:function(){var e=this,t=this.contentId,i=this.hasContent,n=this.contentCollapsed,r=this._flowItems,o=this.viewModel.content,s=r.toArray(),l=(0,a.Z)({},Rn.contentHasFlows,!!s.length);return i&&!n?(0,ze.u)("div",{key:null!==o&&void 0!==o?o:"content",enterAnimation:this._createFeatureUpdatedAnimation(),id:t,class:this.classes(Rn.content,l)},(0,ze.u)("calcite-flow",{bind:this},(0,ze.u)("calcite-flow-item",{bind:this,"data-node-ref":"_rootFlowItemNode",afterCreate:Ne.Yo,key:"root-flow-item",onCalciteFlowItemBack:this._handleBackClick},this.renderContent()),s.map((function(t){return e.renderFlowItem(t)}))),s.map((function(t){return e.renderFlowItemTooltips(t)}))):null}},{key:"renderFlowItem",value:function(e){var t,i,n,r=this,o=this.messages,s=(0,Qt.$o)(),l="graphic"in e&&!e.isTable;return(0,ze.u)("calcite-flow-item",{bind:this,class:this.classes((t={},(0,a.Z)(t,Rn.calciteThemeDark,!s),(0,a.Z)(t,Rn.calciteThemeLight,s),t)),heading:null!==(i=e.title)&&void 0!==i?i:"",description:this._getFlowItemDescription(e),onCalciteFlowItemBack:this._handleBackClick,key:"flow-item-".concat(e.viewModel.uid)},(0,ze.u)("calcite-action",{class:Rn.actionExit,icon:"move-up",label:null===o||void 0===o?void 0:o.exitRelatedRecords,text:null===o||void 0===o?void 0:o.exitRelatedRecords,slot:"header-actions-start",bind:this,afterCreate:function(t){return r._storeExitRelatedRecordsAction(e,t)},onclick:this._destroyFlowItemWidgets}),l?(0,ze.u)("calcite-action",{class:Rn.actionSelectFeature,icon:"zoom-to-object",label:null===o||void 0===o?void 0:o.selectFeature,text:null===o||void 0===o?void 0:o.selectFeature,slot:"header-actions-end",bind:this,afterCreate:function(t){return r._storeFeatureSelectionAction(e,t)},onclick:function(){return r._handleOpenRelatedFeature(e)}}):null,(0,ze.u)("div",{class:this.classes(Rn.contentFlowItem,(n={},(0,a.Z)(n,Rn.calciteThemeDark,s),(0,a.Z)(n,Rn.calciteThemeLight,!s),n))},e.render()))}},{key:"renderFlowItemTooltips",value:function(e){var t,i,n=this.messages,r=this._exitRelatedRecordsActions,o=this._featureSelectionActions,s=(0,Qt.$o)(),l=o.get(e);return[(0,ze.u)("calcite-tooltip",{class:this.classes((t={},(0,a.Z)(t,Rn.calciteThemeDark,!s),(0,a.Z)(t,Rn.calciteThemeLight,s),t)),key:"exit-related-records-tooltip-".concat(e.viewModel.uid),label:null===n||void 0===n?void 0:n.exitRelatedRecords,overlayPositioning:"fixed",referenceElement:r.get(e),placement:"top"},null===n||void 0===n?void 0:n.exitRelatedRecords),l?(0,ze.u)("calcite-tooltip",{class:this.classes((i={},(0,a.Z)(i,Rn.calciteThemeDark,!s),(0,a.Z)(i,Rn.calciteThemeLight,s),i)),key:"select-related-record-tooltip-".concat(e.viewModel.uid),label:null===n||void 0===n?void 0:n.selectFeature,overlayPositioning:"fixed",referenceElement:l,placement:"top"},null===n||void 0===n?void 0:n.selectFeature):null]}},{key:"renderActionsMenuButton",value:function(){var e=this.actionsMenuId,t=this.actionsMenuButtonId,i=this.actionsMenuOpen,n=this.dividedActions,r=this.messagesCommon,a=i?r.close:r.open;return n.menuActions.length?(0,ze.u)("div",{key:rr("actions-menu-button"),class:this.classes(Rn.button,Rn.actionsMenuButton),role:"button",id:t,"aria-haspopup":"true","aria-controls":i?e:null,tabIndex:0,bind:this,onclick:this._toggleActionsMenu,onkeydown:this._toggleActionsMenu,afterCreate:this._focusActionsMenuButtonNode,afterUpdate:this._focusActionsMenuButtonNode,"aria-label":a,title:a},(0,ze.u)("span",{"aria-hidden":"true",class:Rn.iconActionsMenu})):null}},{key:"renderMenuActions",value:function(){var e=this,t=this.actionsMenuId,i=this.actionsMenuButtonId,n=this.actionsMenuOpen,r=this.dividedActions.menuActions;return r.length&&n?(0,ze.u)("ul",{id:t,role:"menu","aria-labelledby":i,key:rr("actions"),class:Rn.actions,bind:this,onkeyup:this._handleActionMenuKeyup,afterCreate:this._actionsMenuNodeUpdated,afterUpdate:this._actionsMenuNodeUpdated},r.toArray().map((function(t){return e.renderAction({action:t,type:"menu-item"})}))):null}},{key:"renderInlineActions",value:function(){var e=this,t=this.dividedActions.inlineActions;return t.length?t.toArray().map((function(t){return e.renderAction({action:t,type:"inline"})})):[]}},{key:"renderInlineActionsContainer",value:function(){var e=this.dividedActions,t=e.inlineActions,i=e.menuActions,n=!!t.length,r=!!i.length;return n||r?(0,ze.u)("div",{key:"inline-actions-container","data-inline-actions":n.toString(),"data-menu-actions":r.toString(),class:Rn.inlineActionsContainer},this.renderInlineActions(),this.renderActionsMenuButton(),this.renderMenuActions()):null}},{key:"renderNavigation",value:function(){return this.featureNavigationVisible?(0,ze.u)("section",{key:rr("navigation"),class:this.classes(Rn.navigation)},this.renderNavigationButtons()):null}},{key:"renderFooter",value:function(){var e,t=this.featureNavigationVisible,i=this.dividedActions,n=i.inlineActions,r=i.menuActions,o=!!n.length,s=!!r.length,l=(e={},(0,a.Z)(e,Rn.footerHasPagination,t),(0,a.Z)(e,Rn.footerHasActions,o),(0,a.Z)(e,Rn.footerHasActionsMenu,s),e);return t||o?(0,ze.u)("div",{key:rr("feature-buttons"),class:this.classes(Rn.footer,l)},this.renderInlineActionsContainer(),this.renderNavigation()):null}},{key:"renderFeatureMenuContainer",value:function(){var e=this.messages,t=this.viewModel,i=t.featureViewModels,n=t.isLoadingFeature,r=(0,Jt.n)(e.selectedFeatures,{total:i.length});return(0,ze.u)("section",{key:rr("menu"),class:Rn.featureMenu},(0,ze.u)("strong",{class:Rn.featureMenuHeader},r),(0,ze.u)("nav",{bind:this,class:Rn.featureMenuViewport,"data-node-ref":"_featureMenuViewportNode",afterCreate:Ne.Yo},this.renderFeatureMenu(),(0,ze.u)("div",{class:Rn.featureMenuObserver,bind:this,afterCreate:this._featureMenuIntersectionObserverCreated}),n?(0,ze.u)("div",{class:Rn.featureMenuLoader},this.renderLoadingIcon()):null))}},{key:"renderPointer",value:function(){return this.dockEnabled?null:(0,ze.u)("div",{key:rr("pointer"),class:Rn.pointer,role:"presentation"},(0,ze.u)("div",{class:this.classes(Rn.pointerDirection,Rn.shadow)}))}},{key:"renderMainContainer",value:function(){var e,t=this.dockEnabled,i=this.currentAlignment,n=this.currentDockPosition,r=this.titleId,o=this.contentId,s=this.collapsible,l=this.hasContent,u=this.contentCollapsed,c=this.visibleElements,d=this.viewModel.title,h="bottom-left"===i||"bottom-center"===i||"bottom-right"===i||"top-left"===n||"top-center"===n||"top-right"===n,f="top-left"===i||"top-center"===i||"top-right"===i||"bottom-left"===n||"bottom-center"===n||"bottom-right"===n,v=(e={},(0,a.Z)(e,Rn.shadow,t),(0,a.Z)(e,Rn.isCollapsible,s),(0,a.Z)(e,Rn.isCollapsed,u),e);return(0,ze.u)("div",{class:this.classes(Rn.main,Rn.widget,v),tabIndex:c.closeButton?void 0:-1,role:"dialog","aria-live":"polite","aria-labelledby":d?r:"","aria-describedby":l&&!u?o:"",bind:this,onkeyup:this._handleMainKeyup,afterCreate:this._mainContainerNodeUpdated,afterUpdate:this._mainContainerNodeUpdated},h?this.renderFooter():null,h?this.renderFeatureMenuContainer():null,this.renderHeader(),this.renderContentContainer(),f?this.renderFooter():null,f?this.renderFeatureMenuContainer():null)}},{key:"renderContent",value:function(){var e,t=null===(e=this.viewModel)||void 0===e?void 0:e.content;return t?"string"==typeof t?(0,ze.u)("div",{class:nn.contentNode,key:t,innerHTML:t}):this.renderNodeContent(t):null}},{key:"renderActionText",value:function(e){return(0,ze.u)("span",{key:"text",class:Rn.actionText},e)}},{key:"renderActionCalciteIcon",value:function(e,t){return(0,ze.u)("calcite-icon",{scale:"s",key:"calcite-icon-".concat(t),icon:e,class:Rn.icon})}},{key:"renderActionIcon",value:function(e){var t,i=this._getActionClass(e),n=this._getActionImage(e),r=(t={},(0,a.Z)(t,Rn.iconLoading,e.active),(0,a.Z)(t,Rn.rotating,e.active),(0,a.Z)(t,Rn.icon,!!i),(0,a.Z)(t,Rn.actionImage,!e.active&&!!n),t);return i&&(r[i]=!e.active),(0,ze.u)("span",{key:"icon","aria-hidden":"true",class:this.classes(Rn.icon,r),styles:this._getIconStyles(n)})}},{key:"renderAction",value:function(e){var t,i=e.action,n=e.type,r=this._getActionTitle(i),o=(t={},(0,a.Z)(t,Rn.action,"toggle"!==i.type),(0,a.Z)(t,Rn.actionToggle,"toggle"===i.type),(0,a.Z)(t,Rn.actionToggleOn,"toggle"===i.type&&i.value),(0,a.Z)(t,Rn.buttonDisabled,i.disabled),t),s=[i.icon&&!i.active?this.renderActionCalciteIcon(i.icon,i.uid):this.renderActionIcon(i),this.renderActionText(r)],l="menu-item"===n?(0,ze.u)("li",{key:i.uid,role:"menuitem",tabIndex:0,title:r,"aria-label":r,class:this.classes(Rn.button,o),onkeyup:this._handleActionMenuItemKeyup,bind:this,"data-action-uid":i.uid,onclick:this._triggerAction,onkeydown:this._triggerAction},s):(0,ze.u)("div",{key:i.uid,role:"button",tabIndex:0,title:r,"aria-label":r,class:this.classes(Rn.button,o),onkeyup:this._handleActionMenuItemKeyup,bind:this,"data-action-uid":i.uid,onclick:this._triggerAction,onkeydown:this._triggerAction},s);return i.visible?l:null}},{key:"renderFeatureMenuItem",value:function(e,t){var i=this.messages,n=this.messagesCommon,r=this.viewModel,o=r.selectedFeatureIndex,s=e===r.selectedFeatureViewModel,l=(0,a.Z)({},Rn.featureMenuSelected,s),u=s?(0,ze.u)("span",{key:rr("feature-menu-selected-feature-".concat(o)),title:i.selectedFeature,"aria-label":i.selectedFeature,class:Rn.iconCheckMark}):null,c=(0,ze.u)("span",{innerHTML:e.title||n.untitled});return(0,ze.u)("li",{role:"menuitem",tabIndex:-1,key:rr("feature-menu-feature-".concat(o)),class:this.classes(l,Rn.featureMenuItem),bind:this,"data-feature-index":t,onblur:this._removeActiveFeature,onfocus:this._setActiveFeature,onkeyup:this._handleFeatureMenuItemKeyup,onclick:this._selectFeature,onkeydown:this._selectFeature,onmouseover:this._setActiveFeature,onmouseleave:this._removeActiveFeature},(0,ze.u)("span",{class:Rn.featureMenuTitle},c,u))}},{key:"renderFeatureMenu",value:function(){var e=this,t=this.featureMenuId,i=this.viewModel.featureViewModels;return i.length>1?(0,ze.u)("ol",{class:Rn.featureMenuList,id:t,bind:this,afterCreate:this._featureMenuNodeUpdated,afterUpdate:this._featureMenuNodeUpdated,onkeyup:this._handleFeatureMenuKeyup,role:"menu"},i.filter((function(e){return!!e.graphic})).map((function(t,i){return e.renderFeatureMenuItem(t,i)}))):null}},{key:"_storeFeatureSelectionAction",value:function(e,t){this._featureSelectionActions.set(e,t),this.scheduleRender()}},{key:"_storeExitRelatedRecordsAction",value:function(e,t){this._exitRelatedRecordsActions.set(e,t),this.scheduleRender()}},{key:"_getFlowItemDescription",value:function(e){var t;return"featureCountDescription"in e?e.featureCountDescription:null!==(t=e.viewModel.description)&&void 0!==t?t:""}},{key:"_openRelatedFeature",value:function(){var e=(0,r.Z)((0,n.Z)().mark((function e(t){var i,r,a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.viewModel.updateGeometry();case 2:if(i=t.graphic,null!=(r=null===i||void 0===i?void 0:i.geometry)&&null!=i){e.next=5;break}return e.abrupt("return");case 5:return this._destroyFlowItemWidgets(),e.next=8,this.viewModel.zoomTo({target:r});case 8:a=Sn(r),this.open({features:[i],location:null!=a?a:void 0});case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_destroyFlowItemWidgets",value:function(){this._flowItems.removeAll().forEach((function(e){"showAllEnabled"in e.viewModel&&(e.viewModel.showAllEnabled=!1),e.viewModel=null,e.destroy()}))}},{key:"_handleBackClick",value:function(){var e=this._flowItems.pop();e&&(this._exitRelatedRecordsActions.delete(e),this._featureSelectionActions.delete(e),"showAllEnabled"in e.viewModel&&(e.viewModel.showAllEnabled=!1),e&&(e.viewModel=null,e.destroy()))}},{key:"_getActionTitle",value:function(e){var t,i=this.messages,n=this.selectedFeature,r=this.messagesCommon,a=e.id,o=null===n||void 0===n?void 0:n.attributes,s=null!==(t=e.title)&&void 0!==t?t:"",l="zoom-to-feature"===a?(0,Jt.n)(s,{messages:i}):"remove-selected-feature"===a?(0,Jt.n)(s,{messages:r}):"zoom-to-clustered-features"===a||"browse-clustered-features"===a?(0,Jt.n)(s,{messages:i}):e.title;return l&&o?(0,Jt.n)(l,o):null!==l&&void 0!==l?l:""}},{key:"_getActionClass",value:function(e){var t=this.selectedFeature,i=null===t||void 0===t?void 0:t.attributes,n=e.className,r=e.image||n?n:Rn.iconDefaultAction;return r&&i?(0,Jt.n)(r,i):null!==r&&void 0!==r?r:""}},{key:"_getActionImage",value:function(e){if(e.active)return"";var t=this.selectedFeature,i=null===t||void 0===t?void 0:t.attributes,n=e.image;return n&&i?(0,Jt.n)(n,i):null!==n&&void 0!==n?n:""}},{key:"_createFeatureUpdatedAnimation",value:function(){return(0,Ne.vU)("enter",Rn.hasFeatureUpdated)}},{key:"_getInlineActionCount",value:function(){var e=this.maxInlineActions,t=this.featureNavigationVisible;if("number"!=typeof e)return null;var i=Math.round(e);return Math.max(t?i-1:i,0)}},{key:"_watchActions",value:function(){var e=this,t=this.viewModel.allActions;this.notifyChange("dividedActions");var i="actions";this._handles.remove(i),t&&t.forEach((function(t){e._handles.add((0,m.YP)((function(){return[t.uid,t.active,t.className,t.disabled,t.id,t.title,t.image,t.visible]}),(function(){return e.scheduleRender()})),i)}))}},{key:"_divideActions",value:function(){var e=this.viewModel.allActions.filter((function(e){return e.visible})),t=this._getInlineActionCount(),i=null===t,n=0===t;return{inlineActions:i?e.slice(0):n?new f.Z:e.slice(0,t),menuActions:i?new f.Z:n?e.slice(0):e.slice(t)}}},{key:"_featureMenuOpenChanged",value:function(e){e?this._focusFirstFeature=!0:this._focusFeatureMenuButton=!0}},{key:"_actionsMenuOpenChanged",value:function(e){e?this._focusFirstAction=!0:this._focusActionsMenuButton=!0}},{key:"_setTitleFromFeatureWidget",value:function(){var e,t,i=this.selectedFeatureWidget,n=this.messagesCommon;i&&(this.viewModel.title="error"===(null===(e=i.viewModel)||void 0===e?void 0:e.state)?n.errorMessage:(null===(t=i.viewModel)||void 0===t?void 0:t.title)||"")}},{key:"_setContentFromFeatureWidget",value:function(){var e=this.selectedFeatureWidget;e&&(this.viewModel.content=e)}},{key:"_unobserveFeatureMenuObserver",value:function(){this._featureMenuIntersectionObserverNode&&this._featureMenuIntersectionObserver.unobserve(this._featureMenuIntersectionObserverNode)}},{key:"_featureMenuIntersectionObserverCreated",value:function(e){this._unobserveFeatureMenuObserver(),this._featureMenuIntersectionObserver.observe(e),this._featureMenuIntersectionObserverNode=e}},{key:"_handleFeatureMenuKeyup",value:function(e){"Escape"===(0,p.kK)(e)&&(e.stopPropagation(),this._focusFeatureMenuButton=!0,this.featureMenuOpen=!1,this.scheduleRender())}},{key:"_handleActionMenuKeyup",value:function(e){"Escape"===(0,p.kK)(e)&&(e.stopPropagation(),this._focusActionsMenuButton=!0,this.actionsMenuOpen=!1,this.scheduleRender())}},{key:"_setActiveFeature",value:function(e){var t=this.viewModel,i=sr(e.currentTarget);t.activeFeature=t.features[i]||null}},{key:"_removeActiveFeature",value:function(){this.viewModel.activeFeature=null}},{key:"_handleFeatureMenuItemKeyup",value:function(e){var t=(0,p.kK)(e),i=this._featureMenuNode,n=sr(e.currentTarget);if(i){var r=i.querySelectorAll("li"),a=r.length;"ArrowUp"!==t?"ArrowDown"!==t?"Home"!==t?"End"!==t||(e.stopPropagation(),r[r.length-1].focus()):(e.stopPropagation(),r[0].focus()):(e.stopPropagation(),r[(n+1+a)%a].focus()):(e.stopPropagation(),r[(n-1+a)%a].focus())}}},{key:"_handleActionMenuItemKeyup",value:function(e){var t=(0,p.kK)(e),i=this._actionsMenuNode,n=e.currentTarget.dataset.actionUid,r=this.dividedActions.menuActions.findIndex((function(e){return e.uid===n}));if(i){var a=i.querySelectorAll("li"),o=a.length;"ArrowUp"!==t?"ArrowDown"!==t?"Home"!==t?"End"!==t||(e.stopPropagation(),a[a.length-1].focus()):(e.stopPropagation(),a[0].focus()):(e.stopPropagation(),a[(r+1+o)%o].focus()):(e.stopPropagation(),a[(r-1+o)%o].focus())}}},{key:"_handleMainKeyup",value:function(e){var t=(0,p.kK)(e);"ArrowLeft"===t&&(e.stopPropagation(),this.previous()),"ArrowRight"===t&&(e.stopPropagation(),this.next())}},{key:"_spinnerEnabledChange",value:function(e){if(this._destroySpinner(),e){var t=this.get("viewModel.view");this._createSpinner(t)}}},{key:"_hideSpinner",value:function(){var e=this._spinner;e&&(e.location=null,e.hide())}},{key:"_displaySpinner",value:function(){var e=this._spinner;if(e){var t=this.viewModel,i=t.location;t.waitingForResult&&i?e.show({location:i}):e.hide()}}},{key:"_getIconStyles",value:function(e){return{"background-image":e?"url(".concat(e,")"):""}}},{key:"_shouldFocus",value:function(){var e=(0,r.Z)((0,n.Z)().mark((function e(t){var i=this;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=null===t||void 0===t?void 0:t.shouldFocus,!e.t0){e.next=5;break}return e.next=4,(0,m.N1)((function(){var e;return!0===(null===(e=i.viewModel)||void 0===e?void 0:e.active)}));case 4:this.focus();case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_addSelectedFeatureIndexHandle",value:function(){var e=this,t=(0,m.YP)((function(){var t;return null===(t=e.viewModel)||void 0===t?void 0:t.selectedFeatureIndex}),(function(t,i){return e._selectedFeatureIndexUpdated(t,i)}));this._handles.add(t,er)}},{key:"_selectedFeatureIndexUpdated",value:function(e,t){this.featureCount&&e!==t&&-1!==e&&(this._destroyFlowItemWidgets(),this.actionsMenuOpen=!1,this.featureMenuOpen=!1,this._mainContainerNode&&(this._mainContainerNode.scrollTop=0),this._rootFlowItemNode&&this._rootFlowItemNode.scrollContentTo({top:0}))}},{key:"_destroySelectedFeatureWidget",value:function(){var e=this._feature;e&&(e.viewModel=null,e&&!e.destroyed&&e.destroy()),this._feature=null}},{key:"_isScreenLocationWithinView",value:function(e,t){return e.x>-1&&e.y>-1&&e.x<=t.width&&e.y<=t.height}},{key:"_isOutsideView",value:function(e){var t=e.popupHeight,i=e.popupWidth,n=e.screenLocation,r=e.side,a=e.view;if(isNaN(i)||isNaN(t)||!a||!n)return!1;var o=a.padding;return"right"===r&&n.x+i/2>a.width-o.right||"left"===r&&n.x-i/2<o.left||"top"===r&&n.y-t<o.top||"bottom"===r&&n.y+t>a.height-o.bottom}},{key:"_calculateAutoAlignment",value:function(e){if("auto"!==e)return e;var t=this._pointerOffsetInPx,i=this._containerNode,n=this._mainContainerNode,r=this.viewModel,a=r.screenLocation,o=r.view;if(null==a||!o||!i)return"top-center";if(!this._isScreenLocationWithinView(a,o))return this._get("currentAlignment")||"top-center";function s(e){return parseInt(e.replaceAll(/[^-\d\.]/g,""),10)}var l=n?window.getComputedStyle(n,null):null,u=l?s(l.getPropertyValue("max-height")):0,c=l?s(l.getPropertyValue("height")):0,d=i.getBoundingClientRect(),h=d.height,f=d.width+t,v=Math.max(h,u,c)+t,p=this._isOutsideView({popupHeight:v,popupWidth:f,screenLocation:a,side:"right",view:o}),g=this._isOutsideView({popupHeight:v,popupWidth:f,screenLocation:a,side:"left",view:o}),y=this._isOutsideView({popupHeight:v,popupWidth:f,screenLocation:a,side:"top",view:o}),m=this._isOutsideView({popupHeight:v,popupWidth:f,screenLocation:a,side:"bottom",view:o});return g?y?"bottom-right":"top-right":p?y?"bottom-left":"top-left":y?m?"top-center":"bottom-center":"top-center"}},{key:"_callCurrentAlignment",value:function(e){return"function"==typeof e?e.call(this):e}},{key:"_getCurrentAlignment",value:function(){var e=this.alignment;return this.dockEnabled||!this.viewModel.active?null:this._calculatePositionResult(this._calculateAutoAlignment(this._callCurrentAlignment(e)))}},{key:"_setCurrentAlignment",value:function(){this._set("currentAlignment",this._getCurrentAlignment())}},{key:"_setCurrentDockPosition",value:function(){this._set("currentDockPosition",this._getCurrentDockPosition())}},{key:"_calculatePositionResult",value:function(e){var t=["left","right"];return(0,Ne.dZ)(this.container)&&t.reverse(),null===e||void 0===e?void 0:e.replace(/leading/gi,t[0]).replaceAll(/trailing/gi,t[1])}},{key:"_callDockPosition",value:function(e){return"function"==typeof e?e.call(this):e}},{key:"_getDockPosition",value:function(){var e;return this._calculatePositionResult(this._calculateAutoDockPosition(this._callDockPosition(null===(e=this.dockOptions)||void 0===e?void 0:e.position)))}},{key:"_getCurrentDockPosition",value:function(){return this.dockEnabled&&this.viewModel.active?this._getDockPosition():null}},{key:"_wouldDockTo",value:function(){return this.dockEnabled?null:this._getDockPosition()}},{key:"_calculateAutoDockPosition",value:function(e){var t;if("auto"!==e)return e;var i=null===(t=this.viewModel)||void 0===t?void 0:t.view,n=(0,Ne.dZ)(this.container)?"top-left":"top-right";if(!i)return n;var r=i.padding||{left:0,right:0,top:0,bottom:0},a=i.width-r.left-r.right,o=i.breakpoints;return o&&a<=o.xsmall?"bottom-center":n}},{key:"_positionContainer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._containerNode;if(e&&(this._containerNode=e),this._containerNode){var t=this.viewModel.screenLocation,i=this._containerNode.getBoundingClientRect(),n=i.width,r=this._calculatePositionStyle(t,n);r&&Object.assign(this._containerNode.style,r)}}},{key:"_calculateFullWidth",value:function(e){var t=this.currentAlignment,i=this._pointerOffsetInPx;return"top-left"===t||"bottom-left"===t||"top-right"===t||"bottom-right"===t?e+i:e}},{key:"_calculateAlignmentPosition",value:function(e,t,i,n){var r=this.currentAlignment,a=this._pointerOffsetInPx;if(i){var o=i.padding,s=n/2,l=i.height-t,u=i.width-e;return"bottom-center"===r?{top:t+a-o.top,left:e-s-o.left}:"top-left"===r?{bottom:l+a-o.bottom,right:u+a-o.right}:"bottom-left"===r?{top:t+a-o.top,right:u+a-o.right}:"top-right"===r?{bottom:l+a-o.bottom,left:e+a-o.left}:"bottom-right"===r?{top:t+a-o.top,left:e+a-o.left}:"top-center"===r?{bottom:l+a-o.bottom,left:e-s-o.left}:void 0}}},{key:"_calculatePositionStyle",value:function(e,t){var i=this.dockEnabled,n=this.view;if(n){if(i)return{left:"",top:"",right:"",bottom:""};if(null!=e&&t){var r=this._calculateFullWidth(t),a=this._calculateAlignmentPosition(e.x,e.y,n,r);return a?{top:void 0!==a.top?"".concat(a.top,"px"):"auto",left:void 0!==a.left?"".concat(a.left,"px"):"auto",bottom:void 0!==a.bottom?"".concat(a.bottom,"px"):"auto",right:void 0!==a.right?"".concat(a.right,"px"):"auto"}:void 0}}}},{key:"_viewChange",value:function(e,t){e&&t&&(this.close(),this.clear())}},{key:"_viewReadyChange",value:function(e,t){if(e){var i=this.get("viewModel.view");this._wireUpView(i)}else t&&(this.close(),this.clear())}},{key:"_wireUpView",value:function(e){(this._destroySpinner(),e)&&(this.spinnerEnabled&&this._createSpinner(e),this._setDockEnabledForViewSize(this.dockOptions))}},{key:"_dockingThresholdCrossed",value:function(e,t,i){var n=(0,s.Z)(e,2),r=n[0],a=n[1],o=(0,s.Z)(t,2),l=o[0],u=o[1],c=null!==i&&void 0!==i?i:{},d=c.width,h=void 0===d?0:d,f=c.height,v=void 0===f?0:f;return r<=h&&l>h||r>h&&l<=h||a<=v&&u>v||a>v&&u<=v}},{key:"_updateDockEnabledForViewSize",value:function(e,t){if(e&&t){var i=this.get("viewModel.view.padding")||{left:0,right:0,top:0,bottom:0},n=i.left+i.right,r=i.top+i.bottom,a=[],o=[];a[0]=e[0]-n,a[1]=e[1]-r,o[0]=t[0]-n,o[1]=t[1]-r;var s=this.dockOptions,l=s.breakpoint;this._dockingThresholdCrossed(a,o,l)&&this._setDockEnabledForViewSize(s),this._setCurrentDockPosition()}}},{key:"_focusDockButtonNode",value:function(e){this._focusDockButton&&(this._focusDockButton=!1,e.focus())}},{key:"_closeButtonNodeUpdated",value:function(e){return this._focusClose?(this._focusClose=!1,void e.focus()):this._blurClose?(this._blurClose=!1,void e.blur()):void 0}},{key:"_mainContainerNodeUpdated",value:function(e){return this._mainContainerNode=e,this._focusContainer?(this._focusContainer=!1,void e.focus()):this._blurContainer?(this._blurContainer=!1,void e.blur()):void 0}},{key:"_featureMenuNodeUpdated",value:function(e){if(this._featureMenuNode=e,e&&this._focusFirstFeature){this._focusFirstFeature=!1;var t=e.querySelectorAll("li");t.length&&t[0].focus()}}},{key:"_actionsMenuNodeUpdated",value:function(e){if(this._actionsMenuNode=e,e&&this._focusFirstAction){this._focusFirstAction=!1;var t=e.querySelectorAll("li");t.length&&t[0].focus()}}},{key:"_focusFeatureMenuButtonNode",value:function(e){this._focusFeatureMenuButton&&(this._focusFeatureMenuButton=!1,e.focus())}},{key:"_focusActionsMenuButtonNode",value:function(e){this._focusActionsMenuButton&&(this._focusActionsMenuButton=!1,e.focus())}},{key:"_featureMenuViewportScrollTop",value:function(){this._featureMenuViewportNode&&(this._featureMenuViewportNode.scrollTop=0)}},{key:"_toggleScreenLocationEnabled",value:function(){var e=this.dockEnabled,t=this.viewModel;if(t){var i=t.active&&!e;t.screenLocationEnabled=i}}},{key:"_shouldDockAtCurrentViewSize",value:function(e){var t,i,n,r,a=e.breakpoint,o=null===(t=this.viewModel)||void 0===t||null===(i=t.view)||void 0===i?void 0:i.ui;if(!o)return!1;var s=o.width,l=o.height;if(isNaN(s)||isNaN(l))return!1;if(!a)return!1;var u=a.hasOwnProperty("width")&&s<=(null!==(n=a.width)&&void 0!==n?n:0),c=a.hasOwnProperty("height")&&l<=(null!==(r=a.height)&&void 0!==r?r:0);return u||c}},{key:"_setDockEnabledForViewSize",value:function(e){e.breakpoint&&(this.dockEnabled=this._shouldDockAtCurrentViewSize(e))}},{key:"_getPageText",value:function(e,t){return this.featureNavigationVisible?(0,Jt.n)(this.messages.pageText,{index:t+1,total:e}):null}},{key:"_destroySpinner",value:function(){var e,t;this._spinner&&(null!==(e=this.view)&&void 0!==e&&null!==(t=e.ui)&&void 0!==t&&t.remove(this._spinner,tr),this._spinner.destroy(),this._spinner=null)}},{key:"_createSpinner",value:function(e){e&&(this._spinner=new bn({view:e}),e.ui.add(this._spinner,{key:tr,position:"manual",internal:!0}))}},{key:"_toggleCollapsed",value:function(){this.collapsed=!this.collapsed}},{key:"_close",value:function(){this.close(),this.view&&this.view.focus()}},{key:"_toggleDockEnabled",value:function(){this.dockEnabled=!this.dockEnabled,this._focusDockButton=!0,this.scheduleRender()}},{key:"_toggleFeatureMenu",value:function(){var e=!this.featureMenuOpen;this._featureMenuOpenChanged(e),this.actionsMenuOpen=!1,this.featureMenuOpen=e}},{key:"_toggleActionsMenu",value:function(){var e=!this.actionsMenuOpen;this._actionsMenuOpenChanged(e),this.featureMenuOpen=!1,this.actionsMenuOpen=e}},{key:"_triggerAction",value:function(e){var t=e.currentTarget.dataset.actionUid,i=this.viewModel.allActions,n=i.findIndex((function(e){return e.uid===t})),r=i.at(n);r&&"toggle"===r.type&&(r.value=!r.value),this.actionsMenuOpen=!1,this.viewModel.triggerAction(n)}},{key:"_selectFeature",value:function(e){var t=sr(e.currentTarget);null==t||isNaN(t)||(this.viewModel.selectedFeatureIndex=t),this.featureMenuOpen=!1,this._focusFeatureMenuButton=!0,this.scheduleRender()}},{key:"_next",value:function(){this.next()}},{key:"_previous",value:function(){this.previous()}}]),h}(rn(C.Z));function sr(e){return null===e||void 0===e?void 0:e["data-feature-index"]}(0,h._)([(0,_.Cb)({readOnly:!0})],or.prototype,"actionsMenuId",null),(0,h._)([(0,_.Cb)({readOnly:!0})],or.prototype,"actionsMenuButtonId",null),(0,h._)([(0,_.Cb)({readOnly:!0})],or.prototype,"featureMenuId",null),(0,h._)([(0,_.Cb)({readOnly:!0})],or.prototype,"titleId",null),(0,h._)([(0,_.Cb)({readOnly:!0})],or.prototype,"contentId",null),(0,h._)([(0,_.Cb)({readOnly:!0})],or.prototype,"hasContent",null),(0,h._)([(0,_.Cb)({readOnly:!0})],or.prototype,"featureNavigationVisible",null),(0,h._)([(0,_.Cb)({readOnly:!0})],or.prototype,"collapsible",null),(0,h._)([(0,_.Cb)({readOnly:!0})],or.prototype,"featureMenuVisible",null),(0,h._)([(0,_.Cb)({readOnly:!0})],or.prototype,"contentCollapsed",null),(0,h._)([(0,_.Cb)({readOnly:!0})],or.prototype,"dividedActions",null),(0,h._)([(0,_.Cb)({readOnly:!0,dependsOn:["_flowItems.length"]})],or.prototype,"_activeFlowItemWidget",null),(0,h._)([(0,_.Cb)()],or.prototype,"actions",null),(0,h._)([(0,_.Cb)()],or.prototype,"actionsMenuOpen",null),(0,h._)([(0,_.Cb)()],or.prototype,"alignment",void 0),(0,h._)([(0,_.Cb)()],or.prototype,"autoCloseEnabled",null),(0,h._)([(0,_.Cb)()],or.prototype,"autoOpenEnabled",null),(0,h._)([(0,_.Cb)()],or.prototype,"defaultPopupTemplateEnabled",null),(0,h._)([(0,_.Cb)()],or.prototype,"content",null),(0,h._)([(0,_.Cb)()],or.prototype,"collapsed",void 0),(0,h._)([(0,_.Cb)()],or.prototype,"collapseEnabled",void 0),(0,h._)([(0,_.Cb)({readOnly:!0})],or.prototype,"currentAlignment",null),(0,h._)([(0,_.Cb)({readOnly:!0})],or.prototype,"currentDockPosition",null),(0,h._)([(0,_.Cb)()],or.prototype,"dockOptions",null),(0,h._)([(0,_.Cb)()],or.prototype,"dockEnabled",void 0),(0,h._)([(0,_.Cb)({readOnly:!0})],or.prototype,"featureCount",null),(0,h._)([(0,_.Cb)()],or.prototype,"featureMenuOpen",null),(0,h._)([(0,_.Cb)()],or.prototype,"features",null),(0,h._)([(0,_.Cb)()],or.prototype,"goToOverride",null),(0,h._)([(0,_.Cb)()],or.prototype,"headingLevel",void 0),(0,h._)([(0,_.Cb)()],or.prototype,"highlightEnabled",null),(0,h._)([(0,_.Cb)()],or.prototype,"location",null),(0,h._)([(0,_.Cb)()],or.prototype,"label",null),(0,h._)([(0,_.Cb)()],or.prototype,"maxInlineActions",void 0),(0,h._)([(0,_.Cb)(),(0,He.H)("esri/widgets/Popup/t9n/Popup")],or.prototype,"messages",void 0),(0,h._)([(0,_.Cb)(),(0,He.H)("esri/t9n/common")],or.prototype,"messagesCommon",void 0),(0,h._)([(0,_.Cb)()],or.prototype,"promises",null),(0,h._)([(0,_.Cb)({readOnly:!0})],or.prototype,"selectedFeature",null),(0,h._)([(0,_.Cb)()],or.prototype,"selectedFeatureIndex",null),(0,h._)([(0,_.Cb)({readOnly:!0})],or.prototype,"selectedFeatureWidget",null),(0,h._)([(0,_.Cb)()],or.prototype,"spinnerEnabled",void 0),(0,h._)([(0,_.Cb)()],or.prototype,"title",null),(0,h._)([(0,_.Cb)()],or.prototype,"updateLocationEnabled",null),(0,h._)([(0,_.Cb)()],or.prototype,"view",null),(0,h._)([(0,_.Cb)({type:$n}),(0,Jn.s)(["triggerAction","trigger-action"])],or.prototype,"viewModel",void 0),(0,h._)([(0,_.Cb)()],or.prototype,"visible",null),(0,h._)([(0,_.Cb)()],or.prototype,"visibleElements",void 0),(0,h._)([(0,w.p)("visibleElements")],or.prototype,"castVisibleElements",null),(0,h._)([(0,Qn.h)()],or.prototype,"_close",null),(0,h._)([(0,Qn.h)()],or.prototype,"_toggleDockEnabled",null),(0,h._)([(0,Qn.h)()],or.prototype,"_toggleFeatureMenu",null),(0,h._)([(0,Qn.h)()],or.prototype,"_toggleActionsMenu",null),(0,h._)([(0,Qn.h)()],or.prototype,"_triggerAction",null),(0,h._)([(0,Qn.h)()],or.prototype,"_selectFeature",null),(0,h._)([(0,Qn.h)()],or.prototype,"_next",null),(0,h._)([(0,Qn.h)()],or.prototype,"_previous",null);var lr=or=(0,h._)([(0,x.j)("esri.widgets.Popup")],or)},86798:function(e,t,i){i.r(t),i.d(t,{createRoot:function(){return Oe},esriChartColorSet:function(){return Fe}});var n=i(74165),r=i(15861),a=i(37762),o=i(82963),s=i(97326),l=i(11752),u=i(61120),c=i(60136),d=i(29388),h=i(15671),f=i(43144),v=(i(59166),i(24390)),p=i(32390),g=i(98266),y=i(36257),m=function(){function e(){var t=this;(0,h.Z)(this,e),Object.defineProperty(this,"_observer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_targets",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this._observer=new ResizeObserver((function(e){(0,v.e)(e,(function(e){(0,v.e)(t._targets,(function(t){t.target===e.target&&t.callback()}))}))}))}return(0,f.Z)(e,[{key:"addTarget",value:function(e,t){this._observer.observe(e,{box:"border-box"}),this._targets.push({target:e,callback:t})}},{key:"removeTarget",value:function(e){this._observer.unobserve(e),(0,v.k)(this._targets,(function(t){return t.target!==e}))}}]),e}(),b=function(){function e(){(0,h.Z)(this,e),Object.defineProperty(this,"_timer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_targets",{enumerable:!0,configurable:!0,writable:!0,value:[]})}return(0,f.Z)(e,[{key:"addTarget",value:function(t,i){var n=this;if(null===this._timer){var r=null;this._timer=requestAnimationFrame((function t(){var i=Date.now();(null===r||i>r+e.delay)&&(r=i,(0,v.e)(n._targets,(function(e){var t=e.target.getBoundingClientRect();t.width===e.size.width&&t.height===e.size.height||(e.size=t,e.callback())}))),0===n._targets.length?n._timer=null:n._timer=requestAnimationFrame(t)}))}this._targets.push({target:t,callback:i,size:{width:0,height:0,left:0,right:0,top:0,bottom:0,x:0,y:0}})}},{key:"removeTarget",value:function(e){(0,v.k)(this._targets,(function(t){return t.target!==e})),0===this._targets.length&&null!==this._timer&&(cancelAnimationFrame(this._timer),this._timer=null)}}]),e}();Object.defineProperty(b,"delay",{enumerable:!0,configurable:!0,writable:!0,value:200});var _=null;var w=function(){function e(t,i){(0,h.Z)(this,e),Object.defineProperty(this,"_sensor",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_element",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_listener",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_disposed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this._sensor=(null===_&&(_="undefined"!=typeof ResizeObserver?new m:new b),_),this._element=t,this._listener=(0,v.o)(i),this._sensor.addTarget(t,i)}return(0,f.Z)(e,[{key:"isDisposed",value:function(){return this._disposed}},{key:"dispose",value:function(){this._disposed||(this._disposed=!0,this._sensor.removeTarget(this._element),this._listener.dispose())}},{key:"sensor",get:function(){return this._sensor}}]),e}(),k=function(e){(0,c.Z)(i,e);var t=(0,d.Z)(i);function i(){return(0,h.Z)(this,i),t.apply(this,arguments)}return(0,f.Z)(i)}(v.E);Object.defineProperty(k,"className",{enumerable:!0,configurable:!0,writable:!0,value:"InterfaceColors"}),Object.defineProperty(k,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:v.E.classNames.concat([k.className])});var x=function(e){(0,c.Z)(i,e);var t=(0,d.Z)(i);function i(){return(0,h.Z)(this,i),t.apply(this,arguments)}return(0,f.Z)(i,[{key:"_setDefaults",value:function(){this._setDefault("negativeBase",0),this._setDefault("numberFormat","#,###.#####"),this._setDefault("smallNumberThreshold",1);var e="_big_number_suffix_",t="_small_number_suffix_",n="_byte_suffix_";this._setDefault("bigNumberPrefixes",[{number:1e3,suffix:this._t(e+"3")},{number:1e6,suffix:this._t(e+"6")},{number:1e9,suffix:this._t(e+"9")},{number:1e12,suffix:this._t(e+"12")},{number:1e15,suffix:this._t(e+"15")},{number:1e18,suffix:this._t(e+"18")},{number:1e21,suffix:this._t(e+"21")},{number:1e24,suffix:this._t(e+"24")}]),this._setDefault("smallNumberPrefixes",[{number:1e-24,suffix:this._t(t+"24")},{number:1e-21,suffix:this._t(t+"21")},{number:1e-18,suffix:this._t(t+"18")},{number:1e-15,suffix:this._t(t+"15")},{number:1e-12,suffix:this._t(t+"12")},{number:1e-9,suffix:this._t(t+"9")},{number:1e-6,suffix:this._t(t+"6")},{number:.001,suffix:this._t(t+"3")}]),this._setDefault("bytePrefixes",[{number:1,suffix:this._t(n+"B")},{number:1024,suffix:this._t(n+"KB")},{number:1048576,suffix:this._t(n+"MB")},{number:1073741824,suffix:this._t(n+"GB")},{number:1099511627776,suffix:this._t(n+"TB")},{number:0x4000000000000,suffix:this._t(n+"PB")}]),(0,l.Z)((0,u.Z)(i.prototype),"_setDefaults",this).call(this)}},{key:"_beforeChanged",value:function(){(0,l.Z)((0,u.Z)(i.prototype),"_beforeChanged",this).call(this)}},{key:"format",value:function(e,t,i){var n;(null==t||(0,v.i)(t)&&"number"===t.toLowerCase())&&(t=this.get("numberFormat",""));var r=Number(e);if((0,v.a)(t))try{return this.get("intlLocales")?new Intl.NumberFormat(this.get("intlLocales"),t).format(r):new Intl.NumberFormat(void 0,t).format(r)}catch(s){return"Invalid"}else{t=(0,v.c)(t);var a,o=this.parseFormat(t,this._root.language);a=r>this.get("negativeBase")?o.positive:r<this.get("negativeBase")?o.negative:o.zero,null==i||a.mod||((a=(0,v.b)(a)).decimals.active=0==r?0:i),n=a.template.split(v.P).join(this.applyFormat(r,a))}return n}},{key:"parseFormat",value:function(e,t){var i=this,n=t.translateEmpty("_thousandSeparator"),r=t.translateEmpty("_decimalSeparator"),a={positive:{thousands:{active:-1,passive:-1,interval:-1,separator:n},decimals:{active:-1,passive:-1,separator:r},template:"",source:"",parsed:!1},negative:{thousands:{active:-1,passive:-1,interval:-1,separator:n},decimals:{active:-1,passive:-1,separator:r},template:"",source:"",parsed:!1},zero:{thousands:{active:-1,passive:-1,interval:-1,separator:n},decimals:{active:-1,passive:-1,separator:r},template:"",source:"",parsed:!1}},o=(e=e.replace("||",v.d)).split("|");return a.positive.source=o[0],void 0===o[2]?a.zero=a.positive:a.zero.source=o[2],void 0===o[1]?a.negative=a.positive:a.negative.source=o[1],(0,v.f)(a,(function(e,t){if(!t.parsed){var n=t.source;"number"===n.toLowerCase()&&(n=i.get("numberFormat","#,###.#####"));for(var r=v.T.chunk(n,!0),a=0;a<r.length;a++){var o=r[a];if(o.text=o.text.replace(v.d,"|"),"value"===o.type){var s=o.text.match(/[#0.,]+[ ]?[abespABESP%!]?[abespABESP\u2030!]?/);if(s)if(null===s||""===s[0])t.template+=o.text;else{var l=s[0].match(/[abespABESP%\u2030!]{2}|[abespABESP%\u2030]{1}$/);l&&(t.mod=l[0].toLowerCase(),t.modSpacing=!!s[0].match(/[ ]{1}[abespABESP%\u2030!]{1}$/));var u=s[0].split(".");if(""===u[0]);else{t.thousands.active=(u[0].match(/0/g)||[]).length,t.thousands.passive=(u[0].match(/\#/g)||[]).length+t.thousands.active;var c=u[0].split(",");1===c.length||(t.thousands.interval=(c.pop()||"").length,0===t.thousands.interval&&(t.thousands.interval=-1))}void 0===u[1]||(t.decimals.active=(u[1].match(/0/g)||[]).length,t.decimals.passive=(u[1].match(/\#/g)||[]).length+t.decimals.active),t.template+=o.text.split(s[0]).join(v.P)}}else t.template+=o.text}t.parsed=!0}})),a}},{key:"applyFormat",value:function(e,t){var i=e<0;e=Math.abs(e);var n,r="",a="",o=t.mod?t.mod.split(""):[];if(-1!==o.indexOf("b")){var s=this.applyPrefix(e,this.get("bytePrefixes"),-1!==o.indexOf("!"));e=s[0],r=s[1],a=s[2],t.modSpacing&&(a=" "+a)}else if(-1!==o.indexOf("a")){var l=this.applyPrefix(e,e<this.get("smallNumberThreshold")?this.get("smallNumberPrefixes"):this.get("bigNumberPrefixes"),-1!==o.indexOf("!"));e=l[0],r=l[1],a=l[2],t.modSpacing&&(a=" "+a)}else if(-1!==o.indexOf("p")){var u=Math.min(e.toString().length+2,21);e=parseFloat(e.toPrecision(u)),r=this._root.language.translate("_percentPrefix"),a=this._root.language.translate("_percentSuffix"),""==r&&""==a&&(a="%")}else if(-1!==o.indexOf("%")){var c=Math.min(e.toString().length+2,21);e*=100,e=parseFloat(e.toPrecision(c)),a="%"}else if(-1!==o.indexOf("\u2030")){var d=Math.min(e.toString().length+3,21);e*=1e3,e=parseFloat(e.toPrecision(d)),a="\u2030"}if(-1!==o.indexOf("e"))n=t.decimals.passive>=0?e.toExponential(t.decimals.passive).split("e"):e.toExponential().split("e"),e=Number(n[0]),a="e"+n[1],t.modSpacing&&(a=" "+a);else if(0===t.decimals.passive)e=Math.round(e);else if(t.decimals.passive>0){var h=Math.pow(10,t.decimals.passive);e=Math.round(e*h)/h}var f="",p=(0,v.n)(e).split("."),g=p[0];if(g.length<t.thousands.active&&(g=Array(t.thousands.active-g.length+1).join("0")+g),t.thousands.interval>0){for(var y=[],m=g.split("").reverse().join(""),b=0,_=g.length;b<=_;b+=t.thousands.interval){var w=m.substr(b,t.thousands.interval).split("").reverse().join("");""!==w&&y.unshift(w)}g=y.join(t.thousands.separator)}f+=g,1===p.length&&p.push("");var k=p[1];return k.length<t.decimals.active&&(k+=Array(t.decimals.active-k.length+1).join("0")),""!==k&&(f+=t.decimals.separator+k),""===f&&(f="0"),0!==e&&i&&-1===o.indexOf("s")&&(f="-"+f),r&&(f=r+f),a&&(f+=a),f}},{key:"applyPrefix",value:function(e,t){for(var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=e,r="",a="",o=!1,s=1,l=0,u=t.length;l<u;l++)t[l].number<=e&&(0===t[l].number?n=0:(n=e/t[l].number,s=t[l].number),r=t[l].prefix,a=t[l].suffix,o=!0);return!o&&i&&t.length&&0!=e&&(n=e/t[0].number,r=t[0].prefix,a=t[0].suffix,o=!0),o&&(n=parseFloat(n.toPrecision(Math.min(s.toString().length+Math.floor(n).toString().replace(/[^0-9]*/g,"").length,21)))),[n,r,a]}},{key:"escape",value:function(e){return e.replace("||",v.d)}},{key:"unescape",value:function(e){return e.replace(v.d,"|")}}]),i}(v.E);function C(e,t){var i=0,n=0,r=1,a=0,o=0,s=0,l=0,u=0;return e.formatToParts(t).forEach((function(e){switch(e.type){case"year":i=+e.value;break;case"month":n=+e.value-1;break;case"day":r=+e.value;break;case"hour":a=+e.value;break;case"minute":o=+e.value;break;case"second":s=+e.value;break;case"fractionalSecond":l=+e.value;break;case"weekday":switch(e.value){case"Sun":u=0;break;case"Mon":u=1;break;case"Tue":u=2;break;case"Wed":u=3;break;case"Thu":u=4;break;case"Fri":u=5;break;case"Sat":u=6}}})),24===a&&(a=0),{year:i,month:n,day:r,hour:a,minute:o,second:s,millisecond:l,weekday:u}}function M(e,t){var i=C(e,t),n=i.year,r=i.month,a=i.day,o=i.hour,s=i.minute,l=i.second,u=i.millisecond;return Date.UTC(n,r,a,o,s,l,u)}var P=function(){function e(t,i){if((0,h.Z)(this,e),Object.defineProperty(this,"_utc",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_dtf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),!i)throw new Error("You cannot use `new Class()`, instead use `Class.new()`");this.name=t,this._utc=new Intl.DateTimeFormat("UTC",{hour12:!1,timeZone:"UTC",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",weekday:"short",fractionalSecondDigits:3}),this._dtf=new Intl.DateTimeFormat("UTC",{hour12:!1,timeZone:t,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",weekday:"short",fractionalSecondDigits:3})}return(0,f.Z)(e,[{key:"convertLocal",value:function(e){var t=this.offsetUTC(e),i=e.getTimezoneOffset(),n=new Date(e);n.setUTCMinutes(n.getUTCMinutes()-(t-i));var r=n.getTimezoneOffset();return i!=r&&n.setUTCMinutes(n.getUTCMinutes()+r-i),n}},{key:"offsetUTC",value:function(e){return(M(this._utc,e)-M(this._dtf,e))/6e4}},{key:"parseDate",value:function(e){return C(this._dtf,e)}}],[{key:"new",value:function(e){return new this(e,!0)}}]),e}(),Z=function(e){(0,c.Z)(i,e);var t=(0,d.Z)(i);function i(){return(0,h.Z)(this,i),t.apply(this,arguments)}return(0,f.Z)(i,[{key:"_setDefaults",value:function(){this._setDefault("capitalize",!0),this._setDefault("dateFormat","yyyy-MM-dd"),(0,l.Z)((0,u.Z)(i.prototype),"_setDefaults",this).call(this)}},{key:"_beforeChanged",value:function(){(0,l.Z)((0,u.Z)(i.prototype),"_beforeChanged",this).call(this)}},{key:"format",value:function(e,t){var i;void 0!==t&&""!==t||(t=this.get("dateFormat","yyyy-MM-dd"));var n=e;if((0,v.a)(t))try{var r=this.get("intlLocales");return r?new Intl.DateTimeFormat(r,t).format(n):new Intl.DateTimeFormat(void 0,t).format(n)}catch(s){return"Invalid"}var a=this.parseFormat(t),o=this._root.timezone;return o&&!this._root.utc&&(n=o.convertLocal(n)),(0,v.g)(n.getTime())?(i=this.applyFormat(n,a),this.get("capitalize")&&(i=i.replace(/^.{1}/,i.substr(0,1).toUpperCase())),i):"Invalid date"}},{key:"applyFormat",value:function(e,t){var i,n,r,a,o,s,l,u,c=t.template,d=e.getTime();this._root.utc?(i=e.getUTCFullYear(),n=e.getUTCMonth(),r=e.getUTCDay(),a=e.getUTCDate(),o=e.getUTCHours(),s=e.getUTCMinutes(),l=e.getUTCSeconds(),u=e.getUTCMilliseconds()):(i=e.getFullYear(),n=e.getMonth(),r=e.getDay(),a=e.getDate(),o=e.getHours(),s=e.getMinutes(),l=e.getSeconds(),u=e.getMilliseconds());for(var h=0,f=t.parts.length;h<f;h++){var p="";switch(t.parts[h]){case"G":p=this._t(i<0?"_era_bc":"_era_ad");break;case"yyyy":p=Math.abs(i).toString(),i<0&&(p+=this._t("_era_bc"));break;case"yyy":case"yy":case"y":p=Math.abs(i).toString().substr(-t.parts[h].length),i<0&&(p+=this._t("_era_bc"));break;case"YYYY":case"YYY":case"YY":case"Y":var g=(0,v.s)(e,this._root.utc);p="YYYY"==t.parts[h]?Math.abs(g).toString():Math.abs(g).toString().substr(-t.parts[h].length),g<0&&(p+=this._t("_era_bc"));break;case"u":case"F":case"g":break;case"q":p=""+Math.ceil((e.getMonth()+1)/3);break;case"MMMMM":p=this._t(this._getMonth(n)).substr(0,1);break;case"MMMM":p=this._t(this._getMonth(n));break;case"MMM":p=this._t(this._getShortMonth(n));break;case"MM":p=(0,v.p)(n+1,2,"0");break;case"M":p=(n+1).toString();break;case"ww":p=(0,v.p)((0,v.r)(e,this._root.utc),2,"0");break;case"w":p=(0,v.r)(e,this._root.utc).toString();break;case"W":p=(0,v.q)(e,this._root.utc).toString();break;case"dd":p=(0,v.p)(a,2,"0");break;case"d":p=a.toString();break;case"DD":case"DDD":p=(0,v.p)((0,v.m)(e,this._root.utc).toString(),t.parts[h].length,"0");break;case"D":p=(0,v.m)(e,this._root.utc).toString();break;case"t":p=this._root.language.translateFunc("_dateOrd").call(this,a);break;case"E":p=(r||7).toString();break;case"EE":p=(0,v.p)((r||7).toString(),2,"0");break;case"EEE":case"eee":p=this._t(this._getShortWeekday(r));break;case"EEEE":case"eeee":p=this._t(this._getWeekday(r));break;case"EEEEE":case"eeeee":p=this._t(this._getShortWeekday(r)).substr(0,1);break;case"e":case"ee":p=(r-(this._root.locale.firstDayOfWeek||1)+1).toString(),"ee"==t.parts[h]&&(p=(0,v.p)(p,2,"0"));break;case"a":p=o>=12?this._t("PM"):this._t("AM");break;case"aa":p=o>=12?this._t("P.M."):this._t("A.M.");break;case"aaa":p=o>=12?this._t("P"):this._t("A");break;case"h":p=(0,v.l)(o).toString();break;case"hh":p=(0,v.p)((0,v.l)(o),2,"0");break;case"H":p=o.toString();break;case"HH":p=(0,v.p)(o,2,"0");break;case"K":p=(0,v.l)(o,0).toString();break;case"KK":p=(0,v.p)((0,v.l)(o,0),2,"0");break;case"k":p=(o+1).toString();break;case"kk":p=(0,v.p)(o+1,2,"0");break;case"m":p=s.toString();break;case"mm":p=(0,v.p)(s,2,"0");break;case"s":p=l.toString();break;case"ss":p=(0,v.p)(l,2,"0");break;case"S":case"SS":case"SSS":p=Math.round(u/1e3*Math.pow(10,t.parts[h].length)).toString();break;case"x":p=d.toString();break;case"n":case"nn":case"nnn":p=(0,v.p)(u,t.parts[h].length,"0");break;case"z":p=(0,v.j)(e,!1,!1,this._root.utc);break;case"zz":p=(0,v.j)(e,!0,!1,this._root.utc);break;case"zzz":p=(0,v.j)(e,!1,!0,this._root.utc);break;case"zzzz":p=(0,v.j)(e,!0,!0,this._root.utc);break;case"Z":case"ZZ":var y=this._root.utc?"UTC":this._root.timezone;y instanceof P&&(y=y.name);var m=y?(0,v.h)(y):e.getTimezoneOffset(),b=Math.abs(m)/60,_=Math.floor(b),w=60*b-60*_;this._root.utc&&(_=0,w=0),"Z"==t.parts[h]?(p="GMT",p+=m>0?"-":"+",p+=(0,v.p)(_,2)+":"+(0,v.p)(w,2)):(p=m>0?"-":"+",p+=(0,v.p)(_,2)+(0,v.p)(w,2));break;case"i":p=e.toISOString();break;case"I":p=e.toUTCString()}c=c.replace(v.P,p)}return c}},{key:"parseFormat",value:function(e){for(var t={template:"",parts:[]},i=v.T.chunk(e,!0),n=0;n<i.length;n++){var r=i[n];if("value"===r.type){if(r.text.match(/^date$/i)){var a=this.get("dateFormat","yyyy-MM-dd");(0,v.i)(a)||(a="yyyy-MM-dd"),r.text=a}var o=r.text.match(/G|yyyy|yyy|yy|y|YYYY|YYY|YY|Y|u|q|MMMMM|MMMM|MMM|MM|M|ww|w|W|dd|d|DDD|DD|D|F|g|EEEEE|EEEE|EEE|EE|E|eeeee|eeee|eee|ee|e|aaa|aa|a|hh|h|HH|H|KK|K|kk|k|mm|m|ss|s|SSS|SS|S|A|zzzz|zzz|zz|z|ZZ|Z|t|x|nnn|nn|n|i|I/g);if(o)for(var s=0;s<o.length;s++)t.parts.push(o[s]),r.text=r.text.replace(o[s],v.P)}t.template+=r.text}return t}},{key:"_months",value:function(){return["January","February","March","April","May","June","July","August","September","October","November","December"]}},{key:"_getMonth",value:function(e){return this._months()[e]}},{key:"_shortMonths",value:function(){return["Jan","Feb","Mar","Apr","May(short)","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}},{key:"_getShortMonth",value:function(e){return this._shortMonths()[e]}},{key:"_weekdays",value:function(){return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}},{key:"_getWeekday",value:function(e){return this._weekdays()[e]}},{key:"_shortWeekdays",value:function(){return["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]}},{key:"_getShortWeekday",value:function(e){return this._shortWeekdays()[e]}},{key:"parse",value:function(e,t){if(e instanceof Date)return e;if((0,v.g)(e))return new Date(e);var i;(0,v.i)(e)||(e=e.toString());var n="";t=(t=(0,v.c)(t)).substr(0,e.length);for(var r=this.parseFormat(t),a={year:-1,year3:-1,year2:-1,year1:-1,month:-1,monthShort:-1,monthLong:-1,weekdayShort:-1,weekdayLong:-1,day:-1,yearDay:-1,week:-1,hourBase0:-1,hour12Base0:-1,hourBase1:-1,hour12Base1:-1,minute:-1,second:-1,millisecond:-1,millisecondDigits:-1,am:-1,zone:-1,timestamp:-1,iso:-1},o={year:1970,month:0,day:1,hour:0,minute:0,second:0,millisecond:0,timestamp:null,offset:0,utc:this._root.utc},s=0,l=0,u=0;u<r.parts.length;u++){switch(l=u+s+1,r.parts[u]){case"yyyy":case"YYYY":n+="([0-9]{4})",a.year=l;break;case"yyy":case"YYY":n+="([0-9]{3})",a.year3=l;break;case"yy":case"YY":n+="([0-9]{2})",a.year2=l;break;case"y":case"Y":n+="([0-9]{1})",a.year1=l;break;case"MMMM":n+="("+this.getStringList(this._months()).join("|")+")",a.monthLong=l;break;case"MMM":n+="("+this.getStringList(this._shortMonths()).join("|")+")",a.monthShort=l;break;case"MM":case"M":n+="([0-9]{2}|[0-9]{1})",a.month=l;break;case"ww":case"w":n+="([0-9]{2}|[0-9]{1})",a.week=l;break;case"dd":case"d":n+="([0-9]{2}|[0-9]{1})",a.day=l;break;case"DDD":case"DD":case"D":n+="([0-9]{3}|[0-9]{2}|[0-9]{1})",a.yearDay=l;break;case"dddd":n+="("+this.getStringList(this._weekdays()).join("|")+")",a.weekdayLong=l;break;case"ddd":n+="("+this.getStringList(this._shortWeekdays()).join("|")+")",a.weekdayShort=l;break;case"aaa":case"aa":case"a":n+="("+this.getStringList(["AM","PM","A.M.","P.M.","A","P"]).join("|")+")",a.am=l;break;case"hh":case"h":n+="([0-9]{2}|[0-9]{1})",a.hour12Base1=l;break;case"HH":case"H":n+="([0-9]{2}|[0-9]{1})",a.hourBase0=l;break;case"KK":case"K":n+="([0-9]{2}|[0-9]{1})",a.hour12Base0=l;break;case"kk":case"k":n+="([0-9]{2}|[0-9]{1})",a.hourBase1=l;break;case"mm":case"m":n+="([0-9]{2}|[0-9]{1})",a.minute=l;break;case"ss":case"s":n+="([0-9]{2}|[0-9]{1})",a.second=l;break;case"SSS":case"SS":case"S":n+="([0-9]{3}|[0-9]{2}|[0-9]{1})",a.millisecond=l,a.millisecondDigits=r.parts[u].length;break;case"nnn":case"nn":case"n":n+="([0-9]{3}|[0-9]{2}|[0-9]{1})",a.millisecond=l;break;case"x":n+="([0-9]{1,})",a.timestamp=l;break;case"Z":n+="GMT([-+]+[0-9]{2}:[0-9]{2})",a.zone=l;break;case"ZZ":n+="([\\-+]+[0-9]{2}[0-9]{2})",a.zone=l;break;case"i":n+="([0-9]{4})-?([0-9]{2})-?([0-9]{2})T?([0-9]{2}):?([0-9]{2}):?([0-9]{2})\\.?([0-9]{0,3})([zZ]|[+\\-][0-9]{2}:?[0-9]{2}|$)",a.iso=l,s+=7;break;case"G":case"YYYY":case"YYY":case"YY":case"Y":case"MMMMM":case"W":case"EEEEE":case"EEEE":case"EEE":case"EE":case"E":case"eeeee":case"eeee":case"eee":case"ee":case"e":case"zzzz":case"zzz":case"zz":case"z":case"t":s--}n+="[^0-9]*"}var c=new RegExp(n),d=e.match(c);if(d){if(a.year>-1&&(o.year=parseInt(d[a.year])),a.year3>-1){var h=parseInt(d[a.year3]);h+=1e3,o.year=h}if(a.year2>-1){var f=parseInt(d[a.year2]);f+=f>50?1e3:2e3,o.year=f}if(a.year1>-1){var p=parseInt(d[a.year1]);p=10*Math.floor((new Date).getFullYear()/10)+p,o.year=p}if(a.monthLong>-1&&(o.month=this.resolveMonth(d[a.monthLong])),a.monthShort>-1&&(o.month=this.resolveShortMonth(d[a.monthShort])),a.month>-1&&(o.month=parseInt(d[a.month])-1),a.week>-1&&-1===a.day&&(o.month=0,o.day=(0,v.t)(parseInt(d[a.week]),o.year,1,this._root.utc)),a.day>-1&&(o.day=parseInt(d[a.day])),a.yearDay>-1&&(o.month=0,o.day=parseInt(d[a.yearDay])),a.hourBase0>-1&&(o.hour=parseInt(d[a.hourBase0])),a.hourBase1>-1&&(o.hour=parseInt(d[a.hourBase1])-1),a.hour12Base0>-1){var g=parseInt(d[a.hour12Base0]);11==g&&(g=0),a.am>-1&&!this.isAm(d[a.am])&&(g+=12),o.hour=g}if(a.hour12Base1>-1){var y=parseInt(d[a.hour12Base1]);12==y&&(y=0),a.am>-1&&!this.isAm(d[a.am])&&(y+=12),o.hour=y}if(a.minute>-1&&(o.minute=parseInt(d[a.minute])),a.second>-1&&(o.second=parseInt(d[a.second])),a.millisecond>-1){var m=parseInt(d[a.millisecond]);2==a.millisecondDigits?m*=10:1==a.millisecondDigits&&(m*=100),o.millisecond=m}if(a.timestamp>-1){o.timestamp=parseInt(d[a.timestamp]);var b=new Date(o.timestamp);o.year=b.getUTCFullYear(),o.month=b.getUTCMonth(),o.day=b.getUTCDate(),o.hour=b.getUTCHours(),o.minute=b.getUTCMinutes(),o.second=b.getUTCSeconds(),o.millisecond=b.getUTCMilliseconds()}a.zone>-1&&(o.offset=this.resolveTimezoneOffset(new Date(o.year,o.month,o.day),d[a.zone])),a.iso>-1&&(o.year=(0,v.u)(d[a.iso+0]),o.month=(0,v.u)(d[a.iso+1])-1,o.day=(0,v.u)(d[a.iso+2]),o.hour=(0,v.u)(d[a.iso+3]),o.minute=(0,v.u)(d[a.iso+4]),o.second=(0,v.u)(d[a.iso+5]),o.millisecond=(0,v.u)(d[a.iso+6]),"Z"==d[a.iso+7]||"z"==d[a.iso+7]?o.utc=!0:""!=d[a.iso+7]&&(o.offset=this.resolveTimezoneOffset(new Date(o.year,o.month,o.day),d[a.iso+7]))),i=o.utc?new Date(Date.UTC(o.year,o.month,o.day,o.hour,o.minute,o.second,o.millisecond)):new Date(o.year,o.month,o.day,o.hour,o.minute+o.offset,o.second,o.millisecond)}else i=new Date(e);return i}},{key:"resolveTimezoneOffset",value:function(e,t){if(t.match(/([+\-]?)([0-9]{2}):?([0-9]{2})/)){var i=t.match(/([+\-]?)([0-9]{2}):?([0-9]{2})/),n=i[1],r=i[2],a=i[3],o=60*parseInt(r)+parseInt(a);return"+"==n&&(o*=-1),o-(e||new Date).getTimezoneOffset()}return 0}},{key:"resolveMonth",value:function(e){var t=this._months().indexOf(e);return t>-1||!this._root.language.isDefault()&&(t=this._root.language.translateAll(this._months()).indexOf(e))>-1?t:0}},{key:"resolveShortMonth",value:function(e){var t=this._shortMonths().indexOf(e);return t>-1?t:(t=this._months().indexOf(e))>-1||this._root.language&&!this._root.language.isDefault()&&(t=this._root.language.translateAll(this._shortMonths()).indexOf(e))>-1?t:0}},{key:"isAm",value:function(e){return this.getStringList(["AM","A.M.","A"]).indexOf(e.toUpperCase())>-1}},{key:"getStringList",value:function(e){for(var t=[],i=0;i<e.length;i++)this._root.language?t.push((0,v.v)(this._t(e[i]))):t.push((0,v.v)(e[i]));return t}}]),i}(v.E),A=function(e){(0,c.Z)(i,e);var t=(0,d.Z)(i);function i(){var e;return(0,h.Z)(this,i),e=t.apply(this,arguments),Object.defineProperty((0,s.Z)(e),"_unitAliases",{enumerable:!0,configurable:!0,writable:!0,value:{Y:"y",D:"d",H:"h",K:"h",k:"h",n:"S"}}),e}return(0,f.Z)(i,[{key:"_setDefaults",value:function(){var e="_duration_millisecond",t="_duration_second",n="_duration_minute",r="_duration_hour",a="_duration_day",o="_duration_week",s="_duration_month",c="_minute",d="_hour",h="_day",f="_week",v="_week",p="_year";this._setDefault("negativeBase",0),this._setDefault("baseUnit","second"),this._setDefault("durationFormats",{millisecond:{millisecond:this._t(e),second:this._t(e+"_second"),minute:this._t(e+c),hour:this._t(e+d),day:this._t(e+h),week:this._t(e+f),month:this._t(e+v),year:this._t(e+p)},second:{second:this._t(t),minute:this._t(t+c),hour:this._t(t+d),day:this._t(t+h),week:this._t(t+f),month:this._t(t+v),year:this._t(t+p)},minute:{minute:this._t(n),hour:this._t(n+d),day:this._t(n+h),week:this._t(n+f),month:this._t(n+v),year:this._t(n+p)},hour:{hour:this._t(r),day:this._t(r+h),week:this._t(r+f),month:this._t(r+v),year:this._t(r+p)},day:{day:this._t(a),week:this._t(a+f),month:this._t(a+v),year:this._t(a+p)},week:{week:this._t(o),month:this._t(o+v),year:this._t(o+p)},month:{month:this._t(s),year:this._t(s+p)},year:{year:this._t("_duration_year")}}),(0,l.Z)((0,u.Z)(i.prototype),"_setDefaults",this).call(this)}},{key:"_beforeChanged",value:function(){(0,l.Z)((0,u.Z)(i.prototype),"_beforeChanged",this).call(this)}},{key:"format",value:function(e,t,i){var n=i||this.get("baseUnit");void 0!==t&&""!==t||(t=null!=this.get("durationFormat")?this.get("durationFormat"):this.getFormat((0,v.u)(e),void 0,n)),t=(0,v.c)(t);var r,a=this.parseFormat(t,n),o=Number(e);r=o>this.get("negativeBase")?a.positive:o<this.get("negativeBase")?a.negative:a.zero;var s=this.applyFormat(o,r);return""!==r.color&&(s="["+r.color+"]"+s+"[/]"),s}},{key:"parseFormat",value:function(e,t){var i=this,n=t||this.get("baseUnit"),r={positive:{color:"",template:"",parts:[],source:"",baseUnit:n,parsed:!1,absolute:!1},negative:{color:"",template:"",parts:[],source:"",baseUnit:n,parsed:!1,absolute:!1},zero:{color:"",template:"",parts:[],source:"",baseUnit:n,parsed:!1,absolute:!1}},a=(e=e.replace("||",v.d)).split("|");return r.positive.source=a[0],void 0===a[2]?r.zero=r.positive:r.zero.source=a[2],void 0===a[1]?r.negative=r.positive:r.negative.source=a[1],(0,v.f)(r,(function(e,t){if(!t.parsed){var n,r=t.source;(n=t.source.match(/^\[([^\]]*)\]/))&&n.length&&""!==n[0]&&(r=t.source.substr(n[0].length),t.color=n[1]);for(var a=v.T.chunk(r,!0),o=0;o<a.length;o++){var s=a[o];if(s.text=s.text.replace(v.d,"|"),"value"===s.type){s.text.match(/[yYMdDwhHKkmsSn]+a/)&&(t.absolute=!0,s.text=s.text.replace(/([yYMdDwhHKkmsSn]+)a/,"$1"));var l=s.text.match(/y+|Y+|M+|d+|D+|w+|h+|H+|K+|k+|m+|s+|S+|n+/g);if(l)for(var u=0;u<l.length;u++)null==l[u]&&(l[u]=i._unitAliases[l[u]]),t.parts.push(l[u]),s.text=s.text.replace(l[u],v.P)}t.template+=s.text}t.parsed=!0}})),r}},{key:"applyFormat",value:function(e,t){var i=!t.absolute&&e<this.get("negativeBase");e=Math.abs(e);for(var n=this.toTimeStamp(e,t.baseUnit),r=t.template,a=0,o=t.parts.length;a<o;a++){var s=t.parts[a],l=this._toTimeUnit(s.substr(0,1)),u=s.length,c=Math.floor(n/this._getUnitValue(l));r=r.replace(v.P,(0,v.p)(c,u,"0")),n-=c*this._getUnitValue(l)}return i&&(r="-"+r),r}},{key:"toTimeStamp",value:function(e,t){return e*this._getUnitValue(t)}},{key:"_toTimeUnit",value:function(e){switch(e){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":return"hour";case"d":return"day";case"w":return"week";case"M":return"month";case"y":return"year"}}},{key:"getFormat",value:function(e,t,i){if(null!=this.get("durationFormat"))return this.get("durationFormat");if(i||(i=this.get("baseUnit")),null!=t&&e!=t){e=Math.abs(e),t=Math.abs(t);var n=this.getValueUnit(Math.max(e,t),i);return this.get("durationFormats")[i][n]}var r=this.getValueUnit(e,i);return this.get("durationFormats")[i][r]}},{key:"getValueUnit",value:function(e,t){var i;t||(t=this.get("baseUnit"));var n=this.getMilliseconds(e,t);return(0,v.w)(this._getUnitValues(),(function(e,r){if(e==t||i){if(n/r<=1)return i||(i=e),!1;i=e}return!0})),i}},{key:"getMilliseconds",value:function(e,t){return t||(t=this.get("baseUnit")),e*this._getUnitValue(t)}},{key:"_getUnitValue",value:function(e){return this._getUnitValues()[e]}},{key:"_getUnitValues",value:function(){return{millisecond:1,second:1e3,minute:6e4,hour:36e5,day:864e5,week:6048e5,month:2592e6,year:31536e6}}}]),i}(v.E),T={firstDayOfWeek:1,_decimalSeparator:".",_thousandSeparator:",",_percentPrefix:null,_percentSuffix:"%",_big_number_suffix_3:"k",_big_number_suffix_6:"M",_big_number_suffix_9:"G",_big_number_suffix_12:"T",_big_number_suffix_15:"P",_big_number_suffix_18:"E",_big_number_suffix_21:"Z",_big_number_suffix_24:"Y",_small_number_suffix_3:"m",_small_number_suffix_6:"\u03bc",_small_number_suffix_9:"n",_small_number_suffix_12:"p",_small_number_suffix_15:"f",_small_number_suffix_18:"a",_small_number_suffix_21:"z",_small_number_suffix_24:"y",_byte_suffix_B:"B",_byte_suffix_KB:"KB",_byte_suffix_MB:"MB",_byte_suffix_GB:"GB",_byte_suffix_TB:"TB",_byte_suffix_PB:"PB",_date:"yyyy-MM-dd",_date_millisecond:"mm:ss SSS",_date_millisecond_full:"HH:mm:ss SSS",_date_second:"HH:mm:ss",_date_second_full:"HH:mm:ss",_date_minute:"HH:mm",_date_minute_full:"HH:mm - MMM dd, yyyy",_date_hour:"HH:mm",_date_hour_full:"HH:mm - MMM dd, yyyy",_date_day:"MMM dd",_date_day_full:"MMM dd, yyyy",_date_week:"ww",_date_week_full:"MMM dd, yyyy",_date_month:"MMM",_date_month_full:"MMM, yyyy",_date_year:"yyyy",_duration_millisecond:"SSS",_duration_millisecond_second:"ss.SSS",_duration_millisecond_minute:"mm:ss SSS",_duration_millisecond_hour:"hh:mm:ss SSS",_duration_millisecond_day:"d'd' mm:ss SSS",_duration_millisecond_week:"d'd' mm:ss SSS",_duration_millisecond_month:"M'm' dd'd' mm:ss SSS",_duration_millisecond_year:"y'y' MM'm' dd'd' mm:ss SSS",_duration_second:"ss",_duration_second_minute:"mm:ss",_duration_second_hour:"hh:mm:ss",_duration_second_day:"d'd' hh:mm:ss",_duration_second_week:"d'd' hh:mm:ss",_duration_second_month:"M'm' dd'd' hh:mm:ss",_duration_second_year:"y'y' MM'm' dd'd' hh:mm:ss",_duration_minute:"mm",_duration_minute_hour:"hh:mm",_duration_minute_day:"d'd' hh:mm",_duration_minute_week:"d'd' hh:mm",_duration_minute_month:"M'm' dd'd' hh:mm",_duration_minute_year:"y'y' MM'm' dd'd' hh:mm",_duration_hour:"hh'h'",_duration_hour_day:"d'd' hh'h'",_duration_hour_week:"d'd' hh'h'",_duration_hour_month:"M'm' dd'd' hh'h'",_duration_hour_year:"y'y' MM'm' dd'd' hh'h'",_duration_day:"d'd'",_duration_day_week:"d'd'",_duration_day_month:"M'm' dd'd'",_duration_day_year:"y'y' MM'm' dd'd'",_duration_week:"w'w'",_duration_week_month:"w'w'",_duration_week_year:"w'w'",_duration_month:"M'm'",_duration_month_year:"y'y' MM'm'",_duration_year:"y'y'",_era_ad:"AD",_era_bc:"BC",A:"",P:"",AM:"",PM:"","A.M.":"","P.M.":"",January:"",February:"",March:"",April:"",May:"",June:"",July:"",August:"",September:"",October:"",November:"",December:"",Jan:"",Feb:"",Mar:"",Apr:"","May(short)":"May",Jun:"",Jul:"",Aug:"",Sep:"",Oct:"",Nov:"",Dec:"",Sunday:"",Monday:"",Tuesday:"",Wednesday:"",Thursday:"",Friday:"",Saturday:"",Sun:"",Mon:"",Tue:"",Wed:"",Thu:"",Fri:"",Sat:"",_dateOrd:function(e){var t="th";if(e<11||e>13)switch(e%10){case 1:t="st";break;case 2:t="nd";break;case 3:t="rd"}return t},"Zoom Out":"",Play:"",Stop:"",Legend:"","Press ENTER to toggle":"",Loading:"",Home:"",Chart:"","Serial chart":"","X/Y chart":"","Pie chart":"","Gauge chart":"","Radar chart":"","Sankey diagram":"","Flow diagram":"","Chord diagram":"","TreeMap chart":"","Force directed tree":"","Sliced chart":"",Series:"","Candlestick Series":"","OHLC Series":"","Column Series":"","Line Series":"","Pie Slice Series":"","Funnel Series":"","Pyramid Series":"","X/Y Series":"",Map:"","Press ENTER to zoom in":"","Press ENTER to zoom out":"","Use arrow keys to zoom in and out":"","Use plus and minus keys on your keyboard to zoom in and out":"",Export:"",Image:"",Data:"",Print:"","Press ENTER or use arrow keys to navigate":"","Press ENTER to open":"","Press ENTER to print.":"","Press ENTER to export as %1.":"","(Press ESC to close this message)":"","Image Export Complete":"","Export operation took longer than expected. Something might have gone wrong.":"","Saved from":"",PNG:"",JPG:"",GIF:"",SVG:"",PDF:"",JSON:"",CSV:"",XLSX:"",HTML:"","Use TAB to select grip buttons or left and right arrows to change selection":"","Use left and right arrows to move selection":"","Use left and right arrows to move left selection":"","Use left and right arrows to move right selection":"","Use TAB select grip buttons or up and down arrows to change selection":"","Use up and down arrows to move selection":"","Use up and down arrows to move lower selection":"","Use up and down arrows to move upper selection":"","From %1 to %2":"","From %1":"","To %1":"","No parser available for file: %1":"","Error parsing file: %1":"","Unable to load file: %1":"","Invalid date":"",Close:"",Minimize:""},I=function(e){(0,c.Z)(i,e);var t=(0,d.Z)(i);function i(){return(0,h.Z)(this,i),t.apply(this,arguments)}return(0,f.Z)(i,[{key:"_setDefaults",value:function(){this.setPrivate("defaultLocale",T),(0,l.Z)((0,u.Z)(i.prototype),"_setDefaults",this).call(this)}},{key:"translate",value:function(e,t){t||(t=this._root.locale||this.getPrivate("defaultLocale"));for(var i=e,n=t[e],r=arguments.length,a=new Array(r>2?r-2:0),o=2;o<r;o++)a[o-2]=arguments[o];if(null===n)i="";else if(null!=n)n&&(i=n);else if(t!==this.getPrivate("defaultLocale"))return this.translate.apply(this,[e,this.getPrivate("defaultLocale")].concat(a));if(a.length)for(var s=a.length,l=0;l<s;++l)i=i.split("%"+(l+1)).join(a[l]);return i}},{key:"translateAny",value:function(e,t){for(var i=arguments.length,n=new Array(i>2?i-2:0),r=2;r<i;r++)n[r-2]=arguments[r];return this.translate.apply(this,[e,t].concat(n))}},{key:"setTranslationAny",value:function(e,t,i){(i||this._root.locale)[e]=t}},{key:"setTranslationsAny",value:function(e,t){var i=this;(0,v.f)(e,(function(e,n){i.setTranslationAny(e,n,t)}))}},{key:"translateEmpty",value:function(e,t){for(var i=arguments.length,n=new Array(i>2?i-2:0),r=2;r<i;r++)n[r-2]=arguments[r];var a=this.translate.apply(this,[e,t].concat(n));return a==e?"":a}},{key:"translateFunc",value:function(e,t){return this._root.locale[e]?this._root.locale[e]:t!==this.getPrivate("defaultLocale")?this.translateFunc(e,this.getPrivate("defaultLocale")):function(){return""}}},{key:"translateAll",value:function(e,t){var i=this;return this.isDefault()?e:(0,v.x)(e,(function(e){return i.translate(e,t)}))}},{key:"isDefault",value:function(){return this.getPrivate("defaultLocale")===this._root.locale}}]),i}(v.E),O=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;(0,h.Z)(this,e),Object.defineProperty(this,"a",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"b",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"c",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"d",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tx",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"ty",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.a=t,this.b=i,this.c=n,this.d=r,this.tx=a,this.ty=o}return(0,f.Z)(e,[{key:"setTransform",value:function(e,t,i,n,r){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;this.a=Math.cos(r)*a,this.b=Math.sin(r)*a,this.c=-Math.sin(r)*a,this.d=Math.cos(r)*a,this.tx=e-(i*this.a+n*this.c),this.ty=t-(i*this.b+n*this.d)}},{key:"apply",value:function(e){return{x:this.a*e.x+this.c*e.y+this.tx,y:this.b*e.x+this.d*e.y+this.ty}}},{key:"applyInverse",value:function(e){var t=1/(this.a*this.d+this.c*-this.b);return{x:this.d*t*e.x+-this.c*t*e.y+(this.ty*this.c-this.tx*this.d)*t,y:this.a*t*e.y+-this.b*t*e.x+(-this.ty*this.a+this.tx*this.b)*t}}},{key:"append",value:function(e){var t=this.a,i=this.b,n=this.c,r=this.d;this.a=e.a*t+e.b*n,this.b=e.a*i+e.b*r,this.c=e.c*t+e.d*n,this.d=e.c*i+e.d*r,this.tx=e.tx*t+e.ty*n+this.tx,this.ty=e.tx*i+e.ty*r+this.ty}},{key:"prepend",value:function(e){var t=this.tx;if(1!==e.a||0!==e.b||0!==e.c||1!==e.d){var i=this.a,n=this.c;this.a=i*e.a+this.b*e.c,this.b=i*e.b+this.b*e.d,this.c=n*e.a+this.d*e.c,this.d=n*e.b+this.d*e.d}this.tx=t*e.a+this.ty*e.c+e.tx,this.ty=t*e.b+this.ty*e.d+e.ty}},{key:"copyFrom",value:function(e){this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty}}]),e}(),D=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var i=[],n=!0,r=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(i.push(o.value),!t||i.length!==t);n=!0);}catch(l){r=!0,a=l}finally{try{!n&&s.return&&s.return()}finally{if(r)throw a}}return i}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},F=2*Math.PI,E=function(e,t,i,n,r,a,o){var s=e.x,l=e.y;return{x:n*(s*=t)-r*(l*=i)+a,y:r*s+n*l+o}},S=function(e,t){var i=1.5707963267948966===t?.551915024494:-1.5707963267948966===t?-.551915024494:4/3*Math.tan(t/4),n=Math.cos(e),r=Math.sin(e),a=Math.cos(e+t),o=Math.sin(e+t);return[{x:n-r*i,y:r+n*i},{x:a+o*i,y:o-a*i},{x:a,y:o}]},B=function(e,t,i,n){var r=e*i+t*n;return r>1&&(r=1),r<-1&&(r=-1),(e*n-t*i<0?-1:1)*Math.acos(r)},L=function(e){var t=e.px,i=e.py,n=e.cx,r=e.cy,a=e.rx,o=e.ry,s=e.xAxisRotation,l=void 0===s?0:s,u=e.largeArcFlag,c=void 0===u?0:u,d=e.sweepFlag,h=void 0===d?0:d,f=[];if(0===a||0===o)return[];var v=Math.sin(l*F/360),p=Math.cos(l*F/360),g=p*(t-n)/2+v*(i-r)/2,y=-v*(t-n)/2+p*(i-r)/2;if(0===g&&0===y)return[];a=Math.abs(a),o=Math.abs(o);var m=Math.pow(g,2)/Math.pow(a,2)+Math.pow(y,2)/Math.pow(o,2);m>1&&(a*=Math.sqrt(m),o*=Math.sqrt(m));var b=function(e,t,i,n,r,a,o,s,l,u,c,d){var h=Math.pow(r,2),f=Math.pow(a,2),v=Math.pow(c,2),p=Math.pow(d,2),g=h*f-h*p-f*v;g<0&&(g=0),g/=h*p+f*v;var y=(g=Math.sqrt(g)*(o===s?-1:1))*r/a*d,m=g*-a/r*c,b=u*y-l*m+(e+i)/2,_=l*y+u*m+(t+n)/2,w=(c-y)/r,k=(d-m)/a,x=(-c-y)/r,C=(-d-m)/a,M=B(1,0,w,k),P=B(w,k,x,C);return 0===s&&P>0&&(P-=F),1===s&&P<0&&(P+=F),[b,_,M,P]}(t,i,n,r,a,o,c,h,v,p,g,y),_=D(b,4),w=_[0],k=_[1],x=_[2],C=_[3],M=Math.abs(C)/(F/4);Math.abs(1-M)<1e-7&&(M=1);var P=Math.max(Math.ceil(M),1);C/=P;for(var Z=0;Z<P;Z++)f.push(S(x,C)),x+=C;return f.map((function(e){var t=E(e[0],a,o,p,v,w,k),i=t.x,n=t.y,r=E(e[1],a,o,p,v,w,k),s=r.x,l=r.y,u=E(e[2],a,o,p,v,w,k);return{x1:i,y1:n,x2:s,y2:l,x:u.x,y:u.y}}))};function j(e,t,i){if(t!==i)throw new Error("Required "+i+" arguments for "+e+" but got "+t)}function R(e,t,i){if(t<i)throw new Error("Required at least "+i+" arguments for "+e+" but got "+t)}function N(e,t,i){if(R(e,t,i),t%i!=0)throw new Error("Arguments for "+e+" must be in pairs of "+i)}function H(e){for(var t=0;t<e.length;t+=7){var i=t+3,n=e[i];if(n.length>1){var r=/^([01])([01])(.*)$/.exec(n);null!==r&&(e.splice(i,0,r[1]),++i,e.splice(i,0,r[2]),++i,r[3].length>0?e[i]=r[3]:e.splice(i,1))}if((n=e[++i]).length>1){var a=/^([01])(.+)$/.exec(n);null!==a&&(e.splice(i,0,a[1]),e[++i]=a[2])}}}function z(e){if(0===e||1===e)return e;throw new Error("Flag must be 0 or 1")}function V(e,t){for(;(!e.interactive||t(e))&&e._parent;)e=e._parent}function W(e,t,i){return(0,v.z)(e,(0,v.H)(t),(function(e){var t=(0,v.I)(e),n=e.touches;n?(0==n.length&&(n=e.changedTouches),i((0,v.K)(n),t)):i([e],t)}))}function Y(e){var t=document.createElement("canvas");t.width=1,t.height=1;var i=t.getContext("2d",{willReadFrequently:!0});i.drawImage(e,0,0,1,1);try{return i.getImageData(0,0,1,1),!1}catch(n){return console.warn('Image "'+e.src+'" is loaded from different host and is not covered by CORS policy. For more information about the implications read here: https://www.amcharts.com/docs/v5/concepts/cors'),!0}}function U(e){e.width=0,e.height=0,e.style.width="0px",e.style.height="0px"}var q=function(){function e(){(0,h.Z)(this,e),Object.defineProperty(this,"_x",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_y",{enumerable:!0,configurable:!0,writable:!0,value:0})}return(0,f.Z)(e,[{key:"x",get:function(){return this._x},set:function(e){this._x=e}},{key:"y",get:function(){return this._y},set:function(e){this._y=e}}]),e}(),G=function(e){(0,c.Z)(i,e);var t=(0,d.Z)(i);function i(e){var n;return(0,h.Z)(this,i),n=t.call(this),Object.defineProperty((0,s.Z)(n),"_layer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,s.Z)(n),"mask",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty((0,s.Z)(n),"visible",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty((0,s.Z)(n),"exportable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty((0,s.Z)(n),"interactive",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty((0,s.Z)(n),"inactive",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty((0,s.Z)(n),"wheelable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty((0,s.Z)(n),"cancelTouch",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty((0,s.Z)(n),"isMeasured",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty((0,s.Z)(n),"buttonMode",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty((0,s.Z)(n),"alpha",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty((0,s.Z)(n),"compoundAlpha",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty((0,s.Z)(n),"angle",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty((0,s.Z)(n),"scale",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty((0,s.Z)(n),"x",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty((0,s.Z)(n),"y",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty((0,s.Z)(n),"crisp",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty((0,s.Z)(n),"pivot",{enumerable:!0,configurable:!0,writable:!0,value:new q}),Object.defineProperty((0,s.Z)(n),"filter",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,s.Z)(n),"cursorOverStyle",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,s.Z)(n),"_replacedCursorStyle",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,s.Z)(n),"_localMatrix",{enumerable:!0,configurable:!0,writable:!0,value:new O}),Object.defineProperty((0,s.Z)(n),"_matrix",{enumerable:!0,configurable:!0,writable:!0,value:new O}),Object.defineProperty((0,s.Z)(n),"_uMatrix",{enumerable:!0,configurable:!0,writable:!0,value:new O}),Object.defineProperty((0,s.Z)(n),"_renderer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,s.Z)(n),"_parent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,s.Z)(n),"_localBounds",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,s.Z)(n),"_bounds",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,s.Z)(n),"_colorId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),n._renderer=e,n}return(0,f.Z)(i,[{key:"_dispose",value:function(){this._renderer._removeObject(this),this.getLayer().dirty=!0}},{key:"getCanvas",value:function(){return this.getLayer().view}},{key:"getLayer",value:function(){for(var e=this;;){if(e._layer)return e._layer;if(!e._parent)return this._renderer.defaultLayer;e=e._parent}}},{key:"setLayer",value:function(e,t){if(null==e)this._layer=void 0;else{this._layer=this._renderer.getLayer(e,true),this._layer.visible=true,this._layer.margin=t,t&&(0,v.W)(this._layer.view,!1),this._renderer._ghostLayer.setMargin(this._renderer.layers),this._parent&&this._parent.registerChildLayer(this._layer),this._layer.dirty=!0,this._renderer.resizeLayer(this._layer),this._renderer.resizeGhost()}}},{key:"markDirtyLayer",value:function(){this.getLayer().dirty=!0}},{key:"clear",value:function(){this.invalidateBounds()}},{key:"invalidateBounds",value:function(){this._localBounds=void 0}},{key:"_addBounds",value:function(e){}},{key:"_getColorId",value:function(){return void 0===this._colorId&&(this._colorId=this._renderer.paintId(this)),this._colorId}},{key:"_isInteractive",value:function(){return 0==this.inactive&&(this.interactive||this._renderer._forceInteractive>0)}},{key:"_isInteractiveMask",value:function(){return this._isInteractive()}},{key:"contains",value:function(e){for(;;){if(e===this)return!0;if(!e._parent)return!1;e=e._parent}}},{key:"toGlobal",value:function(e){return this._matrix.apply(e)}},{key:"toLocal",value:function(e){return this._matrix.applyInverse(e)}},{key:"getLocalMatrix",value:function(){return this._uMatrix.setTransform(0,0,this.pivot.x,this.pivot.y,this.angle*Math.PI/180,this.scale),this._uMatrix}},{key:"getLocalBounds",value:function(){if(!this._localBounds){var e=1e7;this._localBounds={left:e,top:e,right:-e,bottom:-e},this._addBounds(this._localBounds)}return this._localBounds}},{key:"getAdjustedBounds",value:function(e){this._setMatrix();var t=this.getLocalMatrix(),i=t.apply({x:e.left,y:e.top}),n=t.apply({x:e.right,y:e.top}),r=t.apply({x:e.right,y:e.bottom}),a=t.apply({x:e.left,y:e.bottom});return{left:Math.min(i.x,n.x,r.x,a.x),top:Math.min(i.y,n.y,r.y,a.y),right:Math.max(i.x,n.x,r.x,a.x),bottom:Math.max(i.y,n.y,r.y,a.y)}}},{key:"on",value:function(e,t,i){return this.interactive?this._renderer._addEvent(this,e,t,i):new v.D((function(){}))}},{key:"_setMatrix",value:function(){this._localMatrix.setTransform(this.x,this.y,this.pivot.x,this.pivot.y,this.angle*Math.PI/180,this.scale),this._matrix.copyFrom(this._localMatrix),this._parent&&this._matrix.prepend(this._parent._matrix)}},{key:"_transform",value:function(e,t){var i=this._matrix,n=i.tx*t,r=i.ty*t;this.crisp&&(n=Math.floor(n)+.5,r=Math.floor(r)+.5),e.setTransform(i.a*t,i.b*t,i.c*t,i.d*t,n,r)}},{key:"_transformMargin",value:function(e,t,i){var n=this._matrix;e.setTransform(n.a*t,n.b*t,n.c*t,n.d*t,(n.tx+i.left)*t,(n.ty+i.top)*t)}},{key:"_transformLayer",value:function(e,t,i){i.margin?this._transformMargin(e,i.scale||t,i.margin):this._transform(e,i.scale||t)}},{key:"render",value:function(e){var t=this;if(this.visible&&(!1!==this.exportable||!this._renderer._omitTainted)){this._setMatrix();var i=this._renderer.resolution,n=this._renderer.layers,r=this._renderer._ghostLayer,a=r.context,o=this.mask;o&&o._setMatrix(),(0,v.e)(n,(function(e){if(e){var n=e.context;n.save(),o&&(o._transformLayer(n,i,e),o._runPath(n),n.clip()),n.globalAlpha=t.compoundAlpha*t.alpha,t._transformLayer(n,i,e),t.filter&&(n.filter=t.filter)}})),a.save(),o&&this._isInteractiveMask()&&(o._transformMargin(a,i,r.margin),o._runPath(a),a.clip()),this._transformMargin(a,i,r.margin),this._render(e),a.restore(),(0,v.e)(n,(function(e){e&&e.context.restore()}))}}},{key:"_render",value:function(e){!1===this.exportable&&((this._layer||e).tainted=!0)}},{key:"hovering",value:function(){return this._renderer._hovering.has(this)}},{key:"dragging",value:function(){var e=this;return this._renderer._dragging.some((function(t){return t.value===e}))}},{key:"shouldCancelTouch",value:function(){var e=this._renderer;return!(e.tapToActivate&&!e._touchActive)&&(!!this.cancelTouch||!!this._parent&&this._parent.shouldCancelTouch())}}]),i}(v.V),X=function(e){(0,c.Z)(i,e);var t=(0,d.Z)(i);function i(){var e;return(0,h.Z)(this,i),e=t.apply(this,arguments),Object.defineProperty((0,s.Z)(e),"interactiveChildren",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty((0,s.Z)(e),"_childLayers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,s.Z)(e),"_children",{enumerable:!0,configurable:!0,writable:!0,value:[]}),e}return(0,f.Z)(i,[{key:"_isInteractiveMask",value:function(){return this.interactiveChildren||(0,l.Z)((0,u.Z)(i.prototype),"_isInteractiveMask",this).call(this)}},{key:"addChild",value:function(e){e._parent=this,this._children.push(e),e._layer&&this.registerChildLayer(e._layer)}},{key:"addChildAt",value:function(e,t){e._parent=this,this._children.splice(t,0,e),e._layer&&this.registerChildLayer(e._layer)}},{key:"removeChild",value:function(e){e._parent=void 0,(0,v.J)(this._children,e)}},{key:"_render",value:function(e){var t=this;(0,l.Z)((0,u.Z)(i.prototype),"_render",this).call(this,e);var n=this._renderer;this.interactive&&this.interactiveChildren&&++n._forceInteractive;var r=this._layer||e;(0,v.e)(this._children,(function(e){e.compoundAlpha=t.compoundAlpha*t.alpha,e.render(r)})),this.interactive&&this.interactiveChildren&&--n._forceInteractive}},{key:"registerChildLayer",value:function(e){this._childLayers||(this._childLayers=[]),(0,v.L)(this._childLayers,e),this._parent&&this._parent.registerChildLayer(e)}},{key:"markDirtyLayer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];(0,l.Z)((0,u.Z)(i.prototype),"markDirtyLayer",this).call(this),e&&this._childLayers&&(0,v.e)(this._childLayers,(function(e){return e.dirty=!0}))}},{key:"_dispose",value:function(){(0,l.Z)((0,u.Z)(i.prototype),"_dispose",this).call(this),this._childLayers&&(0,v.e)(this._childLayers,(function(e){e.dirty=!0}))}}]),i}(G);function K(e,t){e.left=Math.min(e.left,t.x),e.top=Math.min(e.top,t.y),e.right=Math.max(e.right,t.x),e.bottom=Math.max(e.bottom,t.y)}var $=function(){function e(){(0,h.Z)(this,e)}return(0,f.Z)(e,[{key:"colorize",value:function(e,t){}},{key:"path",value:function(e){}},{key:"addBounds",value:function(e){}}]),e}(),Q=function(e){(0,c.Z)(i,e);var t=(0,d.Z)(i);function i(){return(0,h.Z)(this,i),t.apply(this,arguments)}return(0,f.Z)(i,[{key:"colorize",value:function(e,t){e.beginPath()}}]),i}($),J=function(e){(0,c.Z)(i,e);var t=(0,d.Z)(i);function i(e){var n;return(0,h.Z)(this,i),n=t.call(this),Object.defineProperty((0,s.Z)(n),"color",{enumerable:!0,configurable:!0,writable:!0,value:e}),n}return(0,f.Z)(i,[{key:"colorize",value:function(e,t){e.fillStyle=void 0!==t?t:this.color}}]),i}($),ee=function(e){(0,c.Z)(i,e);var t=(0,d.Z)(i);function i(e){var n;return(0,h.Z)(this,i),n=t.call(this),Object.defineProperty((0,s.Z)(n),"clearShadow",{enumerable:!0,configurable:!0,writable:!0,value:e}),n}return(0,f.Z)(i,[{key:"colorize",value:function(e,t){e.fill(),this.clearShadow&&(e.shadowColor="",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0)}}]),i}($),te=function(e){(0,c.Z)(i,e);var t=(0,d.Z)(i);function i(){return(0,h.Z)(this,i),t.apply(this,arguments)}return(0,f.Z)(i,[{key:"colorize",value:function(e,t){e.stroke()}}]),i}($),ie=function(e){(0,c.Z)(i,e);var t=(0,d.Z)(i);function i(e,n,r){var a;return(0,h.Z)(this,i),a=t.call(this),Object.defineProperty((0,s.Z)(a),"width",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty((0,s.Z)(a),"color",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty((0,s.Z)(a),"lineJoin",{enumerable:!0,configurable:!0,writable:!0,value:r}),a}return(0,f.Z)(i,[{key:"colorize",value:function(e,t){e.strokeStyle=void 0!==t?t:this.color,e.lineWidth=this.width,this.lineJoin&&(e.lineJoin=this.lineJoin)}}]),i}($),ne=function(e){(0,c.Z)(i,e);var t=(0,d.Z)(i);function i(e){var n;return(0,h.Z)(this,i),n=t.call(this),Object.defineProperty((0,s.Z)(n),"dash",{enumerable:!0,configurable:!0,writable:!0,value:e}),n}return(0,f.Z)(i,[{key:"colorize",value:function(e,t){e.setLineDash(this.dash)}}]),i}($),re=function(e){(0,c.Z)(i,e);var t=(0,d.Z)(i);function i(e){var n;return(0,h.Z)(this,i),n=t.call(this),Object.defineProperty((0,s.Z)(n),"dashOffset",{enumerable:!0,configurable:!0,writable:!0,value:e}),n}return(0,f.Z)(i,[{key:"colorize",value:function(e,t){e.lineDashOffset=this.dashOffset}}]),i}($),ae=function(e){(0,c.Z)(i,e);var t=(0,d.Z)(i);function i(e,n,r,a){var o;return(0,h.Z)(this,i),o=t.call(this),Object.defineProperty((0,s.Z)(o),"x",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty((0,s.Z)(o),"y",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty((0,s.Z)(o),"width",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty((0,s.Z)(o),"height",{enumerable:!0,configurable:!0,writable:!0,value:a}),o}return(0,f.Z)(i,[{key:"path",value:function(e){e.rect(this.x,this.y,this.width,this.height)}},{key:"addBounds",value:function(e){var t=this.x,i=this.y,n=t+this.width,r=i+this.height;K(e,{x:t,y:i}),K(e,{x:n,y:i}),K(e,{x:t,y:r}),K(e,{x:n,y:r})}}]),i}($),oe=function(e){(0,c.Z)(i,e);var t=(0,d.Z)(i);function i(e,n,r){var a;return(0,h.Z)(this,i),a=t.call(this),Object.defineProperty((0,s.Z)(a),"x",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty((0,s.Z)(a),"y",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty((0,s.Z)(a),"radius",{enumerable:!0,configurable:!0,writable:!0,value:r}),a}return(0,f.Z)(i,[{key:"path",value:function(e){e.moveTo(this.x+this.radius,this.y),e.arc(this.x,this.y,this.radius,0,2*Math.PI)}},{key:"addBounds",value:function(e){K(e,{x:this.x-this.radius,y:this.y-this.radius}),K(e,{x:this.x+this.radius,y:this.y+this.radius})}}]),i}($),se=function(e){(0,c.Z)(i,e);var t=(0,d.Z)(i);function i(e,n,r,a){var o;return(0,h.Z)(this,i),o=t.call(this),Object.defineProperty((0,s.Z)(o),"x",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty((0,s.Z)(o),"y",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty((0,s.Z)(o),"radiusX",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty((0,s.Z)(o),"radiusY",{enumerable:!0,configurable:!0,writable:!0,value:a}),o}return(0,f.Z)(i,[{key:"path",value:function(e){e.ellipse(0,0,this.radiusX,this.radiusY,0,0,2*Math.PI)}},{key:"addBounds",value:function(e){K(e,{x:this.x-this.radiusX,y:this.y-this.radiusY}),K(e,{x:this.x+this.radiusX,y:this.y+this.radiusY})}}]),i}($),le=function(e){(0,c.Z)(i,e);var t=(0,d.Z)(i);function i(e,n,r,a,o,l){var u;return(0,h.Z)(this,i),u=t.call(this),Object.defineProperty((0,s.Z)(u),"cx",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty((0,s.Z)(u),"cy",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty((0,s.Z)(u),"radius",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty((0,s.Z)(u),"startAngle",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty((0,s.Z)(u),"endAngle",{enumerable:!0,configurable:!0,writable:!0,value:o}),Object.defineProperty((0,s.Z)(u),"anticlockwise",{enumerable:!0,configurable:!0,writable:!0,value:l}),u}return(0,f.Z)(i,[{key:"path",value:function(e){this.radius>0&&e.arc(this.cx,this.cy,this.radius,this.startAngle,this.endAngle,this.anticlockwise)}},{key:"addBounds",value:function(e){var t=(0,v.X)(this.cx,this.cy,this.startAngle*v.Y,this.endAngle*v.Y,this.radius);K(e,{x:t.left,y:t.top}),K(e,{x:t.right,y:t.bottom})}}]),i}($),ue=function(e){(0,c.Z)(i,e);var t=(0,d.Z)(i);function i(e,n,r,a,o){var l;return(0,h.Z)(this,i),l=t.call(this),Object.defineProperty((0,s.Z)(l),"x1",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty((0,s.Z)(l),"y1",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty((0,s.Z)(l),"x2",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty((0,s.Z)(l),"y2",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty((0,s.Z)(l),"radius",{enumerable:!0,configurable:!0,writable:!0,value:o}),l}return(0,f.Z)(i,[{key:"path",value:function(e){this.radius>0&&e.arcTo(this.x1,this.y1,this.x2,this.y2,this.radius)}},{key:"addBounds",value:function(e){}}]),i}($),ce=function(e){(0,c.Z)(i,e);var t=(0,d.Z)(i);function i(e,n){var r;return(0,h.Z)(this,i),r=t.call(this),Object.defineProperty((0,s.Z)(r),"x",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty((0,s.Z)(r),"y",{enumerable:!0,configurable:!0,writable:!0,value:n}),r}return(0,f.Z)(i,[{key:"path",value:function(e){e.lineTo(this.x,this.y)}},{key:"addBounds",value:function(e){K(e,{x:this.x,y:this.y})}}]),i}($),de=function(e){(0,c.Z)(i,e);var t=(0,d.Z)(i);function i(e,n){var r;return(0,h.Z)(this,i),r=t.call(this),Object.defineProperty((0,s.Z)(r),"x",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty((0,s.Z)(r),"y",{enumerable:!0,configurable:!0,writable:!0,value:n}),r}return(0,f.Z)(i,[{key:"path",value:function(e){e.moveTo(this.x,this.y)}},{key:"addBounds",value:function(e){K(e,{x:this.x,y:this.y})}}]),i}($),he=function(e){(0,c.Z)(i,e);var t=(0,d.Z)(i);function i(){return(0,h.Z)(this,i),t.apply(this,arguments)}return(0,f.Z)(i,[{key:"path",value:function(e){e.closePath()}}]),i}($),fe=function(e){(0,c.Z)(i,e);var t=(0,d.Z)(i);function i(e,n,r,a,o,l){var u;return(0,h.Z)(this,i),u=t.call(this),Object.defineProperty((0,s.Z)(u),"cpX",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty((0,s.Z)(u),"cpY",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty((0,s.Z)(u),"cpX2",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty((0,s.Z)(u),"cpY2",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty((0,s.Z)(u),"toX",{enumerable:!0,configurable:!0,writable:!0,value:o}),Object.defineProperty((0,s.Z)(u),"toY",{enumerable:!0,configurable:!0,writable:!0,value:l}),u}return(0,f.Z)(i,[{key:"path",value:function(e){e.bezierCurveTo(this.cpX,this.cpY,this.cpX2,this.cpY2,this.toX,this.toY)}},{key:"addBounds",value:function(e){K(e,{x:this.cpX,y:this.cpY}),K(e,{x:this.cpX2,y:this.cpY2}),K(e,{x:this.toX,y:this.toY})}}]),i}($),ve=function(e){(0,c.Z)(i,e);var t=(0,d.Z)(i);function i(e,n,r,a){var o;return(0,h.Z)(this,i),o=t.call(this),Object.defineProperty((0,s.Z)(o),"cpX",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty((0,s.Z)(o),"cpY",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty((0,s.Z)(o),"toX",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty((0,s.Z)(o),"toY",{enumerable:!0,configurable:!0,writable:!0,value:a}),o}return(0,f.Z)(i,[{key:"path",value:function(e){e.quadraticCurveTo(this.cpX,this.cpY,this.toX,this.toY)}},{key:"addBounds",value:function(e){K(e,{x:this.cpX,y:this.cpY}),K(e,{x:this.toX,y:this.toY})}}]),i}($),pe=function(e){(0,c.Z)(i,e);var t=(0,d.Z)(i);function i(e,n,r,a,o){var l;return(0,h.Z)(this,i),l=t.call(this),Object.defineProperty((0,s.Z)(l),"color",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty((0,s.Z)(l),"blur",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty((0,s.Z)(l),"offsetX",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty((0,s.Z)(l),"offsetY",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty((0,s.Z)(l),"opacity",{enumerable:!0,configurable:!0,writable:!0,value:o}),l}return(0,f.Z)(i,[{key:"colorize",value:function(e,t){this.opacity&&(e.fillStyle=this.color),e.shadowColor=this.color,e.shadowBlur=this.blur,e.shadowOffsetX=this.offsetX,e.shadowOffsetY=this.offsetY}}]),i}($),ge=function(e){(0,c.Z)(i,e);var t=(0,d.Z)(i);function i(e,n,r,a,o){var l;return(0,h.Z)(this,i),l=t.call(this),Object.defineProperty((0,s.Z)(l),"image",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty((0,s.Z)(l),"width",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty((0,s.Z)(l),"height",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty((0,s.Z)(l),"x",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty((0,s.Z)(l),"y",{enumerable:!0,configurable:!0,writable:!0,value:o}),l}return(0,f.Z)(i,[{key:"path",value:function(e){e.drawImage(this.image,this.x,this.y,this.width,this.height)}},{key:"addBounds",value:function(e){K(e,{x:this.x,y:this.y}),K(e,{x:this.width,y:this.height})}}]),i}($),ye=function(e){(0,c.Z)(i,e);var t=(0,d.Z)(i);function i(){var e;return(0,h.Z)(this,i),e=t.apply(this,arguments),Object.defineProperty((0,s.Z)(e),"_operations",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty((0,s.Z)(e),"blendMode",{enumerable:!0,configurable:!0,writable:!0,value:v.N.NORMAL}),Object.defineProperty((0,s.Z)(e),"_hasShadows",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty((0,s.Z)(e),"_fillAlpha",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,s.Z)(e),"_strokeAlpha",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e}return(0,f.Z)(i,[{key:"clear",value:function(){(0,l.Z)((0,u.Z)(i.prototype),"clear",this).call(this),this._operations.length=0}},{key:"_pushOp",value:function(e){this._operations.push(e)}},{key:"beginFill",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this._fillAlpha=t,e?e instanceof v.C?this._pushOp(new J(e.toCSS(t))):(this.isMeasured=!0,this._pushOp(new J(e))):this._pushOp(new J("rgba(0, 0, 0, "+t+")"))}},{key:"endFill",value:function(){this._pushOp(new ee(this._hasShadows))}},{key:"endStroke",value:function(){this._pushOp(new te)}},{key:"beginPath",value:function(){this._pushOp(new Q)}},{key:"lineStyle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3?arguments[3]:void 0;this._strokeAlpha=i,t?t instanceof v.C?this._pushOp(new ie(e,t.toCSS(i),n)):this._pushOp(new ie(e,t,n)):this._pushOp(new ie(e,"rgba(0, 0, 0, "+i+")",n))}},{key:"setLineDash",value:function(e){this._pushOp(new ne(e||[]))}},{key:"setLineDashOffset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._pushOp(new re(e))}},{key:"drawRect",value:function(e,t,i,n){this._pushOp(new ae(e,t,i,n))}},{key:"drawCircle",value:function(e,t,i){this._pushOp(new oe(e,t,i))}},{key:"drawEllipse",value:function(e,t,i,n){this._pushOp(new se(e,t,i,n))}},{key:"arc",value:function(e,t,i,n,r){var a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];this._pushOp(new le(e,t,i,n,r,a))}},{key:"arcTo",value:function(e,t,i,n,r){this._pushOp(new ue(e,t,i,n,r))}},{key:"lineTo",value:function(e,t){this._pushOp(new ce(e,t))}},{key:"moveTo",value:function(e,t){this._pushOp(new de(e,t))}},{key:"bezierCurveTo",value:function(e,t,i,n,r,a){this._pushOp(new fe(e,t,i,n,r,a))}},{key:"quadraticCurveTo",value:function(e,t,i,n){this._pushOp(new ve(e,t,i,n))}},{key:"closePath",value:function(){this._pushOp(new he)}},{key:"shadow",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4?arguments[4]:void 0;this._hasShadows=!0,this._pushOp(new pe(r?e.toCSS(r):e.toCSS(this._fillAlpha||this._strokeAlpha),t,i,n))}},{key:"image",value:function(e,t,i,n,r){this._pushOp(new ge(e,t,i,n,r))}},{key:"svgPath",value:function(e){for(var t,i=this,n=0,r=0,a=null,o=null,s=null,l=null,u=/([MmZzLlHhVvCcSsQqTtAa])([^MmZzLlHhVvCcSsQqTtAa]*)/g,c=/[\u0009\u0020\u000A\u000C\u000D]*([\+\-]?[0-9]*\.?[0-9]+(?:[eE][\+\-]?[0-9]+)?)[\u0009\u0020\u000A\u000C\u000D]*,?/g;null!==(t=u.exec(e));){for(var d=t[1],h=t[2],f=[];null!==(t=c.exec(h));)f.push(t[1]);switch("S"!==d&&"s"!==d&&"C"!==d&&"c"!==d&&(a=null,o=null),"Q"!==d&&"q"!==d&&"T"!==d&&"t"!==d&&(s=null,l=null),d){case"M":N(d,f.length,2),n=+f[0],r=+f[1],this.moveTo(n,r);for(var p=2;p<f.length;p+=2)n=+f[p],r=+f[p+1],this.lineTo(n,r);break;case"m":N(d,f.length,2),n+=+f[0],r+=+f[1],this.moveTo(n,r);for(var g=2;g<f.length;g+=2)n+=+f[g],r+=+f[g+1],this.lineTo(n,r);break;case"L":N(d,f.length,2);for(var y=0;y<f.length;y+=2)n=+f[y],r=+f[y+1],this.lineTo(n,r);break;case"l":N(d,f.length,2);for(var m=0;m<f.length;m+=2)n+=+f[m],r+=+f[m+1],this.lineTo(n,r);break;case"H":R(d,f.length,1);for(var b=0;b<f.length;++b)n=+f[b],this.lineTo(n,r);break;case"h":R(d,f.length,1);for(var _=0;_<f.length;++_)n+=+f[_],this.lineTo(n,r);break;case"V":R(d,f.length,1);for(var w=0;w<f.length;++w)r=+f[w],this.lineTo(n,r);break;case"v":R(d,f.length,1);for(var k=0;k<f.length;++k)r+=+f[k],this.lineTo(n,r);break;case"C":N(d,f.length,6);for(var x=0;x<f.length;x+=6){var C=+f[x],M=+f[x+1];a=+f[x+2],o=+f[x+3],n=+f[x+4],r=+f[x+5],this.bezierCurveTo(C,M,a,o,n,r)}break;case"c":N(d,f.length,6);for(var P=0;P<f.length;P+=6){var Z=+f[P]+n,A=+f[P+1]+r;a=+f[P+2]+n,o=+f[P+3]+r,n+=+f[P+4],r+=+f[P+5],this.bezierCurveTo(Z,A,a,o,n,r)}break;case"S":N(d,f.length,4),null!==a&&null!==o||(a=n,o=r);for(var T=0;T<f.length;T+=4){var I=2*n-a,O=2*r-o;a=+f[T],o=+f[T+1],n=+f[T+2],r=+f[T+3],this.bezierCurveTo(I,O,a,o,n,r)}break;case"s":N(d,f.length,4),null!==a&&null!==o||(a=n,o=r);for(var D=0;D<f.length;D+=4){var F=2*n-a,E=2*r-o;a=+f[D]+n,o=+f[D+1]+r,n+=+f[D+2],r+=+f[D+3],this.bezierCurveTo(F,E,a,o,n,r)}break;case"Q":N(d,f.length,4);for(var S=0;S<f.length;S+=4)s=+f[S],l=+f[S+1],n=+f[S+2],r=+f[S+3],this.quadraticCurveTo(s,l,n,r);break;case"q":N(d,f.length,4);for(var B=0;B<f.length;B+=4)s=+f[B]+n,l=+f[B+1]+r,n+=+f[B+2],r+=+f[B+3],this.quadraticCurveTo(s,l,n,r);break;case"T":N(d,f.length,2),null!==s&&null!==l||(s=n,l=r);for(var V=0;V<f.length;V+=2)s=2*n-s,l=2*r-l,n=+f[V],r=+f[V+1],this.quadraticCurveTo(s,l,n,r);break;case"t":N(d,f.length,2),null!==s&&null!==l||(s=n,l=r);for(var W=0;W<f.length;W+=2)s=2*n-s,l=2*r-l,n+=+f[W],r+=+f[W+1],this.quadraticCurveTo(s,l,n,r);break;case"A":case"a":var Y="a"===d;H(f),N(d,f.length,7);for(var U=0;U<f.length;U+=7){var q=+f[U+5],G=+f[U+6];Y&&(q+=n,G+=r);var X=L({px:n,py:r,rx:+f[U],ry:+f[U+1],xAxisRotation:+f[U+2],largeArcFlag:z(+f[U+3]),sweepFlag:z(+f[U+4]),cx:q,cy:G});(0,v.e)(X,(function(e){i.bezierCurveTo(e.x1,e.y1,e.x2,e.y2,e.x,e.y),n=e.x,r=e.y}))}break;case"Z":case"z":j(d,f.length,0),this.closePath()}}}},{key:"_runPath",value:function(e){e.beginPath(),(0,v.e)(this._operations,(function(t){t.path(e)}))}},{key:"_render",value:function(e){(0,l.Z)((0,u.Z)(i.prototype),"_render",this).call(this,e);var t=this._layer||e,n=t.dirty,r=this._isInteractive();if(n||r){var a,o=t.context,s=this._renderer._ghostLayer.context;n&&(o.globalCompositeOperation=this.blendMode,o.beginPath()),r&&(s.beginPath(),a=this._getColorId()),(0,v.e)(this._operations,(function(e){n&&(e.path(o),e.colorize(o,void 0)),r&&(e.path(s),e.colorize(s,a))}))}}},{key:"renderDetached",value:function(e){if(this.visible){this._setMatrix(),e.save();var t=this.mask;t&&(t._setMatrix(),t._transform(e,1),t._runPath(e),e.clip()),e.globalAlpha=this.compoundAlpha*this.alpha,this._transform(e,1),this.filter&&(e.filter=this.filter),e.globalCompositeOperation=this.blendMode,e.beginPath(),(0,v.e)(this._operations,(function(t){t.path(e),t.colorize(e,void 0)})),e.restore()}}},{key:"_addBounds",value:function(e){this.visible&&this.isMeasured&&(0,v.e)(this._operations,(function(t){t.addBounds(e)}))}}]),i}(G),me=function(e){(0,c.Z)(i,e);var t=(0,d.Z)(i);function i(e,n,r){var a;return(0,h.Z)(this,i),a=t.call(this,e),Object.defineProperty((0,s.Z)(a),"text",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,s.Z)(a),"style",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,s.Z)(a),"resolution",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty((0,s.Z)(a),"textVisible",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty((0,s.Z)(a),"_textInfo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,s.Z)(a),"_originalScale",{enumerable:!0,configurable:!0,writable:!0,value:1}),a.text=n,a.style=r,a}return(0,f.Z)(i,[{key:"invalidateBounds",value:function(){(0,l.Z)((0,u.Z)(i.prototype),"invalidateBounds",this).call(this),this._textInfo=void 0}},{key:"_shared",value:function(e){this.style.textAlign&&(e.textAlign=this.style.textAlign),this.style.direction&&(e.direction=this.style.direction),this.style.textBaseline&&(e.textBaseline=this.style.textBaseline)}},{key:"_prerender",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];(0,l.Z)((0,u.Z)(i.prototype),"_render",this).call(this,e);var r=e.context,a=this._renderer._ghostLayer.context,o=this.style,s=this._getFontStyle(void 0,n);r.font=s,this._isInteractive()&&!t&&(a.font=s),o.fill&&(o.fill instanceof v.C?r.fillStyle=o.fill.toCSS(null!=o.fillOpacity?o.fillOpacity:1):r.fillStyle=o.fill),o.shadowColor&&(e.context.shadowColor=o.shadowColor.toCSS(o.shadowOpacity||1)),o.shadowBlur&&(e.context.shadowBlur=o.shadowBlur),o.shadowOffsetX&&(e.context.shadowOffsetX=o.shadowOffsetX),o.shadowOffsetY&&(e.context.shadowOffsetY=o.shadowOffsetY),this._shared(r),this._isInteractive()&&!t&&(a.fillStyle=this._getColorId(),this._shared(a))}},{key:"_getFontStyle",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.style,n=[];return e&&e.fontVariant?n.push(e.fontVariant):i.fontVariant&&n.push(i.fontVariant),t||(e&&e.fontWeight?n.push(e.fontWeight):i.fontWeight&&n.push(i.fontWeight)),e&&e.fontStyle?n.push(e.fontStyle):i.fontStyle&&n.push(i.fontStyle),e&&e.fontSize?((0,v.g)(e.fontSize)&&(e.fontSize=e.fontSize+"px"),n.push(e.fontSize)):i.fontSize&&((0,v.g)(i.fontSize)&&(i.fontSize=i.fontSize+"px"),n.push(i.fontSize)),e&&e.fontFamily?n.push(e.fontFamily):i.fontFamily?n.push(i.fontFamily):n.length&&n.push("Arial"),n.join(" ")}},{key:"_render",value:function(e){var t=this,i=this._layer||e;if(this._textInfo||this._measure(i),this.textVisible){var n=this._isInteractive(),r=i.context,a=i.dirty,o=this._renderer._ghostLayer.context;r.save(),o.save(),this._prerender(i),(0,v.e)(this._textInfo,(function(e,i){(0,v.e)(e.textChunks,(function(i,s){if(i.style&&(r.save(),o.save(),r.font=i.style,t._isInteractive()&&(o.font=i.style)),i.fill&&(r.save(),r.fillStyle=i.fill.toCSS()),a&&r.fillText(i.text,i.offsetX,e.offsetY+i.offsetY),"underline"==i.textDecoration||"line-through"==i.textDecoration){var l,u=1,c=1,d=i.height,h=i.offsetX;switch(t.style.textAlign){case"right":case"end":h-=i.width;break;case"center":h-=i.width/2}if(i.style)switch(v.T.getTextStyle(i.style).fontWeight){case"bolder":case"bold":case"700":case"800":case"900":u=2}d&&(c=d/20),l="line-through"==i.textDecoration?u+e.offsetY+i.offsetY-i.height/2:u+1.5*c+e.offsetY+i.offsetY,r.save(),r.beginPath(),i.fill?r.strokeStyle=i.fill.toCSS():t.style.fill&&t.style.fill instanceof v.C&&(r.strokeStyle=t.style.fill.toCSS()),r.lineWidth=u*c,r.moveTo(h,l),r.lineTo(h+i.width,l),r.stroke(),r.restore()}n&&t.interactive&&o.fillText(i.text,i.offsetX,e.offsetY+i.offsetY),i.fill&&r.restore(),i.style&&(r.restore(),o.restore())}))})),r.restore(),o.restore()}}},{key:"_addBounds",value:function(e){if(this.visible&&this.isMeasured){var t=this._measure(this.getLayer());K(e,{x:t.left,y:t.top}),K(e,{x:t.right,y:t.bottom})}}},{key:"_ignoreFontWeight",value:function(){return/apple/i.test(navigator.vendor)}},{key:"_measure",value:function(e){var t=this,i=e.context,n=this._renderer._ghostLayer.context,r="rtl"==this.style.direction;this._textInfo=[];var a=this.style.oversizedBehavior,o=this.style.maxWidth,s=(0,v.g)(o)&&"truncate"==a,l=(0,v.g)(o)&&("wrap"==a||"wrap-no-break"==a);i.save(),n.save(),this._prerender(e,!0,this._ignoreFontWeight());var u,c="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 ",d=this.text.toString().replace(/\r/g,"").split(/\n/),h=!0,f=0,p=0,g=0;(0,v.e)(d,(function(e,r){var a,d=function(){var e={offsetY:g,ascent:0,width:0,height:0,left:0,right:0,textChunks:[]},r=t._measureText(c,i),d=r.actualBoundingBoxAscent+r.actualBoundingBoxDescent,y=void 0;e.height=d,e.ascent=r.actualBoundingBoxAscent;var m=void 0,b=void 0,_=void 0,w=t.style.textDecoration,k=!1,x=!0,C=[];(0,v.O)(a,(function(r,d){if("format"==r.type)if("[/]"==r.text)h||(i.restore(),n.restore(),h=!0),m=void 0,u=void 0,b=void 0,w=t.style.textDecoration,_=void 0,y=r.text;else{h||(i.restore(),n.restore());var f=v.T.getTextStyle(r.text),p=t._getFontStyle(f);i.save(),n.save(),i.font=p,u=p,y=r.text,f.textDecoration&&(w=f.textDecoration),f.fill&&(m=f.fill),f.width&&(b=(0,v.u)(f.width)),f.verticalAlign&&(_=f.verticalAlign),h=!1;var g=t._measureText(c,i),M=g.actualBoundingBoxAscent+g.actualBoundingBoxDescent;M>e.height&&(e.height=M),g.actualBoundingBoxAscent>e.ascent&&(e.ascent=g.actualBoundingBoxAscent)}else if("value"==r.type&&!k){var P=t._measureText(r.text,i),Z=P.actualBoundingBoxLeft+P.actualBoundingBoxRight;if(s){var A=x||t.style.breakWords||!1,T=t.style.ellipsis||"",I=t._measureText(T,i),O=I.actualBoundingBoxLeft+I.actualBoundingBoxRight;if(e.width+Z>o){var D=o-e.width-O;r.text=t._truncateText(i,r.text,D,A),r.text+=T,k=!0}}else if(l&&e.width+Z>o){var F=o-e.width,E=t._truncateText(i,r.text,F,!1,x&&"wrap-no-break"!=t.style.oversizedBehavior);if(""==E)return t.textVisible=!0,!1;C=a.slice(d+1),(0,v.Z)(E)!=(0,v.Z)(r.text)&&(C.unshift({type:"value",text:r.text.substr(E.length)}),y&&C.unshift({type:"format",text:y})),r.text=(0,v.Z)(E),a=[],k=!0}var S=1,B=1;if(u&&b&&b>Z){var L=Z/b;switch(t.style.textAlign){case"right":case"end":S=L;break;case"center":S=L,B=L;break;default:B=L}Z=b}var j=P.actualBoundingBoxAscent+P.actualBoundingBoxDescent;j>e.height&&(e.height=j),P.actualBoundingBoxAscent>e.ascent&&(e.ascent=P.actualBoundingBoxAscent),e.width+=Z,e.left+=P.actualBoundingBoxLeft/S,e.right+=P.actualBoundingBoxRight/B,e.textChunks.push({style:u,fill:m,text:r.text,width:Z,height:j,left:P.actualBoundingBoxLeft,right:P.actualBoundingBoxRight,ascent:P.actualBoundingBoxAscent,offsetX:0,offsetY:0,textDecoration:w,verticalAlign:_}),x=!1}return!0})),t.style.lineHeight instanceof v.Q?(e.height*=t.style.lineHeight.value,e.ascent*=t.style.lineHeight.value):(e.height*=t.style.lineHeight||1.2,e.ascent*=t.style.lineHeight||1.2),f<e.left&&(f=e.left),p<e.right&&(p=e.right),t._textInfo.push(e),g+=e.height,a=C||[]};for(a=""==e?[{type:"value",text:""}]:v.T.chunk(e,!1,t.style.ignoreFormatting);a.length>0;)d()})),h||(i.restore(),n.restore()),(0,v.e)(this._textInfo,(function(e,i){var n=0;(0,v.e)(e.textChunks,(function(i){if(i.offsetX=n+i.left-e.left,i.offsetY+=e.height-e.height*(t.style.baselineRatio||.19),n+=i.width,i.verticalAlign)switch(i.verticalAlign){case"super":i.offsetY-=e.height/2-i.height/2;break;case"sub":i.offsetY+=i.height/2}}))}));var y={left:r?-p:-f,top:0,right:r?f:p,bottom:g};if("none"!==a){var m=this._fitRatio(y);if(m<1)if("fit"==a)(0,v.g)(this.style.minScale)&&m<this.style.minScale?(this.textVisible=!1,y.left=0,y.top=0,y.right=0,y.bottom=0):(this._originalScale&&1!=this._originalScale||(this._originalScale=this.scale),this.scale=m,this.textVisible=!0);else if("hide"==a)this.textVisible=!1,y.left=0,y.top=0,y.right=0,y.bottom=0;else{switch(this.style.textAlign){case"right":case"end":y.left=-o,y.right=0;break;case"center":y.left=-o/2,y.right=o/2;break;default:y.left=0,y.right=o}this.scale=this._originalScale||1,this._originalScale=void 0,this.textVisible=!0}else this.scale=this._originalScale||1,this._originalScale=void 0,this.textVisible=!0}return i.restore(),n.restore(),y}},{key:"_fitRatio",value:function(e){var t=this.style.maxWidth,i=this.style.maxHeight;if(!(0,v.g)(t)&&!(0,v.g)(i))return 1;var n=e.right-e.left,r=e.bottom-e.top;return Math.min(t/n||1,i/r||1)}},{key:"_truncateText",value:function(e,t,i){var n,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];do{if(r)t=t.slice(0,-1);else{var o=t.replace(/[^,;:!?\\\/\s]+[,;:!?\\\/\s]*$/g,"");if(""==o&&a)r=!0;else{if(""==o)return t;t=o}}var s=this._measureText(t,e);n=s.actualBoundingBoxLeft+s.actualBoundingBoxRight}while(n>i&&""!=t);return t}},{key:"_measureText",value:function(e,t){var i=t.measureText(e),n={};if(null==i.actualBoundingBoxAscent){var r=document.createElement("div");r.innerText=e,r.style.visibility="hidden",r.style.position="absolute",r.style.top="-1000000px;",r.style.fontFamily=this.style.fontFamily||"",r.style.fontSize=this.style.fontSize+"",document.body.appendChild(r);var a=r.getBoundingClientRect();document.body.removeChild(r);var o=a.height,s=i.width;n={actualBoundingBoxAscent:o,actualBoundingBoxDescent:0,actualBoundingBoxLeft:0,actualBoundingBoxRight:s,fontBoundingBoxAscent:o,fontBoundingBoxDescent:0,width:s}}else n={actualBoundingBoxAscent:i.actualBoundingBoxAscent,actualBoundingBoxDescent:i.actualBoundingBoxDescent,actualBoundingBoxLeft:i.actualBoundingBoxLeft,actualBoundingBoxRight:i.actualBoundingBoxRight,fontBoundingBoxAscent:i.actualBoundingBoxAscent,fontBoundingBoxDescent:i.actualBoundingBoxDescent,width:i.width};var l=i.width;switch(this.style.textAlign){case"right":case"end":n.actualBoundingBoxLeft=l,n.actualBoundingBoxRight=0;break;case"center":n.actualBoundingBoxLeft=l/2,n.actualBoundingBoxRight=l/2;break;default:n.actualBoundingBoxLeft=0,n.actualBoundingBoxRight=l}return n}}]),i}(G),be=(0,f.Z)((function e(){(0,h.Z)(this,e),Object.defineProperty(this,"fill",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fillOpacity",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"textAlign",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fontFamily",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fontWeight",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fontVariant",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"textDecoration",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shadowColor",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shadowBlur",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shadowOffsetX",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shadowOffsetY",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shadowOpacity",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lineHeight",{enumerable:!0,configurable:!0,writable:!0,value:(0,v.R)(120)}),Object.defineProperty(this,"baselineRatio",{enumerable:!0,configurable:!0,writable:!0,value:.19}),Object.defineProperty(this,"direction",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"textBaseline",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"oversizedBehavior",{enumerable:!0,configurable:!0,writable:!0,value:"none"}),Object.defineProperty(this,"breakWords",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ellipsis",{enumerable:!0,configurable:!0,writable:!0,value:"\u2026"}),Object.defineProperty(this,"maxWidth",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxHeight",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"minScale",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"ignoreFormatting",{enumerable:!0,configurable:!0,writable:!0,value:!1})})),_e=function(e){(0,c.Z)(i,e);var t=(0,d.Z)(i);function i(){var e;return(0,h.Z)(this,i),e=t.apply(this,arguments),Object.defineProperty((0,s.Z)(e),"textType",{enumerable:!0,configurable:!0,writable:!0,value:"circular"}),Object.defineProperty((0,s.Z)(e),"radius",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,s.Z)(e),"startAngle",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,s.Z)(e),"inside",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty((0,s.Z)(e),"orientation",{enumerable:!0,configurable:!0,writable:!0,value:"auto"}),Object.defineProperty((0,s.Z)(e),"kerning",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty((0,s.Z)(e),"_textReversed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),e}return(0,f.Z)(i,[{key:"_render",value:function(e){"circular"===this.textType?this._renderCircular(e):(0,l.Z)((0,u.Z)(i.prototype),"_render",this).call(this,e)}},{key:"_renderCircular",value:function(e){if(this.textVisible){var t=this._layer||e;this._prerender(t);var i=this._isInteractive(),n=t.context,r=t.dirty,a=this._renderer._ghostLayer.context;n.save(),i&&a.save(),this._textInfo||this._measure(t);var o=this.radius||0,s=this.startAngle||0,l=0,u=this.orientation,c="auto"==u?"auto":"inward"==u,d=this.inside,h=this.style.textAlign||"left",f=this.kerning||0,p="left"==h?1:-1,g=!this._textReversed;if("auto"==c){var y=0,m=0;(0,v.e)(this._textInfo,(function(e,t){var i=s+e.width/(o-e.height)/2*-p;i>y&&(y=i)})),m="left"==h?(y+l/2)*v.Y:"right"==h?(y-l/2)*v.Y:s*v.Y,m=(0,v.S)(m),c=m>=270||m<=90}1==c&&g&&(this._textInfo.reverse(),this._textReversed=!0),(0,v.e)(this._textInfo,(function(e,t){var u=e.height;d||(o+=u),(-1==p&&c||1==p&&!c)&&g&&e.textChunks.reverse();var y=s;l=0,"center"==h&&(y+=e.width/(o-u)/2*-p,l=y-s),y+=Math.PI*(c?0:1),n.save(),i&&a.save(),n.rotate(y),i&&a.rotate(y);var m=0;(0,v.e)(e.textChunks,(function(e,t){var s=e.text,l=e.width;m=l/2/(o-u)*p,n.rotate(m),i&&a.rotate(m),e.style&&(n.save(),a.save(),n.font=e.style,i&&(a.font=e.style)),e.fill&&(n.save(),n.fillStyle=e.fill.toCSS()),n.textBaseline="middle",n.textAlign="center",i&&(a.textBaseline="middle",a.textAlign="center"),r&&n.fillText(s,0,(c?1:-1)*(0-o+u/2)),i&&a.fillText(s,0,(c?1:-1)*(0-o+u/2)),e.fill&&n.restore(),e.style&&(n.restore(),a.restore()),m=(l/2+f)/(o-u)*p,n.rotate(m),i&&a.rotate(m)})),n.restore(),i&&a.restore(),d&&(o-=u)})),n.restore(),i&&a.restore()}}},{key:"_measure",value:function(e){return"circular"===this.textType?this._measureCircular(e):(0,l.Z)((0,u.Z)(i.prototype),"_measure",this).call(this,e)}},{key:"_measureCircular",value:function(e){var t,i=this,n=e.context,r=this._renderer._ghostLayer.context,a="rtl"==this.style.direction,o=this.style.oversizedBehavior,s=this.style.maxWidth,l=(0,v.g)(s)&&"truncate"==o,u=this.style.ellipsis||"";this.textVisible=!0,this._textInfo=[],this._textReversed=!1,n.save(),r.save(),this._prerender(e,!0);var c=this.text.toString().replace(/\r/g,"").split(/\n/),d=!0,h=0,f=0;return(0,v.e)(c,(function(e,o){var c,p,g,y=v.T.chunk(e,!1,i.style.ignoreFormatting),m={offsetY:f,ascent:0,width:0,height:0,left:0,right:0,textChunks:[]};(0,v.e)(y,(function(e,o){if("format"==e.type){if("[/]"==e.text)d||(n.restore(),r.restore(),d=!0),p=void 0,c=void 0,g=void 0;else{var f=v.T.getTextStyle(e.text),y=i._getFontStyle(f);n.save(),r.save(),n.font=y,c=y,f.fill&&(p=f.fill),f.width&&(g=(0,v.u)(f.width)),d=!1}l&&(t=i._measureText(u,n))}else if("value"==e.type){var b=e.text.match(/(?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/g)||[];a&&b.reverse();for(var _=0;_<b.length;_++){var w=b[_],k=i._measureText(w,n),x=k.width;c&&g&&g>x&&(x=g);var C=k.actualBoundingBoxAscent+k.actualBoundingBoxDescent;if(C>m.height&&(m.height=C),k.actualBoundingBoxAscent>m.ascent&&(m.ascent=k.actualBoundingBoxAscent),m.width+=x,m.left+=k.actualBoundingBoxLeft,m.right+=k.actualBoundingBoxRight,m.textChunks.push({style:c,fill:p,text:w,width:x,height:C+k.actualBoundingBoxDescent,left:k.actualBoundingBoxLeft,right:k.actualBoundingBoxRight,ascent:k.actualBoundingBoxAscent,offsetX:0,offsetY:C,textDecoration:void 0}),h+=x,l){t||(t=i._measureText(u,n));var M=t.actualBoundingBoxLeft+t.actualBoundingBoxRight;if((h+=M)+M>s){1==m.textChunks.length?i.textVisible=!1:(m.width+=M,m.left+=t.actualBoundingBoxLeft,m.right+=t.actualBoundingBoxRight,m.textChunks.push({style:c,fill:p,text:u,width:M,height:C+t.actualBoundingBoxDescent,left:t.actualBoundingBoxLeft,right:t.actualBoundingBoxRight,ascent:t.actualBoundingBoxAscent,offsetX:0,offsetY:C,textDecoration:void 0}));break}}if(a)break}}})),i.style.lineHeight instanceof v.Q?m.height*=i.style.lineHeight.value:m.height*=i.style.lineHeight||1.2,i._textInfo.push(m),f+=m.height})),d||(n.restore(),r.restore()),"hide"==o&&h>s&&(this.textVisible=!1),(0,v.e)(this._textInfo,(function(e){(0,v.e)(e.textChunks,(function(t){t.offsetY+=Math.round((e.height-t.height+(e.ascent-t.ascent))/2)}))})),n.restore(),r.restore(),{left:0,top:0,right:0,bottom:0}}}]),i}(me),we=function(e){(0,c.Z)(i,e);var t=(0,d.Z)(i);function i(e,n){var r;return(0,h.Z)(this,i),r=t.call(this,e),Object.defineProperty((0,s.Z)(r),"width",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,s.Z)(r),"height",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,s.Z)(r),"image",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,s.Z)(r),"tainted",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,s.Z)(r),"shadowColor",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,s.Z)(r),"shadowBlur",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,s.Z)(r),"shadowOffsetX",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,s.Z)(r),"shadowOffsetY",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,s.Z)(r),"shadowOpacity",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,s.Z)(r),"_imageMask",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),r.image=n,r}return(0,f.Z)(i,[{key:"_dispose",value:function(){(0,l.Z)((0,u.Z)(i.prototype),"_dispose",this).call(this),this._imageMask&&U(this._imageMask)}},{key:"getLocalBounds",value:function(){if(!this._localBounds){var e=0,t=0;this.width&&(e=this.width),this.height&&(t=this.height),this._localBounds={left:0,top:0,right:e,bottom:t},this._addBounds(this._localBounds)}return this._localBounds}},{key:"_render",value:function(e){if((0,l.Z)((0,u.Z)(i.prototype),"_render",this).call(this,e),this.image){var t=this._layer||e;if(void 0===this.tainted&&(this.tainted=Y(this.image),t.tainted=!0),this.tainted&&this._renderer._omitTainted)return;if(t.dirty){this.shadowColor&&(t.context.shadowColor=this.shadowColor.toCSS(this.shadowOpacity||1)),this.shadowBlur&&(t.context.shadowBlur=this.shadowBlur),this.shadowOffsetX&&(t.context.shadowOffsetX=this.shadowOffsetX),this.shadowOffsetY&&(t.context.shadowOffsetY=this.shadowOffsetY);var n=this.width||this.image.naturalWidth,r=this.height||this.image.naturalHeight;t.context.drawImage(this.image,0,0,n,r)}if(this.interactive&&this._isInteractive()){var a=this._getMask(this.image);this._renderer._ghostLayer.context.drawImage(a,0,0)}}}},{key:"clear",value:function(){(0,l.Z)((0,u.Z)(i.prototype),"clear",this).call(this),this.image=void 0,this._imageMask=void 0}},{key:"_getMask",value:function(e){if(void 0===this._imageMask){var t=this.width||e.naturalWidth,i=this.height||e.naturalHeight,n=document.createElement("canvas");n.width=t,n.height=i;var r=n.getContext("2d");r.imageSmoothingEnabled=!1,r.fillStyle=this._getColorId(),r.fillRect(0,0,t,i),Y(e)||(r.globalCompositeOperation="destination-in",r.drawImage(e,0,0,t,i)),this._imageMask=n}return this._imageMask}}]),i}(G),ke=(0,f.Z)((function e(t,i,n,r){(0,h.Z)(this,e),Object.defineProperty(this,"event",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"originalPoint",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"point",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"bbox",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"simulated",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"native",{enumerable:!0,configurable:!0,writable:!0,value:!0}),(0,v.y)("touchevents")&&t instanceof Touch?this.id=t.identifier:this.id=null})),xe=function(e){(0,c.Z)(i,e);var t=(0,d.Z)(i);function i(e){var n;if((0,h.Z)(this,i),n=t.call(this),Object.defineProperty((0,s.Z)(n),"view",{enumerable:!0,configurable:!0,writable:!0,value:document.createElement("div")}),Object.defineProperty((0,s.Z)(n),"_layerDom",{enumerable:!0,configurable:!0,writable:!0,value:document.createElement("div")}),Object.defineProperty((0,s.Z)(n),"layers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty((0,s.Z)(n),"_dirtyLayers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty((0,s.Z)(n),"defaultLayer",{enumerable:!0,configurable:!0,writable:!0,value:n.getLayer(0)}),Object.defineProperty((0,s.Z)(n),"_ghostLayer",{enumerable:!0,configurable:!0,writable:!0,value:new Ce}),Object.defineProperty((0,s.Z)(n),"_patternCanvas",{enumerable:!0,configurable:!0,writable:!0,value:document.createElement("canvas")}),Object.defineProperty((0,s.Z)(n),"_patternContext",{enumerable:!0,configurable:!0,writable:!0,value:n._patternCanvas.getContext("2d")}),Object.defineProperty((0,s.Z)(n),"_domWidth",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty((0,s.Z)(n),"_domHeight",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty((0,s.Z)(n),"_canvasWidth",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty((0,s.Z)(n),"_canvasHeight",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty((0,s.Z)(n),"resolution",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,s.Z)(n),"interactionsEnabled",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty((0,s.Z)(n),"_listeners",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty((0,s.Z)(n),"_events",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty((0,s.Z)(n),"_colorId",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty((0,s.Z)(n),"_colorMap",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty((0,s.Z)(n),"_forceInteractive",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty((0,s.Z)(n),"_omitTainted",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty((0,s.Z)(n),"_hovering",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty((0,s.Z)(n),"_dragging",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty((0,s.Z)(n),"_mousedown",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty((0,s.Z)(n),"_lastPointerMoveEvent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,s.Z)(n),"tapToActivate",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty((0,s.Z)(n),"tapToActivateTimeout",{enumerable:!0,configurable:!0,writable:!0,value:3e3}),Object.defineProperty((0,s.Z)(n),"_touchActive",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty((0,s.Z)(n),"_touchActiveTimeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),n.resolution=null!==e&&void 0!==e?e:window.devicePixelRatio,n.view.style.position="absolute",n.view.appendChild(n._layerDom),n._disposers.push(new v.D((function(){(0,v.f)(n._events,(function(e,t){t.disposer.dispose()})),(0,v.e)(n.layers,(function(e){U(e.view),e.exportableView&&U(e.exportableView)})),U(n._ghostLayer.view),U(n._patternCanvas)}))),n._disposers.push((0,v.o)((function(){null==e&&(n.resolution=window.devicePixelRatio)}))),(0,v.y)("touchevents")){var r=function(e){0!==n._dragging.length&&(0,v.O)(n._dragging,(function(t){return!t.value.shouldCancelTouch()||(e.preventDefault(),!1)})),n._touchActiveTimeout&&n._delayTouchDeactivate()};n._disposers.push((0,v.z)(window,"touchstart",r,{passive:!1})),n._disposers.push((0,v.z)(n.view,"touchstart",r,{passive:!1})),n._disposers.push((0,v.z)(n.view,"touchmove",(function(){n._touchActiveTimeout&&n._delayTouchDeactivate()}),{passive:!0})),n._disposers.push((0,v.z)(window,"click",(function(e){n._touchActive=!1}),{passive:!0})),n._disposers.push((0,v.z)(n.view,"click",(function(e){window.setTimeout((function(){n._touchActive=!0,n._delayTouchDeactivate()}),100)}),{passive:!0}))}return(0,v.y)("wheelevents")&&n._disposers.push((0,v.z)(n.view,"wheel",(function(e){var t=!1;n._hovering.forEach((function(e){if(e.wheelable)return t=!0,!1})),t&&e.preventDefault()}),{passive:!1})),(0,o.Z)(n)}return(0,f.Z)(i,[{key:"_delayTouchDeactivate",value:function(){var e=this;this._touchActiveTimeout&&clearTimeout(this._touchActiveTimeout),this.tapToActivateTimeout>0&&(this._touchActiveTimeout=window.setTimeout((function(){e._touchActive=!1}),this.tapToActivateTimeout))}},{key:"debugGhostView",get:function(){return!!this._ghostLayer.view.parentNode},set:function(e){e?this._ghostLayer.view.parentNode||this.view.appendChild(this._ghostLayer.view):this._ghostLayer.view.parentNode&&this._ghostLayer.view.parentNode.removeChild(this._ghostLayer.view)}},{key:"createLinearGradient",value:function(e,t,i,n){return this.defaultLayer.context.createLinearGradient(e,t,i,n)}},{key:"createRadialGradient",value:function(e,t,i,n,r,a){return this.defaultLayer.context.createRadialGradient(e,t,i,n,r,a)}},{key:"createPattern",value:function(e,t,i,n,r){return this._patternCanvas.width=n,this._patternCanvas.height=r,this._patternContext.clearRect(0,0,n,r),t.renderDetached(this._patternContext),e.renderDetached(this._patternContext),this._patternContext.createPattern(this._patternCanvas,i)}},{key:"makeContainer",value:function(){return new X(this)}},{key:"makeGraphics",value:function(){return new ye(this)}},{key:"makeText",value:function(e,t){return new me(this,e,t)}},{key:"makeTextStyle",value:function(){return new be}},{key:"makeRadialText",value:function(e,t){return new _e(this,e,t)}},{key:"makePicture",value:function(e){return new we(this,e)}},{key:"resizeLayer",value:function(e){e.resize(this._canvasWidth,this._canvasHeight,this._domWidth,this._domHeight,this.resolution)}},{key:"resizeGhost",value:function(){this._ghostLayer.resize(this._canvasWidth,this._canvasHeight,this._domWidth,this._domHeight,this.resolution)}},{key:"resize",value:function(e,t,i,n){var r=this;this._canvasWidth=e,this._canvasHeight=t,this._domWidth=i,this._domHeight=n,(0,v.e)(this.layers,(function(e){e&&(e.dirty=!0,r.resizeLayer(e))})),this.resizeGhost(),this.view.style.width=i+"px",this.view.style.height=n+"px"}},{key:"createDetachedLayer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=document.createElement("canvas"),i=t.getContext("2d",{willReadFrequently:e}),n=new Me(t,i);return t.style.position="absolute",t.style.top="0px",t.style.left="0px",n}},{key:"getLayerByOrder",value:function(e){for(var t=this.layers,i=t.length,n=0;n<i;n++){var r=t[n];if(r.order==e)return r}}},{key:"getLayer",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.getLayerByOrder(e);if(i)return i;var n=this.createDetachedLayer(99==e);n.order=e,n.visible=t,n.visible&&this.resizeLayer(n);var r=this.layers;r.push(n),r.sort((function(e,t){return e.order>t.order?1:e.order<t.order?-1:0}));for(var a,o=r.length,s=(0,v.B)(r,n)+1;s<o;s++)if(r[s].visible){a=r[s];break}return n.visible&&(void 0===a?this._layerDom.appendChild(n.view):this._layerDom.insertBefore(n.view,a.view)),n}},{key:"render",value:function(e){var t=this;if(this._dirtyLayers.length=0,(0,v.e)(this.layers,(function(e){e&&e.dirty&&e.visible&&(t._dirtyLayers.push(e),e.clear())})),this._ghostLayer.clear(),e.render(this.defaultLayer),this._ghostLayer.context.restore(),(0,v.e)(this.layers,(function(e){if(e){var t=e.context;t.beginPath(),t.moveTo(0,0),t.stroke()}})),(0,v.e)(this._dirtyLayers,(function(e){e.context.restore(),e.dirty=!1})),this._hovering.size&&this._lastPointerMoveEvent){var i=this._lastPointerMoveEvent,n=i.events,r=i.target,a=i.native;(0,v.e)(n,(function(e){t._dispatchGlobalMousemove(e,r,a)}))}}},{key:"paintId",value:function(e){var t=function(e){for(var t=[0,0,0],i=0;i<24;i++)t[i%3]<<=1,t[i%3]|=1&e,e>>=1;return(0|t[2])+(t[1]<<8)+(t[0]<<16)}(++this._colorId),i=v.C.fromHex(t).toCSS();return this._colorMap[i]=e,i}},{key:"_removeObject",value:function(e){void 0!==e._colorId&&delete this._colorMap[e._colorId]}},{key:"_adjustBoundingBox",value:function(e){var t=this._ghostLayer.margin;return new DOMRect(e.left-t.left,e.top-t.top,e.width+t.left+t.right,e.height+t.top+t.bottom)}},{key:"getEvent",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.view.getBoundingClientRect(),n={x:e.clientX||0,y:e.clientY||0},r={x:n.x-(t?i.left:0),y:n.y-(t?i.top:0)};return new ke(e,n,r,this._adjustBoundingBox(i))}},{key:"_getHitTarget",value:function(e,t,i){if(!(0===t.width||0===t.height||e.x<t.left||e.x>t.right||e.y<t.top||e.y>t.bottom)&&i&&this._layerDom.contains(i)){var n=this._ghostLayer.getImageData(e,t);if(0===n.data[0]&&0===n.data[1]&&0===n.data[2])return!1;var r=v.C.fromRGB(n.data[0],n.data[1],n.data[2]).toCSS();return this._colorMap[r]}}},{key:"_withEvents",value:function(e,t){var i=this._events[e];if(void 0!==i){i.dispatching=!0;try{t(i)}finally{i.dispatching=!1,i.cleanup&&(i.cleanup=!1,(0,v.k)(i.callbacks,(function(e){return!e.disposed})),0===i.callbacks.length&&(i.disposer.dispose(),delete this._events[e]))}}}},{key:"_dispatchEventAll",value:function(e,t){this.interactionsEnabled&&this._withEvents(e,(function(e){(0,v.e)(e.callbacks,(function(e){e.disposed||e.callback.call(e.context,t)}))}))}},{key:"_dispatchEvent",value:function(e,t,i){if(!this.interactionsEnabled)return!1;var n=!1;return this._withEvents(e,(function(e){(0,v.e)(e.callbacks,(function(e){e.disposed||e.object!==t||(e.callback.call(e.context,i),n=!0)}))})),n}},{key:"_dispatchMousedown",value:function(e,t){var i=this,n=e.button;if(0==n||2==n||1==n||void 0===n){var r=this.getEvent(e),a=this._getHitTarget(r.originalPoint,r.bbox,t);if(a){var o=r.id,s=!1;V(a,(function(e){var t={id:o,value:e};return i._mousedown.push(t),!s&&i._dispatchEvent("pointerdown",e,r)&&(s=!0,i._dragging.some((function(t){return t.value===e&&t.id===o}))||i._dragging.push(t)),!0}))}}}},{key:"_dispatchGlobalMousemove",value:function(e,t,i){var n=this,r=this.getEvent(e),a=this._getHitTarget(r.originalPoint,r.bbox,t);r.native=i,a?(this._hovering.forEach((function(e){e.contains(a)||(n._hovering.delete(e),e.cursorOverStyle&&(0,v.F)(document.body,"cursor",e._replacedCursorStyle),n._dispatchEvent("pointerout",e,r))})),r.native&&V(a,(function(e){return n._hovering.has(e)||(n._hovering.add(e),e.cursorOverStyle&&(e._replacedCursorStyle=(0,v.U)(document.body,"cursor"),(0,v.F)(document.body,"cursor",e.cursorOverStyle)),n._dispatchEvent("pointerover",e,r)),!0}))):(this._hovering.forEach((function(e){e.cursorOverStyle&&(0,v.F)(document.body,"cursor",e._replacedCursorStyle),n._dispatchEvent("pointerout",e,r)})),this._hovering.clear()),this._dispatchEventAll("globalpointermove",r)}},{key:"_dispatchGlobalMouseup",value:function(e,t){var i=this.getEvent(e);i.native=t,this._dispatchEventAll("globalpointerup",i)}},{key:"_dispatchDragMove",value:function(e){var t=this;if(0!==this._dragging.length){var i=this.getEvent(e),n=i.id;this._dragging.forEach((function(e){e.id===n&&t._dispatchEvent("pointermove",e.value,i)}))}}},{key:"_dispatchDragEnd",value:function(e,t){var i,n=this,r=e.button;if(0==r||void 0===r)i="click";else if(2==r)i="rightclick";else{if(1!=r)return;i="middleclick"}var a=this.getEvent(e),o=a.id;if(0!==this._mousedown.length){var s=this._getHitTarget(a.originalPoint,a.bbox,t);s&&this._mousedown.forEach((function(e){e.id===o&&e.value.contains(s)&&n._dispatchEvent(i,e.value,a)})),this._mousedown.length=0}0!==this._dragging.length&&(this._dragging.forEach((function(e){e.id===o&&n._dispatchEvent("pointerup",e.value,a)})),this._dragging.length=0)}},{key:"_dispatchDoubleClick",value:function(e,t){var i=this,n=this.getEvent(e),r=this._getHitTarget(n.originalPoint,n.bbox,t);r&&V(r,(function(e){return!i._dispatchEvent("dblclick",e,n)}))}},{key:"_dispatchWheel",value:function(e,t){var i=this,n=this.getEvent(e),r=this._getHitTarget(n.originalPoint,n.bbox,t);r&&V(r,(function(e){return!i._dispatchEvent("wheel",e,n)}))}},{key:"_makeSharedEvent",value:function(e,t){var i=this;if(void 0===this._listeners[e]){var n=t();this._listeners[e]=new v.G((function(){delete i._listeners[e],n.dispose()}))}return this._listeners[e].increment()}},{key:"_onPointerEvent",value:function(e,t){var i=!1,n=null;function r(){n=null,i=!1}return new v.M([new v.D((function(){null!==n&&clearTimeout(n),r()})),(0,v.z)(this.view,(0,v.H)(e),(function(e){i=!0,null!==n&&clearTimeout(n),n=window.setTimeout(r,0)})),W(window,e,(function(e,r){null!==n&&(clearTimeout(n),n=null),t(e,r,i),i=!1}))])}},{key:"_initEvent",value:function(e){var t=this;switch(e){case"globalpointermove":case"pointerover":case"pointerout":return this._makeSharedEvent("pointermove",(function(){var e=function(e,i,n){t._lastPointerMoveEvent={events:e,target:i,native:n},(0,v.e)(e,(function(e){t._dispatchGlobalMousemove(e,i,n)}))};return new v.M([t._onPointerEvent("pointerdown",e),t._onPointerEvent("pointermove",e)])}));case"globalpointerup":return this._makeSharedEvent("pointerup",(function(){var e=t._onPointerEvent("pointerup",(function(e,i,n){(0,v.e)(e,(function(e){t._dispatchGlobalMouseup(e,n)})),t._lastPointerMoveEvent={events:e,target:i,native:n}})),i=t._onPointerEvent("pointercancel",(function(e,i,n){(0,v.e)(e,(function(e){t._dispatchGlobalMouseup(e,n)})),t._lastPointerMoveEvent={events:e,target:i,native:n}}));return new v.D((function(){e.dispose(),i.dispose()}))}));case"click":case"rightclick":case"middleclick":case"pointerdown":case"pointermove":case"pointerup":return this._makeSharedEvent("pointerdown",(function(){var e=t._onPointerEvent("pointerdown",(function(e,i){(0,v.e)(e,(function(e){t._dispatchMousedown(e,i)}))})),i=t._onPointerEvent("pointermove",(function(e){(0,v.e)(e,(function(e){t._dispatchDragMove(e)}))})),n=t._onPointerEvent("pointerup",(function(e,i){(0,v.e)(e,(function(e){t._dispatchDragEnd(e,i)}))})),r=t._onPointerEvent("pointercancel",(function(e,i){(0,v.e)(e,(function(e){t._dispatchDragEnd(e,i)}))}));return new v.D((function(){e.dispose(),i.dispose(),n.dispose(),r.dispose()}))}));case"dblclick":return this._makeSharedEvent("dblclick",(function(){return t._onPointerEvent("dblclick",(function(e,i){(0,v.e)(e,(function(e){t._dispatchDoubleClick(e,i)}))}))}));case"wheel":return this._makeSharedEvent("wheel",(function(){return(0,v.z)(window,(0,v.H)("wheel"),(function(e){t._dispatchWheel(e,(0,v.I)(e))}),{passive:!1})}))}}},{key:"_addEvent",value:function(e,t,i,n){var r=this,a=this._events[t];void 0===a&&(a=this._events[t]={disposer:this._initEvent(t),callbacks:[],dispatching:!1,cleanup:!1});var o={object:e,context:n,callback:i,disposed:!1};return a.callbacks.push(o),new v.D((function(){o.disposed=!0,a.dispatching?a.cleanup=!0:((0,v.J)(a.callbacks,o),0===a.callbacks.length&&(a.disposer.dispose(),delete r._events[t]))}))}},{key:"getCanvas",value:function(e,t){var i=this;this.render(e),t||(t={});var n=this.resolution,r=Math.floor(this._canvasWidth*this.resolution),a=Math.floor(this._canvasHeight*this.resolution);if(t.minWidth&&t.minWidth>r){var o=t.minWidth/r;o>n&&(n=o*this.resolution)}if(t.minHeight&&t.minHeight>a){var s=t.minHeight/a;s>n&&(n=s*this.resolution)}if(t.maxWidth&&t.maxWidth<r){var l=t.maxWidth/r;l<n&&(n=l*this.resolution)}if(t.maxHeight&&t.maxHeight>a){var u=t.maxHeight/a;u<n&&(n=u*this.resolution)}t.maintainPixelRatio&&(n/=this.resolution);var c=[],d=!1,h=document.createElement("canvas");n!=this.resolution&&(d=!0,r=r*n/this.resolution,a=a*n/this.resolution),h.width=r,h.height=a,h.style.position="fixed",h.style.top="-10000px",this.view.appendChild(h),c.push(h);var f=h.getContext("2d"),p=0,g=0,y=!1;return(0,v.e)(this.layers,(function(e){if(e&&e.visible&&(e.tainted||d)){y=!0,e.exportableView=e.view,e.exportableContext=e.context,e.view=document.createElement("canvas"),e.view.style.position="fixed",e.view.style.top="-10000px",i.view.appendChild(e.view),c.push(e.view);var t=0,o=0;e.margin&&(t+=e.margin.left||0+e.margin.right||0,o+=e.margin.top||0+e.margin.bottom||0),e.view.width=r+t,e.view.height=a+o,e.context=e.view.getContext("2d"),e.dirty=!0,e.scale=n}})),y&&(this._omitTainted=!0,this.render(e),this._omitTainted=!1),(0,v.e)(this.layers,(function(e){if(e&&e.visible){var t=0,n=0;e.margin&&(t=-(e.margin.left||0)*i.resolution,n=-(e.margin.top||0)*i.resolution),f.drawImage(e.view,t,n),e.exportableView&&(e.view=e.exportableView,e.exportableView=void 0),e.exportableContext&&(e.context=e.exportableContext,e.exportableContext=void 0),p<e.view.clientWidth&&(p=e.view.clientWidth),g<e.view.clientHeight&&(g=e.view.clientHeight),e.scale=void 0}})),h.style.width=p+"px",h.style.height=g+"px",(0,v.e)(c,(function(e){e.style.position="",e.style.top="",i.view.removeChild(e)})),h}}]),i}(v.A),Ce=function(){function e(){(0,h.Z)(this,e),Object.defineProperty(this,"view",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"context",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"margin",{enumerable:!0,configurable:!0,writable:!0,value:{left:0,right:0,top:0,bottom:0}}),Object.defineProperty(this,"_width",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_height",{enumerable:!0,configurable:!0,writable:!0,value:0}),this.view=document.createElement("canvas"),this.context=this.view.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.context.imageSmoothingEnabled=!1,this.view.style.position="absolute",this.view.style.top="0px",this.view.style.left="0px"}return(0,f.Z)(e,[{key:"resize",value:function(e,t,i,n,r){e+=this.margin.left+this.margin.right,t+=this.margin.top+this.margin.bottom,i+=this.margin.left+this.margin.right,n+=this.margin.top+this.margin.bottom,this.view.style.left=-this.margin.left+"px",this.view.style.top=-this.margin.top+"px",this._width=Math.floor(e*r),this._height=Math.floor(t*r),this.view.width=this._width,this.view.style.width=i+"px",this.view.height=this._height,this.view.style.height=n+"px"}},{key:"getImageData",value:function(e,t){return this.context.getImageData(Math.round((e.x-t.left)/t.width*this._width),Math.round((e.y-t.top)/t.height*this._height),1,1)}},{key:"setMargin",value:function(e){var t=this;this.margin.left=0,this.margin.right=0,this.margin.top=0,this.margin.bottom=0,(0,v.e)(e,(function(e){e.margin&&(t.margin.left=Math.max(t.margin.left,e.margin.left),t.margin.right=Math.max(t.margin.right,e.margin.right),t.margin.top=Math.max(t.margin.top,e.margin.top),t.margin.bottom=Math.max(t.margin.bottom,e.margin.bottom))}))}},{key:"clear",value:function(){this.context.save(),this.context.fillStyle="#000",this.context.fillRect(0,0,this._width,this._height)}}]),e}(),Me=function(){function e(t,i){(0,h.Z)(this,e),Object.defineProperty(this,"view",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"context",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tainted",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"margin",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"order",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"visible",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"scale",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"dirty",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"exportableView",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"exportableContext",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_width",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_height",{enumerable:!0,configurable:!0,writable:!0,value:0}),this.view=t,this.context=i}return(0,f.Z)(e,[{key:"resize",value:function(e,t,i,n,r){null!=this.width&&(e=this.width,i=this.width),null!=this.height&&(t=this.height,n=this.height),this.margin?(e+=this.margin.left+this.margin.right,t+=this.margin.top+this.margin.bottom,i+=this.margin.left+this.margin.right,n+=this.margin.top+this.margin.bottom,this.view.style.left=-this.margin.left+"px",this.view.style.top=-this.margin.top+"px"):(this.view.style.left="0px",this.view.style.top="0px"),this._width=Math.floor(e*r),this._height=Math.floor(t*r),this.view.width=this._width,this.view.style.width=i+"px",this.view.height=this._height,this.view.style.height=n+"px"}},{key:"clear",value:function(){this.context.save(),this.context.clearRect(0,0,this._width,this._height)}}]),e}();function Pe(e,t){null==e?requestAnimationFrame(t):setTimeout((function(){requestAnimationFrame(t)}),1e3/e)}var Ze=function(){function e(t){var i,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2?arguments[2]:void 0;if((0,h.Z)(this,e),Object.defineProperty(this,"dom",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_inner",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_settings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_isDirty",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_isDirtyParents",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_dirty",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_dirtyParents",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_dirtyBounds",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_dirtyPositions",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_ticker",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_tickers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_updateTick",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:new v._}),Object.defineProperty(this,"animationTime",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_animations",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_renderer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_rootContainer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tooltipContainer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tooltipContainerSettings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tooltip",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"language",{enumerable:!0,configurable:!0,writable:!0,value:I.new(this,{})}),Object.defineProperty(this,"locale",{enumerable:!0,configurable:!0,writable:!0,value:T}),Object.defineProperty(this,"utc",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"timezone",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fps",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"numberFormatter",{enumerable:!0,configurable:!0,writable:!0,value:x.new(this,{})}),Object.defineProperty(this,"dateFormatter",{enumerable:!0,configurable:!0,writable:!0,value:Z.new(this,{})}),Object.defineProperty(this,"durationFormatter",{enumerable:!0,configurable:!0,writable:!0,value:A.new(this,{})}),Object.defineProperty(this,"tabindex",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_tabindexes",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_a11yD",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_focusElementDirty",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_focusElementContainer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_focusedSprite",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_isShift",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_keyboardDragPoint",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tooltipElementContainer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_readerAlertElement",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_logo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tooltipDiv",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"nonce",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"interfaceColors",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"verticalLayout",{enumerable:!0,configurable:!0,writable:!0,value:v.$.new(this,{})}),Object.defineProperty(this,"horizontalLayout",{enumerable:!0,configurable:!0,writable:!0,value:v.a0.new(this,{})}),Object.defineProperty(this,"gridLayout",{enumerable:!0,configurable:!0,writable:!0,value:v.a1.new(this,{})}),Object.defineProperty(this,"_paused",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"autoResize",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"_fontHash",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(this,"_isDisposed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_disposers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_resizeSensorDisposer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tooltips",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_htmlElementContainer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_htmlEnabledContainers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),!a)throw new Error("You cannot use `new Class()`, instead use `Class.new()`");if(this._settings=r,0==r.accessible&&(this._a11yD=!0),null==r.useSafeResolution&&(r.useSafeResolution=!0),r.useSafeResolution&&(i=(0,v.ah)()),this._renderer=new xe(i),n=t instanceof HTMLElement?t:document.getElementById(t),(0,v.e)(v.a2.rootElements,(function(e){if(e.dom===n)throw new Error("You cannot have multiple Roots on the same DOM node")})),this.interfaceColors=k.new(this,{}),null===n)throw new Error("Could not find HTML element with id `"+t+"`");this.dom=n;var o=document.createElement("div");o.style.position="relative",o.style.height="100%",n.appendChild(o);var s=r.tooltipContainerBounds;s&&(this._tooltipContainerSettings=s),this._inner=o,this._updateComputedStyles(),v.a2.rootElements.push(this)}return(0,f.Z)(e,[{key:"moveDOM",value:function(e){var t;if(t=e instanceof HTMLElement?e:document.getElementById(e)){for(;this.dom.childNodes.length>0;)t.appendChild(this.dom.childNodes[0]);this.dom=t,this._initResizeSensor(),this.resize()}}},{key:"_handleLogo",value:function(){if(this._logo){var e=this.dom.offsetWidth,t=this.dom.offsetHeight;e<=150||t<=60?this._logo.hide():this._logo.show()}}},{key:"_showBranding",value:function(){if(!this._logo){var e=this.tooltipContainer.children.push(v.a3.new(this,{interactive:!0,interactiveChildren:!1,position:"absolute",setStateOnChildren:!0,paddingTop:9,paddingRight:9,paddingBottom:9,paddingLeft:9,scale:.6,y:(0,v.R)(100),centerY:v.a4,tooltipText:"Created using amCharts 5",tooltipX:v.a4,cursorOverStyle:"pointer",background:v.a5.new(this,{fill:(0,v.a6)(4671320),fillOpacity:0,tooltipY:5})})),t=p.T.new(this,{pointerOrientation:"horizontal",paddingTop:4,paddingRight:7,paddingBottom:4,paddingLeft:7});t.label.setAll({fontSize:12}),t.get("background").setAll({fill:this.interfaceColors.get("background"),stroke:this.interfaceColors.get("grid"),strokeOpacity:.3}),e.set("tooltip",t),e.events.on("click",(function(){window.open("https://www.amcharts.com/","_blank")})),e.states.create("hover",{}),e.children.push(v.a7.new(this,{stroke:(0,v.a6)(13421772),strokeWidth:3,svgPath:"M5 25 L13 25h13.6c3.4 0 6 0 10.3-4.3s5.2-12 8.6-12c3.4 0 4.3 8.6 7.7 8.6M83.4 25H79.8c-3.4 0-6 0-10.3-4.3s-5.2-12-8.6-12-4.3 8.6-7.7 8.6"})).states.create("hover",{stroke:(0,v.a6)(3976191)}),e.children.push(v.a7.new(this,{stroke:(0,v.a6)(8947848),strokeWidth:3,svgPath:"M83.4 25h-31C37 25 39.5 4.4 28.4 4.4S18.9 24.2 4.3 25H0"})).states.create("hover",{stroke:(0,v.a6)(4671320)}),this._logo=e,this._handleLogo()}}},{key:"_getRealSize",value:function(){return this.dom.getBoundingClientRect()}},{key:"_getCalculatedSize",value:function(e){return this._settings.calculateSize?this._settings.calculateSize(e):{width:e.width,height:e.height}}},{key:"_init",value:function(){var e=this,t=this._renderer,i=this._getRealSize(),n=this._getCalculatedSize(i),r=Math.floor(n.width),a=Math.floor(n.height),o=Math.floor(i.width),s=Math.floor(i.height),l=v.a3.new(this,{visible:!0,width:o,height:s});this._rootContainer=l,this._rootContainer._defaultThemes.push(g.D.new(this));var u=l.children.push(v.a3.new(this,{visible:!0,width:v.a4,height:v.a4}));this.container=u,t.resize(o,s,r,a),this._inner.appendChild(t.view),this._initResizeSensor();var c=document.createElement("div");if(this._htmlElementContainer=c,c.className="am5-html-container",c.style.position="absolute",c.style.pointerEvents="none",this._tooltipContainerSettings||(c.style.overflow="hidden"),this._inner.appendChild(c),!0!==this._a11yD){var d=document.createElement("div");d.className="am5-reader-container",d.setAttribute("role","alert"),d.style.position="absolute",d.style.width="1px",d.style.height="1px",d.style.overflow="hidden",d.style.clip="rect(1px, 1px, 1px, 1px)",this._readerAlertElement=d,this._inner.appendChild(this._readerAlertElement);var h=document.createElement("div");h.className="am5-focus-container",h.style.position="absolute",h.style.pointerEvents="none",h.style.top="0px",h.style.left="0px",h.style.overflow="hidden",h.style.width=r+"px",h.style.height=a+"px",h.setAttribute("role","application"),(0,v.W)(h,!1),this._focusElementContainer=h,this._inner.appendChild(this._focusElementContainer);var f=document.createElement("div");this._tooltipElementContainer=f,f.className="am5-tooltip-container",this._inner.appendChild(f),(0,v.y)("keyboardevents")&&(this._disposers.push((0,v.z)(window,"keydown",(function(t){16==t.keyCode?e._isShift=!0:9==t.keyCode&&(e._isShift=t.shiftKey)}))),this._disposers.push((0,v.z)(window,"keyup",(function(t){16==t.keyCode&&(e._isShift=!1)}))),this._disposers.push((0,v.z)(h,"keydown",(function(i){var n=e._focusedSprite;if(n){27==i.keyCode&&((0,v.a8)(),e._focusedSprite=void 0);var r=0,a=0;switch(i.keyCode){case 13:i.preventDefault();var o=t.getEvent(new MouseEvent("click"));return void n.events.dispatch("click",{type:"click",originalEvent:o.event,point:o.point,simulated:!0,target:n});case 37:r=-6;break;case 39:r=6;break;case 38:a=-6;break;case 40:a=6;break;default:return}if(0!=r||0!=a){if(i.preventDefault(),!n.isDragging()){e._keyboardDragPoint={x:0,y:0};var s=t.getEvent(new MouseEvent("mousedown",{clientX:0,clientY:0}));n.events.isEnabled("pointerdown")&&n.events.dispatch("pointerdown",{type:"pointerdown",originalEvent:s.event,point:s.point,simulated:!0,target:n})}var l=e._keyboardDragPoint;l.x+=r,l.y+=a;var u=t.getEvent(new MouseEvent("mousemove",{clientX:l.x,clientY:l.y}),!1);n.events.isEnabled("globalpointermove")&&n.events.dispatch("globalpointermove",{type:"globalpointermove",originalEvent:u.event,point:u.point,simulated:!0,target:n})}}}))),this._disposers.push((0,v.z)(h,"keyup",(function(i){if(e._focusedSprite){var n=e._focusedSprite,r=i.keyCode;switch(r){case 37:case 39:case 38:case 40:if(n.isDragging()){var a=e._keyboardDragPoint,o=t.getEvent(new MouseEvent("mouseup",{clientX:a.x,clientY:a.y}));return n.events.isEnabled("globalpointerup")&&n.events.dispatch("globalpointerup",{type:"globalpointerup",originalEvent:o.event,point:o.point,simulated:!0,target:n}),void(e._keyboardDragPoint=void 0)}if(n.get("focusableGroup")){var s=n.get("focusableGroup"),l=e._tabindexes.filter((function(e){return e.get("focusableGroup")==s})),u=l.indexOf(n),c=l.length-1;(u+=39==r||40==r?1:-1)<0?u=c:u>c&&(u=0),(0,v.a9)(l[u].getPrivate("focusElement").dom)}}}}))))}this._startTicker(),this.setThemes([]),this._addTooltip(),this._hasLicense()||this._showBranding()}},{key:"_initResizeSensor",value:function(){var e=this;this._resizeSensorDisposer&&this._resizeSensorDisposer.dispose(),this._resizeSensorDisposer=new w(this.dom,(function(){e.autoResize&&e.resize()})),this._disposers.push(this._resizeSensorDisposer)}},{key:"resize",value:function(){var e=this._getRealSize(),t=this._getCalculatedSize(e),i=Math.floor(t.width),n=Math.floor(t.height);if(i>0&&n>0){var r=Math.floor(e.width),a=Math.floor(e.height),o=this._htmlElementContainer;if(o.style.width=i+"px",o.style.height=n+"px",!0!==this._a11yD){var s=this._focusElementContainer;s.style.width=i+"px",s.style.height=n+"px"}this._renderer.resize(r,a,i,n);var l=this._rootContainer;l.setPrivate("width",r),l.setPrivate("height",a),this._render(),this._handleLogo()}}},{key:"_render",value:function(){this._renderer.render(this._rootContainer._display),this._focusElementDirty&&(this._updateCurrentFocus(),this._focusElementDirty=!1)}},{key:"_runTickers",value:function(e){(0,v.e)(this._tickers,(function(t){t(e)}))}},{key:"_runAnimations",value:function(e){(0,v.k)(this._animations,(function(t){return t._runAnimation(e)}))}},{key:"_runDirties",value:function(){for(var e=this,t={};this._isDirtyParents;)this._isDirtyParents=!1,(0,v.aa)(this._dirtyParents).forEach((function(i){var n=e._dirtyParents[i];delete e._dirtyParents[i],n.isDisposed()||(t[n.uid]=n,n._prepareChildren())}));(0,v.aa)(t).forEach((function(e){t[e]._updateChildren()}));var i=[];(0,v.aa)(this._dirty).forEach((function(t){var n=e._dirty[t];n.isDisposed()?delete e._dirty[n.uid]:(i.push(n),n._beforeChanged())})),i.forEach((function(t){t._changed(),delete e._dirty[t.uid],t._clearDirty()})),this._isDirty=!1;var n={},r=[];(0,v.aa)(this._dirtyBounds).forEach((function(t){var i=e._dirtyBounds[t];delete e._dirtyBounds[t],i.isDisposed()||(n[i.uid]=i.depth(),r.push(i))})),this._positionHTMLElements(),r.sort((function(e,t){return(0,v.ab)(n[t.uid],n[e.uid])})),r.forEach((function(e){e._updateBounds()}));var a=this._dirtyPositions;(0,v.aa)(a).forEach((function(e){var t=a[e];delete a[e],t.isDisposed()||t._updatePosition()})),i.forEach((function(e){e._afterChanged()}))}},{key:"_renderFrame",value:function(e){return!this._updateTick||(this.events.isEnabled("framestarted")&&this.events.dispatch("framestarted",{type:"framestarted",target:this,timestamp:e}),this._checkComputedStyles(),this._runTickers(e),this._runAnimations(e),this._runDirties(),this._render(),this._positionHTMLElements(),this.events.isEnabled("frameended")&&this.events.dispatch("frameended",{type:"frameended",target:this,timestamp:e}),0===this._tickers.length&&0===this._animations.length&&!this._isDirty)}},{key:"_runTicker",value:function(e,t){this.isDisposed()||(this.animationTime=e,this._renderFrame(e)?(this._ticker=null,this.animationTime=null):this._paused||(t?this._ticker:Pe(this.fps,this._ticker)))}},{key:"_runTickerNow",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e4;if(!this.isDisposed())for(var t=performance.now()+e;;){var i=performance.now();if(i>=t){this.animationTime=null;break}if(this.animationTime=i,this._renderFrame(i)){this.animationTime=null;break}}}},{key:"_startTicker",value:function(){var e=this;null===this._ticker&&(this.animationTime=null,this._ticker=function(t){e._runTicker(t)},Pe(this.fps,this._ticker))}},{key:"updateTick",get:function(){return this._updateTick},set:function(e){this._updateTick=e,e&&this._startTicker()}},{key:"_addDirtyEntity",value:function(e){void 0===this._dirty[e.uid]&&(this._isDirty=!0,this._dirty[e.uid]=e,this._startTicker())}},{key:"_addDirtyParent",value:function(e){void 0===this._dirtyParents[e.uid]&&(this._isDirty=!0,this._isDirtyParents=!0,this._dirtyParents[e.uid]=e,this._startTicker())}},{key:"_addDirtyBounds",value:function(e){void 0===this._dirtyBounds[e.uid]&&(this._isDirty=!0,this._dirtyBounds[e.uid]=e,this._startTicker())}},{key:"_addDirtyPosition",value:function(e){void 0===this._dirtyPositions[e.uid]&&(this._isDirty=!0,this._dirtyPositions[e.uid]=e,this._startTicker())}},{key:"_addAnimation",value:function(e){-1===this._animations.indexOf(e)&&(this._animations.push(e),this._startTicker())}},{key:"_markDirty",value:function(){this._isDirty=!0}},{key:"_markDirtyRedraw",value:function(){var e=this;this.events.once("frameended",(function(){e._isDirty=!0,e._startTicker()}))}},{key:"eachFrame",value:function(e){var t=this;return this._tickers.push(e),this._startTicker(),new v.D((function(){(0,v.J)(t._tickers,e)}))}},{key:"markDirtyGlobal",value:function(e){var t=this;e||(e=this.container),e.walkChildren((function(e){e instanceof v.a3&&t.markDirtyGlobal(e),e.markDirty(),e.markDirtyBounds()}))}},{key:"width",value:function(){return Math.floor(this._getCalculatedSize(this._getRealSize()).width)}},{key:"height",value:function(){return Math.floor(this._getCalculatedSize(this._getRealSize()).height)}},{key:"dispose",value:function(){this._isDisposed||(this._isDisposed=!0,this._rootContainer.dispose(),this._renderer.dispose(),this.horizontalLayout.dispose(),this.verticalLayout.dispose(),this.interfaceColors.dispose(),(0,v.e)(this._disposers,(function(e){e.dispose()})),this._inner&&(0,v.ac)(this._inner),(0,v.ad)(v.a2.rootElements,this))}},{key:"isDisposed",value:function(){return this._isDisposed}},{key:"readerAlert",value:function(e){!0!==this._a11yD&&(this._readerAlertElement.innerHTML=(0,v.ae)(e))}},{key:"setThemes",value:function(e){this._rootContainer.set("themes",e);var t=this.tooltipContainer;t&&t._applyThemes();var i=this.interfaceColors;i&&i._applyThemes()}},{key:"_addTooltip",value:function(){if(!this.tooltipContainer){var e=this._tooltipContainerSettings,t=this._rootContainer.children.push(v.a3.new(this,{position:"absolute",isMeasured:!1,width:v.a4,height:v.a4,layer:e?35:30,layerMargin:e||void 0}));this.tooltipContainer=t;var i=p.T.new(this,{});this.container.set("tooltip",i),i.hide(0),this._tooltip=i}}},{key:"_registerTabindexOrder",value:function(e){1!=this._a11yD&&(e.get("focusable")?(0,v.L)(this._tabindexes,e):(0,v.ad)(this._tabindexes,e),this._invalidateTabindexes())}},{key:"_unregisterTabindexOrder",value:function(e){1!=this._a11yD&&((0,v.ad)(this._tabindexes,e),this._invalidateTabindexes())}},{key:"_invalidateTabindexes",value:function(){var e=this;if(1!=this._a11yD){this._tabindexes.sort((function(e,t){var i=e.get("tabindexOrder",0),n=t.get("tabindexOrder",0);return i==n?0:i>n?1:-1}));var t=[];(0,v.e)(this._tabindexes,(function(i,n){i.getPrivate("focusElement")?e._moveFocusElement(n,i):e._makeFocusElement(n,i);var r=i.get("focusableGroup");r&&(-1!==t.indexOf(r)?i.getPrivate("focusElement").dom.setAttribute("tabindex","-1"):t.push(r))}))}}},{key:"_updateCurrentFocus",value:function(){1!=this._a11yD&&this._focusedSprite&&(this._decorateFocusElement(this._focusedSprite),this._positionFocusElement(this._focusedSprite))}},{key:"_decorateFocusElement",value:function(e,t){if(1!=this._a11yD&&(t||(t=e.getPrivate("focusElement").dom),t)){e.get("visible")&&"tooltip"!=e.get("role")&&!e.isHidden()?"-1"!=t.getAttribute("tabindex")&&t.setAttribute("tabindex",""+this.tabindex):t.removeAttribute("tabindex");var i=e.get("role");i?t.setAttribute("role",i):t.removeAttribute("role");var n=e.get("ariaLabel");if(n){var r=(0,v.af)(e,n);t.setAttribute("aria-label",r)}else t.removeAttribute("aria-label");var a=e.get("ariaLive");a?t.setAttribute("aria-live",a):t.removeAttribute("aria-live");var o=e.get("ariaChecked");null!=o?t.setAttribute("aria-checked",o?"true":"false"):t.removeAttribute("aria-checked"),e.get("ariaHidden")?t.setAttribute("aria-hidden","hidden"):t.removeAttribute("aria-hidden");var s=e.get("ariaOrientation");s?t.setAttribute("aria-orientation",s):t.removeAttribute("aria-orientation");var l=e.get("ariaValueNow");l?t.setAttribute("aria-valuenow",l):t.removeAttribute("aria-valuenow");var u=e.get("ariaValueMin");u?t.setAttribute("aria-valuemin",u):t.removeAttribute("aria-valuemin");var c=e.get("ariaValueMax");c?t.setAttribute("aria-valuemax",c):t.removeAttribute("aria-valuemax");var d=e.get("ariaValueText");d?t.setAttribute("aria-valuetext",d):t.removeAttribute("aria-valuetext");var h=e.get("ariaControls");h?t.setAttribute("aria-controls",h):t.removeAttribute("aria-controls")}}},{key:"_makeFocusElement",value:function(e,t){var i=this;if(!t.getPrivate("focusElement")&&1!=this._a11yD){var n=document.createElement("div");"tooltip"!=t.get("role")&&(n.tabIndex=this.tabindex),n.style.position="absolute",(0,v.W)(n,!1);var r=[];t.setPrivate("focusElement",{dom:n,disposers:r}),this._decorateFocusElement(t),r.push((0,v.z)(n,"focus",(function(t){i._handleFocus(t,e)}))),r.push((0,v.z)(n,"blur",(function(t){i._handleBlur(t,e)}))),this._moveFocusElement(e,t)}}},{key:"_removeFocusElement",value:function(e){if(1!=this._a11yD){(0,v.ad)(this._tabindexes,e);var t=e.getPrivate("focusElement");t&&(this._focusElementContainer.removeChild(t.dom),(0,v.e)(t.disposers,(function(e){e.dispose()})))}}},{key:"_hideFocusElement",value:function(e){1!=this._a11yD&&(e.getPrivate("focusElement").dom.style.display="none")}},{key:"_moveFocusElement",value:function(e,t){if(1!=this._a11yD){var i=this._focusElementContainer,n=t.getPrivate("focusElement").dom;if(n!==this._focusElementContainer.children[e]){var r=this._focusElementContainer.children[e+1];r?i.insertBefore(n,r):i.append(n)}}}},{key:"_positionFocusElement",value:function(e){if(1!=this._a11yD){var t=e.globalBounds(),i=t.right==t.left?e.width():t.right-t.left,n=t.top==t.bottom?e.height():t.bottom-t.top,r=t.left-2,a=t.top-2;i<0&&(r+=i,i=Math.abs(i)),n<0&&(a+=n,n=Math.abs(n));var o=e.getPrivate("focusElement").dom;o.style.top=a+"px",o.style.left=r+"px",o.style.width=i+4+"px",o.style.height=n+4+"px"}}},{key:"_handleFocus",value:function(e,t){if(1!=this._a11yD){var i=this._tabindexes[t];i.isVisibleDeep()?(this._positionFocusElement(i),this._focusedSprite=i,i.events.isEnabled("focus")&&i.events.dispatch("focus",{type:"focus",originalEvent:e,target:i})):this._focusNext(e.target,this._isShift?-1:1)}}},{key:"_focusNext",value:function(e,t){if(1!=this._a11yD){var i=Array.from(document.querySelectorAll(["a[href]","area[href]","button:not([disabled])","details","input:not([disabled])","iframe:not([disabled])","select:not([disabled])","textarea:not([disabled])",'[contentEditable=""]','[contentEditable="true"]','[contentEditable="TRUE"]','[tabindex]:not([tabindex^="-"])'].join(","))),n=i.indexOf(e)+t;n<0?n=i.length-1:n>=i.length&&(n=0),i[n].focus()}}},{key:"_handleBlur",value:function(e,t){if(1!=this._a11yD){var i=this._focusedSprite;i&&i.events.isEnabled("blur")&&i.events.dispatch("blur",{type:"blur",originalEvent:e,target:i}),this._focusedSprite=void 0}}},{key:"updateTooltip",value:function(e){if(1!=this._a11yD){var t=(0,v.ae)(e._getText()),i=e.getPrivate("tooltipElement");"tooltip"==e.get("role")&&""!=t?(i||(i=this._makeTooltipElement(e)),i.innerHTML!=t&&(i.innerHTML=t)):i&&(i.remove(),e.removePrivate("tooltipElement"))}}},{key:"_makeTooltipElement",value:function(e){var t=this._tooltipElementContainer,i=document.createElement("div");return i.style.position="absolute",i.style.width="1px",i.style.height="1px",i.style.overflow="hidden",i.style.clip="rect(1px, 1px, 1px, 1px)",(0,v.W)(i,!1),this._decorateFocusElement(e,i),t.append(i),e.setPrivate("tooltipElement",i),i}},{key:"_removeTooltipElement",value:function(e){if(1!=this._a11yD){var t=e.getPrivate("tooltipElement");if(t){var i=t.parentElement;i&&i.removeChild(t)}}}},{key:"_invalidateAccessibility",value:function(e){if(1!=this._a11yD){this._focusElementDirty=!0;var t=e.getPrivate("focusElement");e.get("focusable")?t&&(this._decorateFocusElement(e),this._positionFocusElement(e)):t&&this._removeFocusElement(e)}}},{key:"focused",value:function(e){return this._focusedSprite===e}},{key:"documentPointToRoot",value:function(e){var t=this.dom.getBoundingClientRect();return{x:e.x-t.left,y:e.y-t.top}}},{key:"rootPointToDocument",value:function(e){var t=this.dom.getBoundingClientRect();return{x:e.x+t.left,y:e.y+t.top}}},{key:"addDisposer",value:function(e){return this._disposers.push(e),e}},{key:"_updateComputedStyles",value:function(){var e=window.getComputedStyle(this.dom),t="";(0,v.f)(e,(function(e,i){(0,v.i)(e)&&e.match(/^font/)&&(t+=i)}));var i=t!=this._fontHash;return i&&(this._fontHash=t),i}},{key:"_checkComputedStyles",value:function(){this._updateComputedStyles()&&this._invalidateLabelBounds(this.container)}},{key:"_invalidateLabelBounds",value:function(e){var t=this;e instanceof v.a3?e.children.each((function(e){t._invalidateLabelBounds(e)})):e instanceof v.ag&&e.markDirtyBounds()}},{key:"_hasLicense",value:function(){for(var e=0;e<v.a2.licenses.length;e++)if(v.a2.licenses[e].match(/^AM5C.{5,}/i))return!0;return!1}},{key:"_licenseApplied",value:function(){this._logo&&this._logo.set("forceHidden",!0)}},{key:"debugGhostView",get:function(){return this._renderer.debugGhostView},set:function(e){this._renderer.debugGhostView=e}},{key:"tapToActivate",get:function(){return this._renderer.tapToActivate},set:function(e){this._renderer.tapToActivate=e}},{key:"tapToActivateTimeout",get:function(){return this._renderer.tapToActivateTimeout},set:function(e){this._renderer.tapToActivateTimeout=e}},{key:"_makeHTMLElement",value:function(e){var t=this,i=this._htmlElementContainer,n=document.createElement("div");return e.setPrivate("htmlElement",n),n.style.position="absolute",n.style.overflow="auto",n.style.boxSizing="border-box",(0,v.W)(n,e.get("interactive",!1)),e.events.isEnabled("click")&&((0,v.W)(n,!0),this._disposers.push((0,v.z)(n,"click",(function(i){var n=t._renderer.getEvent(i);e.events.dispatch("click",{type:"click",originalEvent:n.event,point:n.point,simulated:!1,target:e})})))),this._positionHTMLElement(e),i.append(n),(0,v.L)(this._htmlEnabledContainers,e),n}},{key:"_positionHTMLElements",value:function(){var e=this;(0,v.e)(this._htmlEnabledContainers,(function(t){e._positionHTMLElement(t)}))}},{key:"_positionHTMLElement",value:function(e){var t=e.getPrivate("htmlElement");if(t){(0,v.e)(["paddingTop","paddingRight","paddingBottom","paddingLeft","minWidth","minHeight","maxWidth","maxHeight"],(function(i){var n=e.get(i);t.style[i]=n?n+"px":""}));var i=e.compositeOpacity();setTimeout((function(){t.style.opacity=i+""}),10);var n=e.isVisibleDeep();n&&(t.style.display="block");var r=e.globalBounds();t.style.top=r.top+"px",t.style.left=r.left+"px";var a=e.get("width"),o=e.get("height"),s=0,l=0;if(a&&(s=e.width()),o&&(l=e.height()),a&&o)e.removePrivate("minWidth"),e.removePrivate("minHeight");else{t.style.position="fixed",t.style.width="",t.style.height="";var u=t.getBoundingClientRect();t.style.position="absolute",s=u.width,l=u.height,e._adjustedLocalBounds={left:0,right:0,top:0,bottom:0},e.setPrivate("minWidth",s),e.setPrivate("minHeight",l)}s>0&&(t.style.minWidth=s+"px"),l>0&&(t.style.minHeight=l+"px"),n&&0!=i||(t.style.display="none")}}},{key:"_setHTMLContent",value:function(e,t){var i=e.getPrivate("htmlElement");i||(i=this._makeHTMLElement(e)),i.innerHTML!=t&&(i.innerHTML=t)}},{key:"_removeHTMLContent",value:function(e){var t=e.getPrivate("htmlElement");t&&this._htmlElementContainer.removeChild(t),(0,v.ad)(this._htmlEnabledContainers,e)}}],[{key:"new",value:function(t,i){var n=new e(t,i,!0);return n._init(),n}}]),e}();(0,v.ai)("AM5C241025748");var Ae="en-us",Te=new Map([["ar",function(){return i.e(5291).then(i.bind(i,79406))}],["bg-bg",function(){return i.e(73).then(i.bind(i,60073))}],["bs-ba",function(){return i.e(6636).then(i.bind(i,86636))}],["ca-es",function(){return i.e(9359).then(i.bind(i,69359))}],["cs-cz",function(){return i.e(99).then(i.bind(i,50099))}],["da-dk",function(){return i.e(2371).then(i.bind(i,92371))}],["de-de",function(){return i.e(9566).then(i.bind(i,19566))}],["de-ch",function(){return i.e(5155).then(i.bind(i,85155))}],["el-gr",function(){return i.e(5133).then(i.bind(i,75133))}],["en-us",function(){return i.e(7559).then(i.bind(i,87559))}],["en-ca",function(){return i.e(5970).then(i.bind(i,65970))}],["es-es",function(){return i.e(9722).then(i.bind(i,69722))}],["et-ee",function(){return i.e(9658).then(i.bind(i,19658))}],["fi-fi",function(){return i.e(8292).then(i.bind(i,18292))}],["fr-fr",function(){return i.e(9543).then(i.bind(i,69543))}],["he-il",function(){return i.e(4669).then(i.bind(i,44669))}],["hr-hr",function(){return i.e(2194).then(i.bind(i,12194))}],["hu-hu",function(){return i.e(9906).then(i.bind(i,59906))}],["id-id",function(){return i.e(8661).then(i.bind(i,68661))}],["it-it",function(){return i.e(321).then(i.bind(i,60321))}],["ja-jp",function(){return i.e(4625).then(i.bind(i,94625))}],["ko-kr",function(){return i.e(8244).then(i.bind(i,38244))}],["lt-lt",function(){return i.e(782).then(i.bind(i,10782))}],["lv-lv",function(){return i.e(1960).then(i.bind(i,71960))}],["nb-no",function(){return i.e(4263).then(i.bind(i,84263))}],["nl-nl",function(){return i.e(1428).then(i.bind(i,51428))}],["pl-pl",function(){return i.e(5979).then(i.bind(i,65979))}],["pt-br",function(){return i.e(8220).then(i.bind(i,88220))}],["pt-pt",function(){return i.e(6425).then(i.bind(i,46425))}],["ro-ro",function(){return i.e(9768).then(i.bind(i,79768))}],["ru-ru",function(){return i.e(9437).then(i.bind(i,59437))}],["sk-sk",function(){return i.e(4699).then(i.bind(i,64699))}],["sl-sl",function(){return i.e(9613).then(i.bind(i,29613))}],["sr-rs",function(){return i.e(8191).then(i.bind(i,8191))}],["sv-se",function(){return i.e(4230).then(i.bind(i,44230))}],["th-th",function(){return i.e(4104).then(i.bind(i,64104))}],["tr-tr",function(){return i.e(5431).then(i.bind(i,12215))}],["uk-ua",function(){return i.e(9514).then(i.bind(i,88191))}],["vi-vn",function(){return i.e(2838).then(i.bind(i,92838))}],["zh-cn",function(){return i.e(6867).then(i.bind(i,6867))}],["zh-hk",function(){return i.e(9014).then(i.bind(i,69014))}],["zh-tw",function(){return i.e(9014).then(i.bind(i,69014))}]]);function Ie(e){return e?Te.has(e.toLowerCase())?e.toLowerCase():function(e){var t,i=e.split("-")[0].toLowerCase(),n=null,r=(0,a.Z)(Te.keys());try{for(r.s();!(t=r.n()).done;){var o=t.value;if(o.startsWith(i)){n=o;break}}}catch(s){r.e(s)}finally{r.f()}return n}(e)||Ae:Ae}function Oe(e){return De.apply(this,arguments)}function De(){return De=(0,r.Z)((0,n.Z)().mark((function e(t){var i,r,a=arguments;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=a.length>1&&void 0!==a[1]?a[1]:(0,y.Kd)(),r=Ze.new(t),e.next=4,Te.get(Ie(i))();case 4:return r.locale=e.sent.default,e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)}))),De.apply(this,arguments)}var Fe=["#7ABEE5","#B39BD5","#F8AE83","#92E6E4","#FBC487","#EE967A","#CEA2D6","#89D594","#CEE68F","#F1A6D5"].map((function(e){return(0,v.a6)(e)}))}}]);
//# sourceMappingURL=3357.4a0f1a54.chunk.js.map